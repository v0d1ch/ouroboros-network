<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_J2uTuCDZ0WPGUwXvKTaUDq"></span><span class="hs-pragma">{-# LANGUAGE DataKinds                  #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric              #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies         #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia                #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards            #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving         #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">-- For Show Errno and Condense SeekMode instances</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ouroboros.Consensus.Storage.FS.API.Types</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Modes</span></span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#OpenMode"><span class="hs-identifier">OpenMode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AllowExisting"><span class="hs-identifier">AllowExisting</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#allowExisting"><span class="hs-identifier">allowExisting</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SeekMode</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Paths</span></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier">FsPath</span></a></span><span> </span><span class="hs-comment">-- opaque</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathToList"><span class="hs-identifier">fsPathToList</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathFromList"><span class="hs-identifier">fsPathFromList</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathSplit"><span class="hs-identifier">fsPathSplit</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathInit"><span class="hs-identifier">fsPathInit</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#mkFsPath"><span class="hs-identifier">mkFsPath</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MountPoint"><span class="hs-identifier">MountPoint</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsToFilePath"><span class="hs-identifier">fsToFilePath</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsFromFilePath"><span class="hs-identifier">fsFromFilePath</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Handles</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#Handle"><span class="hs-identifier">Handle</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Offset</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AbsOffset"><span class="hs-identifier">AbsOffset</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Errors</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsError"><span class="hs-identifier">FsError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorType"><span class="hs-identifier">FsErrorType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier">FsErrorPath</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#sameFsError"><span class="hs-identifier">sameFsError</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#isFsErrorType"><span class="hs-identifier">isFsErrorType</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#prettyFsError"><span class="hs-identifier">prettyFsError</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsToFsErrorPath"><span class="hs-identifier">fsToFsErrorPath</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsToFsErrorPathUnmounted"><span class="hs-identifier">fsToFsErrorPathUnmounted</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#hasMountPoint"><span class="hs-identifier">hasMountPoint</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- * From 'IOError' to 'FsError'</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#ioToFsError"><span class="hs-identifier">ioToFsError</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#ioToFsErrorType"><span class="hs-identifier">ioToFsErrorType</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">force</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stripPrefix</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Foreign.C.Error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Errno</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Foreign.C.Error</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">GHC.IO.Exception</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GHC</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">InspectHeap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">InspectHeapNamed</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>                     </span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SeekMode</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Error</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IO</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.CallStack.html"><span class="hs-identifier">Ouroboros.Consensus.Util.CallStack</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html"><span class="hs-identifier">Ouroboros.Consensus.Util.Condense</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Modes
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | How to 'hOpen' a new file.</span><span>
</span><span id="line-71"></span><span class="hs-keyword">data</span><span> </span><span id="OpenMode"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#OpenMode"><span class="hs-identifier hs-var">OpenMode</span></a></span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ReadMode"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#ReadMode"><span class="hs-identifier hs-var">ReadMode</span></a></span></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="WriteMode"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#WriteMode"><span class="hs-identifier hs-var">WriteMode</span></a></span></span><span>     </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AllowExisting"><span class="hs-identifier hs-type">AllowExisting</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AppendMode"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AppendMode"><span class="hs-identifier hs-var">AppendMode</span></a></span></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AllowExisting"><span class="hs-identifier hs-type">AllowExisting</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ReadWriteMode"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#ReadWriteMode"><span class="hs-identifier hs-var">ReadWriteMode</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AllowExisting"><span class="hs-identifier hs-type">AllowExisting</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679982240"><span id="local-6989586621679982242"><span class="annot"><span class="annottext">OpenMode -&gt; OpenMode -&gt; Bool
(OpenMode -&gt; OpenMode -&gt; Bool)
-&gt; (OpenMode -&gt; OpenMode -&gt; Bool) -&gt; Eq OpenMode
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: OpenMode -&gt; OpenMode -&gt; Bool
$c/= :: OpenMode -&gt; OpenMode -&gt; Bool
== :: OpenMode -&gt; OpenMode -&gt; Bool
$c== :: OpenMode -&gt; OpenMode -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679982233"><span id="local-6989586621679982235"><span id="local-6989586621679982237"><span class="annot"><span class="annottext">Int -&gt; OpenMode -&gt; ShowS
[OpenMode] -&gt; ShowS
OpenMode -&gt; String
(Int -&gt; OpenMode -&gt; ShowS)
-&gt; (OpenMode -&gt; String) -&gt; ([OpenMode] -&gt; ShowS) -&gt; Show OpenMode
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [OpenMode] -&gt; ShowS
$cshowList :: [OpenMode] -&gt; ShowS
show :: OpenMode -&gt; String
$cshow :: OpenMode -&gt; String
showsPrec :: Int -&gt; OpenMode -&gt; ShowS
$cshowsPrec :: Int -&gt; OpenMode -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | When 'hOpen'ing a file:</span><span>
</span><span id="line-79"></span><span class="hs-keyword">data</span><span> </span><span id="AllowExisting"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AllowExisting"><span class="hs-identifier hs-var">AllowExisting</span></a></span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="AllowExisting"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AllowExisting"><span class="hs-identifier hs-var">AllowExisting</span></a></span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-comment">-- ^ The file may already exist. If it does, it is reopened. If it</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-comment">-- doesn't, it is created.</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MustBeNew"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MustBeNew"><span class="hs-identifier hs-var">MustBeNew</span></a></span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-comment">-- ^ The file may not yet exist. If it does, an error</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-comment">-- ('FsResourceAlreadyExist') is thrown.</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679982226"><span id="local-6989586621679982228"><span class="annot"><span class="annottext">AllowExisting -&gt; AllowExisting -&gt; Bool
(AllowExisting -&gt; AllowExisting -&gt; Bool)
-&gt; (AllowExisting -&gt; AllowExisting -&gt; Bool) -&gt; Eq AllowExisting
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: AllowExisting -&gt; AllowExisting -&gt; Bool
$c/= :: AllowExisting -&gt; AllowExisting -&gt; Bool
== :: AllowExisting -&gt; AllowExisting -&gt; Bool
$c== :: AllowExisting -&gt; AllowExisting -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679982220"><span id="local-6989586621679982222"><span id="local-6989586621679982224"><span class="annot"><span class="annottext">Int -&gt; AllowExisting -&gt; ShowS
[AllowExisting] -&gt; ShowS
AllowExisting -&gt; String
(Int -&gt; AllowExisting -&gt; ShowS)
-&gt; (AllowExisting -&gt; String)
-&gt; ([AllowExisting] -&gt; ShowS)
-&gt; Show AllowExisting
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AllowExisting] -&gt; ShowS
$cshowList :: [AllowExisting] -&gt; ShowS
show :: AllowExisting -&gt; String
$cshow :: AllowExisting -&gt; String
showsPrec :: Int -&gt; AllowExisting -&gt; ShowS
$cshowsPrec :: Int -&gt; AllowExisting -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#allowExisting"><span class="hs-identifier hs-type">allowExisting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#OpenMode"><span class="hs-identifier hs-type">OpenMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AllowExisting"><span class="hs-identifier hs-type">AllowExisting</span></a></span><span>
</span><span id="line-89"></span><span id="allowExisting"><span class="annot"><span class="annottext">allowExisting :: OpenMode -&gt; AllowExisting
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#allowExisting"><span class="hs-identifier hs-var hs-var">allowExisting</span></a></span></span><span> </span><span id="local-6989586621679982219"><span class="annot"><span class="annottext">OpenMode
</span><a href="#local-6989586621679982219"><span class="hs-identifier hs-var">openMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OpenMode
</span><a href="#local-6989586621679982219"><span class="hs-identifier hs-var">openMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><span class="annottext">OpenMode
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#ReadMode"><span class="hs-identifier hs-var">ReadMode</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AllowExisting
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AllowExisting"><span class="hs-identifier hs-var">AllowExisting</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#WriteMode"><span class="hs-identifier hs-type">WriteMode</span></a></span><span>     </span><span id="local-6989586621679982218"><span class="annot"><span class="annottext">AllowExisting
</span><a href="#local-6989586621679982218"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AllowExisting
</span><a href="#local-6989586621679982218"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AppendMode"><span class="hs-identifier hs-type">AppendMode</span></a></span><span>    </span><span id="local-6989586621679982217"><span class="annot"><span class="annottext">AllowExisting
</span><a href="#local-6989586621679982217"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AllowExisting
</span><a href="#local-6989586621679982217"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#ReadWriteMode"><span class="hs-identifier hs-type">ReadWriteMode</span></a></span><span> </span><span id="local-6989586621679982216"><span class="annot"><span class="annottext">AllowExisting
</span><a href="#local-6989586621679982216"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AllowExisting
</span><a href="#local-6989586621679982216"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Paths
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span id="local-6989586621679982214"><span id="local-6989586621679982215"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="FsPath"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-var">FsPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UnsafeFsPath"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#UnsafeFsPath"><span class="hs-identifier hs-var">UnsafeFsPath</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="fsPathToList"><span class="annot"><span class="annottext">FsPath -&gt; [Text]
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathToList"><span class="hs-identifier hs-var hs-var">fsPathToList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Strict.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679982209"><span id="local-6989586621679982211"><span class="annot"><span class="annottext">FsPath -&gt; FsPath -&gt; Bool
(FsPath -&gt; FsPath -&gt; Bool)
-&gt; (FsPath -&gt; FsPath -&gt; Bool) -&gt; Eq FsPath
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FsPath -&gt; FsPath -&gt; Bool
$c/= :: FsPath -&gt; FsPath -&gt; Bool
== :: FsPath -&gt; FsPath -&gt; Bool
$c== :: FsPath -&gt; FsPath -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679982194"><span id="local-6989586621679982196"><span id="local-6989586621679982198"><span id="local-6989586621679982200"><span id="local-6989586621679982202"><span id="local-6989586621679982204"><span id="local-6989586621679982206"><span class="annot"><span class="annottext">Eq FsPath
Eq FsPath
-&gt; (FsPath -&gt; FsPath -&gt; Ordering)
-&gt; (FsPath -&gt; FsPath -&gt; Bool)
-&gt; (FsPath -&gt; FsPath -&gt; Bool)
-&gt; (FsPath -&gt; FsPath -&gt; Bool)
-&gt; (FsPath -&gt; FsPath -&gt; Bool)
-&gt; (FsPath -&gt; FsPath -&gt; FsPath)
-&gt; (FsPath -&gt; FsPath -&gt; FsPath)
-&gt; Ord FsPath
FsPath -&gt; FsPath -&gt; Bool
FsPath -&gt; FsPath -&gt; Ordering
FsPath -&gt; FsPath -&gt; FsPath
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: FsPath -&gt; FsPath -&gt; FsPath
$cmin :: FsPath -&gt; FsPath -&gt; FsPath
max :: FsPath -&gt; FsPath -&gt; FsPath
$cmax :: FsPath -&gt; FsPath -&gt; FsPath
&gt;= :: FsPath -&gt; FsPath -&gt; Bool
$c&gt;= :: FsPath -&gt; FsPath -&gt; Bool
&gt; :: FsPath -&gt; FsPath -&gt; Bool
$c&gt; :: FsPath -&gt; FsPath -&gt; Bool
&lt;= :: FsPath -&gt; FsPath -&gt; Bool
$c&lt;= :: FsPath -&gt; FsPath -&gt; Bool
&lt; :: FsPath -&gt; FsPath -&gt; Bool
$c&lt; :: FsPath -&gt; FsPath -&gt; Bool
compare :: FsPath -&gt; FsPath -&gt; Ordering
$ccompare :: FsPath -&gt; FsPath -&gt; Ordering
$cp1Ord :: Eq FsPath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. FsPath -&gt; Rep FsPath x)
-&gt; (forall x. Rep FsPath x -&gt; FsPath) -&gt; Generic FsPath
forall x. Rep FsPath x -&gt; FsPath
forall x. FsPath -&gt; Rep FsPath x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep FsPath x -&gt; FsPath
$cfrom :: forall x. FsPath -&gt; Rep FsPath x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679982184"><span id="local-6989586621679982186"><span id="local-6989586621679982188"><span class="annot"><span class="annottext">Context -&gt; FsPath -&gt; IO (Maybe ThunkInfo)
Proxy FsPath -&gt; String
(Context -&gt; FsPath -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; FsPath -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy FsPath -&gt; String)
-&gt; NoThunks FsPath
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy FsPath -&gt; String
$cshowTypeOf :: Proxy FsPath -&gt; String
wNoThunks :: Context -&gt; FsPath -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; FsPath -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; FsPath -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: Context -&gt; FsPath -&gt; IO (Maybe ThunkInfo)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></span></span></span></span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InspectHeap</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathFromList"><span class="hs-identifier hs-type">fsPathFromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Strict.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span>
</span><span id="line-104"></span><span id="fsPathFromList"><span class="annot"><span class="annottext">fsPathFromList :: [Text] -&gt; FsPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathFromList"><span class="hs-identifier hs-var hs-var">fsPathFromList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; FsPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#UnsafeFsPath"><span class="hs-identifier hs-var">UnsafeFsPath</span></a></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; FsPath) -&gt; ([Text] -&gt; [Text]) -&gt; [Text] -&gt; FsPath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; [Text]
forall a. NFData a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">force</span></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679982177"><span id="local-6989586621679982180"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621679982176"><span class="annot"><span class="annottext">show :: FsPath -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Context -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Context -&gt; String) -&gt; (FsPath -&gt; Context) -&gt; FsPath -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; [Text] -&gt; Context
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">Strict.unpack</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Context) -&gt; (FsPath -&gt; [Text]) -&gt; FsPath -&gt; Context
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FsPath -&gt; [Text]
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathToList"><span class="hs-identifier hs-var hs-var">fsPathToList</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#Condense"><span class="hs-identifier hs-type">Condense</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679982171"><span class="annot"><span class="annottext">condense :: FsPath -&gt; String
</span><a href="Ouroboros.Consensus.Util.Condense.html#condense"><span class="hs-identifier hs-var hs-var hs-var hs-var">condense</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FsPath -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- | Constructor for 'FsPath' ensures path is in normal form</span><span>
</span><span id="line-113"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#mkFsPath"><span class="hs-identifier hs-type">mkFsPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span>
</span><span id="line-114"></span><span id="mkFsPath"><span class="annot"><span class="annottext">mkFsPath :: Context -&gt; FsPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#mkFsPath"><span class="hs-identifier hs-var hs-var">mkFsPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; FsPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathFromList"><span class="hs-identifier hs-var">fsPathFromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; FsPath) -&gt; (Context -&gt; [Text]) -&gt; Context -&gt; FsPath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; Context -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Strict.pack</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | Split 'FsPath' is essentially @(init fp, last fp)@</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- Like @init@ and @last@, 'Nothing' if empty.</span><span>
</span><span id="line-119"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathSplit"><span class="hs-identifier hs-type">fsPathSplit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Strict.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span id="fsPathSplit"><span class="annot"><span class="annottext">fsPathSplit :: FsPath -&gt; Maybe (FsPath, Text)
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathSplit"><span class="hs-identifier hs-var hs-var">fsPathSplit</span></a></span></span><span> </span><span id="local-6989586621679982168"><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982168"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; [Text]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FsPath -&gt; [Text]
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathToList"><span class="hs-identifier hs-var hs-var">fsPathToList</span></a></span><span> </span><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982168"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (FsPath, Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-123"></span><span>      </span><span id="local-6989586621679982166"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679982166"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679982165"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679982165"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(FsPath, Text) -&gt; Maybe (FsPath, Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; FsPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathFromList"><span class="hs-identifier hs-var">fsPathFromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; [Text]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679982165"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679982166"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- | Drop the final component of the path</span><span>
</span><span id="line-126"></span><span class="hs-comment">--</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- Undefined if the path is empty.</span><span>
</span><span id="line-128"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathInit"><span class="hs-identifier hs-type">fsPathInit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span>
</span><span id="line-129"></span><span id="fsPathInit"><span class="annot"><span class="annottext">fsPathInit :: FsPath -&gt; FsPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathInit"><span class="hs-identifier hs-var hs-var">fsPathInit</span></a></span></span><span> </span><span id="local-6989586621679982164"><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982164"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FsPath -&gt; Maybe (FsPath, Text)
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathSplit"><span class="hs-identifier hs-var">fsPathSplit</span></a></span><span> </span><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982164"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-130"></span><span>                  </span><span class="annot"><span class="annottext">Maybe (FsPath, Text)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; FsPath
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; FsPath) -&gt; String -&gt; FsPath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fsPathInit: empty path&quot;</span></span><span>
</span><span id="line-131"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679982162"><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982162"><span class="hs-identifier hs-var">fp'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982162"><span class="hs-identifier hs-var">fp'</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- | Mount point</span><span>
</span><span id="line-134"></span><span class="hs-comment">--</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- 'FsPath's are not absolute paths, but must be interpreted with respect to</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- a particualar mount point.</span><span>
</span><span id="line-137"></span><span class="hs-keyword">newtype</span><span> </span><span id="MountPoint"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MountPoint"><span class="hs-identifier hs-var">MountPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MountPoint"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MountPoint"><span class="hs-identifier hs-var">MountPoint</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsToFilePath"><span class="hs-identifier hs-type">fsToFilePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MountPoint"><span class="hs-identifier hs-type">MountPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-140"></span><span id="fsToFilePath"><span class="annot"><span class="annottext">fsToFilePath :: MountPoint -&gt; FsPath -&gt; String
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsToFilePath"><span class="hs-identifier hs-var hs-var">fsToFilePath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MountPoint"><span class="hs-identifier hs-type">MountPoint</span></a></span><span> </span><span id="local-6989586621679982159"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679982159"><span class="hs-identifier hs-var">mp</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679982158"><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982158"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679982159"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ShowS) -&gt; String -&gt; Context -&gt; String
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">(&lt;/&gt;)</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; [Text] -&gt; Context
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">Strict.unpack</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Context) -&gt; [Text] -&gt; Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FsPath -&gt; [Text]
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsPathToList"><span class="hs-identifier hs-var hs-var">fsPathToList</span></a></span><span> </span><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982158"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsFromFilePath"><span class="hs-identifier hs-type">fsFromFilePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MountPoint"><span class="hs-identifier hs-type">MountPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span>
</span><span id="line-144"></span><span id="fsFromFilePath"><span class="annot"><span class="annottext">fsFromFilePath :: MountPoint -&gt; String -&gt; Maybe FsPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsFromFilePath"><span class="hs-identifier hs-var hs-var">fsFromFilePath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MountPoint"><span class="hs-identifier hs-type">MountPoint</span></a></span><span> </span><span id="local-6989586621679982155"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679982155"><span class="hs-identifier hs-var">mp</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679982154"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679982154"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; FsPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#mkFsPath"><span class="hs-identifier hs-var">mkFsPath</span></a></span><span> </span><span class="annot"><span class="annottext">(Context -&gt; FsPath) -&gt; Maybe Context -&gt; Maybe FsPath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="annottext">Context -&gt; Context -&gt; Maybe Context
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><span class="hs-identifier hs-var">stripPrefix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Context
</span><span class="hs-identifier hs-var">splitDirectories</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679982155"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Context
</span><span class="hs-identifier hs-var">splitDirectories</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679982154"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | For better error reporting to the end user, we want to include the</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- mount point of the file. But the mountpoint may not always be available,</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- like when we mock the fs or we simulate fs errors.</span><span>
</span><span id="line-150"></span><span class="hs-keyword">data</span><span> </span><span id="FsErrorPath"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-var">FsErrorPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FsErrorPath"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-var">FsErrorPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MountPoint"><span class="hs-identifier hs-type">MountPoint</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsToFsErrorPath"><span class="hs-identifier hs-type">fsToFsErrorPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MountPoint"><span class="hs-identifier hs-type">MountPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-type">FsErrorPath</span></a></span><span>
</span><span id="line-153"></span><span id="fsToFsErrorPath"><span class="annot"><span class="annottext">fsToFsErrorPath :: MountPoint -&gt; FsPath -&gt; FsErrorPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsToFsErrorPath"><span class="hs-identifier hs-var hs-var">fsToFsErrorPath</span></a></span></span><span> </span><span id="local-6989586621679982150"><span class="annot"><span class="annottext">MountPoint
</span><a href="#local-6989586621679982150"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MountPoint -&gt; FsPath -&gt; FsErrorPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-var">FsErrorPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MountPoint -&gt; Maybe MountPoint
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MountPoint
</span><a href="#local-6989586621679982150"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Like 'fsToFsErrorPath', but when we don't have a 'MountPoint'</span><span>
</span><span id="line-156"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsToFsErrorPathUnmounted"><span class="hs-identifier hs-type">fsToFsErrorPathUnmounted</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-type">FsErrorPath</span></a></span><span>
</span><span id="line-157"></span><span id="fsToFsErrorPathUnmounted"><span class="annot"><span class="annottext">fsToFsErrorPathUnmounted :: FsPath -&gt; FsErrorPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsToFsErrorPathUnmounted"><span class="hs-identifier hs-var hs-var">fsToFsErrorPathUnmounted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MountPoint -&gt; FsPath -&gt; FsErrorPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-var">FsErrorPath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MountPoint
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679982145"><span id="local-6989586621679982148"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-type">FsErrorPath</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621679982144"><span class="annot"><span class="annottext">show :: FsErrorPath -&gt; String
</span><a href="#local-6989586621679982144"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-type">FsErrorPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679982143"><span class="annot"><span class="annottext">MountPoint
</span><a href="#local-6989586621679982143"><span class="hs-identifier hs-var">mp</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679982142"><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982142"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MountPoint -&gt; FsPath -&gt; String
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsToFilePath"><span class="hs-identifier hs-var">fsToFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">MountPoint
</span><a href="#local-6989586621679982143"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982142"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-type">FsErrorPath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MountPoint
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span id="local-6989586621679982141"><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982141"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FsPath -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982141"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#Condense"><span class="hs-identifier hs-type">Condense</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-type">FsErrorPath</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679982139"><span class="annot"><span class="annottext">condense :: FsErrorPath -&gt; String
</span><a href="#local-6989586621679982139"><span class="hs-identifier hs-var hs-var hs-var hs-var">condense</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FsErrorPath -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | We only care to compare the 'FsPath', because the 'MountPoint' may not</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- exist.</span><span>
</span><span id="line-168"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679982136"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-type">FsErrorPath</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-type">FsErrorPath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MountPoint
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679982135"><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982135"><span class="hs-identifier hs-var">fp1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679982134"><span class="annot"><span class="annottext">== :: FsErrorPath -&gt; FsErrorPath -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-type">FsErrorPath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MountPoint
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679982133"><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982133"><span class="hs-identifier hs-var">fp2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982135"><span class="hs-identifier hs-var">fp1</span></a></span><span> </span><span class="annot"><span class="annottext">FsPath -&gt; FsPath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982133"><span class="hs-identifier hs-var">fp2</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Handles
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span id="local-6989586621679982131"><span id="local-6989586621679982132"></span></span><span class="hs-keyword">data</span><span> </span><span id="Handle"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#Handle"><span class="hs-identifier hs-var">Handle</span></a></span></span><span> </span><span id="local-6989586621679982292"><span class="annot"><a href="#local-6989586621679982292"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Handle"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#Handle"><span class="hs-identifier hs-var">Handle</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-176"></span><span>      </span><span class="hs-comment">-- | The raw underlying handle</span><span>
</span><span id="line-177"></span><span>      </span><span id="handleRaw"><span class="annot"><span class="annottext">Handle h -&gt; h
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#handleRaw"><span class="hs-identifier hs-var hs-var">handleRaw</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679982292"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span>      </span><span class="hs-comment">-- | The path corresponding to this handle</span><span>
</span><span id="line-180"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-181"></span><span>      </span><span class="hs-comment">-- This is primarily useful for error reporting.</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="handlePath"><span class="annot"><span class="annottext">Handle h -&gt; FsPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#handlePath"><span class="hs-identifier hs-var hs-var">handlePath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsPath"><span class="hs-identifier hs-type">FsPath</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. Handle h -&gt; Rep (Handle h) x)
-&gt; (forall x. Rep (Handle h) x -&gt; Handle h) -&gt; Generic (Handle h)
forall x. Rep (Handle h) x -&gt; Handle h
forall x. Handle h -&gt; Rep (Handle h) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall h x. Rep (Handle h) x -&gt; Handle h
forall h x. Handle h -&gt; Rep (Handle h) x
$cto :: forall h x. Rep (Handle h) x -&gt; Handle h
$cfrom :: forall h x. Handle h -&gt; Rep (Handle h) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679982120"><span id="local-6989586621679982122"><span id="local-6989586621679982124"><span class="annot"><span class="annottext">Context -&gt; Handle h -&gt; IO (Maybe ThunkInfo)
Proxy (Handle h) -&gt; String
(Context -&gt; Handle h -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; Handle h -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy (Handle h) -&gt; String)
-&gt; NoThunks (Handle h)
forall h. Context -&gt; Handle h -&gt; IO (Maybe ThunkInfo)
forall h. Proxy (Handle h) -&gt; String
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy (Handle h) -&gt; String
$cshowTypeOf :: forall h. Proxy (Handle h) -&gt; String
wNoThunks :: Context -&gt; Handle h -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: forall h. Context -&gt; Handle h -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; Handle h -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: forall h. Context -&gt; Handle h -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621679982120"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InspectHeapNamed</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Handle&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#Handle"><span class="hs-identifier hs-type">Handle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679982292"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span id="local-6989586621679982119"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679982116"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679982119"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#Handle"><span class="hs-identifier hs-type">Handle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679982119"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621679982115"><span class="annot"><span class="annottext">== :: Handle h -&gt; Handle h -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(==)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">h -&gt; h -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">(h -&gt; h -&gt; Bool) -&gt; (Handle h -&gt; h) -&gt; Handle h -&gt; Handle h -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">Handle h -&gt; h
forall h. Handle h -&gt; h
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#handleRaw"><span class="hs-identifier hs-var hs-var">handleRaw</span></a></span></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span id="local-6989586621679982114"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679982109"><span id="local-6989586621679982112"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#Handle"><span class="hs-identifier hs-type">Handle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679982114"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679982108"><span class="annot"><span class="annottext">show :: Handle h -&gt; String
</span><a href="#local-6989586621679982108"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#Handle"><span class="hs-identifier hs-type">Handle</span></a></span><span> </span><span class="annot"><span class="annottext">h
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679982107"><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982107"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;Handle &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">MountPoint -&gt; FsPath -&gt; String
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsToFilePath"><span class="hs-identifier hs-var">fsToFilePath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; MountPoint
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MountPoint"><span class="hs-identifier hs-var">MountPoint</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;root&gt;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FsPath
</span><a href="#local-6989586621679982107"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&quot;</span></span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Offset wrappers
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-keyword">newtype</span><span> </span><span id="AbsOffset"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AbsOffset"><span class="hs-identifier hs-var">AbsOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AbsOffset"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AbsOffset"><span class="hs-identifier hs-var">AbsOffset</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unAbsOffset"><span class="annot"><span class="annottext">AbsOffset -&gt; Word64
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#unAbsOffset"><span class="hs-identifier hs-var hs-var">unAbsOffset</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679982101"><span id="local-6989586621679982103"><span class="annot"><span class="annottext">AbsOffset -&gt; AbsOffset -&gt; Bool
(AbsOffset -&gt; AbsOffset -&gt; Bool)
-&gt; (AbsOffset -&gt; AbsOffset -&gt; Bool) -&gt; Eq AbsOffset
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: AbsOffset -&gt; AbsOffset -&gt; Bool
$c/= :: AbsOffset -&gt; AbsOffset -&gt; Bool
== :: AbsOffset -&gt; AbsOffset -&gt; Bool
$c== :: AbsOffset -&gt; AbsOffset -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679982086"><span id="local-6989586621679982088"><span id="local-6989586621679982090"><span id="local-6989586621679982092"><span id="local-6989586621679982094"><span id="local-6989586621679982096"><span id="local-6989586621679982098"><span class="annot"><span class="annottext">Eq AbsOffset
Eq AbsOffset
-&gt; (AbsOffset -&gt; AbsOffset -&gt; Ordering)
-&gt; (AbsOffset -&gt; AbsOffset -&gt; Bool)
-&gt; (AbsOffset -&gt; AbsOffset -&gt; Bool)
-&gt; (AbsOffset -&gt; AbsOffset -&gt; Bool)
-&gt; (AbsOffset -&gt; AbsOffset -&gt; Bool)
-&gt; (AbsOffset -&gt; AbsOffset -&gt; AbsOffset)
-&gt; (AbsOffset -&gt; AbsOffset -&gt; AbsOffset)
-&gt; Ord AbsOffset
AbsOffset -&gt; AbsOffset -&gt; Bool
AbsOffset -&gt; AbsOffset -&gt; Ordering
AbsOffset -&gt; AbsOffset -&gt; AbsOffset
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: AbsOffset -&gt; AbsOffset -&gt; AbsOffset
$cmin :: AbsOffset -&gt; AbsOffset -&gt; AbsOffset
max :: AbsOffset -&gt; AbsOffset -&gt; AbsOffset
$cmax :: AbsOffset -&gt; AbsOffset -&gt; AbsOffset
&gt;= :: AbsOffset -&gt; AbsOffset -&gt; Bool
$c&gt;= :: AbsOffset -&gt; AbsOffset -&gt; Bool
&gt; :: AbsOffset -&gt; AbsOffset -&gt; Bool
$c&gt; :: AbsOffset -&gt; AbsOffset -&gt; Bool
&lt;= :: AbsOffset -&gt; AbsOffset -&gt; Bool
$c&lt;= :: AbsOffset -&gt; AbsOffset -&gt; Bool
&lt; :: AbsOffset -&gt; AbsOffset -&gt; Bool
$c&lt; :: AbsOffset -&gt; AbsOffset -&gt; Bool
compare :: AbsOffset -&gt; AbsOffset -&gt; Ordering
$ccompare :: AbsOffset -&gt; AbsOffset -&gt; Ordering
$cp1Ord :: Eq AbsOffset
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679982070"><span id="local-6989586621679982072"><span id="local-6989586621679982074"><span id="local-6989586621679982076"><span id="local-6989586621679982078"><span id="local-6989586621679982080"><span id="local-6989586621679982082"><span id="local-6989586621679982084"><span class="annot"><span class="annottext">Int -&gt; AbsOffset
AbsOffset -&gt; Int
AbsOffset -&gt; [AbsOffset]
AbsOffset -&gt; AbsOffset
AbsOffset -&gt; AbsOffset -&gt; [AbsOffset]
AbsOffset -&gt; AbsOffset -&gt; AbsOffset -&gt; [AbsOffset]
(AbsOffset -&gt; AbsOffset)
-&gt; (AbsOffset -&gt; AbsOffset)
-&gt; (Int -&gt; AbsOffset)
-&gt; (AbsOffset -&gt; Int)
-&gt; (AbsOffset -&gt; [AbsOffset])
-&gt; (AbsOffset -&gt; AbsOffset -&gt; [AbsOffset])
-&gt; (AbsOffset -&gt; AbsOffset -&gt; [AbsOffset])
-&gt; (AbsOffset -&gt; AbsOffset -&gt; AbsOffset -&gt; [AbsOffset])
-&gt; Enum AbsOffset
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: AbsOffset -&gt; AbsOffset -&gt; AbsOffset -&gt; [AbsOffset]
$cenumFromThenTo :: AbsOffset -&gt; AbsOffset -&gt; AbsOffset -&gt; [AbsOffset]
enumFromTo :: AbsOffset -&gt; AbsOffset -&gt; [AbsOffset]
$cenumFromTo :: AbsOffset -&gt; AbsOffset -&gt; [AbsOffset]
enumFromThen :: AbsOffset -&gt; AbsOffset -&gt; [AbsOffset]
$cenumFromThen :: AbsOffset -&gt; AbsOffset -&gt; [AbsOffset]
enumFrom :: AbsOffset -&gt; [AbsOffset]
$cenumFrom :: AbsOffset -&gt; [AbsOffset]
fromEnum :: AbsOffset -&gt; Int
$cfromEnum :: AbsOffset -&gt; Int
toEnum :: Int -&gt; AbsOffset
$ctoEnum :: Int -&gt; AbsOffset
pred :: AbsOffset -&gt; AbsOffset
$cpred :: AbsOffset -&gt; AbsOffset
succ :: AbsOffset -&gt; AbsOffset
$csucc :: AbsOffset -&gt; AbsOffset
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679982065"><span id="local-6989586621679982067"><span class="annot"><span class="annottext">AbsOffset
AbsOffset -&gt; AbsOffset -&gt; Bounded AbsOffset
forall a. a -&gt; a -&gt; Bounded a
maxBound :: AbsOffset
$cmaxBound :: AbsOffset
minBound :: AbsOffset
$cminBound :: AbsOffset
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679982050"><span id="local-6989586621679982052"><span id="local-6989586621679982054"><span id="local-6989586621679982056"><span id="local-6989586621679982058"><span id="local-6989586621679982060"><span id="local-6989586621679982062"><span class="annot"><span class="annottext">Integer -&gt; AbsOffset
AbsOffset -&gt; AbsOffset
AbsOffset -&gt; AbsOffset -&gt; AbsOffset
(AbsOffset -&gt; AbsOffset -&gt; AbsOffset)
-&gt; (AbsOffset -&gt; AbsOffset -&gt; AbsOffset)
-&gt; (AbsOffset -&gt; AbsOffset -&gt; AbsOffset)
-&gt; (AbsOffset -&gt; AbsOffset)
-&gt; (AbsOffset -&gt; AbsOffset)
-&gt; (AbsOffset -&gt; AbsOffset)
-&gt; (Integer -&gt; AbsOffset)
-&gt; Num AbsOffset
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
fromInteger :: Integer -&gt; AbsOffset
$cfromInteger :: Integer -&gt; AbsOffset
signum :: AbsOffset -&gt; AbsOffset
$csignum :: AbsOffset -&gt; AbsOffset
abs :: AbsOffset -&gt; AbsOffset
$cabs :: AbsOffset -&gt; AbsOffset
negate :: AbsOffset -&gt; AbsOffset
$cnegate :: AbsOffset -&gt; AbsOffset
* :: AbsOffset -&gt; AbsOffset -&gt; AbsOffset
$c* :: AbsOffset -&gt; AbsOffset -&gt; AbsOffset
- :: AbsOffset -&gt; AbsOffset -&gt; AbsOffset
$c- :: AbsOffset -&gt; AbsOffset -&gt; AbsOffset
+ :: AbsOffset -&gt; AbsOffset -&gt; AbsOffset
$c+ :: AbsOffset -&gt; AbsOffset -&gt; AbsOffset
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679982043"><span id="local-6989586621679982045"><span id="local-6989586621679982047"><span class="annot"><span class="annottext">Int -&gt; AbsOffset -&gt; ShowS
[AbsOffset] -&gt; ShowS
AbsOffset -&gt; String
(Int -&gt; AbsOffset -&gt; ShowS)
-&gt; (AbsOffset -&gt; String)
-&gt; ([AbsOffset] -&gt; ShowS)
-&gt; Show AbsOffset
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AbsOffset] -&gt; ShowS
$cshowList :: [AbsOffset] -&gt; ShowS
show :: AbsOffset -&gt; String
$cshow :: AbsOffset -&gt; String
showsPrec :: Int -&gt; AbsOffset -&gt; ShowS
$cshowsPrec :: Int -&gt; AbsOffset -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Errors
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-keyword">data</span><span> </span><span id="FsError"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsError"><span class="hs-identifier hs-var">FsError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FsError"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsError"><span class="hs-identifier hs-var">FsError</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-comment">-- | Error type</span><span>
</span><span id="line-207"></span><span>      </span><span id="fsErrorType"><span class="annot"><span class="annottext">FsError -&gt; FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorType"><span class="hs-identifier hs-var hs-var">fsErrorType</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorType"><span class="hs-identifier hs-type">FsErrorType</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>      </span><span class="hs-comment">-- | Path to the file</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="fsErrorPath"><span class="annot"><span class="annottext">FsError -&gt; FsErrorPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorPath"><span class="hs-identifier hs-var hs-var">fsErrorPath</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-type">FsErrorPath</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>      </span><span class="hs-comment">-- | Human-readable string giving additional information about the error</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="fsErrorString"><span class="annot"><span class="annottext">FsError -&gt; String
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorString"><span class="hs-identifier hs-var hs-var">fsErrorString</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-comment">-- | The 'Errno', if available. This is more precise than the</span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-comment">-- 'FsErrorType'.</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="fsErrorNo"><span class="annot"><span class="annottext">FsError -&gt; Maybe Errno
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorNo"><span class="hs-identifier hs-var hs-var">fsErrorNo</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Errno</span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>      </span><span class="hs-comment">-- | Call stack</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="fsErrorStack"><span class="annot"><span class="annottext">FsError -&gt; PrettyCallStack
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorStack"><span class="hs-identifier hs-var hs-var">fsErrorStack</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.CallStack.html#PrettyCallStack"><span class="hs-identifier hs-type">PrettyCallStack</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-comment">-- | Is this error due to a limitation of the mock file system?</span><span>
</span><span id="line-223"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-224"></span><span>      </span><span class="hs-comment">-- The mock file system does not all of Posix's features and quirks.</span><span>
</span><span id="line-225"></span><span>      </span><span class="hs-comment">-- This flag will be set for such unsupported IO calls. Real I/O calls</span><span>
</span><span id="line-226"></span><span>      </span><span class="hs-comment">-- would not have thrown an error for these calls.</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="fsLimitation"><span class="annot"><span class="annottext">FsError -&gt; Bool
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsLimitation"><span class="hs-identifier hs-var hs-var">fsLimitation</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679982030"><span id="local-6989586621679982032"><span id="local-6989586621679982034"><span class="annot"><span class="annottext">Int -&gt; FsError -&gt; ShowS
[FsError] -&gt; ShowS
FsError -&gt; String
(Int -&gt; FsError -&gt; ShowS)
-&gt; (FsError -&gt; String) -&gt; ([FsError] -&gt; ShowS) -&gt; Show FsError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FsError] -&gt; ShowS
$cshowList :: [FsError] -&gt; ShowS
show :: FsError -&gt; String
$cshow :: FsError -&gt; String
showsPrec :: Int -&gt; FsError -&gt; ShowS
$cshowsPrec :: Int -&gt; FsError -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span id="local-6989586621679982024"><span id="local-6989586621679982026"><span id="local-6989586621679982028"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Errno</span></span></span></span></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-keyword">data</span><span> </span><span id="FsErrorType"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorType"><span class="hs-identifier hs-var">FsErrorType</span></a></span></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FsIllegalOperation"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsIllegalOperation"><span class="hs-identifier hs-var">FsIllegalOperation</span></a></span></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FsResourceInappropriateType"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsResourceInappropriateType"><span class="hs-identifier hs-var">FsResourceInappropriateType</span></a></span></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-comment">-- ^ e.g the user tried to open a directory with hOpen rather than a file.</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FsResourceAlreadyInUse"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsResourceAlreadyInUse"><span class="hs-identifier hs-var">FsResourceAlreadyInUse</span></a></span></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FsResourceDoesNotExist"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsResourceDoesNotExist"><span class="hs-identifier hs-var">FsResourceDoesNotExist</span></a></span></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FsResourceAlreadyExist"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsResourceAlreadyExist"><span class="hs-identifier hs-var">FsResourceAlreadyExist</span></a></span></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FsReachedEOF"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsReachedEOF"><span class="hs-identifier hs-var">FsReachedEOF</span></a></span></span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FsDeviceFull"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsDeviceFull"><span class="hs-identifier hs-var">FsDeviceFull</span></a></span></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FsTooManyOpenFiles"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsTooManyOpenFiles"><span class="hs-identifier hs-var">FsTooManyOpenFiles</span></a></span></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FsInsufficientPermissions"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsInsufficientPermissions"><span class="hs-identifier hs-var">FsInsufficientPermissions</span></a></span></span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FsInvalidArgument"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsInvalidArgument"><span class="hs-identifier hs-var">FsInvalidArgument</span></a></span></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FsOther"><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsOther"><span class="hs-identifier hs-var">FsOther</span></a></span></span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-comment">-- ^ Used for all other error types</span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679982007"><span id="local-6989586621679982009"><span id="local-6989586621679982011"><span class="annot"><span class="annottext">Int -&gt; FsErrorType -&gt; ShowS
[FsErrorType] -&gt; ShowS
FsErrorType -&gt; String
(Int -&gt; FsErrorType -&gt; ShowS)
-&gt; (FsErrorType -&gt; String)
-&gt; ([FsErrorType] -&gt; ShowS)
-&gt; Show FsErrorType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FsErrorType] -&gt; ShowS
$cshowList :: [FsErrorType] -&gt; ShowS
show :: FsErrorType -&gt; String
$cshow :: FsErrorType -&gt; String
showsPrec :: Int -&gt; FsErrorType -&gt; ShowS
$cshowsPrec :: Int -&gt; FsErrorType -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679982003"><span id="local-6989586621679982005"><span class="annot"><span class="annottext">FsErrorType -&gt; FsErrorType -&gt; Bool
(FsErrorType -&gt; FsErrorType -&gt; Bool)
-&gt; (FsErrorType -&gt; FsErrorType -&gt; Bool) -&gt; Eq FsErrorType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FsErrorType -&gt; FsErrorType -&gt; Bool
$c/= :: FsErrorType -&gt; FsErrorType -&gt; Bool
== :: FsErrorType -&gt; FsErrorType -&gt; Bool
$c== :: FsErrorType -&gt; FsErrorType -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679981997"><span id="local-6989586621679981999"><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsError"><span class="hs-identifier hs-type">FsError</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-250"></span><span>    </span><span id="local-6989586621679981994"><span class="annot"><span class="annottext">displayException :: FsError -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">displayException</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FsError -&gt; String
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#prettyFsError"><span class="hs-identifier hs-var">prettyFsError</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | Check if two errors are semantically the same error</span><span>
</span><span id="line-253"></span><span class="hs-comment">--</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- This ignores the error string, the errno, and the callstack.</span><span>
</span><span id="line-255"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#sameFsError"><span class="hs-identifier hs-type">sameFsError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsError"><span class="hs-identifier hs-type">FsError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsError"><span class="hs-identifier hs-type">FsError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-256"></span><span id="sameFsError"><span class="annot"><span class="annottext">sameFsError :: FsError -&gt; FsError -&gt; Bool
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#sameFsError"><span class="hs-identifier hs-var hs-var">sameFsError</span></a></span></span><span> </span><span id="local-6989586621679981992"><span class="annot"><span class="annottext">FsError
</span><a href="#local-6989586621679981992"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679981991"><span class="annot"><span class="annottext">FsError
</span><a href="#local-6989586621679981991"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FsError -&gt; FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorType"><span class="hs-identifier hs-var hs-var">fsErrorType</span></a></span><span> </span><span class="annot"><span class="annottext">FsError
</span><a href="#local-6989586621679981992"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">FsErrorType -&gt; FsErrorType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FsError -&gt; FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorType"><span class="hs-identifier hs-var hs-var">fsErrorType</span></a></span><span> </span><span class="annot"><span class="annottext">FsError
</span><a href="#local-6989586621679981991"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-257"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">FsError -&gt; FsErrorPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorPath"><span class="hs-identifier hs-var hs-var">fsErrorPath</span></a></span><span> </span><span class="annot"><span class="annottext">FsError
</span><a href="#local-6989586621679981992"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">FsErrorPath -&gt; FsErrorPath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FsError -&gt; FsErrorPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorPath"><span class="hs-identifier hs-var hs-var">fsErrorPath</span></a></span><span> </span><span class="annot"><span class="annottext">FsError
</span><a href="#local-6989586621679981991"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#isFsErrorType"><span class="hs-identifier hs-type">isFsErrorType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorType"><span class="hs-identifier hs-type">FsErrorType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsError"><span class="hs-identifier hs-type">FsError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-260"></span><span id="isFsErrorType"><span class="annot"><span class="annottext">isFsErrorType :: FsErrorType -&gt; FsError -&gt; Bool
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#isFsErrorType"><span class="hs-identifier hs-var hs-var">isFsErrorType</span></a></span></span><span> </span><span id="local-6989586621679981989"><span class="annot"><span class="annottext">FsErrorType
</span><a href="#local-6989586621679981989"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679981988"><span class="annot"><span class="annottext">FsError
</span><a href="#local-6989586621679981988"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FsError -&gt; FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorType"><span class="hs-identifier hs-var hs-var">fsErrorType</span></a></span><span> </span><span class="annot"><span class="annottext">FsError
</span><a href="#local-6989586621679981988"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">FsErrorType -&gt; FsErrorType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FsErrorType
</span><a href="#local-6989586621679981989"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#prettyFsError"><span class="hs-identifier hs-type">prettyFsError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsError"><span class="hs-identifier hs-type">FsError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-263"></span><span id="prettyFsError"><span class="annot"><span class="annottext">prettyFsError :: FsError -&gt; String
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#prettyFsError"><span class="hs-identifier hs-var hs-var">prettyFsError</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsError"><span class="hs-identifier hs-type">FsError</span></a></span><span class="hs-special">{</span><span id="local-6989586621679981982"><span id="local-6989586621679981983"><span id="local-6989586621679981984"><span id="local-6989586621679981985"><span id="local-6989586621679981986"><span id="local-6989586621679981987"><span class="annot"><span class="annottext">Bool
String
Maybe Errno
PrettyCallStack
FsErrorType
FsErrorPath
fsLimitation :: Bool
fsErrorStack :: PrettyCallStack
fsErrorNo :: Maybe Errno
fsErrorString :: String
fsErrorPath :: FsErrorPath
fsErrorType :: FsErrorType
fsLimitation :: FsError -&gt; Bool
fsErrorStack :: FsError -&gt; PrettyCallStack
fsErrorNo :: FsError -&gt; Maybe Errno
fsErrorString :: FsError -&gt; String
fsErrorPath :: FsError -&gt; FsErrorPath
fsErrorType :: FsError -&gt; FsErrorType
</span><a href="#local-6989586621679981982"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-264"></span><span>      </span><span class="annot"><span class="annottext">FsErrorType -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FsErrorType
</span><a href="#local-6989586621679981987"><span class="hs-identifier hs-var">fsErrorType</span></a></span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; for &quot;</span></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FsErrorPath -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FsErrorPath
</span><a href="#local-6989586621679981986"><span class="hs-identifier hs-var">fsErrorPath</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679981985"><span class="hs-identifier hs-var">fsErrorString</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; at &quot;</span></span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrettyCallStack -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PrettyCallStack
</span><a href="#local-6989586621679981983"><span class="hs-identifier hs-var">fsErrorStack</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#hasMountPoint"><span class="hs-identifier hs-type">hasMountPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsError"><span class="hs-identifier hs-type">FsError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-274"></span><span id="hasMountPoint"><span class="annot"><span class="annottext">hasMountPoint :: FsError -&gt; Bool
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#hasMountPoint"><span class="hs-identifier hs-var hs-var">hasMountPoint</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsError"><span class="hs-identifier hs-type">FsError</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">fsErrorPath :: FsError -&gt; FsErrorPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorPath"><span class="hs-identifier hs-var">fsErrorPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-type">FsErrorPath</span></a></span><span> </span><span id="local-6989586621679981980"><span class="annot"><span class="annottext">Maybe MountPoint
</span><a href="#local-6989586621679981980"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="annot"><span class="annottext">FsPath
</span><span class="hs-identifier">_</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MountPoint -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe MountPoint
</span><a href="#local-6989586621679981980"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  From 'IOError' to 'FsError'
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">-- | Translate exceptions thrown by IO functions to 'FsError'</span><span>
</span><span id="line-281"></span><span class="hs-comment">--</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- We take the 'FsPath' as an argument. We could try to translate back from a</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- 'FilePath' to an 'FsPath' (given a 'MountPoint'), but we know the 'FsPath'</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- at all times anyway and not all IO exceptions actually include a filepath.</span><span>
</span><span id="line-285"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#ioToFsError"><span class="hs-identifier hs-type">ioToFsError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span>
</span><span id="line-286"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorPath"><span class="hs-identifier hs-type">FsErrorPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOError</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsError"><span class="hs-identifier hs-type">FsError</span></a></span><span>
</span><span id="line-287"></span><span id="ioToFsError"><span class="annot"><span class="annottext">ioToFsError :: FsErrorPath -&gt; IOError -&gt; FsError
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#ioToFsError"><span class="hs-identifier hs-var hs-var">ioToFsError</span></a></span></span><span> </span><span id="local-6989586621679981979"><span class="annot"><span class="annottext">FsErrorPath
</span><a href="#local-6989586621679981979"><span class="hs-identifier hs-var">fep</span></a></span></span><span> </span><span id="local-6989586621679981978"><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621679981978"><span class="hs-identifier hs-var">ioErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FsError :: FsErrorType
-&gt; FsErrorPath
-&gt; String
-&gt; Maybe Errno
-&gt; PrettyCallStack
-&gt; Bool
-&gt; FsError
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsError"><span class="hs-identifier hs-type">FsError</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fsErrorType :: FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorType"><span class="hs-identifier hs-var">fsErrorType</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOError -&gt; FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#ioToFsErrorType"><span class="hs-identifier hs-var">ioToFsErrorType</span></a></span><span> </span><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621679981978"><span class="hs-identifier hs-var">ioErr</span></a></span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fsErrorPath :: FsErrorPath
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorPath"><span class="hs-identifier hs-var">fsErrorPath</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FsErrorPath
</span><a href="#local-6989586621679981979"><span class="hs-identifier hs-var">fep</span></a></span><span>
</span><span id="line-290"></span><span>      </span><span class="hs-comment">-- We don't use 'ioeGetErrorString', because that only returns the</span><span>
</span><span id="line-291"></span><span>      </span><span class="hs-comment">-- description in case 'isUserErrorType' is true, otherwise it will</span><span>
</span><span id="line-292"></span><span>      </span><span class="hs-comment">-- return 'ioToFsErrorType', which we already include in 'fsErrorType'.</span><span>
</span><span id="line-293"></span><span>      </span><span class="hs-comment">-- So we use the underlying field directly.</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fsErrorString :: String
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorString"><span class="hs-identifier hs-var">fsErrorString</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOError -&gt; String
</span><span class="hs-identifier hs-var hs-var">GHC.ioe_description</span></span><span> </span><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621679981978"><span class="hs-identifier hs-var">ioErr</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fsErrorNo :: Maybe Errno
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorNo"><span class="hs-identifier hs-var">fsErrorNo</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; Errno
</span><span class="hs-identifier hs-var">Errno</span></span><span> </span><span class="annot"><span class="annottext">(CInt -&gt; Errno) -&gt; Maybe CInt -&gt; Maybe Errno
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IOError -&gt; Maybe CInt
</span><span class="hs-identifier hs-var hs-var">GHC.ioe_errno</span></span><span> </span><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621679981978"><span class="hs-identifier hs-var">ioErr</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fsErrorStack :: PrettyCallStack
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsErrorStack"><span class="hs-identifier hs-var">fsErrorStack</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrettyCallStack
HasCallStack =&gt; PrettyCallStack
</span><a href="Ouroboros.Consensus.Util.CallStack.html#prettyCallStack"><span class="hs-identifier hs-var">prettyCallStack</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fsLimitation :: Bool
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#fsLimitation"><span class="hs-identifier hs-var">fsLimitation</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-comment">-- | Assign an 'FsErrorType' to the given 'IOError'.</span><span>
</span><span id="line-301"></span><span class="hs-comment">--</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- Note that we don't always use the classification made by</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- 'Foreign.C.Error.errnoToIOError' (also see 'System.IO.Error') because it</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- combines some errors into one 'IOErrorType', e.g., @EMFILE@ (too many open</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- files) and @ENOSPC@ (no space left on device) both result in</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- 'ResourceExhausted' while we want to keep them separate. For this reason,</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- we do a classification of our own based on the @errno@ while sometimes</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- deferring to the existing classification.</span><span>
</span><span id="line-309"></span><span class="hs-comment">--</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- See the ERRNO(3) man page for the meaning of the different errnos.</span><span>
</span><span id="line-311"></span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#ioToFsErrorType"><span class="hs-identifier hs-type">ioToFsErrorType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOError</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsErrorType"><span class="hs-identifier hs-type">FsErrorType</span></a></span><span>
</span><span id="line-312"></span><span id="ioToFsErrorType"><span class="annot"><span class="annottext">ioToFsErrorType :: IOError -&gt; FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#ioToFsErrorType"><span class="hs-identifier hs-var hs-var">ioToFsErrorType</span></a></span></span><span> </span><span id="local-6989586621679981973"><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621679981973"><span class="hs-identifier hs-var">ioErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; Errno
</span><span class="hs-identifier hs-var">Errno</span></span><span> </span><span class="annot"><span class="annottext">(CInt -&gt; Errno) -&gt; Maybe CInt -&gt; Maybe Errno
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IOError -&gt; Maybe CInt
</span><span class="hs-identifier hs-var hs-var">GHC.ioe_errno</span></span><span> </span><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621679981973"><span class="hs-identifier hs-var">ioErr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679981972"><span class="annot"><span class="annottext">Errno
</span><a href="#local-6989586621679981972"><span class="hs-identifier hs-var">errno</span></a></span></span><span>
</span><span id="line-314"></span><span>      </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Errno
</span><a href="#local-6989586621679981972"><span class="hs-identifier hs-var">errno</span></a></span><span> </span><span class="annot"><span class="annottext">Errno -&gt; Errno -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><span class="hs-identifier hs-var">C.eACCES</span></span><span>
</span><span id="line-315"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><a href="#local-6989586621679981972"><span class="hs-identifier hs-var">errno</span></a></span><span> </span><span class="annot"><span class="annottext">Errno -&gt; Errno -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><span class="hs-identifier hs-var">C.eROFS</span></span><span>
</span><span id="line-316"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><a href="#local-6989586621679981972"><span class="hs-identifier hs-var">errno</span></a></span><span> </span><span class="annot"><span class="annottext">Errno -&gt; Errno -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><span class="hs-identifier hs-var">C.ePERM</span></span><span>
</span><span id="line-317"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsInsufficientPermissions"><span class="hs-identifier hs-var">FsInsufficientPermissions</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span>      </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Errno
</span><a href="#local-6989586621679981972"><span class="hs-identifier hs-var">errno</span></a></span><span> </span><span class="annot"><span class="annottext">Errno -&gt; Errno -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><span class="hs-identifier hs-var">C.eNOSPC</span></span><span>
</span><span id="line-320"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsDeviceFull"><span class="hs-identifier hs-var">FsDeviceFull</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span>      </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Errno
</span><a href="#local-6989586621679981972"><span class="hs-identifier hs-var">errno</span></a></span><span> </span><span class="annot"><span class="annottext">Errno -&gt; Errno -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><span class="hs-identifier hs-var">C.eMFILE</span></span><span>
</span><span id="line-323"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><a href="#local-6989586621679981972"><span class="hs-identifier hs-var">errno</span></a></span><span> </span><span class="annot"><span class="annottext">Errno -&gt; Errno -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><span class="hs-identifier hs-var">C.eNFILE</span></span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsTooManyOpenFiles"><span class="hs-identifier hs-var">FsTooManyOpenFiles</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>      </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Errno
</span><a href="#local-6989586621679981972"><span class="hs-identifier hs-var">errno</span></a></span><span> </span><span class="annot"><span class="annottext">Errno -&gt; Errno -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><span class="hs-identifier hs-var">C.eNOENT</span></span><span>
</span><span id="line-327"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><a href="#local-6989586621679981972"><span class="hs-identifier hs-var">errno</span></a></span><span> </span><span class="annot"><span class="annottext">Errno -&gt; Errno -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Errno
</span><span class="hs-identifier hs-var">C.eNXIO</span></span><span>
</span><span id="line-328"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsResourceDoesNotExist"><span class="hs-identifier hs-var">FsResourceDoesNotExist</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><span class="annottext">Maybe Errno
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IOErrorType -&gt; Bool
</span><span class="hs-identifier hs-var">IO.isAlreadyInUseErrorType</span></span><span> </span><span class="annot"><span class="annottext">IOErrorType
</span><a href="#local-6989586621679981961"><span class="hs-identifier hs-var">eType</span></a></span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsResourceAlreadyInUse"><span class="hs-identifier hs-var">FsResourceAlreadyInUse</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IOErrorType -&gt; Bool
</span><span class="hs-identifier hs-var">IO.isAlreadyExistsErrorType</span></span><span> </span><span class="annot"><span class="annottext">IOErrorType
</span><a href="#local-6989586621679981961"><span class="hs-identifier hs-var">eType</span></a></span><span>
</span><span id="line-334"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsResourceAlreadyExist"><span class="hs-identifier hs-var">FsResourceAlreadyExist</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IOErrorType -&gt; Bool
</span><span class="hs-identifier hs-var">IO.isEOFErrorType</span></span><span> </span><span class="annot"><span class="annottext">IOErrorType
</span><a href="#local-6989586621679981961"><span class="hs-identifier hs-var">eType</span></a></span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsReachedEOF"><span class="hs-identifier hs-var">FsReachedEOF</span></a></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IOErrorType -&gt; Bool
</span><span class="hs-identifier hs-var">IO.isIllegalOperationErrorType</span></span><span> </span><span class="annot"><span class="annottext">IOErrorType
</span><a href="#local-6989586621679981961"><span class="hs-identifier hs-var">eType</span></a></span><span>
</span><span id="line-340"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsIllegalOperation"><span class="hs-identifier hs-var">FsIllegalOperation</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IOErrorType
</span><a href="#local-6989586621679981961"><span class="hs-identifier hs-var">eType</span></a></span><span> </span><span class="annot"><span class="annottext">IOErrorType -&gt; IOErrorType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IOErrorType
</span><span class="hs-identifier hs-var">GHC.InappropriateType</span></span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsResourceInappropriateType"><span class="hs-identifier hs-var">FsResourceInappropriateType</span></a></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IOErrorType
</span><a href="#local-6989586621679981961"><span class="hs-identifier hs-var">eType</span></a></span><span> </span><span class="annot"><span class="annottext">IOErrorType -&gt; IOErrorType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IOErrorType
</span><span class="hs-identifier hs-var">GHC.InvalidArgument</span></span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsInvalidArgument"><span class="hs-identifier hs-var">FsInvalidArgument</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-349"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FsErrorType
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#FsOther"><span class="hs-identifier hs-var">FsOther</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><a href="#local-6989586621679981961"><span class="hs-identifier hs-type">eType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO.IOErrorType</span></span><span>
</span><span id="line-352"></span><span>    </span><span id="local-6989586621679981961"><span class="annot"><span class="annottext">eType :: IOErrorType
</span><a href="#local-6989586621679981961"><span class="hs-identifier hs-var hs-var">eType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOError -&gt; IOErrorType
</span><span class="hs-identifier hs-var">IO.ioeGetErrorType</span></span><span> </span><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621679981973"><span class="hs-identifier hs-var">ioErr</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Condense instances
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#Condense"><span class="hs-identifier hs-type">Condense</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SeekMode</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-359"></span><span>  </span><span id="local-6989586621679981953"><span class="annot"><span class="annottext">condense :: SeekMode -&gt; String
</span><a href="#local-6989586621679981953"><span class="hs-identifier hs-var hs-var hs-var hs-var">condense</span></a></span></span><span> </span><span class="annot"><span class="annottext">SeekMode
</span><span class="hs-identifier hs-var">RelativeSeek</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;r&quot;</span></span><span>
</span><span id="line-360"></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#condense"><span class="hs-identifier hs-var">condense</span></a></span><span> </span><span class="annot"><span class="annottext">SeekMode
</span><span class="hs-identifier hs-var">AbsoluteSeek</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;a&quot;</span></span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#condense"><span class="hs-identifier hs-var">condense</span></a></span><span> </span><span class="annot"><span class="annottext">SeekMode
</span><span class="hs-identifier hs-var">SeekFromEnd</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;e&quot;</span></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#Condense"><span class="hs-identifier hs-type">Condense</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AllowExisting"><span class="hs-identifier hs-type">AllowExisting</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-364"></span><span>  </span><span id="local-6989586621679981948"><span class="annot"><span class="annottext">condense :: AllowExisting -&gt; String
</span><a href="#local-6989586621679981948"><span class="hs-identifier hs-var hs-var hs-var hs-var">condense</span></a></span></span><span> </span><span class="annot"><span class="annottext">AllowExisting
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AllowExisting"><span class="hs-identifier hs-var">AllowExisting</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-365"></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#condense"><span class="hs-identifier hs-var">condense</span></a></span><span> </span><span class="annot"><span class="annottext">AllowExisting
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MustBeNew"><span class="hs-identifier hs-var">MustBeNew</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!&quot;</span></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#Condense"><span class="hs-identifier hs-type">Condense</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#OpenMode"><span class="hs-identifier hs-type">OpenMode</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621679981946"><span class="annot"><span class="annottext">condense :: OpenMode -&gt; String
</span><a href="#local-6989586621679981946"><span class="hs-identifier hs-var hs-var hs-var hs-var">condense</span></a></span></span><span> </span><span class="annot"><span class="annottext">OpenMode
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#ReadMode"><span class="hs-identifier hs-var">ReadMode</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;r&quot;</span></span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#condense"><span class="hs-identifier hs-var">condense</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#WriteMode"><span class="hs-identifier hs-type">WriteMode</span></a></span><span>     </span><span id="local-6989586621679981945"><span class="annot"><span class="annottext">AllowExisting
</span><a href="#local-6989586621679981945"><span class="hs-identifier hs-var">ex</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;w&quot;</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">AllowExisting -&gt; String
forall a. Condense a =&gt; a -&gt; String
</span><a href="Ouroboros.Consensus.Util.Condense.html#condense"><span class="hs-identifier hs-var">condense</span></a></span><span> </span><span class="annot"><span class="annottext">AllowExisting
</span><a href="#local-6989586621679981945"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#condense"><span class="hs-identifier hs-var">condense</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#ReadWriteMode"><span class="hs-identifier hs-type">ReadWriteMode</span></a></span><span> </span><span id="local-6989586621679981944"><span class="annot"><span class="annottext">AllowExisting
</span><a href="#local-6989586621679981944"><span class="hs-identifier hs-var">ex</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rw&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">AllowExisting -&gt; String
forall a. Condense a =&gt; a -&gt; String
</span><a href="Ouroboros.Consensus.Util.Condense.html#condense"><span class="hs-identifier hs-var">condense</span></a></span><span> </span><span class="annot"><span class="annottext">AllowExisting
</span><a href="#local-6989586621679981944"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#condense"><span class="hs-identifier hs-var">condense</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#AppendMode"><span class="hs-identifier hs-type">AppendMode</span></a></span><span>    </span><span id="local-6989586621679981943"><span class="annot"><span class="annottext">AllowExisting
</span><a href="#local-6989586621679981943"><span class="hs-identifier hs-var">ex</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;a&quot;</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">AllowExisting -&gt; String
forall a. Condense a =&gt; a -&gt; String
</span><a href="Ouroboros.Consensus.Util.Condense.html#condense"><span class="hs-identifier hs-var">condense</span></a></span><span> </span><span class="annot"><span class="annottext">AllowExisting
</span><a href="#local-6989586621679981943"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span id="local-6989586621679981942"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.Condense.html#Condense"><span class="hs-identifier hs-type">Condense</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#Handle"><span class="hs-identifier hs-type">Handle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679981942"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621679981940"><span class="annot"><span class="annottext">condense :: Handle h -&gt; String
</span><a href="#local-6989586621679981940"><span class="hs-identifier hs-var hs-var hs-var hs-var">condense</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle h -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span></span><span>
</span><span id="line-375"></span></pre></body></html>