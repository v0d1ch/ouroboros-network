<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds             #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts      #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns        #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards       #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables   #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications      #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">-- | Intended for qualified import</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ouroboros.Consensus.Network.NodeToClient</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Handlers</span></span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Handlers"><span class="hs-identifier">Handlers</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#mkHandlers"><span class="hs-identifier">mkHandlers</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Codecs</span></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#ClientCodecs"><span class="hs-identifier">ClientCodecs</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs"><span class="hs-identifier">Codecs</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs%27"><span class="hs-identifier">Codecs'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#DefaultCodecs"><span class="hs-identifier">DefaultCodecs</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#clientCodecs"><span class="hs-identifier">clientCodecs</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#defaultCodecs"><span class="hs-identifier">defaultCodecs</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#identityCodecs"><span class="hs-identifier">identityCodecs</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-comment">-- * ClientCodecs</span></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Tracers</span></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers"><span class="hs-identifier">Tracers</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers%27"><span class="hs-identifier">Tracers'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#nullTracers"><span class="hs-identifier">nullTracers</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#showTracers"><span class="hs-identifier">showTracers</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Applications</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#App"><span class="hs-identifier">App</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Apps"><span class="hs-identifier">Apps</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#mkApps"><span class="hs-identifier">mkApps</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Projections</span></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#responder"><span class="hs-identifier">responder</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Decoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Decoder</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Encoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Encoding</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DeserialiseFailure</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.Serialise</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Serialise</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Tracer</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">Data.Void</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">Void</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/typed-protocols-0.1.0.0/noopt/doc/html/typed-protocols/src"><span class="hs-identifier">Network.TypedProtocol.Codec</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.AnchoredFragment</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AF</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Block</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Serialised</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">decodePoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">decodeTip</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>                     </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">encodePoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">encodeTip</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.BlockFetch</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier">Ouroboros.Network.Channel</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier">Ouroboros.Network.Driver</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier">Ouroboros.Network.Mux</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.NodeToClient</span></a></span><span> </span><span class="hs-keyword">hiding</span><span>
</span><span id="line-55"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">NodeToClientVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.NodeToClient</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">N</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">NodeToClientVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Protocol.ChainSync.Codec</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Protocol.ChainSync.Server</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Protocol.ChainSync.Type</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Protocol.LocalStateQuery.Codec</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Protocol.LocalStateQuery.Server</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Protocol.LocalStateQuery.Type</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Protocol.LocalTxMonitor.Codec</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Protocol.LocalTxMonitor.Server</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Protocol.LocalTxMonitor.Type</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Protocol.LocalTxSubmission.Codec</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Protocol.LocalTxSubmission.Server</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Protocol.LocalTxSubmission.Type</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Block.html"><span class="hs-identifier">Ouroboros.Consensus.Block</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Extended.html"><span class="hs-identifier">Ouroboros.Consensus.Ledger.Extended</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html"><span class="hs-identifier">Ouroboros.Consensus.Ledger.Query</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html"><span class="hs-identifier">Ouroboros.Consensus.Ledger.SupportsMempool</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsProtocol.html"><span class="hs-identifier">Ouroboros.Consensus.Ledger.SupportsProtocol</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.MiniProtocol.ChainSync.Server.html"><span class="hs-identifier">Ouroboros.Consensus.MiniProtocol.ChainSync.Server</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.MiniProtocol.LocalStateQuery.Server.html"><span class="hs-identifier">Ouroboros.Consensus.MiniProtocol.LocalStateQuery.Server</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.MiniProtocol.LocalTxMonitor.Server.html"><span class="hs-identifier">Ouroboros.Consensus.MiniProtocol.LocalTxMonitor.Server</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.MiniProtocol.LocalTxSubmission.Server.html"><span class="hs-identifier">Ouroboros.Consensus.MiniProtocol.LocalTxSubmission.Server</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html"><span class="hs-identifier">Ouroboros.Consensus.Node.NetworkProtocolVersion</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html"><span class="hs-identifier">Ouroboros.Consensus.Node.Run</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.Serialisation.html"><span class="hs-identifier">Ouroboros.Consensus.Node.Serialisation</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Tracers.html"><span class="hs-identifier">Ouroboros.Consensus.Node.Tracers</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Node</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html"><span class="hs-identifier">Ouroboros.Consensus.NodeKernel</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.html"><span class="hs-identifier">Ouroboros.Consensus.Util</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier">ShowProxy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.IOLike.html"><span class="hs-identifier">Ouroboros.Consensus.Util.IOLike</span></a></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.Orphans.html"><span class="hs-identifier">Ouroboros.Consensus.Util.Orphans</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.ResourceRegistry.html"><span class="hs-identifier">Ouroboros.Consensus.Util.ResourceRegistry</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.API.html"><span class="hs-identifier">Ouroboros.Consensus.Storage.ChainDB.API</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainDB</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Handlers
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Protocol handlers for node-to-client (local) communication</span><span>
</span><span id="line-96"></span><span class="hs-keyword">data</span><span> </span><span id="Handlers"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Handlers"><span class="hs-identifier hs-var">Handlers</span></a></span></span><span> </span><span id="local-6989586621680031888"><span class="annot"><a href="#local-6989586621680031888"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680031886"><span class="annot"><a href="#local-6989586621680031886"><span class="hs-identifier hs-type">peer</span></a></span></span><span> </span><span id="local-6989586621680031887"><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Handlers"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Handlers"><span class="hs-identifier hs-var">Handlers</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-97"></span><span>      </span><span id="hChainSyncServer"><span class="annot"><span class="annottext">Handlers m peer blk
-&gt; Follower m blk (WithPoint blk (Serialised blk))
-&gt; ChainSyncServer (Serialised blk) (Point blk) (Tip blk) m ()
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#hChainSyncServer"><span class="hs-identifier hs-var hs-var">hChainSyncServer</span></a></span></span><span>
</span><span id="line-98"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.API.html#Follower"><span class="hs-identifier hs-type">ChainDB.Follower</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031888"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.API.html#WithPoint"><span class="hs-identifier hs-type">ChainDB.WithPoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Serialised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">ChainSyncServer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Serialised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Tip</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680031888"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hTxSubmissionServer"><span class="annot"><span class="annottext">Handlers m peer blk
-&gt; LocalTxSubmissionServer (GenTx blk) (ApplyTxErr blk) m ()
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#hTxSubmissionServer"><span class="hs-identifier hs-var hs-var">hTxSubmissionServer</span></a></span></span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">LocalTxSubmissionServer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTx"><span class="hs-identifier hs-type">GenTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#ApplyTxErr"><span class="hs-identifier hs-type">ApplyTxErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680031888"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hStateQueryServer"><span class="annot"><span class="annottext">Handlers m peer blk
-&gt; LocalStateQueryServer blk (Point blk) (Query blk) m ()
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#hStateQueryServer"><span class="hs-identifier hs-var hs-var">hStateQueryServer</span></a></span></span><span>
</span><span id="line-105"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">LocalStateQueryServer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680031888"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hTxMonitorServer"><span class="annot"><span class="annottext">Handlers m peer blk
-&gt; LocalTxMonitorServer (GenTxId blk) (GenTx blk) SlotNo m ()
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#hTxMonitorServer"><span class="hs-identifier hs-var hs-var">hTxMonitorServer</span></a></span></span><span>
</span><span id="line-108"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">LocalTxMonitorServer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTxId"><span class="hs-identifier hs-type">GenTxId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTx"><span class="hs-identifier hs-type">GenTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031887"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span class="annot"><a href="#local-6989586621680031888"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#mkHandlers"><span class="hs-identifier hs-type">mkHandlers</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680031427"><span class="annot"><a href="#local-6989586621680031427"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680031426"><span class="annot"><a href="#local-6989586621680031426"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span id="local-6989586621680031425"><span class="annot"><a href="#local-6989586621680031425"><span class="hs-identifier hs-type">remotePeer</span></a></span></span><span> </span><span id="local-6989586621680031424"><span class="annot"><a href="#local-6989586621680031424"><span class="hs-identifier hs-type">localPeer</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-113"></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.IOLike.html#IOLike"><span class="hs-identifier hs-type">IOLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031427"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-114"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#LedgerSupportsMempool"><span class="hs-identifier hs-type">LedgerSupportsMempool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031426"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-115"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsProtocol.html#LedgerSupportsProtocol"><span class="hs-identifier hs-type">LedgerSupportsProtocol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031426"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-116"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#QueryLedger"><span class="hs-identifier hs-type">QueryLedger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031426"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-117"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Config.SupportsNode.html#ConfigSupportsNode"><span class="hs-identifier hs-type">ConfigSupportsNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031426"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-118"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031425"><span class="hs-identifier hs-type">remotePeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031424"><span class="hs-identifier hs-type">localPeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031426"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernel"><span class="hs-identifier hs-type">NodeKernel</span></a></span><span>     </span><span class="annot"><a href="#local-6989586621680031427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031425"><span class="hs-identifier hs-type">remotePeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031424"><span class="hs-identifier hs-type">localPeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031426"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Handlers"><span class="hs-identifier hs-type">Handlers</span></a></span><span>       </span><span class="annot"><a href="#local-6989586621680031427"><span class="hs-identifier hs-type">m</span></a></span><span>            </span><span class="annot"><a href="#local-6989586621680031424"><span class="hs-identifier hs-type">localPeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031426"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-122"></span><span id="mkHandlers"><span class="annot"><span class="annottext">mkHandlers :: NodeKernelArgs m remotePeer localPeer blk
-&gt; NodeKernel m remotePeer localPeer blk
-&gt; Handlers m localPeer blk
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#mkHandlers"><span class="hs-identifier hs-var hs-var">mkHandlers</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680031422"><span class="annot"><span class="annottext">TopLevelConfig blk
$sel:cfg:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk -&gt; TopLevelConfig blk
cfg :: TopLevelConfig blk
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3Acfg%3ANodeKernelArgs"><span class="hs-identifier hs-var hs-var">cfg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680031420"><span class="annot"><span class="annottext">Tracers m remotePeer localPeer blk
$sel:tracers:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk
-&gt; Tracers m remotePeer localPeer blk
tracers :: Tracers m remotePeer localPeer blk
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3Atracers%3ANodeKernelArgs"><span class="hs-identifier hs-var hs-var">tracers</span></a></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernel"><span class="hs-identifier hs-type">NodeKernel</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680031417"><span class="annot"><span class="annottext">ChainDB m blk
$sel:getChainDB:NodeKernel :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernel m remotePeer localPeer blk -&gt; ChainDB m blk
getChainDB :: ChainDB m blk
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AgetChainDB%3ANodeKernel"><span class="hs-identifier hs-var hs-var">getChainDB</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680031415"><span class="annot"><span class="annottext">Mempool m blk TicketNo
$sel:getMempool:NodeKernel :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernel m remotePeer localPeer blk -&gt; Mempool m blk TicketNo
getMempool :: Mempool m blk TicketNo
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AgetMempool%3ANodeKernel"><span class="hs-identifier hs-var hs-var">getMempool</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">Handlers :: forall (m :: * -&gt; *) peer blk.
(Follower m blk (WithPoint blk (Serialised blk))
 -&gt; ChainSyncServer (Serialised blk) (Point blk) (Tip blk) m ())
-&gt; LocalTxSubmissionServer (GenTx blk) (ApplyTxErr blk) m ()
-&gt; LocalStateQueryServer blk (Point blk) (Query blk) m ()
-&gt; LocalTxMonitorServer (GenTxId blk) (GenTx blk) SlotNo m ()
-&gt; Handlers m peer blk
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#Handlers"><span class="hs-identifier hs-type">Handlers</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><span class="annottext">hChainSyncServer :: Follower m blk (WithPoint blk (Serialised blk))
-&gt; ChainSyncServer (Serialised blk) (Point blk) (Tip blk) m ()
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#hChainSyncServer"><span class="hs-identifier hs-var">hChainSyncServer</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>          </span><span class="annot"><span class="annottext">Tracer m (TraceChainSyncServerEvent blk)
-&gt; ChainDB m blk
-&gt; Follower m blk (WithPoint blk (Serialised blk))
-&gt; ChainSyncServer (Serialised blk) (Point blk) (Tip blk) m ()
forall (m :: * -&gt; *) blk.
(IOLike m, HasHeader (Header blk)) =&gt;
Tracer m (TraceChainSyncServerEvent blk)
-&gt; ChainDB m blk
-&gt; Follower m blk (WithPoint blk (Serialised blk))
-&gt; ChainSyncServer (Serialised blk) (Point blk) (Tip blk) m ()
</span><a href="Ouroboros.Consensus.MiniProtocol.ChainSync.Server.html#chainSyncBlocksServer"><span class="hs-identifier hs-var">chainSyncBlocksServer</span></a></span><span>
</span><span id="line-126"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tracers m remotePeer localPeer blk
-&gt; Tracer m (TraceChainSyncServerEvent blk)
forall remotePeer localPeer blk (f :: * -&gt; *).
Tracers' remotePeer localPeer blk f
-&gt; f (TraceChainSyncServerEvent blk)
</span><a href="Ouroboros.Consensus.Node.Tracers.html#chainSyncServerBlockTracer"><span class="hs-identifier hs-var hs-var">Node.chainSyncServerBlockTracer</span></a></span><span> </span><span class="annot"><span class="annottext">Tracers m remotePeer localPeer blk
</span><a href="#local-6989586621680031420"><span class="hs-identifier hs-var">tracers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>            </span><span class="annot"><span class="annottext">ChainDB m blk
</span><a href="#local-6989586621680031417"><span class="hs-identifier hs-var">getChainDB</span></a></span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hTxSubmissionServer :: LocalTxSubmissionServer (GenTx blk) (ApplyTxErr blk) m ()
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#hTxSubmissionServer"><span class="hs-identifier hs-var">hTxSubmissionServer</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>          </span><span class="annot"><span class="annottext">Tracer m (TraceLocalTxSubmissionServerEvent blk)
-&gt; Mempool m blk TicketNo
-&gt; LocalTxSubmissionServer (GenTx blk) (ApplyTxErr blk) m ()
forall (m :: * -&gt; *) blk idx.
MonadSTM m =&gt;
Tracer m (TraceLocalTxSubmissionServerEvent blk)
-&gt; Mempool m blk idx
-&gt; LocalTxSubmissionServer (GenTx blk) (ApplyTxErr blk) m ()
</span><a href="Ouroboros.Consensus.MiniProtocol.LocalTxSubmission.Server.html#localTxSubmissionServer"><span class="hs-identifier hs-var">localTxSubmissionServer</span></a></span><span>
</span><span id="line-130"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tracers m remotePeer localPeer blk
-&gt; Tracer m (TraceLocalTxSubmissionServerEvent blk)
forall remotePeer localPeer blk (f :: * -&gt; *).
Tracers' remotePeer localPeer blk f
-&gt; f (TraceLocalTxSubmissionServerEvent blk)
</span><a href="Ouroboros.Consensus.Node.Tracers.html#localTxSubmissionServerTracer"><span class="hs-identifier hs-var hs-var">Node.localTxSubmissionServerTracer</span></a></span><span> </span><span class="annot"><span class="annottext">Tracers m remotePeer localPeer blk
</span><a href="#local-6989586621680031420"><span class="hs-identifier hs-var">tracers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>            </span><span class="annot"><span class="annottext">Mempool m blk TicketNo
</span><a href="#local-6989586621680031415"><span class="hs-identifier hs-var">getMempool</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hStateQueryServer :: LocalStateQueryServer blk (Point blk) (Query blk) m ()
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#hStateQueryServer"><span class="hs-identifier hs-var">hStateQueryServer</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-133"></span><span>          </span><span class="annot"><span class="annottext">ExtLedgerCfg blk
-&gt; STM m (Point blk)
-&gt; (Point blk -&gt; STM m (Maybe (ExtLedgerState blk)))
-&gt; STM m (Point blk)
-&gt; LocalStateQueryServer blk (Point blk) (Query blk) m ()
forall (m :: * -&gt; *) blk.
(IOLike m, QueryLedger blk, ConfigSupportsNode blk,
 HasAnnTip blk) =&gt;
ExtLedgerCfg blk
-&gt; STM m (Point blk)
-&gt; (Point blk -&gt; STM m (Maybe (ExtLedgerState blk)))
-&gt; STM m (Point blk)
-&gt; LocalStateQueryServer blk (Point blk) (Query blk) m ()
</span><a href="Ouroboros.Consensus.MiniProtocol.LocalStateQuery.Server.html#localStateQueryServer"><span class="hs-identifier hs-var">localStateQueryServer</span></a></span><span>
</span><span id="line-134"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelConfig blk -&gt; ExtLedgerCfg blk
forall blk. TopLevelConfig blk -&gt; ExtLedgerCfg blk
</span><a href="Ouroboros.Consensus.Ledger.Extended.html#ExtLedgerCfg"><span class="hs-identifier hs-var">ExtLedgerCfg</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680031422"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainDB m blk -&gt; STM m (Point blk)
forall (m :: * -&gt; *) blk. ChainDB m blk -&gt; STM m (Point blk)
</span><a href="Ouroboros.Consensus.Storage.ChainDB.API.html#getTipPoint"><span class="hs-identifier hs-var hs-var">ChainDB.getTipPoint</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDB m blk
</span><a href="#local-6989586621680031417"><span class="hs-identifier hs-var">getChainDB</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainDB m blk -&gt; Point blk -&gt; STM m (Maybe (ExtLedgerState blk))
forall (m :: * -&gt; *) blk.
(Monad (STM m), LedgerSupportsProtocol blk) =&gt;
ChainDB m blk -&gt; Point blk -&gt; STM m (Maybe (ExtLedgerState blk))
</span><a href="Ouroboros.Consensus.Storage.ChainDB.API.html#getPastLedger"><span class="hs-identifier hs-var">ChainDB.getPastLedger</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDB m blk
</span><a href="#local-6989586621680031417"><span class="hs-identifier hs-var">getChainDB</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point (Header blk) -&gt; Point blk
forall b b'.
Coercible (HeaderHash b) (HeaderHash b') =&gt;
Point b -&gt; Point b'
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">castPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(Point (Header blk) -&gt; Point blk)
-&gt; (AnchoredFragment (Header blk) -&gt; Point (Header blk))
-&gt; AnchoredFragment (Header blk)
-&gt; Point blk
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AnchoredFragment (Header blk) -&gt; Point (Header blk)
forall block. AnchoredFragment block -&gt; Point block
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">AF.anchorPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(AnchoredFragment (Header blk) -&gt; Point blk)
-&gt; STM m (AnchoredFragment (Header blk)) -&gt; STM m (Point blk)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDB m blk -&gt; STM m (AnchoredFragment (Header blk))
forall (m :: * -&gt; *) blk.
ChainDB m blk -&gt; STM m (AnchoredFragment (Header blk))
</span><a href="Ouroboros.Consensus.Storage.ChainDB.API.html#getCurrentChain"><span class="hs-identifier hs-var hs-var">ChainDB.getCurrentChain</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDB m blk
</span><a href="#local-6989586621680031417"><span class="hs-identifier hs-var">getChainDB</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hTxMonitorServer :: LocalTxMonitorServer (GenTxId blk) (GenTx blk) SlotNo m ()
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#hTxMonitorServer"><span class="hs-identifier hs-var">hTxMonitorServer</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>          </span><span class="annot"><span class="annottext">Mempool m blk TicketNo
-&gt; LocalTxMonitorServer (GenTxId blk) (GenTx blk) SlotNo m ()
forall blk idx (m :: * -&gt; *).
(MonadSTM m, LedgerSupportsMempool blk, Eq idx) =&gt;
Mempool m blk idx
-&gt; LocalTxMonitorServer (GenTxId blk) (GenTx blk) SlotNo m ()
</span><a href="Ouroboros.Consensus.MiniProtocol.LocalTxMonitor.Server.html#localTxMonitorServer"><span class="hs-identifier hs-var">localTxMonitorServer</span></a></span><span>
</span><span id="line-141"></span><span>            </span><span class="annot"><span class="annottext">Mempool m blk TicketNo
</span><a href="#local-6989586621680031415"><span class="hs-identifier hs-var">getMempool</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Codecs
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- | Node-to-client protocol codecs needed to run 'Handlers'.</span><span>
</span><span id="line-149"></span><span class="hs-keyword">data</span><span> </span><span id="Codecs%27"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs%27"><span class="hs-identifier hs-var">Codecs'</span></a></span></span><span> </span><span id="local-6989586621680031794"><span class="annot"><a href="#local-6989586621680031794"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span id="local-6989586621680031795"><span class="annot"><a href="#local-6989586621680031795"><span class="hs-identifier hs-type">serialisedBlk</span></a></span></span><span> </span><span id="local-6989586621680031793"><span class="annot"><a href="#local-6989586621680031793"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680031792"><span class="annot"><a href="#local-6989586621680031792"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680031791"><span class="annot"><a href="#local-6989586621680031791"><span class="hs-identifier hs-type">bCS</span></a></span></span><span> </span><span id="local-6989586621680031790"><span class="annot"><a href="#local-6989586621680031790"><span class="hs-identifier hs-type">bTX</span></a></span></span><span> </span><span id="local-6989586621680031789"><span class="annot"><a href="#local-6989586621680031789"><span class="hs-identifier hs-type">bSQ</span></a></span></span><span> </span><span id="local-6989586621680031788"><span class="annot"><a href="#local-6989586621680031788"><span class="hs-identifier hs-type">bTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Codecs"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs"><span class="hs-identifier hs-var">Codecs</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-150"></span><span>      </span><span id="cChainSyncCodec"><span class="annot"><span class="annottext">Codecs' blk serialisedBlk e m bCS bTX bSQ bTM
-&gt; Codec (ChainSync serialisedBlk (Point blk) (Tip blk)) e m bCS
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cChainSyncCodec"><span class="hs-identifier hs-var hs-var">cChainSyncCodec</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/typed-protocols-0.1.0.0/noopt/doc/html/typed-protocols/src"><span class="hs-identifier hs-type">Codec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">ChainSync</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031795"><span class="hs-identifier hs-type">serialisedBlk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031794"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Tip</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031794"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="annot"><a href="#local-6989586621680031793"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031792"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031791"><span class="hs-identifier hs-type">bCS</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="cTxSubmissionCodec"><span class="annot"><span class="annottext">Codecs' blk serialisedBlk e m bCS bTX bSQ bTM
-&gt; Codec (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)) e m bTX
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cTxSubmissionCodec"><span class="hs-identifier hs-var hs-var">cTxSubmissionCodec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/typed-protocols-0.1.0.0/noopt/doc/html/typed-protocols/src"><span class="hs-identifier hs-type">Codec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">LocalTxSubmission</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTx"><span class="hs-identifier hs-type">GenTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031794"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#ApplyTxErr"><span class="hs-identifier hs-type">ApplyTxErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031794"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="annot"><a href="#local-6989586621680031793"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031792"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031790"><span class="hs-identifier hs-type">bTX</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="cStateQueryCodec"><span class="annot"><span class="annottext">Codecs' blk serialisedBlk e m bCS bTX bSQ bTM
-&gt; Codec (LocalStateQuery blk (Point blk) (Query blk)) e m bSQ
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cStateQueryCodec"><span class="hs-identifier hs-var hs-var">cStateQueryCodec</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/typed-protocols-0.1.0.0/noopt/doc/html/typed-protocols/src"><span class="hs-identifier hs-type">Codec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">LocalStateQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031794"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031794"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031794"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="annot"><a href="#local-6989586621680031793"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031792"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031789"><span class="hs-identifier hs-type">bSQ</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="cTxMonitorCodec"><span class="annot"><span class="annottext">Codecs' blk serialisedBlk e m bCS bTX bSQ bTM
-&gt; Codec (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo) e m bTM
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cTxMonitorCodec"><span class="hs-identifier hs-var hs-var">cTxMonitorCodec</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/typed-protocols-0.1.0.0/noopt/doc/html/typed-protocols/src"><span class="hs-identifier hs-type">Codec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">LocalTxMonitor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTxId"><span class="hs-identifier hs-type">GenTxId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031794"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTx"><span class="hs-identifier hs-type">GenTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031794"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680031793"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031792"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031788"><span class="hs-identifier hs-type">bTM</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-keyword">type</span><span> </span><span id="Codecs"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs"><span class="hs-identifier hs-var">Codecs</span></a></span></span><span> </span><span id="local-6989586621680031394"><span class="annot"><a href="#local-6989586621680031394"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span id="local-6989586621680031393"><span class="annot"><a href="#local-6989586621680031393"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680031392"><span class="annot"><a href="#local-6989586621680031392"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680031391"><span class="annot"><a href="#local-6989586621680031391"><span class="hs-identifier hs-type">bCS</span></a></span></span><span> </span><span id="local-6989586621680031390"><span class="annot"><a href="#local-6989586621680031390"><span class="hs-identifier hs-type">bTX</span></a></span></span><span> </span><span id="local-6989586621680031389"><span class="annot"><a href="#local-6989586621680031389"><span class="hs-identifier hs-type">bSQ</span></a></span></span><span> </span><span id="local-6989586621680031388"><span class="annot"><a href="#local-6989586621680031388"><span class="hs-identifier hs-type">bTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs%27"><span class="hs-identifier hs-type">Codecs'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031394"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Serialised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031394"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680031393"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031392"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031391"><span class="hs-identifier hs-type">bCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031390"><span class="hs-identifier hs-type">bTX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031389"><span class="hs-identifier hs-type">bSQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031388"><span class="hs-identifier hs-type">bTM</span></a></span><span>
</span><span id="line-158"></span><span class="hs-keyword">type</span><span> </span><span id="DefaultCodecs"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#DefaultCodecs"><span class="hs-identifier hs-var">DefaultCodecs</span></a></span></span><span> </span><span id="local-6989586621680031387"><span class="annot"><a href="#local-6989586621680031387"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span id="local-6989586621680031386"><span class="annot"><a href="#local-6989586621680031386"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs%27"><span class="hs-identifier hs-type">Codecs'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031387"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Serialised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031387"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DeserialiseFailure</span></span><span> </span><span class="annot"><a href="#local-6989586621680031386"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-160"></span><span class="hs-keyword">type</span><span> </span><span id="ClientCodecs"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#ClientCodecs"><span class="hs-identifier hs-var">ClientCodecs</span></a></span></span><span> </span><span id="local-6989586621680031385"><span class="annot"><a href="#local-6989586621680031385"><span class="hs-identifier hs-type">blk</span></a></span></span><span>  </span><span id="local-6989586621680031384"><span class="annot"><a href="#local-6989586621680031384"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs%27"><span class="hs-identifier hs-type">Codecs'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031385"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031385"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DeserialiseFailure</span></span><span> </span><span class="annot"><a href="#local-6989586621680031384"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Protocol codecs for the node-to-client protocols</span><span>
</span><span id="line-164"></span><span class="hs-comment">--</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- We pass the 'BlockConfig' here, even though it is currently unused. If at any</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- point we want to introduce local protocols that for example send Byron blocks</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- or headers across, we will need to have the epoch size, which comes from the</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- Byron config. Unlike the full 'TopLevelConfig', it should not be difficult</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- for a wallet to construct the 'BlockConfig'.</span><span>
</span><span id="line-170"></span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- NOTE: Somewhat confusingly, 'pcChainSyncCodec' currently /does/ send Byron</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- blocks across, but it does not deserialize them (the user of the codec is</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- itself responsible for doing that), which is why it currently does not need</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- the config.</span><span>
</span><span id="line-175"></span><span class="hs-comment">--</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- Implementation mode: currently none of the consensus encoders/decoders do</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- anything different based on the version, so @_version@ is unused; it's just</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- that not all codecs are used, depending on the version number.</span><span>
</span><span id="line-179"></span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#defaultCodecs"><span class="hs-identifier hs-type">defaultCodecs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680031383"><span class="annot"><a href="#local-6989586621680031383"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680031382"><span class="annot"><a href="#local-6989586621680031382"><span class="hs-identifier hs-type">blk</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-180"></span><span>                 </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/src"><span class="hs-identifier hs-type">MonadST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031383"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-181"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html#SerialiseNodeToClientConstraints"><span class="hs-identifier hs-type">SerialiseNodeToClientConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031382"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-182"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">ShowQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#BlockQuery"><span class="hs-identifier hs-type">BlockQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031382"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">StandardHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031382"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-184"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Serialise</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">HeaderHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031382"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>                 </span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031382"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-187"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToClientVersion"><span class="hs-identifier hs-type">BlockNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031382"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-188"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">N.NodeToClientVersion</span></a></span><span>
</span><span id="line-189"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#DefaultCodecs"><span class="hs-identifier hs-type">DefaultCodecs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031382"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031383"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-190"></span><span id="defaultCodecs"><span class="annot"><span class="annottext">defaultCodecs :: CodecConfig blk
-&gt; BlockNodeToClientVersion blk
-&gt; NodeToClientVersion
-&gt; DefaultCodecs blk m
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#defaultCodecs"><span class="hs-identifier hs-var hs-var">defaultCodecs</span></a></span></span><span> </span><span id="local-6989586621680031379"><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031379"><span class="hs-identifier hs-var">ccfg</span></a></span></span><span> </span><span id="local-6989586621680031378"><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031378"><span class="hs-identifier hs-var">version</span></a></span></span><span> </span><span id="local-6989586621680031377"><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680031377"><span class="hs-identifier hs-var">networkVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Codecs :: forall blk serialisedBlk e (m :: * -&gt; *) bCS bTX bSQ bTM.
Codec (ChainSync serialisedBlk (Point blk) (Tip blk)) e m bCS
-&gt; Codec (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)) e m bTX
-&gt; Codec (LocalStateQuery blk (Point blk) (Query blk)) e m bSQ
-&gt; Codec (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo) e m bTM
-&gt; Codecs' blk serialisedBlk e m bCS bTX bSQ bTM
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs"><span class="hs-identifier hs-type">Codecs</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-191"></span><span>      </span><span class="annot"><span class="annottext">cChainSyncCodec :: Codec
  (ChainSync (Serialised blk) (Point blk) (Tip blk))
  DeserialiseFailure
  m
  ByteString
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cChainSyncCodec"><span class="hs-identifier hs-var">cChainSyncCodec</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><span class="annottext">(Serialised blk -&gt; Encoding)
-&gt; (forall s. Decoder s (Serialised blk))
-&gt; (Point blk -&gt; Encoding)
-&gt; (forall s. Decoder s (Point blk))
-&gt; (Tip blk -&gt; Encoding)
-&gt; (forall s. Decoder s (Tip blk))
-&gt; Codec
     (ChainSync (Serialised blk) (Point blk) (Tip blk))
     DeserialiseFailure
     m
     ByteString
forall header point tip (m :: * -&gt; *).
MonadST m =&gt;
(header -&gt; Encoding)
-&gt; (forall s. Decoder s header)
-&gt; (point -&gt; Encoding)
-&gt; (forall s. Decoder s point)
-&gt; (tip -&gt; Encoding)
-&gt; (forall s. Decoder s tip)
-&gt; Codec
     (ChainSync header point tip) DeserialiseFailure m ByteString
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">codecChainSync</span></a></span><span>
</span><span id="line-193"></span><span>          </span><span class="annot"><span class="annottext">Serialised blk -&gt; Encoding
forall a. SerialiseNodeToClient blk a =&gt; a -&gt; Encoding
</span><a href="#local-6989586621680031375"><span class="hs-identifier hs-var">enc</span></a></span><span>
</span><span id="line-194"></span><span>          </span><span class="annot"><span class="annottext">forall s. Decoder s (Serialised blk)
forall a s. SerialiseNodeToClient blk a =&gt; Decoder s a
</span><a href="#local-6989586621680031374"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-195"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HeaderHash blk -&gt; Encoding) -&gt; Point blk -&gt; Encoding
forall block.
(HeaderHash block -&gt; Encoding) -&gt; Point block -&gt; Encoding
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">encodePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; HeaderHash blk -&gt; Encoding
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; HeaderHash blk -&gt; Encoding
</span><a href="Ouroboros.Consensus.Block.Abstract.html#encodeRawHash"><span class="hs-identifier hs-var">encodeRawHash</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680031372"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall s. Decoder s (HeaderHash blk))
-&gt; forall s. Decoder s (Point blk)
forall block.
(forall s. Decoder s (HeaderHash block))
-&gt; forall s. Decoder s (Point block)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">decodePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; forall s. Decoder s (HeaderHash blk)
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; forall s. Decoder s (HeaderHash blk)
</span><a href="Ouroboros.Consensus.Block.Abstract.html#decodeRawHash"><span class="hs-identifier hs-var">decodeRawHash</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680031372"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HeaderHash blk -&gt; Encoding) -&gt; Tip blk -&gt; Encoding
forall blk. (HeaderHash blk -&gt; Encoding) -&gt; Tip blk -&gt; Encoding
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">encodeTip</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; HeaderHash blk -&gt; Encoding
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; HeaderHash blk -&gt; Encoding
</span><a href="Ouroboros.Consensus.Block.Abstract.html#encodeRawHash"><span class="hs-identifier hs-var">encodeRawHash</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680031372"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall s. Decoder s (HeaderHash blk))
-&gt; forall s. Decoder s (Tip blk)
forall blk.
(forall s. Decoder s (HeaderHash blk))
-&gt; forall s. Decoder s (Tip blk)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">decodeTip</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; forall s. Decoder s (HeaderHash blk)
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; forall s. Decoder s (HeaderHash blk)
</span><a href="Ouroboros.Consensus.Block.Abstract.html#decodeRawHash"><span class="hs-identifier hs-var">decodeRawHash</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680031372"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cTxSubmissionCodec :: Codec
  (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))
  DeserialiseFailure
  m
  ByteString
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cTxSubmissionCodec"><span class="hs-identifier hs-var">cTxSubmissionCodec</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><span class="annottext">(GenTx blk -&gt; Encoding)
-&gt; (forall s. Decoder s (GenTx blk))
-&gt; (ApplyTxErr blk -&gt; Encoding)
-&gt; (forall s. Decoder s (ApplyTxErr blk))
-&gt; Codec
     (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))
     DeserialiseFailure
     m
     ByteString
forall tx reject (m :: * -&gt; *).
MonadST m =&gt;
(tx -&gt; Encoding)
-&gt; (forall s. Decoder s tx)
-&gt; (reject -&gt; Encoding)
-&gt; (forall s. Decoder s reject)
-&gt; Codec
     (LocalTxSubmission tx reject) DeserialiseFailure m ByteString
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">codecLocalTxSubmission</span></a></span><span>
</span><span id="line-202"></span><span>          </span><span class="annot"><span class="annottext">GenTx blk -&gt; Encoding
forall a. SerialiseNodeToClient blk a =&gt; a -&gt; Encoding
</span><a href="#local-6989586621680031375"><span class="hs-identifier hs-var">enc</span></a></span><span>
</span><span id="line-203"></span><span>          </span><span class="annot"><span class="annottext">forall s. Decoder s (GenTx blk)
forall a s. SerialiseNodeToClient blk a =&gt; Decoder s a
</span><a href="#local-6989586621680031374"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-204"></span><span>          </span><span class="annot"><span class="annottext">ApplyTxErr blk -&gt; Encoding
forall a. SerialiseNodeToClient blk a =&gt; a -&gt; Encoding
</span><a href="#local-6989586621680031375"><span class="hs-identifier hs-var">enc</span></a></span><span>
</span><span id="line-205"></span><span>          </span><span class="annot"><span class="annottext">forall s. Decoder s (ApplyTxErr blk)
forall a s. SerialiseNodeToClient blk a =&gt; Decoder s a
</span><a href="#local-6989586621680031374"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cStateQueryCodec :: Codec
  (LocalStateQuery blk (Point blk) (Query blk))
  DeserialiseFailure
  m
  ByteString
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cStateQueryCodec"><span class="hs-identifier hs-var">cStateQueryCodec</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="annottext">Bool
-&gt; (Point blk -&gt; Encoding)
-&gt; (forall s. Decoder s (Point blk))
-&gt; (forall result. Query blk result -&gt; Encoding)
-&gt; (forall s. Decoder s (Some (Query blk)))
-&gt; (forall result. Query blk result -&gt; result -&gt; Encoding)
-&gt; (forall result. Query blk result -&gt; forall s. Decoder s result)
-&gt; Codec
     (LocalStateQuery blk (Point blk) (Query blk))
     DeserialiseFailure
     m
     ByteString
forall k (block :: k) point (query :: * -&gt; *) (m :: * -&gt; *).
(MonadST m, ShowQuery query) =&gt;
Bool
-&gt; (point -&gt; Encoding)
-&gt; (forall s. Decoder s point)
-&gt; (forall result. query result -&gt; Encoding)
-&gt; (forall s. Decoder s (Some query))
-&gt; (forall result. query result -&gt; result -&gt; Encoding)
-&gt; (forall result. query result -&gt; forall s. Decoder s result)
-&gt; Codec
     (LocalStateQuery block point query) DeserialiseFailure m ByteString
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">codecLocalStateQuery</span></a></span><span>
</span><span id="line-209"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680031377"><span class="hs-identifier hs-var">networkVersion</span></a></span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion -&gt; NodeToClientVersion -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">NodeToClientV_8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HeaderHash blk -&gt; Encoding) -&gt; Point blk -&gt; Encoding
forall block.
(HeaderHash block -&gt; Encoding) -&gt; Point block -&gt; Encoding
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">encodePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; HeaderHash blk -&gt; Encoding
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; HeaderHash blk -&gt; Encoding
</span><a href="Ouroboros.Consensus.Block.Abstract.html#encodeRawHash"><span class="hs-identifier hs-var">encodeRawHash</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680031372"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall s. Decoder s (HeaderHash blk))
-&gt; forall s. Decoder s (Point blk)
forall block.
(forall s. Decoder s (HeaderHash block))
-&gt; forall s. Decoder s (Point block)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">decodePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; forall s. Decoder s (HeaderHash blk)
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; forall s. Decoder s (HeaderHash blk)
</span><a href="Ouroboros.Consensus.Block.Abstract.html#decodeRawHash"><span class="hs-identifier hs-var">decodeRawHash</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680031372"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig blk
-&gt; QueryVersion
-&gt; BlockNodeToClientVersion blk
-&gt; SomeSecond Query blk
-&gt; Encoding
forall blk.
(Typeable blk, Show (SomeSecond BlockQuery blk),
 SerialiseNodeToClient blk (SomeSecond BlockQuery blk)) =&gt;
CodecConfig blk
-&gt; QueryVersion
-&gt; BlockNodeToClientVersion blk
-&gt; SomeSecond Query blk
-&gt; Encoding
</span><a href="Ouroboros.Consensus.Ledger.Query.html#queryEncodeNodeToClient"><span class="hs-identifier hs-var">queryEncodeNodeToClient</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031379"><span class="hs-identifier hs-var">ccfg</span></a></span><span> </span><span class="annot"><span class="annottext">QueryVersion
</span><a href="#local-6989586621680031366"><span class="hs-identifier hs-var">queryVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031378"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="annot"><span class="annottext">(SomeSecond Query blk -&gt; Encoding)
-&gt; (Query blk result -&gt; SomeSecond Query blk)
-&gt; Query blk result
-&gt; Encoding
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Query blk result -&gt; SomeSecond Query blk
forall (f :: * -&gt; * -&gt; *) a b. f a b -&gt; SomeSecond f a
</span><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-var">SomeSecond</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span id="local-6989586621680031364"><span class="annot"><span class="annottext">Query blk b
</span><a href="#local-6989586621680031364"><span class="hs-identifier hs-var">qry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Query blk b -&gt; Some (Query blk)
forall k (f :: k -&gt; *) (a :: k). f a -&gt; Some f
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">Query blk b
</span><a href="#local-6989586621680031364"><span class="hs-identifier hs-var">qry</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SomeSecond Query blk -&gt; Some (Query blk))
-&gt; Decoder s (SomeSecond Query blk) -&gt; Decoder s (Some (Query blk))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
-&gt; QueryVersion
-&gt; BlockNodeToClientVersion blk
-&gt; forall s. Decoder s (SomeSecond Query blk)
forall blk.
SerialiseNodeToClient blk (SomeSecond BlockQuery blk) =&gt;
CodecConfig blk
-&gt; QueryVersion
-&gt; BlockNodeToClientVersion blk
-&gt; forall s. Decoder s (SomeSecond Query blk)
</span><a href="Ouroboros.Consensus.Ledger.Query.html#queryDecodeNodeToClient"><span class="hs-identifier hs-var">queryDecodeNodeToClient</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031379"><span class="hs-identifier hs-var">ccfg</span></a></span><span> </span><span class="annot"><span class="annottext">QueryVersion
</span><a href="#local-6989586621680031366"><span class="hs-identifier hs-var">queryVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031378"><span class="hs-identifier hs-var">version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig blk
-&gt; BlockNodeToClientVersion blk
-&gt; Query blk result
-&gt; result
-&gt; Encoding
forall blk (query :: * -&gt; *) result.
SerialiseResult blk query =&gt;
CodecConfig blk
-&gt; BlockNodeToClientVersion blk
-&gt; query result
-&gt; result
-&gt; Encoding
</span><a href="Ouroboros.Consensus.Node.Serialisation.html#encodeResult"><span class="hs-identifier hs-var">encodeResult</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031379"><span class="hs-identifier hs-var">ccfg</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031378"><span class="hs-identifier hs-var">version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig blk
-&gt; BlockNodeToClientVersion blk
-&gt; Query blk result
-&gt; forall s. Decoder s result
forall blk (query :: * -&gt; *) result.
SerialiseResult blk query =&gt;
CodecConfig blk
-&gt; BlockNodeToClientVersion blk
-&gt; query result
-&gt; forall s. Decoder s result
</span><a href="Ouroboros.Consensus.Node.Serialisation.html#decodeResult"><span class="hs-identifier hs-var">decodeResult</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031379"><span class="hs-identifier hs-var">ccfg</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031378"><span class="hs-identifier hs-var">version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cTxMonitorCodec :: Codec
  (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)
  DeserialiseFailure
  m
  ByteString
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cTxMonitorCodec"><span class="hs-identifier hs-var">cTxMonitorCodec</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><span class="annottext">(GenTxId blk -&gt; Encoding)
-&gt; (forall s. Decoder s (GenTxId blk))
-&gt; (GenTx blk -&gt; Encoding)
-&gt; (forall s. Decoder s (GenTx blk))
-&gt; (SlotNo -&gt; Encoding)
-&gt; (forall s. Decoder s SlotNo)
-&gt; Codec
     (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)
     DeserialiseFailure
     m
     ByteString
forall txid tx slot (m :: * -&gt; *) ptcl.
(MonadST m, ptcl ~ LocalTxMonitor txid tx slot) =&gt;
(txid -&gt; Encoding)
-&gt; (forall s. Decoder s txid)
-&gt; (tx -&gt; Encoding)
-&gt; (forall s. Decoder s tx)
-&gt; (slot -&gt; Encoding)
-&gt; (forall s. Decoder s slot)
-&gt; Codec
     (LocalTxMonitor txid tx slot) DeserialiseFailure m ByteString
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">codecLocalTxMonitor</span></a></span><span>
</span><span id="line-219"></span><span>          </span><span class="annot"><span class="annottext">GenTxId blk -&gt; Encoding
forall a. SerialiseNodeToClient blk a =&gt; a -&gt; Encoding
</span><a href="#local-6989586621680031375"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s (GenTxId blk)
forall a s. SerialiseNodeToClient blk a =&gt; Decoder s a
</span><a href="#local-6989586621680031374"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-220"></span><span>          </span><span class="annot"><span class="annottext">GenTx blk -&gt; Encoding
forall a. SerialiseNodeToClient blk a =&gt; a -&gt; Encoding
</span><a href="#local-6989586621680031375"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s (GenTx blk)
forall a s. SerialiseNodeToClient blk a =&gt; Decoder s a
</span><a href="#local-6989586621680031374"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-221"></span><span>          </span><span class="annot"><span class="annottext">SlotNo -&gt; Encoding
forall a. SerialiseNodeToClient blk a =&gt; a -&gt; Encoding
</span><a href="#local-6989586621680031375"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s SlotNo
forall a s. SerialiseNodeToClient blk a =&gt; Decoder s a
</span><a href="#local-6989586621680031374"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><a href="#local-6989586621680031366"><span class="hs-identifier hs-type">queryVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.Version.html#QueryVersion"><span class="hs-identifier hs-type">QueryVersion</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621680031366"><span class="annot"><span class="annottext">queryVersion :: QueryVersion
</span><a href="#local-6989586621680031366"><span class="hs-identifier hs-var hs-var">queryVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion -&gt; QueryVersion
</span><a href="Ouroboros.Consensus.Ledger.Query.Version.html#nodeToClientVersionToQueryVersion"><span class="hs-identifier hs-var">nodeToClientVersionToQueryVersion</span></a></span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680031377"><span class="hs-identifier hs-var">networkVersion</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="#local-6989586621680031372"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031382"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621680031372"><span class="annot"><span class="annottext">p :: Proxy blk
</span><a href="#local-6989586621680031372"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy blk
forall k (t :: k). Proxy t
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span>    </span><span id="local-6989586621680031775"><span class="annot"><a href="#local-6989586621680031375"><span class="hs-identifier hs-type">enc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Serialisation.html#SerialiseNodeToClient"><span class="hs-identifier hs-type">SerialiseNodeToClient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031382"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031775"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680031775"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span></span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621680031375"><span class="annot"><span class="annottext">enc :: a -&gt; Encoding
</span><a href="#local-6989586621680031375"><span class="hs-identifier hs-var hs-var">enc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodecConfig blk -&gt; BlockNodeToClientVersion blk -&gt; a -&gt; Encoding
forall blk a.
SerialiseNodeToClient blk a =&gt;
CodecConfig blk -&gt; BlockNodeToClientVersion blk -&gt; a -&gt; Encoding
</span><a href="Ouroboros.Consensus.Node.Serialisation.html#encodeNodeToClient"><span class="hs-identifier hs-var">encodeNodeToClient</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031379"><span class="hs-identifier hs-var">ccfg</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031378"><span class="hs-identifier hs-var">version</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621680031773"><span class="annot"><a href="#local-6989586621680031374"><span class="hs-identifier hs-type">dec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Serialisation.html#SerialiseNodeToClient"><span class="hs-identifier hs-type">SerialiseNodeToClient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031382"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031773"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680031772"><span class="annot"><a href="#local-6989586621680031772"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680031772"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031773"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621680031374"><span class="annot"><span class="annottext">dec :: forall s. Decoder s a
</span><a href="#local-6989586621680031374"><span class="hs-identifier hs-var hs-var">dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
-&gt; BlockNodeToClientVersion blk -&gt; forall s. Decoder s a
forall blk a.
SerialiseNodeToClient blk a =&gt;
CodecConfig blk
-&gt; BlockNodeToClientVersion blk -&gt; forall s. Decoder s a
</span><a href="Ouroboros.Consensus.Node.Serialisation.html#decodeNodeToClient"><span class="hs-identifier hs-var">decodeNodeToClient</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031379"><span class="hs-identifier hs-var">ccfg</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031378"><span class="hs-identifier hs-var">version</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- | Protocol codecs for the node-to-client protocols which serialise</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- / deserialise blocks in /chain-sync/ protocol.</span><span>
</span><span id="line-238"></span><span class="hs-comment">--</span><span>
</span><span id="line-239"></span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#clientCodecs"><span class="hs-identifier hs-type">clientCodecs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680031354"><span class="annot"><a href="#local-6989586621680031354"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680031353"><span class="annot"><a href="#local-6989586621680031353"><span class="hs-identifier hs-type">blk</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-240"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/src"><span class="hs-identifier hs-type">MonadST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031354"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-241"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html#SerialiseNodeToClientConstraints"><span class="hs-identifier hs-type">SerialiseNodeToClientConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031353"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-242"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">ShowQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#BlockQuery"><span class="hs-identifier hs-type">BlockQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031353"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">StandardHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031353"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-244"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Serialise</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">HeaderHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031353"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031353"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-247"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToClientVersion"><span class="hs-identifier hs-type">BlockNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031353"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-248"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">N.NodeToClientVersion</span></a></span><span>
</span><span id="line-249"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#ClientCodecs"><span class="hs-identifier hs-type">ClientCodecs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031353"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031354"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-250"></span><span id="clientCodecs"><span class="annot"><span class="annottext">clientCodecs :: CodecConfig blk
-&gt; BlockNodeToClientVersion blk
-&gt; NodeToClientVersion
-&gt; ClientCodecs blk m
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#clientCodecs"><span class="hs-identifier hs-var hs-var">clientCodecs</span></a></span></span><span> </span><span id="local-6989586621680031352"><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031352"><span class="hs-identifier hs-var">ccfg</span></a></span></span><span> </span><span id="local-6989586621680031351"><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031351"><span class="hs-identifier hs-var">version</span></a></span></span><span> </span><span id="local-6989586621680031350"><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680031350"><span class="hs-identifier hs-var">networkVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Codecs :: forall blk serialisedBlk e (m :: * -&gt; *) bCS bTX bSQ bTM.
Codec (ChainSync serialisedBlk (Point blk) (Tip blk)) e m bCS
-&gt; Codec (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)) e m bTX
-&gt; Codec (LocalStateQuery blk (Point blk) (Query blk)) e m bSQ
-&gt; Codec (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo) e m bTM
-&gt; Codecs' blk serialisedBlk e m bCS bTX bSQ bTM
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs"><span class="hs-identifier hs-type">Codecs</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><span class="annottext">cChainSyncCodec :: Codec
  (ChainSync blk (Point blk) (Tip blk))
  DeserialiseFailure
  m
  ByteString
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cChainSyncCodec"><span class="hs-identifier hs-var">cChainSyncCodec</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-252"></span><span>        </span><span class="annot"><span class="annottext">(blk -&gt; Encoding)
-&gt; (forall s. Decoder s blk)
-&gt; (Point blk -&gt; Encoding)
-&gt; (forall s. Decoder s (Point blk))
-&gt; (Tip blk -&gt; Encoding)
-&gt; (forall s. Decoder s (Tip blk))
-&gt; Codec
     (ChainSync blk (Point blk) (Tip blk))
     DeserialiseFailure
     m
     ByteString
forall header point tip (m :: * -&gt; *).
MonadST m =&gt;
(header -&gt; Encoding)
-&gt; (forall s. Decoder s header)
-&gt; (point -&gt; Encoding)
-&gt; (forall s. Decoder s point)
-&gt; (tip -&gt; Encoding)
-&gt; (forall s. Decoder s tip)
-&gt; Codec
     (ChainSync header point tip) DeserialiseFailure m ByteString
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">codecChainSync</span></a></span><span>
</span><span id="line-253"></span><span>          </span><span class="annot"><span class="annottext">blk -&gt; Encoding
forall a. SerialiseNodeToClient blk a =&gt; a -&gt; Encoding
</span><a href="#local-6989586621680031349"><span class="hs-identifier hs-var">enc</span></a></span><span>
</span><span id="line-254"></span><span>          </span><span class="annot"><span class="annottext">forall s. Decoder s blk
forall a s. SerialiseNodeToClient blk a =&gt; Decoder s a
</span><a href="#local-6989586621680031348"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-255"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HeaderHash blk -&gt; Encoding) -&gt; Point blk -&gt; Encoding
forall block.
(HeaderHash block -&gt; Encoding) -&gt; Point block -&gt; Encoding
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">encodePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; HeaderHash blk -&gt; Encoding
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; HeaderHash blk -&gt; Encoding
</span><a href="Ouroboros.Consensus.Block.Abstract.html#encodeRawHash"><span class="hs-identifier hs-var">encodeRawHash</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680031347"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall s. Decoder s (HeaderHash blk))
-&gt; forall s. Decoder s (Point blk)
forall block.
(forall s. Decoder s (HeaderHash block))
-&gt; forall s. Decoder s (Point block)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">decodePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; forall s. Decoder s (HeaderHash blk)
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; forall s. Decoder s (HeaderHash blk)
</span><a href="Ouroboros.Consensus.Block.Abstract.html#decodeRawHash"><span class="hs-identifier hs-var">decodeRawHash</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680031347"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HeaderHash blk -&gt; Encoding) -&gt; Tip blk -&gt; Encoding
forall blk. (HeaderHash blk -&gt; Encoding) -&gt; Tip blk -&gt; Encoding
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">encodeTip</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; HeaderHash blk -&gt; Encoding
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; HeaderHash blk -&gt; Encoding
</span><a href="Ouroboros.Consensus.Block.Abstract.html#encodeRawHash"><span class="hs-identifier hs-var">encodeRawHash</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680031347"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall s. Decoder s (HeaderHash blk))
-&gt; forall s. Decoder s (Tip blk)
forall blk.
(forall s. Decoder s (HeaderHash blk))
-&gt; forall s. Decoder s (Tip blk)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">decodeTip</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; forall s. Decoder s (HeaderHash blk)
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; forall s. Decoder s (HeaderHash blk)
</span><a href="Ouroboros.Consensus.Block.Abstract.html#decodeRawHash"><span class="hs-identifier hs-var">decodeRawHash</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680031347"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cTxSubmissionCodec :: Codec
  (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))
  DeserialiseFailure
  m
  ByteString
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cTxSubmissionCodec"><span class="hs-identifier hs-var">cTxSubmissionCodec</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-261"></span><span>        </span><span class="annot"><span class="annottext">(GenTx blk -&gt; Encoding)
-&gt; (forall s. Decoder s (GenTx blk))
-&gt; (ApplyTxErr blk -&gt; Encoding)
-&gt; (forall s. Decoder s (ApplyTxErr blk))
-&gt; Codec
     (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))
     DeserialiseFailure
     m
     ByteString
forall tx reject (m :: * -&gt; *).
MonadST m =&gt;
(tx -&gt; Encoding)
-&gt; (forall s. Decoder s tx)
-&gt; (reject -&gt; Encoding)
-&gt; (forall s. Decoder s reject)
-&gt; Codec
     (LocalTxSubmission tx reject) DeserialiseFailure m ByteString
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">codecLocalTxSubmission</span></a></span><span>
</span><span id="line-262"></span><span>          </span><span class="annot"><span class="annottext">GenTx blk -&gt; Encoding
forall a. SerialiseNodeToClient blk a =&gt; a -&gt; Encoding
</span><a href="#local-6989586621680031349"><span class="hs-identifier hs-var">enc</span></a></span><span>
</span><span id="line-263"></span><span>          </span><span class="annot"><span class="annottext">forall s. Decoder s (GenTx blk)
forall a s. SerialiseNodeToClient blk a =&gt; Decoder s a
</span><a href="#local-6989586621680031348"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-264"></span><span>          </span><span class="annot"><span class="annottext">ApplyTxErr blk -&gt; Encoding
forall a. SerialiseNodeToClient blk a =&gt; a -&gt; Encoding
</span><a href="#local-6989586621680031349"><span class="hs-identifier hs-var">enc</span></a></span><span>
</span><span id="line-265"></span><span>          </span><span class="annot"><span class="annottext">forall s. Decoder s (ApplyTxErr blk)
forall a s. SerialiseNodeToClient blk a =&gt; Decoder s a
</span><a href="#local-6989586621680031348"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cStateQueryCodec :: Codec
  (LocalStateQuery blk (Point blk) (Query blk))
  DeserialiseFailure
  m
  ByteString
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cStateQueryCodec"><span class="hs-identifier hs-var">cStateQueryCodec</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>        </span><span class="annot"><span class="annottext">Bool
-&gt; (Point blk -&gt; Encoding)
-&gt; (forall s. Decoder s (Point blk))
-&gt; (forall result. Query blk result -&gt; Encoding)
-&gt; (forall s. Decoder s (Some (Query blk)))
-&gt; (forall result. Query blk result -&gt; result -&gt; Encoding)
-&gt; (forall result. Query blk result -&gt; forall s. Decoder s result)
-&gt; Codec
     (LocalStateQuery blk (Point blk) (Query blk))
     DeserialiseFailure
     m
     ByteString
forall k (block :: k) point (query :: * -&gt; *) (m :: * -&gt; *).
(MonadST m, ShowQuery query) =&gt;
Bool
-&gt; (point -&gt; Encoding)
-&gt; (forall s. Decoder s point)
-&gt; (forall result. query result -&gt; Encoding)
-&gt; (forall s. Decoder s (Some query))
-&gt; (forall result. query result -&gt; result -&gt; Encoding)
-&gt; (forall result. query result -&gt; forall s. Decoder s result)
-&gt; Codec
     (LocalStateQuery block point query) DeserialiseFailure m ByteString
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">codecLocalStateQuery</span></a></span><span>
</span><span id="line-269"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680031350"><span class="hs-identifier hs-var">networkVersion</span></a></span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion -&gt; NodeToClientVersion -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">NodeToClientV_8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HeaderHash blk -&gt; Encoding) -&gt; Point blk -&gt; Encoding
forall block.
(HeaderHash block -&gt; Encoding) -&gt; Point block -&gt; Encoding
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">encodePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; HeaderHash blk -&gt; Encoding
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; HeaderHash blk -&gt; Encoding
</span><a href="Ouroboros.Consensus.Block.Abstract.html#encodeRawHash"><span class="hs-identifier hs-var">encodeRawHash</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680031347"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall s. Decoder s (HeaderHash blk))
-&gt; forall s. Decoder s (Point blk)
forall block.
(forall s. Decoder s (HeaderHash block))
-&gt; forall s. Decoder s (Point block)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">decodePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; forall s. Decoder s (HeaderHash blk)
forall blk (proxy :: * -&gt; *).
ConvertRawHash blk =&gt;
proxy blk -&gt; forall s. Decoder s (HeaderHash blk)
</span><a href="Ouroboros.Consensus.Block.Abstract.html#decodeRawHash"><span class="hs-identifier hs-var">decodeRawHash</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680031347"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig blk
-&gt; QueryVersion
-&gt; BlockNodeToClientVersion blk
-&gt; SomeSecond Query blk
-&gt; Encoding
forall blk.
(Typeable blk, Show (SomeSecond BlockQuery blk),
 SerialiseNodeToClient blk (SomeSecond BlockQuery blk)) =&gt;
CodecConfig blk
-&gt; QueryVersion
-&gt; BlockNodeToClientVersion blk
-&gt; SomeSecond Query blk
-&gt; Encoding
</span><a href="Ouroboros.Consensus.Ledger.Query.html#queryEncodeNodeToClient"><span class="hs-identifier hs-var">queryEncodeNodeToClient</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031352"><span class="hs-identifier hs-var">ccfg</span></a></span><span> </span><span class="annot"><span class="annottext">QueryVersion
</span><a href="#local-6989586621680031346"><span class="hs-identifier hs-var">queryVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031351"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="annot"><span class="annottext">(SomeSecond Query blk -&gt; Encoding)
-&gt; (Query blk result -&gt; SomeSecond Query blk)
-&gt; Query blk result
-&gt; Encoding
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Query blk result -&gt; SomeSecond Query blk
forall (f :: * -&gt; * -&gt; *) a b. f a b -&gt; SomeSecond f a
</span><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-var">SomeSecond</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Util.html#SomeSecond"><span class="hs-identifier hs-type">SomeSecond</span></a></span><span> </span><span id="local-6989586621680031345"><span class="annot"><span class="annottext">Query blk b
</span><a href="#local-6989586621680031345"><span class="hs-identifier hs-var">qry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Query blk b -&gt; Some (Query blk)
forall k (f :: k -&gt; *) (a :: k). f a -&gt; Some f
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">Query blk b
</span><a href="#local-6989586621680031345"><span class="hs-identifier hs-var">qry</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SomeSecond Query blk -&gt; Some (Query blk))
-&gt; Decoder s (SomeSecond Query blk) -&gt; Decoder s (Some (Query blk))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
-&gt; QueryVersion
-&gt; BlockNodeToClientVersion blk
-&gt; forall s. Decoder s (SomeSecond Query blk)
forall blk.
SerialiseNodeToClient blk (SomeSecond BlockQuery blk) =&gt;
CodecConfig blk
-&gt; QueryVersion
-&gt; BlockNodeToClientVersion blk
-&gt; forall s. Decoder s (SomeSecond Query blk)
</span><a href="Ouroboros.Consensus.Ledger.Query.html#queryDecodeNodeToClient"><span class="hs-identifier hs-var">queryDecodeNodeToClient</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031352"><span class="hs-identifier hs-var">ccfg</span></a></span><span> </span><span class="annot"><span class="annottext">QueryVersion
</span><a href="#local-6989586621680031346"><span class="hs-identifier hs-var">queryVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031351"><span class="hs-identifier hs-var">version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig blk
-&gt; BlockNodeToClientVersion blk
-&gt; Query blk result
-&gt; result
-&gt; Encoding
forall blk (query :: * -&gt; *) result.
SerialiseResult blk query =&gt;
CodecConfig blk
-&gt; BlockNodeToClientVersion blk
-&gt; query result
-&gt; result
-&gt; Encoding
</span><a href="Ouroboros.Consensus.Node.Serialisation.html#encodeResult"><span class="hs-identifier hs-var">encodeResult</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031352"><span class="hs-identifier hs-var">ccfg</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031351"><span class="hs-identifier hs-var">version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig blk
-&gt; BlockNodeToClientVersion blk
-&gt; Query blk result
-&gt; forall s. Decoder s result
forall blk (query :: * -&gt; *) result.
SerialiseResult blk query =&gt;
CodecConfig blk
-&gt; BlockNodeToClientVersion blk
-&gt; query result
-&gt; forall s. Decoder s result
</span><a href="Ouroboros.Consensus.Node.Serialisation.html#decodeResult"><span class="hs-identifier hs-var">decodeResult</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031352"><span class="hs-identifier hs-var">ccfg</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031351"><span class="hs-identifier hs-var">version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cTxMonitorCodec :: Codec
  (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)
  DeserialiseFailure
  m
  ByteString
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cTxMonitorCodec"><span class="hs-identifier hs-var">cTxMonitorCodec</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-278"></span><span>        </span><span class="annot"><span class="annottext">(GenTxId blk -&gt; Encoding)
-&gt; (forall s. Decoder s (GenTxId blk))
-&gt; (GenTx blk -&gt; Encoding)
-&gt; (forall s. Decoder s (GenTx blk))
-&gt; (SlotNo -&gt; Encoding)
-&gt; (forall s. Decoder s SlotNo)
-&gt; Codec
     (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)
     DeserialiseFailure
     m
     ByteString
forall txid tx slot (m :: * -&gt; *) ptcl.
(MonadST m, ptcl ~ LocalTxMonitor txid tx slot) =&gt;
(txid -&gt; Encoding)
-&gt; (forall s. Decoder s txid)
-&gt; (tx -&gt; Encoding)
-&gt; (forall s. Decoder s tx)
-&gt; (slot -&gt; Encoding)
-&gt; (forall s. Decoder s slot)
-&gt; Codec
     (LocalTxMonitor txid tx slot) DeserialiseFailure m ByteString
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">codecLocalTxMonitor</span></a></span><span>
</span><span id="line-279"></span><span>          </span><span class="annot"><span class="annottext">GenTxId blk -&gt; Encoding
forall a. SerialiseNodeToClient blk a =&gt; a -&gt; Encoding
</span><a href="#local-6989586621680031349"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s (GenTxId blk)
forall a s. SerialiseNodeToClient blk a =&gt; Decoder s a
</span><a href="#local-6989586621680031348"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-280"></span><span>          </span><span class="annot"><span class="annottext">GenTx blk -&gt; Encoding
forall a. SerialiseNodeToClient blk a =&gt; a -&gt; Encoding
</span><a href="#local-6989586621680031349"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s (GenTx blk)
forall a s. SerialiseNodeToClient blk a =&gt; Decoder s a
</span><a href="#local-6989586621680031348"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-281"></span><span>          </span><span class="annot"><span class="annottext">SlotNo -&gt; Encoding
forall a. SerialiseNodeToClient blk a =&gt; a -&gt; Encoding
</span><a href="#local-6989586621680031349"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s SlotNo
forall a s. SerialiseNodeToClient blk a =&gt; Decoder s a
</span><a href="#local-6989586621680031348"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="#local-6989586621680031346"><span class="hs-identifier hs-type">queryVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.Version.html#QueryVersion"><span class="hs-identifier hs-type">QueryVersion</span></a></span><span>
</span><span id="line-285"></span><span>    </span><span id="local-6989586621680031346"><span class="annot"><span class="annottext">queryVersion :: QueryVersion
</span><a href="#local-6989586621680031346"><span class="hs-identifier hs-var hs-var">queryVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion -&gt; QueryVersion
</span><a href="Ouroboros.Consensus.Ledger.Query.Version.html#nodeToClientVersionToQueryVersion"><span class="hs-identifier hs-var">nodeToClientVersionToQueryVersion</span></a></span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680031350"><span class="hs-identifier hs-var">networkVersion</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><a href="#local-6989586621680031347"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031353"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621680031347"><span class="annot"><span class="annottext">p :: Proxy blk
</span><a href="#local-6989586621680031347"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy blk
forall k (t :: k). Proxy t
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span>    </span><span id="local-6989586621680031688"><span class="annot"><a href="#local-6989586621680031349"><span class="hs-identifier hs-type">enc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Serialisation.html#SerialiseNodeToClient"><span class="hs-identifier hs-type">SerialiseNodeToClient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031353"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031688"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680031688"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Encoding</span></span></span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621680031349"><span class="annot"><span class="annottext">enc :: a -&gt; Encoding
</span><a href="#local-6989586621680031349"><span class="hs-identifier hs-var hs-var">enc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodecConfig blk -&gt; BlockNodeToClientVersion blk -&gt; a -&gt; Encoding
forall blk a.
SerialiseNodeToClient blk a =&gt;
CodecConfig blk -&gt; BlockNodeToClientVersion blk -&gt; a -&gt; Encoding
</span><a href="Ouroboros.Consensus.Node.Serialisation.html#encodeNodeToClient"><span class="hs-identifier hs-var">encodeNodeToClient</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031352"><span class="hs-identifier hs-var">ccfg</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031351"><span class="hs-identifier hs-var">version</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621680031687"><span class="annot"><a href="#local-6989586621680031348"><span class="hs-identifier hs-type">dec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Serialisation.html#SerialiseNodeToClient"><span class="hs-identifier hs-type">SerialiseNodeToClient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031353"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031687"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680031686"><span class="annot"><a href="#local-6989586621680031686"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Decoder</span></span><span> </span><span class="annot"><a href="#local-6989586621680031686"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031687"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621680031348"><span class="annot"><span class="annottext">dec :: forall s. Decoder s a
</span><a href="#local-6989586621680031348"><span class="hs-identifier hs-var hs-var">dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
-&gt; BlockNodeToClientVersion blk -&gt; forall s. Decoder s a
forall blk a.
SerialiseNodeToClient blk a =&gt;
CodecConfig blk
-&gt; BlockNodeToClientVersion blk -&gt; forall s. Decoder s a
</span><a href="Ouroboros.Consensus.Node.Serialisation.html#decodeNodeToClient"><span class="hs-identifier hs-var">decodeNodeToClient</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680031352"><span class="hs-identifier hs-var">ccfg</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680031351"><span class="hs-identifier hs-var">version</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- | Identity codecs used in tests.</span><span>
</span><span id="line-297"></span><span id="local-6989586621680031343"><span id="local-6989586621680031344"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#identityCodecs"><span class="hs-identifier hs-type">identityCodecs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031344"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#QueryLedger"><span class="hs-identifier hs-type">QueryLedger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031343"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs"><span class="hs-identifier hs-type">Codecs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031343"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/typed-protocols-0.1.0.0/noopt/doc/html/typed-protocols/src"><span class="hs-identifier hs-type">CodecFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031344"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-299"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/typed-protocols-0.1.0.0/noopt/doc/html/typed-protocols/src"><span class="hs-identifier hs-type">AnyMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">ChainSync</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Serialised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031343"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031343"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Tip</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031343"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/typed-protocols-0.1.0.0/noopt/doc/html/typed-protocols/src"><span class="hs-identifier hs-type">AnyMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">LocalTxSubmission</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTx"><span class="hs-identifier hs-type">GenTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031343"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#ApplyTxErr"><span class="hs-identifier hs-type">ApplyTxErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031343"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/typed-protocols-0.1.0.0/noopt/doc/html/typed-protocols/src"><span class="hs-identifier hs-type">AnyMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">LocalStateQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031343"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031343"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031343"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/typed-protocols-0.1.0.0/noopt/doc/html/typed-protocols/src"><span class="hs-identifier hs-type">AnyMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">LocalTxMonitor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTxId"><span class="hs-identifier hs-type">GenTxId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031343"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTx"><span class="hs-identifier hs-type">GenTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031343"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-303"></span><span id="identityCodecs"><span class="annot"><span class="annottext">identityCodecs :: Codecs
  blk
  CodecFailure
  m
  (AnyMessage (ChainSync (Serialised blk) (Point blk) (Tip blk)))
  (AnyMessage (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)))
  (AnyMessage (LocalStateQuery blk (Point blk) (Query blk)))
  (AnyMessage (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#identityCodecs"><span class="hs-identifier hs-var hs-var">identityCodecs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Codecs :: forall blk serialisedBlk e (m :: * -&gt; *) bCS bTX bSQ bTM.
Codec (ChainSync serialisedBlk (Point blk) (Tip blk)) e m bCS
-&gt; Codec (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)) e m bTX
-&gt; Codec (LocalStateQuery blk (Point blk) (Query blk)) e m bSQ
-&gt; Codec (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo) e m bTM
-&gt; Codecs' blk serialisedBlk e m bCS bTX bSQ bTM
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs"><span class="hs-identifier hs-type">Codecs</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-304"></span><span>      </span><span class="annot"><span class="annottext">cChainSyncCodec :: Codec
  (ChainSync (Serialised blk) (Point blk) (Tip blk))
  CodecFailure
  m
  (AnyMessage (ChainSync (Serialised blk) (Point blk) (Tip blk)))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cChainSyncCodec"><span class="hs-identifier hs-var">cChainSyncCodec</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Codec
  (ChainSync (Serialised blk) (Point blk) (Tip blk))
  CodecFailure
  m
  (AnyMessage (ChainSync (Serialised blk) (Point blk) (Tip blk)))
forall k1 k2 k3 (header :: k1) (point :: k2) (tip :: k3)
       (m :: * -&gt; *).
Monad m =&gt;
Codec
  (ChainSync header point tip)
  CodecFailure
  m
  (AnyMessage (ChainSync header point tip))
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">codecChainSyncId</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cTxSubmissionCodec :: Codec
  (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))
  CodecFailure
  m
  (AnyMessage (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cTxSubmissionCodec"><span class="hs-identifier hs-var">cTxSubmissionCodec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Codec
  (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))
  CodecFailure
  m
  (AnyMessage (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)))
forall k1 k2 (tx :: k1) (reject :: k2) (m :: * -&gt; *).
Monad m =&gt;
Codec
  (LocalTxSubmission tx reject)
  CodecFailure
  m
  (AnyMessage (LocalTxSubmission tx reject))
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">codecLocalTxSubmissionId</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cStateQueryCodec :: Codec
  (LocalStateQuery blk (Point blk) (Query blk))
  CodecFailure
  m
  (AnyMessage (LocalStateQuery blk (Point blk) (Query blk)))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cStateQueryCodec"><span class="hs-identifier hs-var">cStateQueryCodec</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall result1 result2.
 Query blk result1
 -&gt; Query blk result2 -&gt; Maybe (result1 :~: result2))
-&gt; Codec
     (LocalStateQuery blk (Point blk) (Query blk))
     CodecFailure
     m
     (AnyMessage (LocalStateQuery blk (Point blk) (Query blk)))
forall k1 k2 (block :: k1) (point :: k2) (query :: * -&gt; *)
       (m :: * -&gt; *).
Monad m =&gt;
(forall result1 result2.
 query result1 -&gt; query result2 -&gt; Maybe (result1 :~: result2))
-&gt; Codec
     (LocalStateQuery block point query)
     CodecFailure
     m
     (AnyMessage (LocalStateQuery block point query))
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">codecLocalStateQueryId</span></a></span><span> </span><span class="annot"><span class="annottext">forall result1 result2.
Query blk result1
-&gt; Query blk result2 -&gt; Maybe (result1 :~: result2)
forall (f :: * -&gt; *) a b.
SameDepIndex f =&gt;
f a -&gt; f b -&gt; Maybe (a :~: b)
</span><a href="Ouroboros.Consensus.Util.DepPair.html#sameDepIndex"><span class="hs-identifier hs-var">sameDepIndex</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cTxMonitorCodec :: Codec
  (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)
  CodecFailure
  m
  (AnyMessage (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#cTxMonitorCodec"><span class="hs-identifier hs-var">cTxMonitorCodec</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Codec
  (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)
  CodecFailure
  m
  (AnyMessage (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo))
forall k1 k2 k3 (txid :: k1) (tx :: k2) (slot :: k3) (m :: * -&gt; *)
       ptcl.
(Monad m, ptcl ~ LocalTxMonitor txid tx slot) =&gt;
Codec ptcl CodecFailure m (AnyMessage ptcl)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">codecLocalTxMonitorId</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Tracers
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-comment">-- | A record of 'Tracer's for the different protocols.</span><span>
</span><span id="line-315"></span><span class="hs-keyword">type</span><span> </span><span id="Tracers"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers"><span class="hs-identifier hs-var">Tracers</span></a></span></span><span> </span><span id="local-6989586621680031337"><span class="annot"><a href="#local-6989586621680031337"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680031336"><span class="annot"><a href="#local-6989586621680031336"><span class="hs-identifier hs-type">peer</span></a></span></span><span> </span><span id="local-6989586621680031335"><span class="annot"><a href="#local-6989586621680031335"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span id="local-6989586621680031334"><span class="annot"><a href="#local-6989586621680031334"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>     </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers%27"><span class="hs-identifier hs-type">Tracers'</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621680031336"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031335"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031334"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tracer</span></span><span> </span><span class="annot"><a href="#local-6989586621680031337"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-keyword">data</span><span> </span><span id="Tracers%27"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers%27"><span class="hs-identifier hs-var">Tracers'</span></a></span></span><span> </span><span id="local-6989586621680031603"><span class="annot"><a href="#local-6989586621680031603"><span class="hs-identifier hs-type">peer</span></a></span></span><span> </span><span id="local-6989586621680031602"><span class="annot"><a href="#local-6989586621680031602"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span id="local-6989586621680031601"><span class="annot"><a href="#local-6989586621680031601"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680031604"><span class="annot"><a href="#local-6989586621680031604"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Tracers"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers"><span class="hs-identifier hs-var">Tracers</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-319"></span><span>      </span><span id="tChainSyncTracer"><span class="annot"><span class="annottext">Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tChainSyncTracer"><span class="hs-identifier hs-var hs-var">tChainSyncTracer</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680031604"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/src"><span class="hs-identifier hs-type">TraceLabelPeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031603"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">TraceSendRecv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">ChainSync</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Serialised</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031602"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031602"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Tip</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031602"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="tTxSubmissionTracer"><span class="annot"><span class="annottext">Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tTxSubmissionTracer"><span class="hs-identifier hs-var hs-var">tTxSubmissionTracer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680031604"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/src"><span class="hs-identifier hs-type">TraceLabelPeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031603"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">TraceSendRecv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">LocalTxSubmission</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTx"><span class="hs-identifier hs-type">GenTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031602"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#ApplyTxErr"><span class="hs-identifier hs-type">ApplyTxErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031602"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="tStateQueryTracer"><span class="annot"><span class="annottext">Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tStateQueryTracer"><span class="hs-identifier hs-var hs-var">tStateQueryTracer</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680031604"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/src"><span class="hs-identifier hs-type">TraceLabelPeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031603"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">TraceSendRecv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">LocalStateQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031602"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031602"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031602"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="tTxMonitorTracer"><span class="annot"><span class="annottext">Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tTxMonitorTracer"><span class="hs-identifier hs-var hs-var">tTxMonitorTracer</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680031604"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/src"><span class="hs-identifier hs-type">TraceLabelPeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031603"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">TraceSendRecv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">LocalTxMonitor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTxId"><span class="hs-identifier hs-type">GenTxId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031602"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTx"><span class="hs-identifier hs-type">GenTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031602"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span id="local-6989586621680031325"><span id="local-6989586621680031326"><span id="local-6989586621680031327"><span id="local-6989586621680031328"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680031320"><span id="local-6989586621680031322"><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680031606"><span class="annot"><a href="#local-6989586621680031606"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680031328"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers%27"><span class="hs-identifier hs-type">Tracers'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031327"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031326"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031325"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031328"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-326"></span><span>  </span><span id="local-6989586621680031318"><span class="annot"><span class="annottext">Tracers' peer blk e f
</span><a href="#local-6989586621680031318"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621680031317"><span class="annot"><span class="annottext">&lt;&gt; :: Tracers' peer blk e f
-&gt; Tracers' peer blk e f -&gt; Tracers' peer blk e f
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span id="local-6989586621680031316"><span class="annot"><span class="annottext">Tracers' peer blk e f
</span><a href="#local-6989586621680031316"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracers :: forall peer blk e (f :: * -&gt; *).
f (TraceLabelPeer
     peer
     (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
-&gt; f (TraceLabelPeer
        peer (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
-&gt; Tracers' peer blk e f
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers"><span class="hs-identifier hs-type">Tracers</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-327"></span><span>        </span><span class="annot"><span class="annottext">tChainSyncTracer :: f (TraceLabelPeer
     peer
     (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tChainSyncTracer"><span class="hs-identifier hs-var">tChainSyncTracer</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Tracers' peer blk e f
 -&gt; f (TraceLabelPeer
         peer
         (TraceSendRecv
            (ChainSync (Serialised blk) (Point blk) (Tip blk)))))
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
forall a. Semigroup a =&gt; (Tracers' peer blk e f -&gt; a) -&gt; a
</span><a href="#local-6989586621680031315"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
forall peer blk e (f :: * -&gt; *).
Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tChainSyncTracer"><span class="hs-identifier hs-var hs-var">tChainSyncTracer</span></a></span><span>
</span><span id="line-328"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tTxSubmissionTracer :: f (TraceLabelPeer
     peer
     (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tTxSubmissionTracer"><span class="hs-identifier hs-var">tTxSubmissionTracer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Tracers' peer blk e f
 -&gt; f (TraceLabelPeer
         peer
         (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)))))
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
forall a. Semigroup a =&gt; (Tracers' peer blk e f -&gt; a) -&gt; a
</span><a href="#local-6989586621680031315"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
forall peer blk e (f :: * -&gt; *).
Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tTxSubmissionTracer"><span class="hs-identifier hs-var hs-var">tTxSubmissionTracer</span></a></span><span>
</span><span id="line-329"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tStateQueryTracer :: f (TraceLabelPeer
     peer (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tStateQueryTracer"><span class="hs-identifier hs-var">tStateQueryTracer</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Tracers' peer blk e f
 -&gt; f (TraceLabelPeer
         peer
         (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk)))))
-&gt; f (TraceLabelPeer
        peer (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
forall a. Semigroup a =&gt; (Tracers' peer blk e f -&gt; a) -&gt; a
</span><a href="#local-6989586621680031315"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
forall peer blk e (f :: * -&gt; *).
Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tStateQueryTracer"><span class="hs-identifier hs-var hs-var">tStateQueryTracer</span></a></span><span>
</span><span id="line-330"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tTxMonitorTracer :: f (TraceLabelPeer
     peer
     (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tTxMonitorTracer"><span class="hs-identifier hs-var">tTxMonitorTracer</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Tracers' peer blk e f
 -&gt; f (TraceLabelPeer
         peer
         (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo))))
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
forall a. Semigroup a =&gt; (Tracers' peer blk e f -&gt; a) -&gt; a
</span><a href="#local-6989586621680031315"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
forall peer blk e (f :: * -&gt; *).
Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tTxMonitorTracer"><span class="hs-identifier hs-var hs-var">tTxMonitorTracer</span></a></span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>      </span><span class="annot"><a href="#local-6989586621680031315"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680031600"><span class="annot"><a href="#local-6989586621680031600"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031600"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-334"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers%27"><span class="hs-identifier hs-type">Tracers'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031327"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031326"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031325"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031328"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680031600"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680031600"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-336"></span><span>      </span><span id="local-6989586621680031315"><span class="annot"><span class="annottext">f :: (Tracers' peer blk e f -&gt; a) -&gt; a
</span><a href="#local-6989586621680031315"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680031314"><span class="annot"><span class="annottext">Tracers' peer blk e f -&gt; a
</span><a href="#local-6989586621680031314"><span class="hs-identifier hs-var">prj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracers' peer blk e f -&gt; a
</span><a href="#local-6989586621680031314"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">Tracers' peer blk e f
</span><a href="#local-6989586621680031318"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Tracers' peer blk e f -&gt; a
</span><a href="#local-6989586621680031314"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">Tracers' peer blk e f
</span><a href="#local-6989586621680031316"><span class="hs-identifier hs-var">r</span></a></span></span></span></span></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="hs-comment">-- | Use a 'nullTracer' for each protocol.</span><span>
</span><span id="line-339"></span><span id="local-6989586621680031310"><span id="local-6989586621680031311"><span id="local-6989586621680031312"><span id="local-6989586621680031313"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#nullTracers"><span class="hs-identifier hs-type">nullTracers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031313"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers"><span class="hs-identifier hs-type">Tracers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031313"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031312"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031311"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031310"><span class="hs-identifier hs-type">e</span></a></span></span></span></span></span><span>
</span><span id="line-340"></span><span id="nullTracers"><span class="annot"><span class="annottext">nullTracers :: Tracers m peer blk e
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#nullTracers"><span class="hs-identifier hs-var hs-var">nullTracers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracers :: forall peer blk e (f :: * -&gt; *).
f (TraceLabelPeer
     peer
     (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
-&gt; f (TraceLabelPeer
        peer (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
-&gt; Tracers' peer blk e f
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers"><span class="hs-identifier hs-type">Tracers</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-341"></span><span>      </span><span class="annot"><span class="annottext">tChainSyncTracer :: Tracer
  m
  (TraceLabelPeer
     peer
     (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tChainSyncTracer"><span class="hs-identifier hs-var">tChainSyncTracer</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracer
  m
  (TraceLabelPeer
     peer
     (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
forall (m :: * -&gt; *) a. Applicative m =&gt; Tracer m a
</span><span class="hs-identifier hs-var">nullTracer</span></span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tTxSubmissionTracer :: Tracer
  m
  (TraceLabelPeer
     peer
     (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tTxSubmissionTracer"><span class="hs-identifier hs-var">tTxSubmissionTracer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracer
  m
  (TraceLabelPeer
     peer
     (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
forall (m :: * -&gt; *) a. Applicative m =&gt; Tracer m a
</span><span class="hs-identifier hs-var">nullTracer</span></span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tStateQueryTracer :: Tracer
  m
  (TraceLabelPeer
     peer (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tStateQueryTracer"><span class="hs-identifier hs-var">tStateQueryTracer</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracer
  m
  (TraceLabelPeer
     peer (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
forall (m :: * -&gt; *) a. Applicative m =&gt; Tracer m a
</span><span class="hs-identifier hs-var">nullTracer</span></span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tTxMonitorTracer :: Tracer
  m
  (TraceLabelPeer
     peer
     (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tTxMonitorTracer"><span class="hs-identifier hs-var">tTxMonitorTracer</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracer
  m
  (TraceLabelPeer
     peer
     (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
forall (m :: * -&gt; *) a. Applicative m =&gt; Tracer m a
</span><span class="hs-identifier hs-var">nullTracer</span></span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span id="local-6989586621680031305"><span id="local-6989586621680031306"><span id="local-6989586621680031307"><span id="local-6989586621680031308"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#showTracers"><span class="hs-identifier hs-type">showTracers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031308"><span class="hs-identifier hs-type">peer</span></a></span><span>
</span><span id="line-348"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTx"><span class="hs-identifier hs-type">GenTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031307"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTxId"><span class="hs-identifier hs-type">GenTxId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031307"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#ApplyTxErr"><span class="hs-identifier hs-type">ApplyTxErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031307"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">ShowQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#BlockQuery"><span class="hs-identifier hs-type">BlockQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031307"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">HasHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031307"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-353"></span><span>               </span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tracer</span></span><span> </span><span class="annot"><a href="#local-6989586621680031306"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers"><span class="hs-identifier hs-type">Tracers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031306"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031308"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031307"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031305"><span class="hs-identifier hs-type">e</span></a></span></span></span></span></span><span>
</span><span id="line-355"></span><span id="showTracers"><span class="annot"><span class="annottext">showTracers :: Tracer m String -&gt; Tracers m peer blk e
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#showTracers"><span class="hs-identifier hs-var hs-var">showTracers</span></a></span></span><span> </span><span id="local-6989586621680031304"><span class="annot"><span class="annottext">Tracer m String
</span><a href="#local-6989586621680031304"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracers :: forall peer blk e (f :: * -&gt; *).
f (TraceLabelPeer
     peer
     (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
-&gt; f (TraceLabelPeer
        peer (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
-&gt; Tracers' peer blk e f
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers"><span class="hs-identifier hs-type">Tracers</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-356"></span><span>      </span><span class="annot"><span class="annottext">tChainSyncTracer :: Tracer
  m
  (TraceLabelPeer
     peer
     (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tChainSyncTracer"><span class="hs-identifier hs-var">tChainSyncTracer</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracer m String
-&gt; Tracer
     m
     (TraceLabelPeer
        peer
        (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
forall a (m :: * -&gt; *). Show a =&gt; Tracer m String -&gt; Tracer m a
</span><span class="hs-identifier hs-var">showTracing</span></span><span> </span><span class="annot"><span class="annottext">Tracer m String
</span><a href="#local-6989586621680031304"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tTxSubmissionTracer :: Tracer
  m
  (TraceLabelPeer
     peer
     (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tTxSubmissionTracer"><span class="hs-identifier hs-var">tTxSubmissionTracer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracer m String
-&gt; Tracer
     m
     (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
forall a (m :: * -&gt; *). Show a =&gt; Tracer m String -&gt; Tracer m a
</span><span class="hs-identifier hs-var">showTracing</span></span><span> </span><span class="annot"><span class="annottext">Tracer m String
</span><a href="#local-6989586621680031304"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tStateQueryTracer :: Tracer
  m
  (TraceLabelPeer
     peer (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tStateQueryTracer"><span class="hs-identifier hs-var">tStateQueryTracer</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracer m String
-&gt; Tracer
     m
     (TraceLabelPeer
        peer (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
forall a (m :: * -&gt; *). Show a =&gt; Tracer m String -&gt; Tracer m a
</span><span class="hs-identifier hs-var">showTracing</span></span><span> </span><span class="annot"><span class="annottext">Tracer m String
</span><a href="#local-6989586621680031304"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tTxMonitorTracer :: Tracer
  m
  (TraceLabelPeer
     peer
     (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#tTxMonitorTracer"><span class="hs-identifier hs-var">tTxMonitorTracer</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracer m String
-&gt; Tracer
     m
     (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
forall a (m :: * -&gt; *). Show a =&gt; Tracer m String -&gt; Tracer m a
</span><span class="hs-identifier hs-var">showTracing</span></span><span> </span><span class="annot"><span class="annottext">Tracer m String
</span><a href="#local-6989586621680031304"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Applications
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- | A node-to-client application</span><span>
</span><span id="line-367"></span><span class="hs-keyword">type</span><span> </span><span id="App"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#App"><span class="hs-identifier hs-var">App</span></a></span></span><span> </span><span id="local-6989586621680031302"><span class="annot"><a href="#local-6989586621680031302"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680031301"><span class="annot"><a href="#local-6989586621680031301"><span class="hs-identifier hs-type">peer</span></a></span></span><span> </span><span id="local-6989586621680031300"><span class="annot"><a href="#local-6989586621680031300"><span class="hs-identifier hs-type">bytes</span></a></span></span><span> </span><span id="local-6989586621680031299"><span class="annot"><a href="#local-6989586621680031299"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680031301"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">Channel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031302"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031300"><span class="hs-identifier hs-type">bytes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680031302"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680031299"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031300"><span class="hs-identifier hs-type">bytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="hs-comment">-- | Applications for the node-to-client (i.e., local) protocols</span><span>
</span><span id="line-370"></span><span class="hs-comment">--</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- See 'Network.Mux.Types.MuxApplication'</span><span>
</span><span id="line-372"></span><span class="hs-keyword">data</span><span> </span><span id="Apps"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Apps"><span class="hs-identifier hs-var">Apps</span></a></span></span><span> </span><span id="local-6989586621680031545"><span class="annot"><a href="#local-6989586621680031545"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680031544"><span class="annot"><a href="#local-6989586621680031544"><span class="hs-identifier hs-type">peer</span></a></span></span><span> </span><span id="local-6989586621680031543"><span class="annot"><a href="#local-6989586621680031543"><span class="hs-identifier hs-type">bCS</span></a></span></span><span> </span><span id="local-6989586621680031541"><span class="annot"><a href="#local-6989586621680031541"><span class="hs-identifier hs-type">bTX</span></a></span></span><span> </span><span id="local-6989586621680031540"><span class="annot"><a href="#local-6989586621680031540"><span class="hs-identifier hs-type">bSQ</span></a></span></span><span> </span><span id="local-6989586621680031539"><span class="annot"><a href="#local-6989586621680031539"><span class="hs-identifier hs-type">bTM</span></a></span></span><span> </span><span id="local-6989586621680031542"><span class="annot"><a href="#local-6989586621680031542"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Apps"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Apps"><span class="hs-identifier hs-var">Apps</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-373"></span><span>      </span><span class="hs-comment">-- | Start a local chain sync server.</span><span>
</span><span id="line-374"></span><span>      </span><span id="aChainSyncServer"><span class="annot"><span class="annottext">Apps m peer bCS bTX bSQ bTM a -&gt; App m peer bCS a
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#aChainSyncServer"><span class="hs-identifier hs-var hs-var">aChainSyncServer</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031545"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031544"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031543"><span class="hs-identifier hs-type">bCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031542"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span>      </span><span class="hs-comment">-- | Start a local transaction submission server.</span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="aTxSubmissionServer"><span class="annot"><span class="annottext">Apps m peer bCS bTX bSQ bTM a -&gt; App m peer bTX a
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#aTxSubmissionServer"><span class="hs-identifier hs-var hs-var">aTxSubmissionServer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031545"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031544"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031541"><span class="hs-identifier hs-type">bTX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031542"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span>      </span><span class="hs-comment">-- | Start a local state query server.</span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="aStateQueryServer"><span class="annot"><span class="annottext">Apps m peer bCS bTX bSQ bTM a -&gt; App m peer bSQ a
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#aStateQueryServer"><span class="hs-identifier hs-var hs-var">aStateQueryServer</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031545"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031544"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031540"><span class="hs-identifier hs-type">bSQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031542"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span>      </span><span class="hs-comment">-- | Start a local transaction monitor server</span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="aTxMonitorServer"><span class="annot"><span class="annottext">Apps m peer bCS bTX bSQ bTM a -&gt; App m peer bTM a
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#aTxMonitorServer"><span class="hs-identifier hs-var hs-var">aTxMonitorServer</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031545"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031544"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031539"><span class="hs-identifier hs-type">bTM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031542"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | Construct the 'NetworkApplication' for the node-to-client protocols</span><span>
</span><span id="line-387"></span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#mkApps"><span class="hs-identifier hs-type">mkApps</span></a></span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680031293"><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680031292"><span class="annot"><a href="#local-6989586621680031292"><span class="hs-identifier hs-type">remotePeer</span></a></span></span><span> </span><span id="local-6989586621680031291"><span class="annot"><a href="#local-6989586621680031291"><span class="hs-identifier hs-type">localPeer</span></a></span></span><span> </span><span id="local-6989586621680031290"><span class="annot"><a href="#local-6989586621680031290"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span id="local-6989586621680031289"><span class="annot"><a href="#local-6989586621680031289"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680031288"><span class="annot"><a href="#local-6989586621680031288"><span class="hs-identifier hs-type">bCS</span></a></span></span><span> </span><span id="local-6989586621680031287"><span class="annot"><a href="#local-6989586621680031287"><span class="hs-identifier hs-type">bTX</span></a></span></span><span> </span><span id="local-6989586621680031286"><span class="annot"><a href="#local-6989586621680031286"><span class="hs-identifier hs-type">bSQ</span></a></span></span><span> </span><span id="local-6989586621680031285"><span class="annot"><a href="#local-6989586621680031285"><span class="hs-identifier hs-type">bTM</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-389"></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.IOLike.html#IOLike"><span class="hs-identifier hs-type">IOLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-390"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Exception</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031289"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-391"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ShowProxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031290"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-392"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ShowProxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#ApplyTxErr"><span class="hs-identifier hs-type">ApplyTxErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031290"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ShowProxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#BlockQuery"><span class="hs-identifier hs-type">BlockQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031290"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ShowProxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTx"><span class="hs-identifier hs-type">GenTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031290"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ShowProxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.SupportsMempool.html#GenTxId"><span class="hs-identifier hs-type">GenTxId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031290"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">ShowQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Query.html#BlockQuery"><span class="hs-identifier hs-type">BlockQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031290"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernel"><span class="hs-identifier hs-type">NodeKernel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031292"><span class="hs-identifier hs-type">remotePeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031291"><span class="hs-identifier hs-type">localPeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031290"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers"><span class="hs-identifier hs-type">Tracers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031291"><span class="hs-identifier hs-type">localPeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031290"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031289"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs"><span class="hs-identifier hs-type">Codecs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031290"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031289"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031288"><span class="hs-identifier hs-type">bCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031287"><span class="hs-identifier hs-type">bTX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031286"><span class="hs-identifier hs-type">bSQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031285"><span class="hs-identifier hs-type">bTM</span></a></span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Handlers"><span class="hs-identifier hs-type">Handlers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031291"><span class="hs-identifier hs-type">localPeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031290"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Apps"><span class="hs-identifier hs-type">Apps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031291"><span class="hs-identifier hs-type">localPeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031288"><span class="hs-identifier hs-type">bCS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031287"><span class="hs-identifier hs-type">bTX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031286"><span class="hs-identifier hs-type">bSQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031285"><span class="hs-identifier hs-type">bTM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span id="mkApps"><span class="annot"><span class="annottext">mkApps :: NodeKernel m remotePeer localPeer blk
-&gt; Tracers m localPeer blk e
-&gt; Codecs blk e m bCS bTX bSQ bTM
-&gt; Handlers m localPeer blk
-&gt; Apps m localPeer bCS bTX bSQ bTM ()
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#mkApps"><span class="hs-identifier hs-var hs-var">mkApps</span></a></span></span><span> </span><span id="local-6989586621680031283"><span class="annot"><span class="annottext">NodeKernel m remotePeer localPeer blk
</span><a href="#local-6989586621680031283"><span class="hs-identifier hs-var">kernel</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers"><span class="hs-identifier hs-type">Tracers</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680031279"><span id="local-6989586621680031280"><span id="local-6989586621680031281"><span id="local-6989586621680031282"><span class="annot"><span class="annottext">Tracer
  m
  (TraceLabelPeer
     localPeer
     (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
Tracer
  m
  (TraceLabelPeer
     localPeer
     (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
Tracer
  m
  (TraceLabelPeer
     localPeer
     (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
Tracer
  m
  (TraceLabelPeer
     localPeer
     (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
tTxMonitorTracer :: Tracer
  m
  (TraceLabelPeer
     localPeer
     (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
tStateQueryTracer :: Tracer
  m
  (TraceLabelPeer
     localPeer
     (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
tTxSubmissionTracer :: Tracer
  m
  (TraceLabelPeer
     localPeer
     (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
tChainSyncTracer :: Tracer
  m
  (TraceLabelPeer
     localPeer
     (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
tTxMonitorTracer :: forall peer blk e (f :: * -&gt; *).
Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
tStateQueryTracer :: forall peer blk e (f :: * -&gt; *).
Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
tTxSubmissionTracer :: forall peer blk e (f :: * -&gt; *).
Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
tChainSyncTracer :: forall peer blk e (f :: * -&gt; *).
Tracers' peer blk e f
-&gt; f (TraceLabelPeer
        peer
        (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
</span><a href="#local-6989586621680031279"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Codecs"><span class="hs-identifier hs-type">Codecs</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680031275"><span id="local-6989586621680031276"><span id="local-6989586621680031277"><span id="local-6989586621680031278"><span class="annot"><span class="annottext">Codec (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)) e m bTX
Codec (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo) e m bTM
Codec (LocalStateQuery blk (Point blk) (Query blk)) e m bSQ
Codec (ChainSync (Serialised blk) (Point blk) (Tip blk)) e m bCS
cTxMonitorCodec :: Codec (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo) e m bTM
cStateQueryCodec :: Codec (LocalStateQuery blk (Point blk) (Query blk)) e m bSQ
cTxSubmissionCodec :: Codec (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)) e m bTX
cChainSyncCodec :: Codec (ChainSync (Serialised blk) (Point blk) (Tip blk)) e m bCS
cTxMonitorCodec :: forall blk serialisedBlk e (m :: * -&gt; *) bCS bTX bSQ bTM.
Codecs' blk serialisedBlk e m bCS bTX bSQ bTM
-&gt; Codec (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo) e m bTM
cStateQueryCodec :: forall blk serialisedBlk e (m :: * -&gt; *) bCS bTX bSQ bTM.
Codecs' blk serialisedBlk e m bCS bTX bSQ bTM
-&gt; Codec (LocalStateQuery blk (Point blk) (Query blk)) e m bSQ
cTxSubmissionCodec :: forall blk serialisedBlk e (m :: * -&gt; *) bCS bTX bSQ bTM.
Codecs' blk serialisedBlk e m bCS bTX bSQ bTM
-&gt; Codec (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)) e m bTX
cChainSyncCodec :: forall blk serialisedBlk e (m :: * -&gt; *) bCS bTX bSQ bTM.
Codecs' blk serialisedBlk e m bCS bTX bSQ bTM
-&gt; Codec (ChainSync serialisedBlk (Point blk) (Tip blk)) e m bCS
</span><a href="#local-6989586621680031275"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Handlers"><span class="hs-identifier hs-type">Handlers</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680031271"><span id="local-6989586621680031272"><span id="local-6989586621680031273"><span id="local-6989586621680031274"><span class="annot"><span class="annottext">LocalTxSubmissionServer (GenTx blk) (ApplyTxErr blk) m ()
LocalTxMonitorServer (GenTxId blk) (GenTx blk) SlotNo m ()
LocalStateQueryServer blk (Point blk) (Query blk) m ()
Follower m blk (WithPoint blk (Serialised blk))
-&gt; ChainSyncServer (Serialised blk) (Point blk) (Tip blk) m ()
hTxMonitorServer :: LocalTxMonitorServer (GenTxId blk) (GenTx blk) SlotNo m ()
hStateQueryServer :: LocalStateQueryServer blk (Point blk) (Query blk) m ()
hTxSubmissionServer :: LocalTxSubmissionServer (GenTx blk) (ApplyTxErr blk) m ()
hChainSyncServer :: Follower m blk (WithPoint blk (Serialised blk))
-&gt; ChainSyncServer (Serialised blk) (Point blk) (Tip blk) m ()
hTxMonitorServer :: forall (m :: * -&gt; *) peer blk.
Handlers m peer blk
-&gt; LocalTxMonitorServer (GenTxId blk) (GenTx blk) SlotNo m ()
hStateQueryServer :: forall (m :: * -&gt; *) peer blk.
Handlers m peer blk
-&gt; LocalStateQueryServer blk (Point blk) (Query blk) m ()
hTxSubmissionServer :: forall (m :: * -&gt; *) peer blk.
Handlers m peer blk
-&gt; LocalTxSubmissionServer (GenTx blk) (ApplyTxErr blk) m ()
hChainSyncServer :: forall (m :: * -&gt; *) peer blk.
Handlers m peer blk
-&gt; Follower m blk (WithPoint blk (Serialised blk))
-&gt; ChainSyncServer (Serialised blk) (Point blk) (Tip blk) m ()
</span><a href="#local-6989586621680031271"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-404"></span><span>    </span><span class="annot"><span class="annottext">Apps :: forall (m :: * -&gt; *) peer bCS bTX bSQ bTM a.
App m peer bCS a
-&gt; App m peer bTX a
-&gt; App m peer bSQ a
-&gt; App m peer bTM a
-&gt; Apps m peer bCS bTX bSQ bTM a
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#Apps"><span class="hs-identifier hs-type">Apps</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">localPeer -&gt; Channel m bCS -&gt; m ((), Maybe bCS)
localPeer -&gt; Channel m bTX -&gt; m ((), Maybe bTX)
localPeer -&gt; Channel m bSQ -&gt; m ((), Maybe bSQ)
localPeer -&gt; Channel m bTM -&gt; m ((), Maybe bTM)
aTxMonitorServer :: localPeer -&gt; Channel m bTM -&gt; m ((), Maybe bTM)
aStateQueryServer :: localPeer -&gt; Channel m bSQ -&gt; m ((), Maybe bSQ)
aTxSubmissionServer :: localPeer -&gt; Channel m bTX -&gt; m ((), Maybe bTX)
aChainSyncServer :: localPeer -&gt; Channel m bCS -&gt; m ((), Maybe bCS)
aTxMonitorServer :: localPeer -&gt; Channel m bTM -&gt; m ((), Maybe bTM)
aStateQueryServer :: localPeer -&gt; Channel m bSQ -&gt; m ((), Maybe bSQ)
aTxSubmissionServer :: localPeer -&gt; Channel m bTX -&gt; m ((), Maybe bTX)
aChainSyncServer :: localPeer -&gt; Channel m bCS -&gt; m ((), Maybe bCS)
</span><a href="#local-6989586621680031267"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-406"></span><span>    </span><span class="annot"><a href="#local-6989586621680031270"><span class="hs-identifier hs-type">aChainSyncServer</span></a></span><span>
</span><span id="line-407"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680031291"><span class="hs-identifier hs-type">localPeer</span></a></span><span>
</span><span id="line-408"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">Channel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031288"><span class="hs-identifier hs-type">bCS</span></a></span><span>
</span><span id="line-409"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031288"><span class="hs-identifier hs-type">bCS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>    </span><span id="local-6989586621680031270"><span class="annot"><span class="annottext">aChainSyncServer :: localPeer -&gt; Channel m bCS -&gt; m ((), Maybe bCS)
</span><a href="#local-6989586621680031270"><span class="hs-identifier hs-var hs-var">aChainSyncServer</span></a></span></span><span> </span><span id="local-6989586621680031266"><span class="annot"><span class="annottext">localPeer
</span><a href="#local-6989586621680031266"><span class="hs-identifier hs-var">them</span></a></span></span><span> </span><span id="local-6989586621680031265"><span class="annot"><span class="annottext">Channel m bCS
</span><a href="#local-6989586621680031265"><span class="hs-identifier hs-var">channel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-411"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). MonadThread m =&gt; String -&gt; m ()
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/src"><span class="hs-identifier hs-var">labelThisThread</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LocalChainSyncServer&quot;</span></span><span>
</span><span id="line-412"></span><span>      </span><span class="annot"><span class="annottext">(ResourceRegistry m
 -&gt; m (Follower m blk (WithPoint blk (Serialised blk))))
-&gt; (Follower m blk (WithPoint blk (Serialised blk)) -&gt; m ())
-&gt; (Follower m blk (WithPoint blk (Serialised blk))
    -&gt; m ((), Maybe bCS))
-&gt; m ((), Maybe bCS)
forall (m :: * -&gt; *) a r.
(IOLike m, HasCallStack) =&gt;
(ResourceRegistry m -&gt; m a) -&gt; (a -&gt; m ()) -&gt; (a -&gt; m r) -&gt; m r
</span><a href="Ouroboros.Consensus.Util.ResourceRegistry.html#bracketWithPrivateRegistry"><span class="hs-identifier hs-var">bracketWithPrivateRegistry</span></a></span><span>
</span><span id="line-413"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainDB m blk
-&gt; ResourceRegistry m
-&gt; m (Follower m blk (WithPoint blk (Serialised blk)))
forall (m :: * -&gt; *) blk.
ChainDB m blk
-&gt; ResourceRegistry m
-&gt; m (Follower m blk (WithPoint blk (Serialised blk)))
</span><a href="Ouroboros.Consensus.MiniProtocol.ChainSync.Server.html#chainSyncBlockServerFollower"><span class="hs-identifier hs-var">chainSyncBlockServerFollower</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeKernel m remotePeer localPeer blk -&gt; ChainDB m blk
forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernel m remotePeer localPeer blk -&gt; ChainDB m blk
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AgetChainDB%3ANodeKernel"><span class="hs-identifier hs-var hs-var">getChainDB</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernel m remotePeer localPeer blk
</span><a href="#local-6989586621680031283"><span class="hs-identifier hs-var">kernel</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>        </span><span class="annot"><span class="annottext">Follower m blk (WithPoint blk (Serialised blk)) -&gt; m ()
forall (m :: * -&gt; *) blk a. Follower m blk a -&gt; m ()
</span><a href="Ouroboros.Consensus.Storage.ChainDB.API.html#followerClose"><span class="hs-identifier hs-var hs-var">ChainDB.followerClose</span></a></span><span>
</span><span id="line-415"></span><span>        </span><span class="annot"><span class="annottext">((Follower m blk (WithPoint blk (Serialised blk))
  -&gt; m ((), Maybe bCS))
 -&gt; m ((), Maybe bCS))
-&gt; (Follower m blk (WithPoint blk (Serialised blk))
    -&gt; m ((), Maybe bCS))
-&gt; m ((), Maybe bCS)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680031260"><span class="annot"><span class="annottext">Follower m blk (WithPoint blk (Serialised blk))
</span><a href="#local-6989586621680031260"><span class="hs-identifier hs-var">flr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-416"></span><span>          </span><span class="annot"><span class="annottext">Tracer
  m
  (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk)))
-&gt; Codec (ChainSync (Serialised blk) (Point blk) (Tip blk)) e m bCS
-&gt; Channel m bCS
-&gt; Peer
     (ChainSync (Serialised blk) (Point blk) (Tip blk))
     'AsServer
     'StIdle
     m
     ()
-&gt; m ((), Maybe bCS)
forall ps (st :: ps) (pr :: PeerRole) failure bytes (m :: * -&gt; *)
       a.
(MonadThrow m, Show failure,
 forall (st' :: ps). Show (ClientHasAgency st'),
 forall (st' :: ps). Show (ServerHasAgency st'), ShowProxy ps) =&gt;
Tracer m (TraceSendRecv ps)
-&gt; Codec ps failure m bytes
-&gt; Channel m bytes
-&gt; Peer ps pr st m a
-&gt; m (a, Maybe bytes)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">runPeer</span></a></span><span>
</span><span id="line-417"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))
 -&gt; TraceLabelPeer
      localPeer
      (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
-&gt; Tracer
     m
     (TraceLabelPeer
        localPeer
        (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
-&gt; Tracer
     m
     (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk)))
forall (f :: * -&gt; *) a b. Contravariant f =&gt; (a -&gt; b) -&gt; f b -&gt; f a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">contramap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">localPeer
-&gt; TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))
-&gt; TraceLabelPeer
     localPeer
     (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk)))
forall peerid a. peerid -&gt; a -&gt; TraceLabelPeer peerid a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/src"><span class="hs-identifier hs-var">TraceLabelPeer</span></a></span><span> </span><span class="annot"><span class="annottext">localPeer
</span><a href="#local-6989586621680031266"><span class="hs-identifier hs-var">them</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tracer
  m
  (TraceLabelPeer
     localPeer
     (TraceSendRecv (ChainSync (Serialised blk) (Point blk) (Tip blk))))
</span><a href="#local-6989586621680031282"><span class="hs-identifier hs-var">tChainSyncTracer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>            </span><span class="annot"><span class="annottext">Codec (ChainSync (Serialised blk) (Point blk) (Tip blk)) e m bCS
</span><a href="#local-6989586621680031278"><span class="hs-identifier hs-var">cChainSyncCodec</span></a></span><span>
</span><span id="line-419"></span><span>            </span><span class="annot"><span class="annottext">Channel m bCS
</span><a href="#local-6989586621680031265"><span class="hs-identifier hs-var">channel</span></a></span><span>
</span><span id="line-420"></span><span>            </span><span class="annot"><span class="annottext">(Peer
   (ChainSync (Serialised blk) (Point blk) (Tip blk))
   'AsServer
   'StIdle
   m
   ()
 -&gt; m ((), Maybe bCS))
-&gt; Peer
     (ChainSync (Serialised blk) (Point blk) (Tip blk))
     'AsServer
     'StIdle
     m
     ()
-&gt; m ((), Maybe bCS)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ChainSyncServer (Serialised blk) (Point blk) (Tip blk) m ()
-&gt; Peer
     (ChainSync (Serialised blk) (Point blk) (Tip blk))
     'AsServer
     'StIdle
     m
     ()
forall header point tip (m :: * -&gt; *) a.
Monad m =&gt;
ChainSyncServer header point tip m a
-&gt; Peer (ChainSync header point tip) 'AsServer 'StIdle m a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">chainSyncServerPeer</span></a></span><span>
</span><span id="line-421"></span><span>            </span><span class="annot"><span class="annottext">(ChainSyncServer (Serialised blk) (Point blk) (Tip blk) m ()
 -&gt; Peer
      (ChainSync (Serialised blk) (Point blk) (Tip blk))
      'AsServer
      'StIdle
      m
      ())
-&gt; ChainSyncServer (Serialised blk) (Point blk) (Tip blk) m ()
-&gt; Peer
     (ChainSync (Serialised blk) (Point blk) (Tip blk))
     'AsServer
     'StIdle
     m
     ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Follower m blk (WithPoint blk (Serialised blk))
-&gt; ChainSyncServer (Serialised blk) (Point blk) (Tip blk) m ()
</span><a href="#local-6989586621680031274"><span class="hs-identifier hs-var">hChainSyncServer</span></a></span><span> </span><span class="annot"><span class="annottext">Follower m blk (WithPoint blk (Serialised blk))
</span><a href="#local-6989586621680031260"><span class="hs-identifier hs-var">flr</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><a href="#local-6989586621680031269"><span class="hs-identifier hs-type">aTxSubmissionServer</span></a></span><span>
</span><span id="line-424"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680031291"><span class="hs-identifier hs-type">localPeer</span></a></span><span>
</span><span id="line-425"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">Channel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031287"><span class="hs-identifier hs-type">bTX</span></a></span><span>
</span><span id="line-426"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031287"><span class="hs-identifier hs-type">bTX</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>    </span><span id="local-6989586621680031269"><span class="annot"><span class="annottext">aTxSubmissionServer :: localPeer -&gt; Channel m bTX -&gt; m ((), Maybe bTX)
</span><a href="#local-6989586621680031269"><span class="hs-identifier hs-var hs-var">aTxSubmissionServer</span></a></span></span><span> </span><span id="local-6989586621680031255"><span class="annot"><span class="annottext">localPeer
</span><a href="#local-6989586621680031255"><span class="hs-identifier hs-var">them</span></a></span></span><span> </span><span id="local-6989586621680031254"><span class="annot"><span class="annottext">Channel m bTX
</span><a href="#local-6989586621680031254"><span class="hs-identifier hs-var">channel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-428"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). MonadThread m =&gt; String -&gt; m ()
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/src"><span class="hs-identifier hs-var">labelThisThread</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LocalTxSubmissionServer&quot;</span></span><span>
</span><span id="line-429"></span><span>      </span><span class="annot"><span class="annottext">Tracer
  m (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)))
-&gt; Codec (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)) e m bTX
-&gt; Channel m bTX
-&gt; Peer
     (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))
     'AsServer
     'StIdle
     m
     ()
-&gt; m ((), Maybe bTX)
forall ps (st :: ps) (pr :: PeerRole) failure bytes (m :: * -&gt; *)
       a.
(MonadThrow m, Show failure,
 forall (st' :: ps). Show (ClientHasAgency st'),
 forall (st' :: ps). Show (ServerHasAgency st'), ShowProxy ps) =&gt;
Tracer m (TraceSendRecv ps)
-&gt; Codec ps failure m bytes
-&gt; Channel m bytes
-&gt; Peer ps pr st m a
-&gt; m (a, Maybe bytes)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">runPeer</span></a></span><span>
</span><span id="line-430"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))
 -&gt; TraceLabelPeer
      localPeer
      (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
-&gt; Tracer
     m
     (TraceLabelPeer
        localPeer
        (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
-&gt; Tracer
     m (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)))
forall (f :: * -&gt; *) a b. Contravariant f =&gt; (a -&gt; b) -&gt; f b -&gt; f a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">contramap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">localPeer
-&gt; TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))
-&gt; TraceLabelPeer
     localPeer
     (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)))
forall peerid a. peerid -&gt; a -&gt; TraceLabelPeer peerid a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/src"><span class="hs-identifier hs-var">TraceLabelPeer</span></a></span><span> </span><span class="annot"><span class="annottext">localPeer
</span><a href="#local-6989586621680031255"><span class="hs-identifier hs-var">them</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tracer
  m
  (TraceLabelPeer
     localPeer
     (TraceSendRecv (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))))
</span><a href="#local-6989586621680031281"><span class="hs-identifier hs-var">tTxSubmissionTracer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>        </span><span class="annot"><span class="annottext">Codec (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)) e m bTX
</span><a href="#local-6989586621680031277"><span class="hs-identifier hs-var">cTxSubmissionCodec</span></a></span><span>
</span><span id="line-432"></span><span>        </span><span class="annot"><span class="annottext">Channel m bTX
</span><a href="#local-6989586621680031254"><span class="hs-identifier hs-var">channel</span></a></span><span>
</span><span id="line-433"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m (LocalTxSubmissionServer (GenTx blk) (ApplyTxErr blk) m ())
-&gt; Peer
     (LocalTxSubmission (GenTx blk) (ApplyTxErr blk))
     'AsServer
     'StIdle
     m
     ()
forall tx reject (m :: * -&gt; *) a.
Monad m =&gt;
m (LocalTxSubmissionServer tx reject m a)
-&gt; Peer (LocalTxSubmission tx reject) 'AsServer 'StIdle m a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">localTxSubmissionServerPeer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalTxSubmissionServer (GenTx blk) (ApplyTxErr blk) m ()
-&gt; m (LocalTxSubmissionServer (GenTx blk) (ApplyTxErr blk) m ())
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">LocalTxSubmissionServer (GenTx blk) (ApplyTxErr blk) m ()
</span><a href="#local-6989586621680031273"><span class="hs-identifier hs-var">hTxSubmissionServer</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><a href="#local-6989586621680031268"><span class="hs-identifier hs-type">aStateQueryServer</span></a></span><span>
</span><span id="line-436"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680031291"><span class="hs-identifier hs-type">localPeer</span></a></span><span>
</span><span id="line-437"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">Channel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031286"><span class="hs-identifier hs-type">bSQ</span></a></span><span>
</span><span id="line-438"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031286"><span class="hs-identifier hs-type">bSQ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>    </span><span id="local-6989586621680031268"><span class="annot"><span class="annottext">aStateQueryServer :: localPeer -&gt; Channel m bSQ -&gt; m ((), Maybe bSQ)
</span><a href="#local-6989586621680031268"><span class="hs-identifier hs-var hs-var">aStateQueryServer</span></a></span></span><span> </span><span id="local-6989586621680031252"><span class="annot"><span class="annottext">localPeer
</span><a href="#local-6989586621680031252"><span class="hs-identifier hs-var">them</span></a></span></span><span> </span><span id="local-6989586621680031251"><span class="annot"><span class="annottext">Channel m bSQ
</span><a href="#local-6989586621680031251"><span class="hs-identifier hs-var">channel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-440"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). MonadThread m =&gt; String -&gt; m ()
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/src"><span class="hs-identifier hs-var">labelThisThread</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LocalStateQueryServer&quot;</span></span><span>
</span><span id="line-441"></span><span>      </span><span class="annot"><span class="annottext">Tracer
  m (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk)))
-&gt; Codec (LocalStateQuery blk (Point blk) (Query blk)) e m bSQ
-&gt; Channel m bSQ
-&gt; Peer
     (LocalStateQuery blk (Point blk) (Query blk))
     'AsServer
     'StIdle
     m
     ()
-&gt; m ((), Maybe bSQ)
forall ps (st :: ps) (pr :: PeerRole) failure bytes (m :: * -&gt; *)
       a.
(MonadThrow m, Show failure,
 forall (st' :: ps). Show (ClientHasAgency st'),
 forall (st' :: ps). Show (ServerHasAgency st'), ShowProxy ps) =&gt;
Tracer m (TraceSendRecv ps)
-&gt; Codec ps failure m bytes
-&gt; Channel m bytes
-&gt; Peer ps pr st m a
-&gt; m (a, Maybe bytes)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">runPeer</span></a></span><span>
</span><span id="line-442"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))
 -&gt; TraceLabelPeer
      localPeer
      (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
-&gt; Tracer
     m
     (TraceLabelPeer
        localPeer
        (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
-&gt; Tracer
     m (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk)))
forall (f :: * -&gt; *) a b. Contravariant f =&gt; (a -&gt; b) -&gt; f b -&gt; f a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">contramap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">localPeer
-&gt; TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))
-&gt; TraceLabelPeer
     localPeer
     (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk)))
forall peerid a. peerid -&gt; a -&gt; TraceLabelPeer peerid a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/src"><span class="hs-identifier hs-var">TraceLabelPeer</span></a></span><span> </span><span class="annot"><span class="annottext">localPeer
</span><a href="#local-6989586621680031252"><span class="hs-identifier hs-var">them</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tracer
  m
  (TraceLabelPeer
     localPeer
     (TraceSendRecv (LocalStateQuery blk (Point blk) (Query blk))))
</span><a href="#local-6989586621680031280"><span class="hs-identifier hs-var">tStateQueryTracer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>        </span><span class="annot"><span class="annottext">Codec (LocalStateQuery blk (Point blk) (Query blk)) e m bSQ
</span><a href="#local-6989586621680031276"><span class="hs-identifier hs-var">cStateQueryCodec</span></a></span><span>
</span><span id="line-444"></span><span>        </span><span class="annot"><span class="annottext">Channel m bSQ
</span><a href="#local-6989586621680031251"><span class="hs-identifier hs-var">channel</span></a></span><span>
</span><span id="line-445"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalStateQueryServer blk (Point blk) (Query blk) m ()
-&gt; Peer
     (LocalStateQuery blk (Point blk) (Query blk))
     'AsServer
     'StIdle
     m
     ()
forall block point (query :: * -&gt; *) (m :: * -&gt; *) a.
Monad m =&gt;
LocalStateQueryServer block point query m a
-&gt; Peer (LocalStateQuery block point query) 'AsServer 'StIdle m a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">localStateQueryServerPeer</span></a></span><span> </span><span class="annot"><span class="annottext">LocalStateQueryServer blk (Point blk) (Query blk) m ()
</span><a href="#local-6989586621680031272"><span class="hs-identifier hs-var">hStateQueryServer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><a href="#local-6989586621680031267"><span class="hs-identifier hs-type">aTxMonitorServer</span></a></span><span>
</span><span id="line-448"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680031291"><span class="hs-identifier hs-type">localPeer</span></a></span><span>
</span><span id="line-449"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">Channel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031285"><span class="hs-identifier hs-type">bTM</span></a></span><span>
</span><span id="line-450"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680031293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031285"><span class="hs-identifier hs-type">bTM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>    </span><span id="local-6989586621680031267"><span class="annot"><span class="annottext">aTxMonitorServer :: localPeer -&gt; Channel m bTM -&gt; m ((), Maybe bTM)
</span><a href="#local-6989586621680031267"><span class="hs-identifier hs-var hs-var">aTxMonitorServer</span></a></span></span><span> </span><span id="local-6989586621680031249"><span class="annot"><span class="annottext">localPeer
</span><a href="#local-6989586621680031249"><span class="hs-identifier hs-var">them</span></a></span></span><span> </span><span id="local-6989586621680031248"><span class="annot"><span class="annottext">Channel m bTM
</span><a href="#local-6989586621680031248"><span class="hs-identifier hs-var">channel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-452"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *). MonadThread m =&gt; String -&gt; m ()
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/src"><span class="hs-identifier hs-var">labelThisThread</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LocalTxMonitorServer&quot;</span></span><span>
</span><span id="line-453"></span><span>      </span><span class="annot"><span class="annottext">Tracer
  m (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo))
-&gt; Codec (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo) e m bTM
-&gt; Channel m bTM
-&gt; Peer
     (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)
     'AsServer
     'StIdle
     m
     ()
-&gt; m ((), Maybe bTM)
forall ps (st :: ps) (pr :: PeerRole) failure bytes (m :: * -&gt; *)
       a.
(MonadThrow m, Show failure,
 forall (st' :: ps). Show (ClientHasAgency st'),
 forall (st' :: ps). Show (ServerHasAgency st'), ShowProxy ps) =&gt;
Tracer m (TraceSendRecv ps)
-&gt; Codec ps failure m bytes
-&gt; Channel m bytes
-&gt; Peer ps pr st m a
-&gt; m (a, Maybe bytes)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">runPeer</span></a></span><span>
</span><span id="line-454"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)
 -&gt; TraceLabelPeer
      localPeer
      (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
-&gt; Tracer
     m
     (TraceLabelPeer
        localPeer
        (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
-&gt; Tracer
     m (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo))
forall (f :: * -&gt; *) a b. Contravariant f =&gt; (a -&gt; b) -&gt; f b -&gt; f a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">contramap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">localPeer
-&gt; TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)
-&gt; TraceLabelPeer
     localPeer
     (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo))
forall peerid a. peerid -&gt; a -&gt; TraceLabelPeer peerid a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/src"><span class="hs-identifier hs-var">TraceLabelPeer</span></a></span><span> </span><span class="annot"><span class="annottext">localPeer
</span><a href="#local-6989586621680031249"><span class="hs-identifier hs-var">them</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tracer
  m
  (TraceLabelPeer
     localPeer
     (TraceSendRecv (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)))
</span><a href="#local-6989586621680031279"><span class="hs-identifier hs-var">tTxMonitorTracer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>        </span><span class="annot"><span class="annottext">Codec (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo) e m bTM
</span><a href="#local-6989586621680031275"><span class="hs-identifier hs-var">cTxMonitorCodec</span></a></span><span>
</span><span id="line-456"></span><span>        </span><span class="annot"><span class="annottext">Channel m bTM
</span><a href="#local-6989586621680031248"><span class="hs-identifier hs-var">channel</span></a></span><span>
</span><span id="line-457"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalTxMonitorServer (GenTxId blk) (GenTx blk) SlotNo m ()
-&gt; Peer
     (LocalTxMonitor (GenTxId blk) (GenTx blk) SlotNo)
     'AsServer
     'StIdle
     m
     ()
forall txid tx slot (m :: * -&gt; *) a.
Monad m =&gt;
LocalTxMonitorServer txid tx slot m a
-&gt; Peer (LocalTxMonitor txid tx slot) 'AsServer 'StIdle m a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">localTxMonitorServerPeer</span></a></span><span> </span><span class="annot"><span class="annottext">LocalTxMonitorServer (GenTxId blk) (GenTx blk) SlotNo m ()
</span><a href="#local-6989586621680031271"><span class="hs-identifier hs-var">hTxMonitorServer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Projections from 'Apps'
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-comment">-- | A projection from 'NetworkApplication' to a server-side</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- 'OuroborosApplication' for the node-to-client protocols.</span><span>
</span><span id="line-465"></span><span id="local-6989586621680031243"><span id="local-6989586621680031244"><span id="local-6989586621680031245"><span id="local-6989586621680031246"><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#responder"><span class="hs-identifier hs-type">responder</span></a></span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">N.NodeToClientVersion</span></a></span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Apps"><span class="hs-identifier hs-type">Apps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031246"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031245"><span class="hs-identifier hs-type">peer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680031244"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031244"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031244"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031244"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031243"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">OuroborosApplication</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/src"><span class="hs-identifier hs-type">ResponderMode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031245"><span class="hs-identifier hs-type">peer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031244"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031246"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Void</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680031243"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-469"></span><span id="responder"><span class="annot"><span class="annottext">responder :: NodeToClientVersion
-&gt; Apps m (ConnectionId peer) b b b b a
-&gt; OuroborosApplication 'ResponderMode peer b m Void a
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#responder"><span class="hs-identifier hs-var hs-var">responder</span></a></span></span><span> </span><span id="local-6989586621680031242"><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680031242"><span class="hs-identifier hs-var">version</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Apps"><span class="hs-identifier hs-type">Apps</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680031238"><span id="local-6989586621680031239"><span id="local-6989586621680031240"><span id="local-6989586621680031241"><span class="annot"><span class="annottext">App m (ConnectionId peer) b a
aTxMonitorServer :: App m (ConnectionId peer) b a
aStateQueryServer :: App m (ConnectionId peer) b a
aTxSubmissionServer :: App m (ConnectionId peer) b a
aChainSyncServer :: App m (ConnectionId peer) b a
aTxMonitorServer :: forall (m :: * -&gt; *) peer bCS bTX bSQ bTM a.
Apps m peer bCS bTX bSQ bTM a -&gt; App m peer bTM a
aStateQueryServer :: forall (m :: * -&gt; *) peer bCS bTX bSQ bTM a.
Apps m peer bCS bTX bSQ bTM a -&gt; App m peer bSQ a
aTxSubmissionServer :: forall (m :: * -&gt; *) peer bCS bTX bSQ bTM a.
Apps m peer bCS bTX bSQ bTM a -&gt; App m peer bTX a
aChainSyncServer :: forall (m :: * -&gt; *) peer bCS bTX bSQ bTM a.
Apps m peer bCS bTX bSQ bTM a -&gt; App m peer bCS a
</span><a href="#local-6989586621680031238"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-470"></span><span>    </span><span class="annot"><span class="annottext">(ConnectionId peer
 -&gt; STM m ControlMessage
 -&gt; NodeToClientProtocols 'ResponderMode b m Void a)
-&gt; NodeToClientVersion
-&gt; OuroborosApplication 'ResponderMode peer b m Void a
forall addr (m :: * -&gt; *) (appType :: MuxMode) bytes a b.
(ConnectionId addr
 -&gt; STM m ControlMessage
 -&gt; NodeToClientProtocols appType bytes m a b)
-&gt; NodeToClientVersion
-&gt; OuroborosApplication appType addr bytes m a b
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">nodeToClientProtocols</span></a></span><span>
</span><span id="line-471"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680031236"><span class="annot"><span class="annottext">ConnectionId peer
</span><a href="#local-6989586621680031236"><span class="hs-identifier hs-var">peer</span></a></span></span><span> </span><span id="local-6989586621680031235"><span class="annot"><span class="annottext">STM m ControlMessage
</span><a href="#local-6989586621680031235"><span class="hs-identifier hs-var">_shouldStopSTM</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeToClientProtocols :: forall (appType :: MuxMode) bytes (m :: * -&gt; *) a b.
RunMiniProtocol appType bytes m a b
-&gt; RunMiniProtocol appType bytes m a b
-&gt; RunMiniProtocol appType bytes m a b
-&gt; RunMiniProtocol appType bytes m a b
-&gt; NodeToClientProtocols appType bytes m a b
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientProtocols</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-472"></span><span>          </span><span class="annot"><span class="annottext">localChainSyncProtocol :: RunMiniProtocol 'ResponderMode b m Void a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">localChainSyncProtocol</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-473"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MuxPeer b m a -&gt; RunMiniProtocol 'ResponderMode b m Void a
forall bytes (m :: * -&gt; *) b.
MuxPeer bytes m b -&gt; RunMiniProtocol 'ResponderMode bytes m Void b
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">ResponderProtocolOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Channel m b -&gt; m (a, Maybe b)) -&gt; MuxPeer b m a
forall (m :: * -&gt; *) bytes a.
(Channel m bytes -&gt; m (a, Maybe bytes)) -&gt; MuxPeer bytes m a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">MuxPeerRaw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">App m (ConnectionId peer) b a
</span><a href="#local-6989586621680031241"><span class="hs-identifier hs-var">aChainSyncServer</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionId peer
</span><a href="#local-6989586621680031236"><span class="hs-identifier hs-var">peer</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-474"></span><span>          </span><span class="annot"><span class="annottext">localTxSubmissionProtocol :: RunMiniProtocol 'ResponderMode b m Void a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">localTxSubmissionProtocol</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-475"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MuxPeer b m a -&gt; RunMiniProtocol 'ResponderMode b m Void a
forall bytes (m :: * -&gt; *) b.
MuxPeer bytes m b -&gt; RunMiniProtocol 'ResponderMode bytes m Void b
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">ResponderProtocolOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Channel m b -&gt; m (a, Maybe b)) -&gt; MuxPeer b m a
forall (m :: * -&gt; *) bytes a.
(Channel m bytes -&gt; m (a, Maybe bytes)) -&gt; MuxPeer bytes m a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">MuxPeerRaw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">App m (ConnectionId peer) b a
</span><a href="#local-6989586621680031240"><span class="hs-identifier hs-var">aTxSubmissionServer</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionId peer
</span><a href="#local-6989586621680031236"><span class="hs-identifier hs-var">peer</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-476"></span><span>          </span><span class="annot"><span class="annottext">localStateQueryProtocol :: RunMiniProtocol 'ResponderMode b m Void a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">localStateQueryProtocol</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-477"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MuxPeer b m a -&gt; RunMiniProtocol 'ResponderMode b m Void a
forall bytes (m :: * -&gt; *) b.
MuxPeer bytes m b -&gt; RunMiniProtocol 'ResponderMode bytes m Void b
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">ResponderProtocolOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Channel m b -&gt; m (a, Maybe b)) -&gt; MuxPeer b m a
forall (m :: * -&gt; *) bytes a.
(Channel m bytes -&gt; m (a, Maybe bytes)) -&gt; MuxPeer bytes m a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">MuxPeerRaw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">App m (ConnectionId peer) b a
</span><a href="#local-6989586621680031239"><span class="hs-identifier hs-var">aStateQueryServer</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionId peer
</span><a href="#local-6989586621680031236"><span class="hs-identifier hs-var">peer</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-478"></span><span>          </span><span class="annot"><span class="annottext">localTxMonitorProtocol :: RunMiniProtocol 'ResponderMode b m Void a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">localTxMonitorProtocol</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-479"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MuxPeer b m a -&gt; RunMiniProtocol 'ResponderMode b m Void a
forall bytes (m :: * -&gt; *) b.
MuxPeer bytes m b -&gt; RunMiniProtocol 'ResponderMode bytes m Void b
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">ResponderProtocolOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Channel m b -&gt; m (a, Maybe b)) -&gt; MuxPeer b m a
forall (m :: * -&gt; *) bytes a.
(Channel m bytes -&gt; m (a, Maybe bytes)) -&gt; MuxPeer bytes m a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">MuxPeerRaw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">App m (ConnectionId peer) b a
</span><a href="#local-6989586621680031238"><span class="hs-identifier hs-var">aTxMonitorServer</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionId peer
</span><a href="#local-6989586621680031236"><span class="hs-identifier hs-var">peer</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>        </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>      </span><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680031242"><span class="hs-identifier hs-var">version</span></a></span><span>
</span><span id="line-482"></span></pre></body></html>