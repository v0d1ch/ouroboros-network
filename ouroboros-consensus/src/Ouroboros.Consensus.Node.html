<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs               #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures      #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE MonadComprehensions #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns      #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE Rank2Types          #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards     #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving  #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- | Run the whole Node</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Intended for qualified import.</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ouroboros.Consensus.Node</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#run"><span class="hs-identifier">run</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#runWith"><span class="hs-identifier">runWith</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Standard arguments</span></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#StdRunNodeArgs"><span class="hs-identifier">StdRunNodeArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdBfcSaltIO"><span class="hs-identifier">stdBfcSaltIO</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdChainSyncTimeout"><span class="hs-identifier">stdChainSyncTimeout</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdKeepAliveRngIO"><span class="hs-identifier">stdKeepAliveRngIO</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdLowLevelRunNodeArgsIO"><span class="hs-identifier">stdLowLevelRunNodeArgsIO</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdMkChainDbHasFS"><span class="hs-identifier">stdMkChainDbHasFS</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdRunDataDiffusion"><span class="hs-identifier">stdRunDataDiffusion</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdVersionDataNTC"><span class="hs-identifier">stdVersionDataNTC</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdVersionDataNTN"><span class="hs-identifier">stdVersionDataNTN</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdWithCheckedDB"><span class="hs-identifier">stdWithCheckedDB</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** P2P Switch</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#NetworkP2PMode"><span class="hs-identifier">NetworkP2PMode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Exposed by 'run' et al</span></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#RelativeMountPoint"><span class="hs-identifier">ChainDB.RelativeMountPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Types.html#TraceEvent"><span class="hs-identifier">ChainDB.TraceEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#ChainDbArgs"><span class="hs-identifier">ChainDbArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.BlockchainTime.WallClock.HardFork.html#HardForkBlockchainTimeArgs"><span class="hs-identifier">HardForkBlockchainTimeArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Recovery.html#LastShutDownWasClean"><span class="hs-identifier">LastShutDownWasClean</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#LowLevelRunNodeArgs"><span class="hs-identifier">LowLevelRunNodeArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.API.html#MempoolCapacityBytesOverride"><span class="hs-identifier">MempoolCapacityBytesOverride</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernel"><span class="hs-identifier">NodeKernel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier">NodeKernelArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.ProtocolInfo.html#ProtocolInfo"><span class="hs-identifier">ProtocolInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html#RunNode"><span class="hs-identifier">RunNode</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#RunNodeArgs"><span class="hs-identifier">RunNodeArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Tracers.html#Tracers"><span class="hs-identifier">Tracers</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Tracers.html#Tracers%27"><span class="hs-identifier">Tracers'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Internal helpers</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#mkChainDbArgs"><span class="hs-identifier">mkChainDbArgs</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#mkNodeKernelArgs"><span class="hs-identifier">mkNodeKernelArgs</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#nodeKernelArgsEnforceInvariants"><span class="hs-identifier">nodeKernelArgsEnforceInvariants</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#openChainDB"><span class="hs-identifier">openChainDB</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.Serialise</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DeserialiseFailure</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Tracer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Tracer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">contramap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Hashable</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">Data.Typeable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">Typeable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/filepath-1.4.2.1/src"><span class="hs-identifier">System.FilePath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/filepath-1.4.2.1/src"><span class="hs-operator">(&lt;/&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StdGen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">newStdGen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">randomIO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">randomRIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/src"><span class="hs-identifier">Control.Monad.Class.MonadTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/src"><span class="hs-identifier">MonadTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/src"><span class="hs-identifier">Control.Monad.Class.MonadTimer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/src"><span class="hs-identifier">MonadTimer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.BlockFetch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">BlockFetchConfiguration</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Diffusion</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Diffusion</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Diffusion.NonP2P</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonP2P</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Diffusion.P2P</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P2P</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.Magic</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.NodeToClient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier">ConnectionId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier">LocalAddress</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>                     </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier">LocalSocket</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">NodeToClientVersionData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier">combineVersions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>                     </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier">simpleSingletonVersions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.NodeToNode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">DiffusionMode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>                     </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">MiniProtocolParameters</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">NodeToNodeVersionData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>                     </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">RemoteAddress</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Socket</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">blockFetchPipeliningMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>                     </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">defaultMiniProtocolParameters</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.PeerSelection.LedgerPeers</span></a></span><span>
</span><span id="line-79"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">LedgerPeersConsensusInterface</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">Ouroboros.Network.PeerSelection.PeerMetric</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">PeerMetrics</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>                     </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">newPeerMetric</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier">reportMetric</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier">Ouroboros.Network.Protocol.Limits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier">shortWait</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier">Ouroboros.Network.RethrowPolicy</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Block.html"><span class="hs-identifier">Ouroboros.Consensus.Block</span></a></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.BlockchainTime.html"><span class="hs-identifier">Ouroboros.Consensus.BlockchainTime</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getSystemStart</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Config.html"><span class="hs-identifier">Ouroboros.Consensus.Config</span></a></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Config.SupportsNode.html"><span class="hs-identifier">Ouroboros.Consensus.Config.SupportsNode</span></a></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Fragment.InFuture.html"><span class="hs-identifier">Ouroboros.Consensus.Fragment.InFuture</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Fragment.InFuture.html#CheckInFuture"><span class="hs-identifier">CheckInFuture</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>                     </span><span class="annot"><a href="Ouroboros.Consensus.Fragment.InFuture.html#ClockSkew"><span class="hs-identifier">ClockSkew</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Fragment.InFuture.html"><span class="hs-identifier">Ouroboros.Consensus.Fragment.InFuture</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">InFuture</span></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Extended.html"><span class="hs-identifier">Ouroboros.Consensus.Ledger.Extended</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Extended.html#ExtLedgerState"><span class="hs-identifier">ExtLedgerState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html"><span class="hs-identifier">Ouroboros.Consensus.Network.NodeToClient</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NTC</span></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToNode.html"><span class="hs-identifier">Ouroboros.Consensus.Network.NodeToNode</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NTN</span></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.DbLock.html"><span class="hs-identifier">Ouroboros.Consensus.Node.DbLock</span></a></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.DbMarker.html"><span class="hs-identifier">Ouroboros.Consensus.Node.DbMarker</span></a></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.ErrorPolicy.html"><span class="hs-identifier">Ouroboros.Consensus.Node.ErrorPolicy</span></a></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.InitStorage.html"><span class="hs-identifier">Ouroboros.Consensus.Node.InitStorage</span></a></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html"><span class="hs-identifier">Ouroboros.Consensus.Node.NetworkProtocolVersion</span></a></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.ProtocolInfo.html"><span class="hs-identifier">Ouroboros.Consensus.Node.ProtocolInfo</span></a></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.Recovery.html"><span class="hs-identifier">Ouroboros.Consensus.Node.Recovery</span></a></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.RethrowPolicy.html"><span class="hs-identifier">Ouroboros.Consensus.Node.RethrowPolicy</span></a></span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html"><span class="hs-identifier">Ouroboros.Consensus.Node.Run</span></a></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Node.Tracers.html"><span class="hs-identifier">Ouroboros.Consensus.Node.Tracers</span></a></span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html"><span class="hs-identifier">Ouroboros.Consensus.NodeKernel</span></a></span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.Args.html"><span class="hs-identifier">Ouroboros.Consensus.Util.Args</span></a></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.IOLike.html"><span class="hs-identifier">Ouroboros.Consensus.Util.IOLike</span></a></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.Orphans.html"><span class="hs-identifier">Ouroboros.Consensus.Util.Orphans</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.ResourceRegistry.html"><span class="hs-identifier">Ouroboros.Consensus.Util.ResourceRegistry</span></a></span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.Time.html"><span class="hs-identifier">Ouroboros.Consensus.Util.Time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Util.Time.html#secondsToNominalDiffTime"><span class="hs-identifier">secondsToNominalDiffTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.html"><span class="hs-identifier">Ouroboros.Consensus.Storage.ChainDB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.API.html#ChainDB"><span class="hs-identifier">ChainDB</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#ChainDbArgs"><span class="hs-identifier">ChainDbArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.html"><span class="hs-identifier">Ouroboros.Consensus.Storage.ChainDB</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainDB</span></span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.html"><span class="hs-identifier">Ouroboros.Consensus.Storage.FS.API</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.html#SomeHasFS"><span class="hs-identifier">SomeHasFS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.Types.html"><span class="hs-identifier">Ouroboros.Consensus.Storage.FS.API.Types</span></a></span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.IO.html"><span class="hs-identifier">Ouroboros.Consensus.Storage.FS.IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.IO.html#ioHasFS"><span class="hs-identifier">ioHasFS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ImmutableDB.html"><span class="hs-identifier">Ouroboros.Consensus.Storage.ImmutableDB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.ImmutableDB.Chunks.Internal.html#ChunkInfo"><span class="hs-identifier">ChunkInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>                     </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Types.html#ValidationPolicy"><span class="hs-identifier">ValidationPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Storage.LedgerDB.DiskPolicy.html"><span class="hs-identifier">Ouroboros.Consensus.Storage.LedgerDB.DiskPolicy</span></a></span><span>
</span><span id="line-120"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.LedgerDB.DiskPolicy.html#SnapshotInterval"><span class="hs-identifier">SnapshotInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.LedgerDB.DiskPolicy.html#defaultDiskPolicy"><span class="hs-identifier">defaultDiskPolicy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Storage.VolatileDB.html"><span class="hs-identifier">Ouroboros.Consensus.Storage.VolatileDB</span></a></span><span>
</span><span id="line-122"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.VolatileDB.Impl.Types.html#BlockValidationPolicy"><span class="hs-identifier">BlockValidationPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  The arguments to the Consensus Layer node functionality
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- How to add a new argument</span><span>
</span><span id="line-129"></span><span class="hs-comment">--</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- 1) As a Consensus Layer maintainer, use your judgement to determine whether</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- the new argument belongs in 'RunNodeArgs' or 'LowLevelArgs'. Give it the type</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- that seems most &quot; natural &quot;, future-proof, and useful for the whole range of</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- invocations: our tests, our own benchmarks, deployment on @mainnet@, etc. The</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- major litmus test is: it only belongs in 'RunNodeArgs' if /every/ invocation</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- of our node code must specify it.</span><span>
</span><span id="line-136"></span><span class="hs-comment">--</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- 2) If you add it to 'LowLevelArgs', you'll have type errors in</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- 'stdLowLevelRunNodeArgsIO'. To fix them, you'll need to either hard-code a</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- default value or else extend 'StdRunNodeArgs' with a new sufficient field.</span><span>
</span><span id="line-140"></span><span class="hs-comment">--</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- 3) When extending either 'RunNodeArgs' or 'StdRunNodeArgs', the</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- @cardano-node@ will have to be updated, so consider the Node Team's</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- preferences when choosing the new field's type. As an oversimplification,</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- Consensus /owns/ 'RunNodeArgs' while Node /owns/ 'StdRunNodeArgs', but it's</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- always worth spending some effort to try to find a type that satisfies both</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- teams.</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- | Arguments expected from any invocation of 'runWith', whether by deployed</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- code, tests, etc.</span><span>
</span><span id="line-150"></span><span class="hs-keyword">data</span><span> </span><span id="RunNodeArgs"><span class="annot"><a href="Ouroboros.Consensus.Node.html#RunNodeArgs"><span class="hs-identifier hs-var">RunNodeArgs</span></a></span></span><span> </span><span id="local-6989586621680032765"><span class="annot"><a href="#local-6989586621680032765"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680032764"><span class="annot"><a href="#local-6989586621680032764"><span class="hs-identifier hs-type">addrNTN</span></a></span></span><span> </span><span id="local-6989586621680032763"><span class="annot"><a href="#local-6989586621680032763"><span class="hs-identifier hs-type">addrNTC</span></a></span></span><span> </span><span id="local-6989586621680032762"><span class="annot"><a href="#local-6989586621680032762"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680032761"><span class="annot"><a href="#local-6989586621680032761"><span class="hs-identifier hs-type">p2p</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.P2P</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RunNodeArgs"><span class="annot"><a href="Ouroboros.Consensus.Node.html#RunNodeArgs"><span class="hs-identifier hs-var">RunNodeArgs</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-151"></span><span>      </span><span class="hs-comment">-- | Consensus tracers</span><span>
</span><span id="line-152"></span><span>      </span><span id="rnTraceConsensus"><span class="annot"><span class="annottext">RunNodeArgs m addrNTN addrNTC blk p2p
-&gt; Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="Ouroboros.Consensus.Node.html#rnTraceConsensus"><span class="hs-identifier hs-var hs-var">rnTraceConsensus</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Tracers.html#Tracers"><span class="hs-identifier hs-type">Tracers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032765"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032764"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032763"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032762"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>      </span><span class="hs-comment">-- | Protocol tracers for node-to-node communication</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rnTraceNTN"><span class="annot"><span class="annottext">RunNodeArgs m addrNTN addrNTC blk p2p
-&gt; Tracers m (ConnectionId addrNTN) blk DeserialiseFailure
</span><a href="Ouroboros.Consensus.Node.html#rnTraceNTN"><span class="hs-identifier hs-var hs-var">rnTraceNTN</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToNode.html#Tracers"><span class="hs-identifier hs-type">NTN.Tracers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032765"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032764"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032762"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DeserialiseFailure</span></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span>      </span><span class="hs-comment">-- | Protocol tracers for node-to-client communication</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rnTraceNTC"><span class="annot"><span class="annottext">RunNodeArgs m addrNTN addrNTC blk p2p
-&gt; Tracers m (ConnectionId addrNTC) blk DeserialiseFailure
</span><a href="Ouroboros.Consensus.Node.html#rnTraceNTC"><span class="hs-identifier hs-var hs-var">rnTraceNTC</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Tracers"><span class="hs-identifier hs-type">NTC.Tracers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032765"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032763"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032762"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DeserialiseFailure</span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-comment">-- | Protocol info</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rnProtocolInfo"><span class="annot"><span class="annottext">RunNodeArgs m addrNTN addrNTC blk p2p -&gt; ProtocolInfo m blk
</span><a href="Ouroboros.Consensus.Node.html#rnProtocolInfo"><span class="hs-identifier hs-var hs-var">rnProtocolInfo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.ProtocolInfo.html#ProtocolInfo"><span class="hs-identifier hs-type">ProtocolInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032765"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032762"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>      </span><span class="hs-comment">-- | Hook called after the initialisation of the 'NodeKernel'</span><span>
</span><span id="line-164"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-comment">-- Called on the 'NodeKernel' after creating it, but before the network</span><span>
</span><span id="line-166"></span><span>      </span><span class="hs-comment">-- layer is initialised.</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rnNodeKernelHook"><span class="annot"><span class="annottext">RunNodeArgs m addrNTN addrNTC blk p2p
-&gt; ResourceRegistry m
-&gt; NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; m ()
</span><a href="Ouroboros.Consensus.Node.html#rnNodeKernelHook"><span class="hs-identifier hs-var hs-var">rnNodeKernelHook</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.ResourceRegistry.html#ResourceRegistry"><span class="hs-identifier hs-type">ResourceRegistry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032765"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-168"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernel"><span class="hs-identifier hs-type">NodeKernel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032765"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032764"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032763"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032762"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-169"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680032765"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>      </span><span class="hs-comment">-- | Network P2P Mode switch</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rnEnableP2P"><span class="annot"><span class="annottext">RunNodeArgs m addrNTN addrNTC blk p2p -&gt; NetworkP2PMode p2p
</span><a href="Ouroboros.Consensus.Node.html#rnEnableP2P"><span class="hs-identifier hs-var hs-var">rnEnableP2P</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#NetworkP2PMode"><span class="hs-identifier hs-type">NetworkP2PMode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032761"><span class="hs-identifier hs-type">p2p</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Arguments that usually only tests /directly/ specify.</span><span>
</span><span id="line-176"></span><span class="hs-comment">--</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- A non-testing invocation probably wouldn't explicitly provide these values to</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- 'runWith'. The @cardano-node@, for example, instead calls the 'run'</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- abbreviation, which uses 'stdLowLevelRunNodeArgsIO' to indirectly specify</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- these low-level values from the higher-level 'StdRunNodeArgs'.</span><span>
</span><span id="line-181"></span><span class="hs-keyword">data</span><span> </span><span id="LowLevelRunNodeArgs"><span class="annot"><a href="Ouroboros.Consensus.Node.html#LowLevelRunNodeArgs"><span class="hs-identifier hs-var">LowLevelRunNodeArgs</span></a></span></span><span> </span><span id="local-6989586621680032760"><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680032759"><span class="annot"><a href="#local-6989586621680032759"><span class="hs-identifier hs-type">addrNTN</span></a></span></span><span> </span><span id="local-6989586621680032758"><span class="annot"><a href="#local-6989586621680032758"><span class="hs-identifier hs-type">addrNTC</span></a></span></span><span> </span><span id="local-6989586621680032757"><span class="annot"><a href="#local-6989586621680032757"><span class="hs-identifier hs-type">versionDataNTN</span></a></span></span><span> </span><span id="local-6989586621680032756"><span class="annot"><a href="#local-6989586621680032756"><span class="hs-identifier hs-type">versionDataNTC</span></a></span></span><span> </span><span id="local-6989586621680032755"><span class="annot"><a href="#local-6989586621680032755"><span class="hs-identifier hs-type">blk</span></a></span></span><span>
</span><span id="line-182"></span><span>                         </span><span class="hs-special">(</span><span id="local-6989586621680032754"><span class="annot"><a href="#local-6989586621680032754"><span class="hs-identifier hs-type">p2p</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.P2P</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-183"></span><span>   </span><span id="LowLevelRunNodeArgs"><span class="annot"><a href="Ouroboros.Consensus.Node.html#LowLevelRunNodeArgs"><span class="hs-identifier hs-var">LowLevelRunNodeArgs</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>      </span><span class="hs-comment">-- | An action that will receive a marker indicating whether the previous</span><span>
</span><span id="line-186"></span><span>      </span><span class="hs-comment">-- shutdown was considered clean and a wrapper for installing a handler to</span><span>
</span><span id="line-187"></span><span>      </span><span class="hs-comment">-- create a clean file on exit if needed. See</span><span>
</span><span id="line-188"></span><span>      </span><span class="hs-comment">-- 'Ouroboros.Consensus.Node.Recovery.runWithCheckedDB'.</span><span>
</span><span id="line-189"></span><span>      </span><span id="llrnWithCheckedDB"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; forall a.
   (LastShutDownWasClean -&gt; (ChainDB m blk -&gt; m a -&gt; m a) -&gt; m a)
   -&gt; m a
</span><a href="Ouroboros.Consensus.Node.html#llrnWithCheckedDB"><span class="hs-identifier hs-var hs-var">llrnWithCheckedDB</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680032910"><span class="annot"><a href="#local-6989586621680032910"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Node.Recovery.html#LastShutDownWasClean"><span class="hs-identifier hs-type">LastShutDownWasClean</span></a></span><span>
</span><span id="line-190"></span><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.API.html#ChainDB"><span class="hs-identifier hs-type">ChainDB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032755"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032910"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032910"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032910"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032910"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-comment">-- | The &quot; static &quot; ChainDB arguments</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="llrnChainDbArgsDefaults"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; ChainDbArgs Defaults m blk
</span><a href="Ouroboros.Consensus.Node.html#llrnChainDbArgsDefaults"><span class="hs-identifier hs-var hs-var">llrnChainDbArgsDefaults</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#ChainDbArgs"><span class="hs-identifier hs-type">ChainDbArgs</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.Args.html#Defaults"><span class="hs-identifier hs-type">Defaults</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032755"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-comment">-- | Customise the 'ChainDbArgs'</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="llrnCustomiseChainDbArgs"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk
</span><a href="Ouroboros.Consensus.Node.html#llrnCustomiseChainDbArgs"><span class="hs-identifier hs-var hs-var">llrnCustomiseChainDbArgs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-199"></span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#ChainDbArgs"><span class="hs-identifier hs-type">ChainDbArgs</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032755"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#ChainDbArgs"><span class="hs-identifier hs-type">ChainDbArgs</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032755"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>      </span><span class="hs-comment">-- | Customise the 'NodeArgs'</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="llrnCustomiseNodeKernelArgs"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="Ouroboros.Consensus.Node.html#llrnCustomiseNodeKernelArgs"><span class="hs-identifier hs-var hs-var">llrnCustomiseNodeKernelArgs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-204"></span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032759"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032758"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032755"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032759"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032758"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032755"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span>      </span><span class="hs-comment">-- | Ie 'bfcSalt'</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="llrnBfcSalt"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; Int
</span><a href="Ouroboros.Consensus.Node.html#llrnBfcSalt"><span class="hs-identifier hs-var hs-var">llrnBfcSalt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>      </span><span class="hs-comment">-- | Ie 'keepAliveRng'</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="llrnKeepAliveRng"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; StdGen
</span><a href="Ouroboros.Consensus.Node.html#llrnKeepAliveRng"><span class="hs-identifier hs-var hs-var">llrnKeepAliveRng</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>      </span><span class="hs-comment">-- | Customise the 'HardForkBlockchainTimeArgs'</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="llrnCustomiseHardForkBlockchainTimeArgs"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; HardForkBlockchainTimeArgs m blk
-&gt; HardForkBlockchainTimeArgs m blk
</span><a href="Ouroboros.Consensus.Node.html#llrnCustomiseHardForkBlockchainTimeArgs"><span class="hs-identifier hs-var hs-var">llrnCustomiseHardForkBlockchainTimeArgs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-215"></span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.BlockchainTime.WallClock.HardFork.html#HardForkBlockchainTimeArgs"><span class="hs-identifier hs-type">HardForkBlockchainTimeArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032755"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-216"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.BlockchainTime.WallClock.HardFork.html#HardForkBlockchainTimeArgs"><span class="hs-identifier hs-type">HardForkBlockchainTimeArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032755"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span>      </span><span class="hs-comment">-- | See 'NTN.ChainSyncTimeout'</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="llrnChainSyncTimeout"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; m ChainSyncTimeout
</span><a href="Ouroboros.Consensus.Node.html#llrnChainSyncTimeout"><span class="hs-identifier hs-var hs-var">llrnChainSyncTimeout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NTN.ChainSyncTimeout</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-comment">-- | How to run the data diffusion applications</span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-223"></span><span>      </span><span class="hs-comment">-- 'run' will not return before this does.</span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="llrnRunDataDiffusion"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; ResourceRegistry m
-&gt; Applications
     addrNTN
     NodeToNodeVersion
     versionDataNTN
     addrNTC
     NodeToClientVersion
     versionDataNTC
     m
-&gt; ExtraApplications p2p addrNTN m
-&gt; m ()
</span><a href="Ouroboros.Consensus.Node.html#llrnRunDataDiffusion"><span class="hs-identifier hs-var hs-var">llrnRunDataDiffusion</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-225"></span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Util.ResourceRegistry.html#ResourceRegistry"><span class="hs-identifier hs-type">ResourceRegistry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-226"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.Applications</span></a></span><span>
</span><span id="line-227"></span><span>             </span><span class="annot"><a href="#local-6989586621680032759"><span class="hs-identifier hs-type">addrNTN</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToNodeVersion</span></a></span><span>   </span><span class="annot"><a href="#local-6989586621680032757"><span class="hs-identifier hs-type">versionDataNTN</span></a></span><span>
</span><span id="line-228"></span><span>             </span><span class="annot"><a href="#local-6989586621680032758"><span class="hs-identifier hs-type">addrNTC</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032756"><span class="hs-identifier hs-type">versionDataNTC</span></a></span><span>
</span><span id="line-229"></span><span>             </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-230"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.ExtraApplications</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032754"><span class="hs-identifier hs-type">p2p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032759"><span class="hs-identifier hs-type">addrNTN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-231"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680032760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="llrnVersionDataNTC"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; versionDataNTC
</span><a href="Ouroboros.Consensus.Node.html#llrnVersionDataNTC"><span class="hs-identifier hs-var hs-var">llrnVersionDataNTC</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680032756"><span class="hs-identifier hs-type">versionDataNTC</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="llrnVersionDataNTN"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; versionDataNTN
</span><a href="Ouroboros.Consensus.Node.html#llrnVersionDataNTN"><span class="hs-identifier hs-var hs-var">llrnVersionDataNTN</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680032757"><span class="hs-identifier hs-type">versionDataNTN</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>      </span><span class="hs-comment">-- | node-to-node protocol versions to run.</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="llrnNodeToNodeVersions"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
</span><a href="Ouroboros.Consensus.Node.html#llrnNodeToNodeVersions"><span class="hs-identifier hs-var hs-var">llrnNodeToNodeVersions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToNodeVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToNodeVersion"><span class="hs-identifier hs-type">BlockNodeToNodeVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032755"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>      </span><span class="hs-comment">-- | node-to-client protocol versions to run.</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="llrnNodeToClientVersions"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; Map NodeToClientVersion (BlockNodeToClientVersion blk)
</span><a href="Ouroboros.Consensus.Node.html#llrnNodeToClientVersions"><span class="hs-identifier hs-var hs-var">llrnNodeToClientVersions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToClientVersion"><span class="hs-identifier hs-type">BlockNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032755"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span>      </span><span class="hs-comment">-- | Maximum clock skew</span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="llrnMaxClockSkew"><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; ClockSkew
</span><a href="Ouroboros.Consensus.Node.html#llrnMaxClockSkew"><span class="hs-identifier hs-var hs-var">llrnMaxClockSkew</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Fragment.InFuture.html#ClockSkew"><span class="hs-identifier hs-type">ClockSkew</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Entrypoints to the Consensus Layer node functionality
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | P2P Switch</span><span>
</span><span id="line-252"></span><span class="hs-comment">--</span><span>
</span><span id="line-253"></span><span class="hs-keyword">data</span><span> </span><span id="NetworkP2PMode"><span class="annot"><a href="Ouroboros.Consensus.Node.html#NetworkP2PMode"><span class="hs-identifier hs-var">NetworkP2PMode</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680032305"><span class="annot"><a href="#local-6989586621680032305"><span class="hs-identifier hs-type">p2p</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.P2P</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-254"></span><span>    </span><span id="EnabledP2PMode"><span class="annot"><a href="Ouroboros.Consensus.Node.html#EnabledP2PMode"><span class="hs-identifier hs-var">EnabledP2PMode</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#NetworkP2PMode"><span class="hs-identifier hs-type">NetworkP2PMode</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.P2P</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span id="DisabledP2PMode"><span class="annot"><a href="Ouroboros.Consensus.Node.html#DisabledP2PMode"><span class="hs-identifier hs-var">DisabledP2PMode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#NetworkP2PMode"><span class="hs-identifier hs-type">NetworkP2PMode</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.NonP2P</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span id="local-6989586621680032298"><span id="local-6989586621680032300"><span id="local-6989586621680032302"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.html#NetworkP2PMode"><span class="hs-identifier hs-type">NetworkP2PMode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032302"><span class="hs-identifier hs-type">p2p</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-258"></span><span id="local-6989586621680032290"><span id="local-6989586621680032292"><span id="local-6989586621680032294"><span id="local-6989586621680032296"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.html#NetworkP2PMode"><span class="hs-identifier hs-type">NetworkP2PMode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032296"><span class="hs-identifier hs-type">p2p</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- | Combination of 'runWith' and 'stdLowLevelRunArgsIO'</span><span>
</span><span id="line-262"></span><span class="annot"><a href="Ouroboros.Consensus.Node.html#run"><span class="hs-identifier hs-type">run</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680032288"><span class="annot"><a href="#local-6989586621680032288"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span id="local-6989586621680032287"><span class="annot"><a href="#local-6989586621680032287"><span class="hs-identifier hs-type">p2p</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-263"></span><span>     </span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html#RunNode"><span class="hs-identifier hs-type">RunNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032288"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#RunNodeArgs"><span class="hs-identifier hs-type">RunNodeArgs</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">RemoteAddress</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">LocalAddress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032288"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032287"><span class="hs-identifier hs-type">p2p</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#StdRunNodeArgs"><span class="hs-identifier hs-type">StdRunNodeArgs</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032288"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032287"><span class="hs-identifier hs-type">p2p</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span id="run"><span class="annot"><span class="annottext">run :: RunNodeArgs IO RemoteAddress LocalAddress blk p2p
-&gt; StdRunNodeArgs IO blk p2p -&gt; IO ()
</span><a href="Ouroboros.Consensus.Node.html#run"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span id="local-6989586621680032286"><span class="annot"><span class="annottext">RunNodeArgs IO RemoteAddress LocalAddress blk p2p
</span><a href="#local-6989586621680032286"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680032285"><span class="annot"><span class="annottext">StdRunNodeArgs IO blk p2p
</span><a href="#local-6989586621680032285"><span class="hs-identifier hs-var">stdArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RunNodeArgs IO RemoteAddress LocalAddress blk p2p
-&gt; StdRunNodeArgs IO blk p2p
-&gt; IO
     (LowLevelRunNodeArgs
        IO
        RemoteAddress
        LocalAddress
        NodeToNodeVersionData
        NodeToClientVersionData
        blk
        p2p)
forall blk (p2p :: P2P).
RunNode blk =&gt;
RunNodeArgs IO RemoteAddress LocalAddress blk p2p
-&gt; StdRunNodeArgs IO blk p2p
-&gt; IO
     (LowLevelRunNodeArgs
        IO
        RemoteAddress
        LocalAddress
        NodeToNodeVersionData
        NodeToClientVersionData
        blk
        p2p)
</span><a href="Ouroboros.Consensus.Node.html#stdLowLevelRunNodeArgsIO"><span class="hs-identifier hs-var">stdLowLevelRunNodeArgsIO</span></a></span><span> </span><span class="annot"><span class="annottext">RunNodeArgs IO RemoteAddress LocalAddress blk p2p
</span><a href="#local-6989586621680032286"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">StdRunNodeArgs IO blk p2p
</span><a href="#local-6989586621680032285"><span class="hs-identifier hs-var">stdArgs</span></a></span><span> </span><span class="annot"><span class="annottext">IO
  (LowLevelRunNodeArgs
     IO
     RemoteAddress
     LocalAddress
     NodeToNodeVersionData
     NodeToClientVersionData
     blk
     p2p)
-&gt; (LowLevelRunNodeArgs
      IO
      RemoteAddress
      LocalAddress
      NodeToNodeVersionData
      NodeToClientVersionData
      blk
      p2p
    -&gt; IO ())
-&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">RunNodeArgs IO RemoteAddress LocalAddress blk p2p
-&gt; LowLevelRunNodeArgs
     IO
     RemoteAddress
     LocalAddress
     NodeToNodeVersionData
     NodeToClientVersionData
     blk
     p2p
-&gt; IO ()
forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
(RunNode blk, IOLike m, MonadTime m, MonadTimer m,
 Hashable addrNTN, Ord addrNTN, Typeable addrNTN) =&gt;
RunNodeArgs m addrNTN addrNTC blk p2p
-&gt; LowLevelRunNodeArgs
     m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; m ()
</span><a href="Ouroboros.Consensus.Node.html#runWith"><span class="hs-identifier hs-var">runWith</span></a></span><span> </span><span class="annot"><span class="annottext">RunNodeArgs IO RemoteAddress LocalAddress blk p2p
</span><a href="#local-6989586621680032286"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Start a node.</span><span>
</span><span id="line-270"></span><span class="hs-comment">--</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- This opens the 'ChainDB', sets up the 'NodeKernel' and initialises the</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- network layer.</span><span>
</span><span id="line-273"></span><span class="hs-comment">--</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- This function runs forever unless an exception is thrown.</span><span>
</span><span id="line-275"></span><span class="annot"><a href="Ouroboros.Consensus.Node.html#runWith"><span class="hs-identifier hs-type">runWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680032782"><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680032778"><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span></span><span> </span><span id="local-6989586621680032776"><span class="annot"><a href="#local-6989586621680032776"><span class="hs-identifier hs-type">addrNTC</span></a></span></span><span> </span><span id="local-6989586621680032774"><span class="annot"><a href="#local-6989586621680032774"><span class="hs-identifier hs-type">versionDataNTN</span></a></span></span><span> </span><span id="local-6989586621680032773"><span class="annot"><a href="#local-6989586621680032773"><span class="hs-identifier hs-type">versionDataNTC</span></a></span></span><span> </span><span id="local-6989586621680032783"><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span id="local-6989586621680032775"><span class="annot"><a href="#local-6989586621680032775"><span class="hs-identifier hs-type">p2p</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-276"></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html#RunNode"><span class="hs-identifier hs-type">RunNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-277"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.IOLike.html#IOLike"><span class="hs-identifier hs-type">IOLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/src"><span class="hs-identifier hs-type">MonadTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/src"><span class="hs-identifier hs-type">MonadTimer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-278"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span>
</span><span id="line-279"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#RunNodeArgs"><span class="hs-identifier hs-type">RunNodeArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032776"><span class="hs-identifier hs-type">addrNTC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032775"><span class="hs-identifier hs-type">p2p</span></a></span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#LowLevelRunNodeArgs"><span class="hs-identifier hs-type">LowLevelRunNodeArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032776"><span class="hs-identifier hs-type">addrNTC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032774"><span class="hs-identifier hs-type">versionDataNTN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032773"><span class="hs-identifier hs-type">versionDataNTC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032775"><span class="hs-identifier hs-type">p2p</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span id="runWith"><span class="annot"><span class="annottext">runWith :: RunNodeArgs m addrNTN addrNTC blk p2p
-&gt; LowLevelRunNodeArgs
     m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; m ()
</span><a href="Ouroboros.Consensus.Node.html#runWith"><span class="hs-identifier hs-var hs-var">runWith</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#RunNodeArgs"><span class="hs-identifier hs-type">RunNodeArgs</span></a></span><span class="hs-special">{</span><span id="local-6989586621680032279"><span id="local-6989586621680032280"><span id="local-6989586621680032281"><span id="local-6989586621680032282"><span id="local-6989586621680032283"><span id="local-6989586621680032284"><span class="annot"><span class="annottext">ProtocolInfo m blk
Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
Tracers m (ConnectionId addrNTN) blk DeserialiseFailure
Tracers m (ConnectionId addrNTC) blk DeserialiseFailure
NetworkP2PMode p2p
ResourceRegistry m
-&gt; NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; m ()
rnEnableP2P :: NetworkP2PMode p2p
rnNodeKernelHook :: ResourceRegistry m
-&gt; NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; m ()
rnProtocolInfo :: ProtocolInfo m blk
rnTraceNTC :: Tracers m (ConnectionId addrNTC) blk DeserialiseFailure
rnTraceNTN :: Tracers m (ConnectionId addrNTN) blk DeserialiseFailure
rnTraceConsensus :: Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
rnEnableP2P :: forall (m :: * -&gt; *) addrNTN addrNTC blk (p2p :: P2P).
RunNodeArgs m addrNTN addrNTC blk p2p -&gt; NetworkP2PMode p2p
rnNodeKernelHook :: forall (m :: * -&gt; *) addrNTN addrNTC blk (p2p :: P2P).
RunNodeArgs m addrNTN addrNTC blk p2p
-&gt; ResourceRegistry m
-&gt; NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; m ()
rnProtocolInfo :: forall (m :: * -&gt; *) addrNTN addrNTC blk (p2p :: P2P).
RunNodeArgs m addrNTN addrNTC blk p2p -&gt; ProtocolInfo m blk
rnTraceNTC :: forall (m :: * -&gt; *) addrNTN addrNTC blk (p2p :: P2P).
RunNodeArgs m addrNTN addrNTC blk p2p
-&gt; Tracers m (ConnectionId addrNTC) blk DeserialiseFailure
rnTraceNTN :: forall (m :: * -&gt; *) addrNTN addrNTC blk (p2p :: P2P).
RunNodeArgs m addrNTN addrNTC blk p2p
-&gt; Tracers m (ConnectionId addrNTN) blk DeserialiseFailure
rnTraceConsensus :: forall (m :: * -&gt; *) addrNTN addrNTC blk (p2p :: P2P).
RunNodeArgs m addrNTN addrNTC blk p2p
-&gt; Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032279"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#LowLevelRunNodeArgs"><span class="hs-identifier hs-type">LowLevelRunNodeArgs</span></a></span><span class="hs-special">{</span><span id="local-6989586621680032265"><span id="local-6989586621680032266"><span id="local-6989586621680032267"><span id="local-6989586621680032268"><span id="local-6989586621680032269"><span id="local-6989586621680032270"><span id="local-6989586621680032271"><span id="local-6989586621680032272"><span id="local-6989586621680032273"><span id="local-6989586621680032274"><span id="local-6989586621680032275"><span id="local-6989586621680032276"><span id="local-6989586621680032277"><span id="local-6989586621680032278"><span class="annot"><span class="annottext">versionDataNTN
versionDataNTC
m ChainSyncTimeout
Int
Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
Map NodeToClientVersion (BlockNodeToClientVersion blk)
StdGen
ClockSkew
ChainDbArgs Defaults m blk
ResourceRegistry m
-&gt; Applications
     addrNTN
     NodeToNodeVersion
     versionDataNTN
     addrNTC
     NodeToClientVersion
     versionDataNTC
     m
-&gt; ExtraApplications p2p addrNTN m
-&gt; m ()
HardForkBlockchainTimeArgs m blk
-&gt; HardForkBlockchainTimeArgs m blk
ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk
NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
forall a.
(LastShutDownWasClean -&gt; (ChainDB m blk -&gt; m a -&gt; m a) -&gt; m a)
-&gt; m a
llrnMaxClockSkew :: ClockSkew
llrnNodeToClientVersions :: Map NodeToClientVersion (BlockNodeToClientVersion blk)
llrnNodeToNodeVersions :: Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
llrnVersionDataNTN :: versionDataNTN
llrnVersionDataNTC :: versionDataNTC
llrnRunDataDiffusion :: ResourceRegistry m
-&gt; Applications
     addrNTN
     NodeToNodeVersion
     versionDataNTN
     addrNTC
     NodeToClientVersion
     versionDataNTC
     m
-&gt; ExtraApplications p2p addrNTN m
-&gt; m ()
llrnChainSyncTimeout :: m ChainSyncTimeout
llrnCustomiseHardForkBlockchainTimeArgs :: HardForkBlockchainTimeArgs m blk
-&gt; HardForkBlockchainTimeArgs m blk
llrnKeepAliveRng :: StdGen
llrnBfcSalt :: Int
llrnCustomiseNodeKernelArgs :: NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
llrnCustomiseChainDbArgs :: ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk
llrnChainDbArgsDefaults :: ChainDbArgs Defaults m blk
llrnWithCheckedDB :: forall a.
(LastShutDownWasClean -&gt; (ChainDB m blk -&gt; m a -&gt; m a) -&gt; m a)
-&gt; m a
llrnMaxClockSkew :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; ClockSkew
llrnNodeToClientVersions :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; Map NodeToClientVersion (BlockNodeToClientVersion blk)
llrnNodeToNodeVersions :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
llrnVersionDataNTN :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; versionDataNTN
llrnVersionDataNTC :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; versionDataNTC
llrnRunDataDiffusion :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; ResourceRegistry m
-&gt; Applications
     addrNTN
     NodeToNodeVersion
     versionDataNTN
     addrNTC
     NodeToClientVersion
     versionDataNTC
     m
-&gt; ExtraApplications p2p addrNTN m
-&gt; m ()
llrnChainSyncTimeout :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; m ChainSyncTimeout
llrnCustomiseHardForkBlockchainTimeArgs :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; HardForkBlockchainTimeArgs m blk
-&gt; HardForkBlockchainTimeArgs m blk
llrnKeepAliveRng :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; StdGen
llrnBfcSalt :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; Int
llrnCustomiseNodeKernelArgs :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
llrnCustomiseChainDbArgs :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk
llrnChainDbArgsDefaults :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; ChainDbArgs Defaults m blk
llrnWithCheckedDB :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
LowLevelRunNodeArgs
  m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
-&gt; forall a.
   (LastShutDownWasClean -&gt; (ChainDB m blk -&gt; m a -&gt; m a) -&gt; m a)
   -&gt; m a
</span><a href="#local-6989586621680032265"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><span class="annottext">(LastShutDownWasClean -&gt; (ChainDB m blk -&gt; m () -&gt; m ()) -&gt; m ())
-&gt; m ()
forall a.
(LastShutDownWasClean -&gt; (ChainDB m blk -&gt; m a -&gt; m a) -&gt; m a)
-&gt; m a
</span><a href="#local-6989586621680032278"><span class="hs-identifier hs-var">llrnWithCheckedDB</span></a></span><span> </span><span class="annot"><span class="annottext">((LastShutDownWasClean -&gt; (ChainDB m blk -&gt; m () -&gt; m ()) -&gt; m ())
 -&gt; m ())
-&gt; (LastShutDownWasClean
    -&gt; (ChainDB m blk -&gt; m () -&gt; m ()) -&gt; m ())
-&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.Recovery.html#LastShutDownWasClean"><span class="hs-identifier hs-type">LastShutDownWasClean</span></a></span><span> </span><span id="local-6989586621680032263"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680032263"><span class="hs-identifier hs-var">lastShutDownWasClean</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680032262"><span class="annot"><span class="annottext">ChainDB m blk -&gt; m () -&gt; m ()
</span><a href="#local-6989586621680032262"><span class="hs-identifier hs-var">continueWithCleanChainDB</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><span class="annottext">(ResourceRegistry m -&gt; m ()) -&gt; m ()
forall (m :: * -&gt; *) a.
(IOLike m, HasCallStack) =&gt;
(ResourceRegistry m -&gt; m a) -&gt; m a
</span><a href="Ouroboros.Consensus.Util.ResourceRegistry.html#withRegistry"><span class="hs-identifier hs-var">withRegistry</span></a></span><span> </span><span class="annot"><span class="annottext">((ResourceRegistry m -&gt; m ()) -&gt; m ())
-&gt; (ResourceRegistry m -&gt; m ()) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680032260"><span class="annot"><span class="annottext">ResourceRegistry m
</span><a href="#local-6989586621680032260"><span class="hs-identifier hs-var">registry</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680032259"><span class="hs-identifier hs-type">systemStart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SystemStart</span></span><span>
</span><span id="line-288"></span><span>          </span><span id="local-6989586621680032259"><span class="annot"><span class="annottext">systemStart :: SystemStart
</span><a href="#local-6989586621680032259"><span class="hs-identifier hs-var hs-var">systemStart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockConfig blk -&gt; SystemStart
forall blk.
ConfigSupportsNode blk =&gt;
BlockConfig blk -&gt; SystemStart
</span><a href="Ouroboros.Consensus.Config.SupportsNode.html#getSystemStart"><span class="hs-identifier hs-var">getSystemStart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelConfig blk -&gt; BlockConfig blk
forall blk. TopLevelConfig blk -&gt; BlockConfig blk
</span><a href="Ouroboros.Consensus.Config.html#configBlock"><span class="hs-identifier hs-var">configBlock</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032256"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span>          </span><span class="annot"><a href="#local-6989586621680032255"><span class="hs-identifier hs-type">systemTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.BlockchainTime.WallClock.Types.html#SystemTime"><span class="hs-identifier hs-type">SystemTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-291"></span><span>          </span><span id="local-6989586621680032255"><span class="annot"><span class="annottext">systemTime :: SystemTime m
</span><a href="#local-6989586621680032255"><span class="hs-identifier hs-var hs-var">systemTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SystemStart
-&gt; Tracer m (TraceBlockchainTimeEvent UTCTime) -&gt; SystemTime m
forall (m :: * -&gt; *).
(MonadTime m, MonadDelay m) =&gt;
SystemStart
-&gt; Tracer m (TraceBlockchainTimeEvent UTCTime) -&gt; SystemTime m
</span><a href="Ouroboros.Consensus.BlockchainTime.WallClock.Default.html#defaultSystemTime"><span class="hs-identifier hs-var">defaultSystemTime</span></a></span><span>
</span><span id="line-292"></span><span>                         </span><span class="annot"><span class="annottext">SystemStart
</span><a href="#local-6989586621680032259"><span class="hs-identifier hs-var">systemStart</span></a></span><span>
</span><span id="line-293"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; Tracer m (TraceBlockchainTimeEvent UTCTime)
forall remotePeer localPeer blk (f :: * -&gt; *).
Tracers' remotePeer localPeer blk f
-&gt; f (TraceBlockchainTimeEvent UTCTime)
</span><a href="Ouroboros.Consensus.Node.Tracers.html#blockchainTimeTracer"><span class="hs-identifier hs-var hs-var">blockchainTimeTracer</span></a></span><span> </span><span class="annot"><span class="annottext">Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032284"><span class="hs-identifier hs-var">rnTraceConsensus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>          </span><span class="annot"><a href="#local-6989586621680032252"><span class="hs-identifier hs-type">inFuture</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Fragment.InFuture.html#CheckInFuture"><span class="hs-identifier hs-type">CheckInFuture</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-296"></span><span>          </span><span id="local-6989586621680032252"><span class="annot"><span class="annottext">inFuture :: CheckInFuture m blk
</span><a href="#local-6989586621680032252"><span class="hs-identifier hs-var hs-var">inFuture</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerConfig blk
-&gt; ClockSkew -&gt; SystemTime m -&gt; CheckInFuture m blk
forall (m :: * -&gt; *) blk.
(Monad m, UpdateLedger blk, HasHardForkHistory blk) =&gt;
LedgerConfig blk
-&gt; ClockSkew -&gt; SystemTime m -&gt; CheckInFuture m blk
</span><a href="Ouroboros.Consensus.Fragment.InFuture.html#reference"><span class="hs-identifier hs-var">InFuture.reference</span></a></span><span>
</span><span id="line-297"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelConfig blk -&gt; LedgerConfig blk
forall blk. TopLevelConfig blk -&gt; LedgerConfig blk
</span><a href="Ouroboros.Consensus.Config.html#configLedger"><span class="hs-identifier hs-var">configLedger</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032256"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>                       </span><span class="annot"><span class="annottext">ClockSkew
</span><a href="#local-6989586621680032265"><span class="hs-identifier hs-var">llrnMaxClockSkew</span></a></span><span>
</span><span id="line-299"></span><span>                       </span><span class="annot"><span class="annottext">SystemTime m
</span><a href="#local-6989586621680032255"><span class="hs-identifier hs-var">systemTime</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680032249"><span class="annot"><span class="annottext">customiseChainDbArgs' :: ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk
</span><a href="#local-6989586621680032249"><span class="hs-identifier hs-var hs-var">customiseChainDbArgs'</span></a></span></span><span> </span><span id="local-6989586621680032248"><span class="annot"><span class="annottext">ChainDbArgs Identity m blk
</span><a href="#local-6989586621680032248"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-302"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680032263"><span class="hs-identifier hs-var">lastShutDownWasClean</span></a></span><span>
</span><span id="line-303"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk
</span><a href="#local-6989586621680032276"><span class="hs-identifier hs-var">llrnCustomiseChainDbArgs</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDbArgs Identity m blk
</span><a href="#local-6989586621680032248"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-304"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-305"></span><span>              </span><span class="hs-comment">-- When the last shutdown was not clean, validate the complete</span><span>
</span><span id="line-306"></span><span>              </span><span class="hs-comment">-- ChainDB to detect and recover from any corruptions. This will</span><span>
</span><span id="line-307"></span><span>              </span><span class="hs-comment">-- override the default value /and/ the user-customised value of</span><span>
</span><span id="line-308"></span><span>              </span><span class="hs-comment">-- the 'ChainDB.cdbImmValidation' and the</span><span>
</span><span id="line-309"></span><span>              </span><span class="hs-comment">-- 'ChainDB.cdbVolValidation' fields.</span><span>
</span><span id="line-310"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk
</span><a href="#local-6989586621680032276"><span class="hs-identifier hs-var">llrnCustomiseChainDbArgs</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDbArgs Identity m blk
</span><a href="#local-6989586621680032248"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-311"></span><span>                  </span><span class="annot"><span class="annottext">cdbImmutableDbValidation :: ValidationPolicy
</span><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#cdbImmutableDbValidation"><span class="hs-identifier hs-var">ChainDB.cdbImmutableDbValidation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ValidationPolicy
</span><a href="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Types.html#ValidateAllChunks"><span class="hs-identifier hs-var">ValidateAllChunks</span></a></span><span>
</span><span id="line-312"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cdbVolatileDbValidation :: BlockValidationPolicy
</span><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#cdbVolatileDbValidation"><span class="hs-identifier hs-var">ChainDB.cdbVolatileDbValidation</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockValidationPolicy
</span><a href="Ouroboros.Consensus.Storage.VolatileDB.Impl.Types.html#ValidateAll"><span class="hs-identifier hs-var">ValidateAll</span></a></span><span>
</span><span id="line-313"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span>      </span><span id="local-6989586621680032243"><span class="annot"><span class="annottext">ChainDB m blk
</span><a href="#local-6989586621680032243"><span class="hs-identifier hs-var">chainDB</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ResourceRegistry m
-&gt; CheckInFuture m blk
-&gt; TopLevelConfig blk
-&gt; ExtLedgerState blk
-&gt; ChainDbArgs Defaults m blk
-&gt; (ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk)
-&gt; m (ChainDB m blk)
forall (m :: * -&gt; *) blk.
(RunNode blk, IOLike m) =&gt;
ResourceRegistry m
-&gt; CheckInFuture m blk
-&gt; TopLevelConfig blk
-&gt; ExtLedgerState blk
-&gt; ChainDbArgs Defaults m blk
-&gt; (ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk)
-&gt; m (ChainDB m blk)
</span><a href="Ouroboros.Consensus.Node.html#openChainDB"><span class="hs-identifier hs-var">openChainDB</span></a></span><span> </span><span class="annot"><span class="annottext">ResourceRegistry m
</span><a href="#local-6989586621680032260"><span class="hs-identifier hs-var">registry</span></a></span><span> </span><span class="annot"><span class="annottext">CheckInFuture m blk
</span><a href="#local-6989586621680032252"><span class="hs-identifier hs-var">inFuture</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032256"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">ExtLedgerState blk
</span><a href="#local-6989586621680032242"><span class="hs-identifier hs-var">initLedger</span></a></span><span>
</span><span id="line-316"></span><span>                </span><span class="annot"><span class="annottext">ChainDbArgs Defaults m blk
</span><a href="#local-6989586621680032277"><span class="hs-identifier hs-var">llrnChainDbArgsDefaults</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk
</span><a href="#local-6989586621680032249"><span class="hs-identifier hs-var">customiseChainDbArgs'</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>      </span><span class="annot"><span class="annottext">ChainDB m blk -&gt; m () -&gt; m ()
</span><a href="#local-6989586621680032262"><span class="hs-identifier hs-var">continueWithCleanChainDB</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDB m blk
</span><a href="#local-6989586621680032243"><span class="hs-identifier hs-var">chainDB</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>        </span><span id="local-6989586621680032241"><span class="annot"><span class="annottext">BlockchainTime m
</span><a href="#local-6989586621680032241"><span class="hs-identifier hs-var">btime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-320"></span><span>          </span><span class="annot"><span class="annottext">HardForkBlockchainTimeArgs m blk -&gt; m (BlockchainTime m)
forall (m :: * -&gt; *) blk.
(IOLike m, HasHardForkHistory blk, HasCallStack) =&gt;
HardForkBlockchainTimeArgs m blk -&gt; m (BlockchainTime m)
</span><a href="Ouroboros.Consensus.BlockchainTime.WallClock.HardFork.html#hardForkBlockchainTime"><span class="hs-identifier hs-var">hardForkBlockchainTime</span></a></span><span> </span><span class="annot"><span class="annottext">(HardForkBlockchainTimeArgs m blk -&gt; m (BlockchainTime m))
-&gt; HardForkBlockchainTimeArgs m blk -&gt; m (BlockchainTime m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-321"></span><span>          </span><span class="annot"><span class="annottext">HardForkBlockchainTimeArgs m blk
-&gt; HardForkBlockchainTimeArgs m blk
</span><a href="#local-6989586621680032272"><span class="hs-identifier hs-var">llrnCustomiseHardForkBlockchainTimeArgs</span></a></span><span> </span><span class="annot"><span class="annottext">(HardForkBlockchainTimeArgs m blk
 -&gt; HardForkBlockchainTimeArgs m blk)
-&gt; HardForkBlockchainTimeArgs m blk
-&gt; HardForkBlockchainTimeArgs m blk
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-322"></span><span>          </span><span class="annot"><span class="annottext">HardForkBlockchainTimeArgs :: forall (m :: * -&gt; *) blk.
m BackoffDelay
-&gt; STM m (LedgerState blk)
-&gt; LedgerConfig blk
-&gt; ResourceRegistry m
-&gt; SystemTime m
-&gt; Tracer m (TraceBlockchainTimeEvent RelativeTime)
-&gt; NominalDiffTime
-&gt; HardForkBlockchainTimeArgs m blk
</span><a href="Ouroboros.Consensus.BlockchainTime.WallClock.HardFork.html#HardForkBlockchainTimeArgs"><span class="hs-identifier hs-type">HardForkBlockchainTimeArgs</span></a></span><span>
</span><span id="line-323"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hfbtBackoffDelay :: m BackoffDelay
</span><a href="Ouroboros.Consensus.BlockchainTime.WallClock.HardFork.html#hfbtBackoffDelay"><span class="hs-identifier hs-var">hfbtBackoffDelay</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BackoffDelay -&gt; m BackoffDelay
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(BackoffDelay -&gt; m BackoffDelay) -&gt; BackoffDelay -&gt; m BackoffDelay
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; BackoffDelay
</span><a href="Ouroboros.Consensus.BlockchainTime.WallClock.HardFork.html#BackoffDelay"><span class="hs-identifier hs-var">BackoffDelay</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">60</span></span><span>
</span><span id="line-324"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hfbtGetLedgerState :: STM m (LedgerState blk)
</span><a href="Ouroboros.Consensus.BlockchainTime.WallClock.HardFork.html#hfbtGetLedgerState"><span class="hs-identifier hs-var">hfbtGetLedgerState</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-325"></span><span>                </span><span class="annot"><span class="annottext">ExtLedgerState blk -&gt; LedgerState blk
forall blk. ExtLedgerState blk -&gt; LedgerState blk
</span><a href="Ouroboros.Consensus.Ledger.Extended.html#ledgerState"><span class="hs-identifier hs-var hs-var">ledgerState</span></a></span><span> </span><span class="annot"><span class="annottext">(ExtLedgerState blk -&gt; LedgerState blk)
-&gt; STM m (ExtLedgerState blk) -&gt; STM m (LedgerState blk)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDB m blk -&gt; STM m (ExtLedgerState blk)
forall (m :: * -&gt; *) blk.
(Monad (STM m), IsLedger (LedgerState blk)) =&gt;
ChainDB m blk -&gt; STM m (ExtLedgerState blk)
</span><a href="Ouroboros.Consensus.Storage.ChainDB.API.html#getCurrentLedger"><span class="hs-identifier hs-var">ChainDB.getCurrentLedger</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDB m blk
</span><a href="#local-6989586621680032243"><span class="hs-identifier hs-var">chainDB</span></a></span><span>
</span><span id="line-326"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hfbtLedgerConfig :: LedgerConfig blk
</span><a href="Ouroboros.Consensus.BlockchainTime.WallClock.HardFork.html#hfbtLedgerConfig"><span class="hs-identifier hs-var">hfbtLedgerConfig</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk -&gt; LedgerConfig blk
forall blk. TopLevelConfig blk -&gt; LedgerConfig blk
</span><a href="Ouroboros.Consensus.Config.html#configLedger"><span class="hs-identifier hs-var">configLedger</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032256"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-327"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hfbtRegistry :: ResourceRegistry m
</span><a href="Ouroboros.Consensus.BlockchainTime.WallClock.HardFork.html#hfbtRegistry"><span class="hs-identifier hs-var">hfbtRegistry</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResourceRegistry m
</span><a href="#local-6989586621680032260"><span class="hs-identifier hs-var">registry</span></a></span><span>
</span><span id="line-328"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hfbtSystemTime :: SystemTime m
</span><a href="Ouroboros.Consensus.BlockchainTime.WallClock.HardFork.html#hfbtSystemTime"><span class="hs-identifier hs-var">hfbtSystemTime</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SystemTime m
</span><a href="#local-6989586621680032255"><span class="hs-identifier hs-var">systemTime</span></a></span><span>
</span><span id="line-329"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hfbtTracer :: Tracer m (TraceBlockchainTimeEvent RelativeTime)
</span><a href="Ouroboros.Consensus.BlockchainTime.WallClock.HardFork.html#hfbtTracer"><span class="hs-identifier hs-var">hfbtTracer</span></a></span><span>         </span><span class="hs-glyph">=</span><span>
</span><span id="line-330"></span><span>                </span><span class="annot"><span class="annottext">(TraceBlockchainTimeEvent RelativeTime
 -&gt; TraceBlockchainTimeEvent UTCTime)
-&gt; Tracer m (TraceBlockchainTimeEvent UTCTime)
-&gt; Tracer m (TraceBlockchainTimeEvent RelativeTime)
forall (f :: * -&gt; *) a b. Contravariant f =&gt; (a -&gt; b) -&gt; f b -&gt; f a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">contramap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RelativeTime -&gt; UTCTime)
-&gt; TraceBlockchainTimeEvent RelativeTime
-&gt; TraceBlockchainTimeEvent UTCTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SystemStart -&gt; RelativeTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">fromRelativeTime</span></span><span> </span><span class="annot"><span class="annottext">SystemStart
</span><a href="#local-6989586621680032259"><span class="hs-identifier hs-var">systemStart</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; Tracer m (TraceBlockchainTimeEvent UTCTime)
forall remotePeer localPeer blk (f :: * -&gt; *).
Tracers' remotePeer localPeer blk f
-&gt; f (TraceBlockchainTimeEvent UTCTime)
</span><a href="Ouroboros.Consensus.Node.Tracers.html#blockchainTimeTracer"><span class="hs-identifier hs-var hs-var">blockchainTimeTracer</span></a></span><span> </span><span class="annot"><span class="annottext">Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032284"><span class="hs-identifier hs-var">rnTraceConsensus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hfbtMaxClockRewind :: NominalDiffTime
</span><a href="Ouroboros.Consensus.BlockchainTime.WallClock.HardFork.html#hfbtMaxClockRewind"><span class="hs-identifier hs-var">hfbtMaxClockRewind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; NominalDiffTime
</span><a href="Ouroboros.Consensus.Util.Time.html#secondsToNominalDiffTime"><span class="hs-identifier hs-var">secondsToNominalDiffTime</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span>
</span><span id="line-333"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span>        </span><span id="local-6989586621680032226"><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032226"><span class="hs-identifier hs-var">nodeKernelArgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-336"></span><span>            </span><span class="annot"><span class="annottext">(NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
 -&gt; NodeKernelArgs
      m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
-&gt; m (NodeKernelArgs
        m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
-&gt; m (NodeKernelArgs
        m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
forall (m :: * -&gt; *) addrNTN addrNTC blk.
NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="Ouroboros.Consensus.Node.html#nodeKernelArgsEnforceInvariants"><span class="hs-identifier hs-var">nodeKernelArgsEnforceInvariants</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
 -&gt; NodeKernelArgs
      m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
-&gt; (NodeKernelArgs
      m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
    -&gt; NodeKernelArgs
         m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032275"><span class="hs-identifier hs-var">llrnCustomiseNodeKernelArgs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (NodeKernelArgs
      m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
 -&gt; m (NodeKernelArgs
         m (ConnectionId addrNTN) (ConnectionId addrNTC) blk))
-&gt; m (NodeKernelArgs
        m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
-&gt; m (NodeKernelArgs
        m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-337"></span><span>            </span><span class="annot"><span class="annottext">ResourceRegistry m
-&gt; Int
-&gt; StdGen
-&gt; TopLevelConfig blk
-&gt; m [BlockForging m blk]
-&gt; Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; BlockchainTime m
-&gt; ChainDB m blk
-&gt; m (NodeKernelArgs
        m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
forall (m :: * -&gt; *) addrNTN addrNTC blk.
(RunNode blk, IOLike m) =&gt;
ResourceRegistry m
-&gt; Int
-&gt; StdGen
-&gt; TopLevelConfig blk
-&gt; m [BlockForging m blk]
-&gt; Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; BlockchainTime m
-&gt; ChainDB m blk
-&gt; m (NodeKernelArgs
        m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
</span><a href="Ouroboros.Consensus.Node.html#mkNodeKernelArgs"><span class="hs-identifier hs-var">mkNodeKernelArgs</span></a></span><span>
</span><span id="line-338"></span><span>              </span><span class="annot"><span class="annottext">ResourceRegistry m
</span><a href="#local-6989586621680032260"><span class="hs-identifier hs-var">registry</span></a></span><span>
</span><span id="line-339"></span><span>              </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680032274"><span class="hs-identifier hs-var">llrnBfcSalt</span></a></span><span>
</span><span id="line-340"></span><span>              </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621680032273"><span class="hs-identifier hs-var">llrnKeepAliveRng</span></a></span><span>
</span><span id="line-341"></span><span>              </span><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032256"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-342"></span><span>              </span><span class="annot"><span class="annottext">m [BlockForging m blk]
</span><a href="#local-6989586621680032224"><span class="hs-identifier hs-var">blockForging</span></a></span><span>
</span><span id="line-343"></span><span>              </span><span class="annot"><span class="annottext">Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032284"><span class="hs-identifier hs-var">rnTraceConsensus</span></a></span><span>
</span><span id="line-344"></span><span>              </span><span class="annot"><span class="annottext">BlockchainTime m
</span><a href="#local-6989586621680032241"><span class="hs-identifier hs-var">btime</span></a></span><span>
</span><span id="line-345"></span><span>              </span><span class="annot"><span class="annottext">ChainDB m blk
</span><a href="#local-6989586621680032243"><span class="hs-identifier hs-var">chainDB</span></a></span><span>
</span><span id="line-346"></span><span>        </span><span id="local-6989586621680032223"><span class="annot"><span class="annottext">NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032223"><span class="hs-identifier hs-var">nodeKernel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; m (NodeKernel
        m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
forall (m :: * -&gt; *) remotePeer localPeer blk.
(IOLike m, RunNode blk, NoThunks remotePeer, Ord remotePeer,
 Hashable remotePeer) =&gt;
NodeKernelArgs m remotePeer localPeer blk
-&gt; m (NodeKernel m remotePeer localPeer blk)
</span><a href="Ouroboros.Consensus.NodeKernel.html#initNodeKernel"><span class="hs-identifier hs-var">initNodeKernel</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032226"><span class="hs-identifier hs-var">nodeKernelArgs</span></a></span><span>
</span><span id="line-347"></span><span>        </span><span class="annot"><span class="annottext">ResourceRegistry m
-&gt; NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; m ()
</span><a href="#local-6989586621680032280"><span class="hs-identifier hs-var">rnNodeKernelHook</span></a></span><span> </span><span class="annot"><span class="annottext">ResourceRegistry m
</span><a href="#local-6989586621680032260"><span class="hs-identifier hs-var">registry</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032223"><span class="hs-identifier hs-var">nodeKernel</span></a></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span>        </span><span id="local-6989586621680032221"><span class="annot"><span class="annottext">PeerMetrics m addrNTN
</span><a href="#local-6989586621680032221"><span class="hs-identifier hs-var">peerMetrics</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (PeerMetrics m addrNTN)
forall (m :: * -&gt; *) p. MonadSTM m =&gt; m (PeerMetrics m p)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">newPeerMetric</span></a></span><span>
</span><span id="line-350"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680032220"><span class="annot"><span class="annottext">ntnApps :: BlockNodeToNodeVersion blk
-&gt; Apps
     m
     (ConnectionId addrNTN)
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ()
</span><a href="#local-6989586621680032220"><span class="hs-identifier hs-var hs-var">ntnApps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; PeerMetrics m addrNTN
-&gt; BlockNodeToNodeVersion blk
-&gt; Apps
     m
     (ConnectionId addrNTN)
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ()
</span><a href="#local-6989586621680032219"><span class="hs-identifier hs-var">mkNodeToNodeApps</span></a></span><span>   </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032226"><span class="hs-identifier hs-var">nodeKernelArgs</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032223"><span class="hs-identifier hs-var">nodeKernel</span></a></span><span> </span><span class="annot"><span class="annottext">PeerMetrics m addrNTN
</span><a href="#local-6989586621680032221"><span class="hs-identifier hs-var">peerMetrics</span></a></span><span>
</span><span id="line-351"></span><span>            </span><span id="local-6989586621680032218"><span class="annot"><span class="annottext">ntcApps :: BlockNodeToClientVersion blk
-&gt; NodeToClientVersion
-&gt; Apps
     m
     (ConnectionId addrNTC)
     ByteString
     ByteString
     ByteString
     ByteString
     ()
</span><a href="#local-6989586621680032218"><span class="hs-identifier hs-var hs-var">ntcApps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; BlockNodeToClientVersion blk
-&gt; NodeToClientVersion
-&gt; Apps
     m
     (ConnectionId addrNTC)
     ByteString
     ByteString
     ByteString
     ByteString
     ()
</span><a href="#local-6989586621680032217"><span class="hs-identifier hs-var">mkNodeToClientApps</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032226"><span class="hs-identifier hs-var">nodeKernelArgs</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032223"><span class="hs-identifier hs-var">nodeKernel</span></a></span><span>
</span><span id="line-352"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680032216"><span class="annot"><span class="annottext">Applications
  addrNTN
  NodeToNodeVersion
  versionDataNTN
  addrNTC
  NodeToClientVersion
  versionDataNTC
  m
</span><a href="#local-6989586621680032216"><span class="hs-identifier hs-var">apps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680032215"><span class="annot"><span class="annottext">ExtraApplications p2p addrNTN m
</span><a href="#local-6989586621680032215"><span class="hs-identifier hs-var">appsExtra</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkP2PMode p2p
-&gt; MiniProtocolParameters
-&gt; (BlockNodeToNodeVersion blk
    -&gt; Apps
         m
         (ConnectionId addrNTN)
         ByteString
         ByteString
         ByteString
         ByteString
         ByteString
         ())
-&gt; (BlockNodeToClientVersion blk
    -&gt; NodeToClientVersion
    -&gt; Apps
         m
         (ConnectionId addrNTC)
         ByteString
         ByteString
         ByteString
         ByteString
         ())
-&gt; NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; PeerMetrics m addrNTN
-&gt; (Applications
      addrNTN
      NodeToNodeVersion
      versionDataNTN
      addrNTC
      NodeToClientVersion
      versionDataNTC
      m,
    ExtraApplications p2p addrNTN m)
forall remotePeer localPeer.
NetworkP2PMode p2p
-&gt; MiniProtocolParameters
-&gt; (BlockNodeToNodeVersion blk
    -&gt; Apps
         m
         (ConnectionId addrNTN)
         ByteString
         ByteString
         ByteString
         ByteString
         ByteString
         ())
-&gt; (BlockNodeToClientVersion blk
    -&gt; NodeToClientVersion
    -&gt; Apps
         m
         (ConnectionId addrNTC)
         ByteString
         ByteString
         ByteString
         ByteString
         ())
-&gt; NodeKernel m remotePeer localPeer blk
-&gt; PeerMetrics m addrNTN
-&gt; (Applications
      addrNTN
      NodeToNodeVersion
      versionDataNTN
      addrNTC
      NodeToClientVersion
      versionDataNTC
      m,
    ExtraApplications p2p addrNTN m)
</span><a href="#local-6989586621680032214"><span class="hs-identifier hs-var">mkDiffusionApplications</span></a></span><span>
</span><span id="line-353"></span><span>                                      </span><span class="annot"><span class="annottext">NetworkP2PMode p2p
</span><a href="#local-6989586621680032279"><span class="hs-identifier hs-var">rnEnableP2P</span></a></span><span>
</span><span id="line-354"></span><span>                                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; MiniProtocolParameters
forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk -&gt; MiniProtocolParameters
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AminiProtocolParameters%3ANodeKernelArgs"><span class="hs-identifier hs-var hs-var">miniProtocolParameters</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032226"><span class="hs-identifier hs-var">nodeKernelArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>                                      </span><span class="annot"><span class="annottext">BlockNodeToNodeVersion blk
-&gt; Apps
     m
     (ConnectionId addrNTN)
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ()
</span><a href="#local-6989586621680032220"><span class="hs-identifier hs-var">ntnApps</span></a></span><span>
</span><span id="line-356"></span><span>                                      </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
-&gt; NodeToClientVersion
-&gt; Apps
     m
     (ConnectionId addrNTC)
     ByteString
     ByteString
     ByteString
     ByteString
     ()
</span><a href="#local-6989586621680032218"><span class="hs-identifier hs-var">ntcApps</span></a></span><span>
</span><span id="line-357"></span><span>                                      </span><span class="annot"><span class="annottext">NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032223"><span class="hs-identifier hs-var">nodeKernel</span></a></span><span>
</span><span id="line-358"></span><span>                                      </span><span class="annot"><span class="annottext">PeerMetrics m addrNTN
</span><a href="#local-6989586621680032221"><span class="hs-identifier hs-var">peerMetrics</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>        </span><span class="annot"><span class="annottext">ResourceRegistry m
-&gt; Applications
     addrNTN
     NodeToNodeVersion
     versionDataNTN
     addrNTC
     NodeToClientVersion
     versionDataNTC
     m
-&gt; ExtraApplications p2p addrNTN m
-&gt; m ()
</span><a href="#local-6989586621680032270"><span class="hs-identifier hs-var">llrnRunDataDiffusion</span></a></span><span> </span><span class="annot"><span class="annottext">ResourceRegistry m
</span><a href="#local-6989586621680032260"><span class="hs-identifier hs-var">registry</span></a></span><span> </span><span class="annot"><span class="annottext">Applications
  addrNTN
  NodeToNodeVersion
  versionDataNTN
  addrNTC
  NodeToClientVersion
  versionDataNTC
  m
</span><a href="#local-6989586621680032216"><span class="hs-identifier hs-var">apps</span></a></span><span> </span><span class="annot"><span class="annottext">ExtraApplications p2p addrNTN m
</span><a href="#local-6989586621680032215"><span class="hs-identifier hs-var">appsExtra</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-362"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Node.ProtocolInfo.html#ProtocolInfo"><span class="hs-identifier hs-type">ProtocolInfo</span></a></span><span>
</span><span id="line-363"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">pInfoConfig :: forall (m :: * -&gt; *) b. ProtocolInfo m b -&gt; TopLevelConfig b
</span><a href="Ouroboros.Consensus.Node.ProtocolInfo.html#pInfoConfig"><span class="hs-identifier hs-var">pInfoConfig</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680032256"><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032256"><span class="hs-identifier hs-var">cfg</span></a></span></span><span>
</span><span id="line-364"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pInfoInitLedger :: forall (m :: * -&gt; *) b. ProtocolInfo m b -&gt; ExtLedgerState b
</span><a href="Ouroboros.Consensus.Node.ProtocolInfo.html#pInfoInitLedger"><span class="hs-identifier hs-var">pInfoInitLedger</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680032242"><span class="annot"><span class="annottext">ExtLedgerState blk
</span><a href="#local-6989586621680032242"><span class="hs-identifier hs-var">initLedger</span></a></span></span><span>
</span><span id="line-365"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pInfoBlockForging :: forall (m :: * -&gt; *) b. ProtocolInfo m b -&gt; m [BlockForging m b]
</span><a href="Ouroboros.Consensus.Node.ProtocolInfo.html#pInfoBlockForging"><span class="hs-identifier hs-var">pInfoBlockForging</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680032224"><span class="annot"><span class="annottext">m [BlockForging m blk]
</span><a href="#local-6989586621680032224"><span class="hs-identifier hs-var">blockForging</span></a></span></span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProtocolInfo m blk
</span><a href="#local-6989586621680032281"><span class="hs-identifier hs-var">rnProtocolInfo</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><a href="#local-6989586621680032208"><span class="hs-identifier hs-type">codecConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Block.Abstract.html#CodecConfig"><span class="hs-identifier hs-type">CodecConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-369"></span><span>    </span><span id="local-6989586621680032208"><span class="annot"><span class="annottext">codecConfig :: CodecConfig blk
</span><a href="#local-6989586621680032208"><span class="hs-identifier hs-var hs-var">codecConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk -&gt; CodecConfig blk
forall blk. TopLevelConfig blk -&gt; CodecConfig blk
</span><a href="Ouroboros.Consensus.Config.html#configCodec"><span class="hs-identifier hs-var">configCodec</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032256"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><a href="#local-6989586621680032219"><span class="hs-identifier hs-type">mkNodeToNodeApps</span></a></span><span>
</span><span id="line-372"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032776"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-373"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernel"><span class="hs-identifier hs-type">NodeKernel</span></a></span><span>     </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032776"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">PeerMetrics</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span>
</span><span id="line-375"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToNodeVersion"><span class="hs-identifier hs-type">BlockNodeToNodeVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-376"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToNode.html#Apps"><span class="hs-identifier hs-type">NTN.Apps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-377"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>          </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-379"></span><span>          </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-380"></span><span>          </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-381"></span><span>          </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-382"></span><span>          </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-383"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621680032219"><span class="annot"><span class="annottext">mkNodeToNodeApps :: NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; PeerMetrics m addrNTN
-&gt; BlockNodeToNodeVersion blk
-&gt; Apps
     m
     (ConnectionId addrNTN)
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ()
</span><a href="#local-6989586621680032219"><span class="hs-identifier hs-var hs-var">mkNodeToNodeApps</span></a></span></span><span> </span><span id="local-6989586621680032206"><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032206"><span class="hs-identifier hs-var">nodeKernelArgs</span></a></span></span><span> </span><span id="local-6989586621680032205"><span class="annot"><span class="annottext">NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032205"><span class="hs-identifier hs-var">nodeKernel</span></a></span></span><span> </span><span id="local-6989586621680032204"><span class="annot"><span class="annottext">PeerMetrics m addrNTN
</span><a href="#local-6989586621680032204"><span class="hs-identifier hs-var">peerMetrics</span></a></span></span><span> </span><span id="local-6989586621680032203"><span class="annot"><span class="annottext">BlockNodeToNodeVersion blk
</span><a href="#local-6989586621680032203"><span class="hs-identifier hs-var">version</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>        </span><span class="annot"><span class="annottext">NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; Tracers m (ConnectionId addrNTN) blk DeserialiseFailure
-&gt; (NodeToNodeVersion
    -&gt; Codecs
         blk
         DeserialiseFailure
         m
         ByteString
         ByteString
         ByteString
         ByteString
         ByteString
         ByteString
         ByteString)
-&gt; ByteLimits
     ByteString ByteString ByteString ByteString ByteString
-&gt; m ChainSyncTimeout
-&gt; ReportPeerMetrics m (ConnectionId addrNTN)
-&gt; Handlers m (ConnectionId addrNTN) blk
-&gt; Apps
     m
     (ConnectionId addrNTN)
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ()
forall (m :: * -&gt; *) remotePeer localPeer blk e bCS bBF bTX bTX2
       bKA.
(IOLike m, MonadTimer m, Ord remotePeer, Exception e,
 LedgerSupportsProtocol blk, ShowProxy blk, ShowProxy (Header blk),
 ShowProxy (TxId (GenTx blk)), ShowProxy (GenTx blk)) =&gt;
NodeKernel m remotePeer localPeer blk
-&gt; Tracers m remotePeer blk e
-&gt; (NodeToNodeVersion
    -&gt; Codecs blk e m bCS bCS bBF bBF bTX bTX2 bKA)
-&gt; ByteLimits bCS bBF bTX bTX2 bKA
-&gt; m ChainSyncTimeout
-&gt; ReportPeerMetrics m remotePeer
-&gt; Handlers m remotePeer blk
-&gt; Apps m remotePeer bCS bBF bTX bTX2 bKA ()
</span><a href="Ouroboros.Consensus.Network.NodeToNode.html#mkApps"><span class="hs-identifier hs-var">NTN.mkApps</span></a></span><span>
</span><span id="line-386"></span><span>          </span><span class="annot"><span class="annottext">NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032205"><span class="hs-identifier hs-var">nodeKernel</span></a></span><span>
</span><span id="line-387"></span><span>          </span><span class="annot"><span class="annottext">Tracers m (ConnectionId addrNTN) blk DeserialiseFailure
</span><a href="#local-6989586621680032283"><span class="hs-identifier hs-var">rnTraceNTN</span></a></span><span>
</span><span id="line-388"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig blk
-&gt; BlockNodeToNodeVersion blk
-&gt; NodeToNodeVersion
-&gt; Codecs
     blk
     DeserialiseFailure
     m
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
forall (m :: * -&gt; *) blk.
(IOLike m, SerialiseNodeToNodeConstraints blk,
 ShowProxy (GenTxId blk), ShowProxy (GenTx blk)) =&gt;
CodecConfig blk
-&gt; BlockNodeToNodeVersion blk
-&gt; NodeToNodeVersion
-&gt; Codecs
     blk
     DeserialiseFailure
     m
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
</span><a href="Ouroboros.Consensus.Network.NodeToNode.html#defaultCodecs"><span class="hs-identifier hs-var">NTN.defaultCodecs</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680032208"><span class="hs-identifier hs-var">codecConfig</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToNodeVersion blk
</span><a href="#local-6989586621680032203"><span class="hs-identifier hs-var">version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>          </span><span class="annot"><span class="annottext">ByteLimits ByteString ByteString ByteString ByteString ByteString
</span><a href="Ouroboros.Consensus.Network.NodeToNode.html#byteLimits"><span class="hs-identifier hs-var">NTN.byteLimits</span></a></span><span>
</span><span id="line-390"></span><span>          </span><span class="annot"><span class="annottext">m ChainSyncTimeout
</span><a href="#local-6989586621680032271"><span class="hs-identifier hs-var">llrnChainSyncTimeout</span></a></span><span>
</span><span id="line-391"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PeerMetrics m addrNTN -&gt; ReportPeerMetrics m (ConnectionId addrNTN)
forall (m :: * -&gt; *) p.
MonadSTM m =&gt;
PeerMetrics m p -&gt; ReportPeerMetrics m (ConnectionId p)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">reportMetric</span></a></span><span> </span><span class="annot"><span class="annottext">PeerMetrics m addrNTN
</span><a href="#local-6989586621680032204"><span class="hs-identifier hs-var">peerMetrics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; Handlers m (ConnectionId addrNTN) blk
forall (m :: * -&gt; *) blk remotePeer localPeer.
(IOLike m, MonadTime m, MonadTimer m, LedgerSupportsMempool blk,
 HasTxId (GenTx blk), LedgerSupportsProtocol blk, Ord remotePeer) =&gt;
NodeKernelArgs m remotePeer localPeer blk
-&gt; NodeKernel m remotePeer localPeer blk
-&gt; Handlers m remotePeer blk
</span><a href="Ouroboros.Consensus.Network.NodeToNode.html#mkHandlers"><span class="hs-identifier hs-var">NTN.mkHandlers</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032206"><span class="hs-identifier hs-var">nodeKernelArgs</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032205"><span class="hs-identifier hs-var">nodeKernel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><a href="#local-6989586621680032217"><span class="hs-identifier hs-type">mkNodeToClientApps</span></a></span><span>
</span><span id="line-395"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032776"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-396"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernel"><span class="hs-identifier hs-type">NodeKernel</span></a></span><span>     </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032776"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-397"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToClientVersion"><span class="hs-identifier hs-type">BlockNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-398"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientVersion</span></a></span><span>
</span><span id="line-399"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Apps"><span class="hs-identifier hs-type">NTC.Apps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032776"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>    </span><span id="local-6989586621680032217"><span class="annot"><span class="annottext">mkNodeToClientApps :: NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; BlockNodeToClientVersion blk
-&gt; NodeToClientVersion
-&gt; Apps
     m
     (ConnectionId addrNTC)
     ByteString
     ByteString
     ByteString
     ByteString
     ()
</span><a href="#local-6989586621680032217"><span class="hs-identifier hs-var hs-var">mkNodeToClientApps</span></a></span></span><span> </span><span id="local-6989586621680032198"><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032198"><span class="hs-identifier hs-var">nodeKernelArgs</span></a></span></span><span> </span><span id="local-6989586621680032197"><span class="annot"><span class="annottext">NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032197"><span class="hs-identifier hs-var">nodeKernel</span></a></span></span><span> </span><span id="local-6989586621680032196"><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680032196"><span class="hs-identifier hs-var">blockVersion</span></a></span></span><span> </span><span id="local-6989586621680032195"><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680032195"><span class="hs-identifier hs-var">networkVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-401"></span><span>        </span><span class="annot"><span class="annottext">NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; Tracers m (ConnectionId addrNTC) blk DeserialiseFailure
-&gt; Codecs
     blk
     DeserialiseFailure
     m
     ByteString
     ByteString
     ByteString
     ByteString
-&gt; Handlers m (ConnectionId addrNTC) blk
-&gt; Apps
     m
     (ConnectionId addrNTC)
     ByteString
     ByteString
     ByteString
     ByteString
     ()
forall (m :: * -&gt; *) remotePeer localPeer blk e bCS bTX bSQ bTM.
(IOLike m, Exception e, ShowProxy blk, ShowProxy (ApplyTxErr blk),
 ShowProxy (BlockQuery blk), ShowProxy (GenTx blk),
 ShowProxy (GenTxId blk), ShowQuery (BlockQuery blk)) =&gt;
NodeKernel m remotePeer localPeer blk
-&gt; Tracers m localPeer blk e
-&gt; Codecs blk e m bCS bTX bSQ bTM
-&gt; Handlers m localPeer blk
-&gt; Apps m localPeer bCS bTX bSQ bTM ()
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#mkApps"><span class="hs-identifier hs-var">NTC.mkApps</span></a></span><span>
</span><span id="line-402"></span><span>          </span><span class="annot"><span class="annottext">NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032197"><span class="hs-identifier hs-var">nodeKernel</span></a></span><span>
</span><span id="line-403"></span><span>          </span><span class="annot"><span class="annottext">Tracers m (ConnectionId addrNTC) blk DeserialiseFailure
</span><a href="#local-6989586621680032282"><span class="hs-identifier hs-var">rnTraceNTC</span></a></span><span>
</span><span id="line-404"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodecConfig blk
-&gt; BlockNodeToClientVersion blk
-&gt; NodeToClientVersion
-&gt; Codecs
     blk
     DeserialiseFailure
     m
     ByteString
     ByteString
     ByteString
     ByteString
forall (m :: * -&gt; *) blk.
(MonadST m, SerialiseNodeToClientConstraints blk,
 ShowQuery (BlockQuery blk), StandardHash blk,
 Serialise (HeaderHash blk)) =&gt;
CodecConfig blk
-&gt; BlockNodeToClientVersion blk
-&gt; NodeToClientVersion
-&gt; DefaultCodecs blk m
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#defaultCodecs"><span class="hs-identifier hs-var">NTC.defaultCodecs</span></a></span><span> </span><span class="annot"><span class="annottext">CodecConfig blk
</span><a href="#local-6989586621680032208"><span class="hs-identifier hs-var">codecConfig</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680032196"><span class="hs-identifier hs-var">blockVersion</span></a></span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680032195"><span class="hs-identifier hs-var">networkVersion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; Handlers m (ConnectionId addrNTC) blk
forall (m :: * -&gt; *) blk remotePeer localPeer.
(IOLike m, LedgerSupportsMempool blk, LedgerSupportsProtocol blk,
 QueryLedger blk, ConfigSupportsNode blk) =&gt;
NodeKernelArgs m remotePeer localPeer blk
-&gt; NodeKernel m remotePeer localPeer blk
-&gt; Handlers m localPeer blk
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#mkHandlers"><span class="hs-identifier hs-var">NTC.mkHandlers</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032198"><span class="hs-identifier hs-var">nodeKernelArgs</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernel m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032197"><span class="hs-identifier hs-var">nodeKernel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621680032666"><span id="local-6989586621680032667"><span class="annot"><a href="#local-6989586621680032214"><span class="hs-identifier hs-type">mkDiffusionApplications</span></a></span><span>
</span><span id="line-408"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#NetworkP2PMode"><span class="hs-identifier hs-type">NetworkP2PMode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032775"><span class="hs-identifier hs-type">p2p</span></a></span><span>
</span><span id="line-409"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">MiniProtocolParameters</span></a></span><span>
</span><span id="line-410"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span>   </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToNodeVersion"><span class="hs-identifier hs-type">BlockNodeToNodeVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-411"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToNode.html#Apps"><span class="hs-identifier hs-type">NTN.Apps</span></a></span><span>
</span><span id="line-412"></span><span>               </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-413"></span><span>               </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>               </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-415"></span><span>               </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-416"></span><span>               </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-417"></span><span>               </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-418"></span><span>               </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-419"></span><span>               </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span>   </span><span class="annot"><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#BlockNodeToClientVersion"><span class="hs-identifier hs-type">BlockNodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-422"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientVersion</span></a></span><span>
</span><span id="line-423"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Network.NodeToClient.html#Apps"><span class="hs-identifier hs-type">NTC.Apps</span></a></span><span>
</span><span id="line-424"></span><span>               </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032776"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernel"><span class="hs-identifier hs-type">NodeKernel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032667"><span class="hs-identifier hs-type">remotePeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032666"><span class="hs-identifier hs-type">localPeer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-427"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">PeerMetrics</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span>
</span><span id="line-428"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.Applications</span></a></span><span>
</span><span id="line-429"></span><span>             </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToNodeVersion</span></a></span><span>   </span><span class="annot"><a href="#local-6989586621680032774"><span class="hs-identifier hs-type">versionDataNTN</span></a></span><span>
</span><span id="line-430"></span><span>             </span><span class="annot"><a href="#local-6989586621680032776"><span class="hs-identifier hs-type">addrNTC</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032773"><span class="hs-identifier hs-type">versionDataNTC</span></a></span><span>
</span><span id="line-431"></span><span>             </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-432"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.ExtraApplications</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032775"><span class="hs-identifier hs-type">p2p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032778"><span class="hs-identifier hs-type">addrNTN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032782"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-433"></span><span>         </span><span class="hs-special">)</span></span></span><span>
</span><span id="line-434"></span><span>    </span><span id="local-6989586621680032214"><span class="annot"><span class="annottext">mkDiffusionApplications :: NetworkP2PMode p2p
-&gt; MiniProtocolParameters
-&gt; (BlockNodeToNodeVersion blk
    -&gt; Apps
         m
         (ConnectionId addrNTN)
         ByteString
         ByteString
         ByteString
         ByteString
         ByteString
         ())
-&gt; (BlockNodeToClientVersion blk
    -&gt; NodeToClientVersion
    -&gt; Apps
         m
         (ConnectionId addrNTC)
         ByteString
         ByteString
         ByteString
         ByteString
         ())
-&gt; NodeKernel m remotePeer localPeer blk
-&gt; PeerMetrics m addrNTN
-&gt; (Applications
      addrNTN
      NodeToNodeVersion
      versionDataNTN
      addrNTC
      NodeToClientVersion
      versionDataNTC
      m,
    ExtraApplications p2p addrNTN m)
</span><a href="#local-6989586621680032214"><span class="hs-identifier hs-var hs-var">mkDiffusionApplications</span></a></span></span><span>
</span><span id="line-435"></span><span>      </span><span id="local-6989586621680032191"><span class="annot"><span class="annottext">NetworkP2PMode p2p
</span><a href="#local-6989586621680032191"><span class="hs-identifier hs-var">enP2P</span></a></span></span><span>
</span><span id="line-436"></span><span>      </span><span id="local-6989586621680032190"><span class="annot"><span class="annottext">MiniProtocolParameters
</span><a href="#local-6989586621680032190"><span class="hs-identifier hs-var">miniProtocolParams</span></a></span></span><span>
</span><span id="line-437"></span><span>      </span><span id="local-6989586621680032189"><span class="annot"><span class="annottext">BlockNodeToNodeVersion blk
-&gt; Apps
     m
     (ConnectionId addrNTN)
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ()
</span><a href="#local-6989586621680032189"><span class="hs-identifier hs-var">ntnApps</span></a></span></span><span>
</span><span id="line-438"></span><span>      </span><span id="local-6989586621680032188"><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
-&gt; NodeToClientVersion
-&gt; Apps
     m
     (ConnectionId addrNTC)
     ByteString
     ByteString
     ByteString
     ByteString
     ()
</span><a href="#local-6989586621680032188"><span class="hs-identifier hs-var">ntcApps</span></a></span></span><span>
</span><span id="line-439"></span><span>      </span><span id="local-6989586621680032187"><span class="annot"><span class="annottext">NodeKernel m remotePeer localPeer blk
</span><a href="#local-6989586621680032187"><span class="hs-identifier hs-var">kernel</span></a></span></span><span>
</span><span id="line-440"></span><span>      </span><span id="local-6989586621680032186"><span class="annot"><span class="annottext">PeerMetrics m addrNTN
</span><a href="#local-6989586621680032186"><span class="hs-identifier hs-var">peerMetrics</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-441"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NetworkP2PMode p2p
</span><a href="#local-6989586621680032191"><span class="hs-identifier hs-var">enP2P</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-442"></span><span>        </span><span class="annot"><span class="annottext">NetworkP2PMode p2p
</span><a href="Ouroboros.Consensus.Node.html#EnabledP2PMode"><span class="hs-identifier hs-var">EnabledP2PMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-443"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Applications
  addrNTN
  NodeToNodeVersion
  versionDataNTN
  addrNTC
  NodeToClientVersion
  versionDataNTC
  m
</span><a href="#local-6989586621680032185"><span class="hs-identifier hs-var">apps</span></a></span><span>
</span><span id="line-444"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ApplicationsExtra addrNTN m -&gt; ExtraApplications 'P2P addrNTN m
forall ntnAddr (m :: * -&gt; *).
ApplicationsExtra ntnAddr m -&gt; ExtraApplications 'P2P ntnAddr m
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">Diffusion.P2PApplications</span></a></span><span>
</span><span id="line-445"></span><span>              </span><span class="annot"><span class="annottext">ApplicationsExtra :: forall ntnAddr (m :: * -&gt; *).
RethrowPolicy
-&gt; RethrowPolicy
-&gt; PeerMetrics m ntnAddr
-&gt; STM m FetchMode
-&gt; ApplicationsExtra ntnAddr m
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">P2P.ApplicationsExtra</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-446"></span><span>                </span><span class="annot"><span class="annottext">daRethrowPolicy :: RethrowPolicy
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">P2P.daRethrowPolicy</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy blk -&gt; RethrowPolicy
forall blk.
(Typeable blk, StandardHash blk) =&gt;
Proxy blk -&gt; RethrowPolicy
</span><a href="Ouroboros.Consensus.Node.RethrowPolicy.html#consensusRethrowPolicy"><span class="hs-identifier hs-var">consensusRethrowPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk
forall k (t :: k). Proxy t
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-447"></span><span>                </span><span class="annot"><span class="annottext">daLocalRethrowPolicy :: RethrowPolicy
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">P2P.daLocalRethrowPolicy</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RethrowPolicy
</span><a href="#local-6989586621680032178"><span class="hs-identifier hs-var">localRethrowPolicy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-448"></span><span>                </span><span class="annot"><span class="annottext">daPeerMetrics :: PeerMetrics m addrNTN
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">P2P.daPeerMetrics</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PeerMetrics m addrNTN
</span><a href="#local-6989586621680032186"><span class="hs-identifier hs-var">peerMetrics</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-449"></span><span>                </span><span class="annot"><span class="annottext">daBlockFetchMode :: STM m FetchMode
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">P2P.daBlockFetchMode</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeKernel m remotePeer localPeer blk -&gt; STM m FetchMode
forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernel m remotePeer localPeer blk -&gt; STM m FetchMode
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AgetFetchMode%3ANodeKernel"><span class="hs-identifier hs-var hs-var">getFetchMode</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernel m remotePeer localPeer blk
</span><a href="#local-6989586621680032187"><span class="hs-identifier hs-var">kernel</span></a></span><span>
</span><span id="line-450"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-451"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>        </span><span class="annot"><span class="annottext">NetworkP2PMode p2p
</span><a href="Ouroboros.Consensus.Node.html#DisabledP2PMode"><span class="hs-identifier hs-var">DisabledP2PMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-453"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Applications
  addrNTN
  NodeToNodeVersion
  versionDataNTN
  addrNTC
  NodeToClientVersion
  versionDataNTC
  m
</span><a href="#local-6989586621680032185"><span class="hs-identifier hs-var">apps</span></a></span><span>
</span><span id="line-454"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ApplicationsExtra -&gt; ExtraApplications 'NonP2P addrNTN m
forall ntnAddr (m :: * -&gt; *).
ApplicationsExtra -&gt; ExtraApplications 'NonP2P ntnAddr m
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">Diffusion.NonP2PApplications</span></a></span><span>
</span><span id="line-455"></span><span>              </span><span class="annot"><span class="annottext">ApplicationsExtra :: ErrorPolicies -&gt; ApplicationsExtra
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NonP2P.ApplicationsExtra</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-456"></span><span>                </span><span class="annot"><span class="annottext">daErrorPolicies :: ErrorPolicies
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">NonP2P.daErrorPolicies</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy blk -&gt; ErrorPolicies
forall blk.
(Typeable blk, StandardHash blk) =&gt;
Proxy blk -&gt; ErrorPolicies
</span><a href="Ouroboros.Consensus.Node.ErrorPolicy.html#consensusErrorPolicy"><span class="hs-identifier hs-var">consensusErrorPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk
forall k (t :: k). Proxy t
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680032783"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-458"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-460"></span><span>        </span><span id="local-6989586621680032185"><span class="annot"><span class="annottext">apps :: Applications
  addrNTN
  NodeToNodeVersion
  versionDataNTN
  addrNTC
  NodeToClientVersion
  versionDataNTC
  m
</span><a href="#local-6989586621680032185"><span class="hs-identifier hs-var hs-var">apps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Applications :: forall ntnAddr ntnVersion ntnVersionData ntcAddr ntcVersion
       ntcVersionData (m :: * -&gt; *).
Versions
  ntnVersion
  ntnVersionData
  (OuroborosBundle 'InitiatorMode ntnAddr ByteString m () Void)
-&gt; Versions
     ntnVersion
     ntnVersionData
     (OuroborosBundle
        'InitiatorResponderMode ntnAddr ByteString m () ())
-&gt; Versions
     ntcVersion
     ntcVersionData
     (OuroborosApplication 'ResponderMode ntcAddr ByteString m Void ())
-&gt; LedgerPeersConsensusInterface m
-&gt; Applications
     ntnAddr
     ntnVersion
     ntnVersionData
     ntcAddr
     ntcVersion
     ntcVersionData
     m
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.Applications</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-461"></span><span>            </span><span class="annot"><span class="annottext">daApplicationInitiatorMode :: Versions
  NodeToNodeVersion
  versionDataNTN
  (OuroborosBundle 'InitiatorMode addrNTN ByteString m () Void)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">Diffusion.daApplicationInitiatorMode</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-462"></span><span>              </span><span class="annot"><span class="annottext">[Versions
   NodeToNodeVersion
   versionDataNTN
   (OuroborosBundle 'InitiatorMode addrNTN ByteString m () Void)]
-&gt; Versions
     NodeToNodeVersion
     versionDataNTN
     (OuroborosBundle 'InitiatorMode addrNTN ByteString m () Void)
forall vNum (f :: * -&gt; *) extra r.
(Ord vNum, Foldable f, HasCallStack) =&gt;
f (Versions vNum extra r) -&gt; Versions vNum extra r
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">combineVersions</span></a></span><span>
</span><span id="line-463"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">NodeToNodeVersion
-&gt; versionDataNTN
-&gt; OuroborosBundle 'InitiatorMode addrNTN ByteString m () Void
-&gt; Versions
     NodeToNodeVersion
     versionDataNTN
     (OuroborosBundle 'InitiatorMode addrNTN ByteString m () Void)
forall vNum vData r. vNum -&gt; vData -&gt; r -&gt; Versions vNum vData r
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">simpleSingletonVersions</span></a></span><span>
</span><span id="line-464"></span><span>                    </span><span class="annot"><span class="annottext">NodeToNodeVersion
</span><a href="#local-6989586621680032168"><span class="hs-identifier hs-var">version</span></a></span><span>
</span><span id="line-465"></span><span>                    </span><span class="annot"><span class="annottext">versionDataNTN
</span><a href="#local-6989586621680032268"><span class="hs-identifier hs-var">llrnVersionDataNTN</span></a></span><span>
</span><span id="line-466"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MiniProtocolParameters
-&gt; NodeToNodeVersion
-&gt; Apps
     m
     (ConnectionId addrNTN)
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ()
-&gt; OuroborosBundle 'InitiatorMode addrNTN ByteString m () Void
forall (m :: * -&gt; *) peer b a.
MiniProtocolParameters
-&gt; NodeToNodeVersion
-&gt; Apps m (ConnectionId peer) b b b b b a
-&gt; OuroborosBundle 'InitiatorMode peer b m a Void
</span><a href="Ouroboros.Consensus.Network.NodeToNode.html#initiator"><span class="hs-identifier hs-var">NTN.initiator</span></a></span><span> </span><span class="annot"><span class="annottext">MiniProtocolParameters
</span><a href="#local-6989586621680032190"><span class="hs-identifier hs-var">miniProtocolParams</span></a></span><span> </span><span class="annot"><span class="annottext">NodeToNodeVersion
</span><a href="#local-6989586621680032168"><span class="hs-identifier hs-var">version</span></a></span><span>
</span><span id="line-467"></span><span>                      </span><span class="annot"><span class="annottext">(Apps
   m
   (ConnectionId addrNTN)
   ByteString
   ByteString
   ByteString
   ByteString
   ByteString
   ()
 -&gt; OuroborosBundle 'InitiatorMode addrNTN ByteString m () Void)
-&gt; Apps
     m
     (ConnectionId addrNTN)
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ()
-&gt; OuroborosBundle 'InitiatorMode addrNTN ByteString m () Void
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToNodeVersion blk
-&gt; Apps
     m
     (ConnectionId addrNTN)
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ()
</span><a href="#local-6989586621680032189"><span class="hs-identifier hs-var">ntnApps</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToNodeVersion blk
</span><a href="#local-6989586621680032166"><span class="hs-identifier hs-var">blockVersion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680032168"><span class="annot"><span class="annottext">NodeToNodeVersion
</span><a href="#local-6989586621680032168"><span class="hs-identifier hs-var">version</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680032166"><span class="annot"><span class="annottext">BlockNodeToNodeVersion blk
</span><a href="#local-6989586621680032166"><span class="hs-identifier hs-var">blockVersion</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
-&gt; [(NodeToNodeVersion, BlockNodeToNodeVersion blk)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
</span><a href="#local-6989586621680032267"><span class="hs-identifier hs-var">llrnNodeToNodeVersions</span></a></span><span>
</span><span id="line-469"></span><span>                </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-470"></span><span>            </span><span class="annot"><span class="annottext">daApplicationInitiatorResponderMode :: Versions
  NodeToNodeVersion
  versionDataNTN
  (OuroborosBundle
     'InitiatorResponderMode addrNTN ByteString m () ())
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">Diffusion.daApplicationInitiatorResponderMode</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-471"></span><span>              </span><span class="annot"><span class="annottext">[Versions
   NodeToNodeVersion
   versionDataNTN
   (OuroborosBundle
      'InitiatorResponderMode addrNTN ByteString m () ())]
-&gt; Versions
     NodeToNodeVersion
     versionDataNTN
     (OuroborosBundle
        'InitiatorResponderMode addrNTN ByteString m () ())
forall vNum (f :: * -&gt; *) extra r.
(Ord vNum, Foldable f, HasCallStack) =&gt;
f (Versions vNum extra r) -&gt; Versions vNum extra r
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">combineVersions</span></a></span><span>
</span><span id="line-472"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">NodeToNodeVersion
-&gt; versionDataNTN
-&gt; OuroborosBundle
     'InitiatorResponderMode addrNTN ByteString m () ()
-&gt; Versions
     NodeToNodeVersion
     versionDataNTN
     (OuroborosBundle
        'InitiatorResponderMode addrNTN ByteString m () ())
forall vNum vData r. vNum -&gt; vData -&gt; r -&gt; Versions vNum vData r
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">simpleSingletonVersions</span></a></span><span>
</span><span id="line-473"></span><span>                    </span><span class="annot"><span class="annottext">NodeToNodeVersion
</span><a href="#local-6989586621680032163"><span class="hs-identifier hs-var">version</span></a></span><span>
</span><span id="line-474"></span><span>                    </span><span class="annot"><span class="annottext">versionDataNTN
</span><a href="#local-6989586621680032268"><span class="hs-identifier hs-var">llrnVersionDataNTN</span></a></span><span>
</span><span id="line-475"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MiniProtocolParameters
-&gt; NodeToNodeVersion
-&gt; Apps
     m
     (ConnectionId addrNTN)
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ()
-&gt; OuroborosBundle
     'InitiatorResponderMode addrNTN ByteString m () ()
forall (m :: * -&gt; *) peer b a.
MiniProtocolParameters
-&gt; NodeToNodeVersion
-&gt; Apps m (ConnectionId peer) b b b b b a
-&gt; OuroborosBundle 'InitiatorResponderMode peer b m a a
</span><a href="Ouroboros.Consensus.Network.NodeToNode.html#initiatorAndResponder"><span class="hs-identifier hs-var">NTN.initiatorAndResponder</span></a></span><span> </span><span class="annot"><span class="annottext">MiniProtocolParameters
</span><a href="#local-6989586621680032190"><span class="hs-identifier hs-var">miniProtocolParams</span></a></span><span> </span><span class="annot"><span class="annottext">NodeToNodeVersion
</span><a href="#local-6989586621680032163"><span class="hs-identifier hs-var">version</span></a></span><span>
</span><span id="line-476"></span><span>                      </span><span class="annot"><span class="annottext">(Apps
   m
   (ConnectionId addrNTN)
   ByteString
   ByteString
   ByteString
   ByteString
   ByteString
   ()
 -&gt; OuroborosBundle
      'InitiatorResponderMode addrNTN ByteString m () ())
-&gt; Apps
     m
     (ConnectionId addrNTN)
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ()
-&gt; OuroborosBundle
     'InitiatorResponderMode addrNTN ByteString m () ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToNodeVersion blk
-&gt; Apps
     m
     (ConnectionId addrNTN)
     ByteString
     ByteString
     ByteString
     ByteString
     ByteString
     ()
</span><a href="#local-6989586621680032189"><span class="hs-identifier hs-var">ntnApps</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToNodeVersion blk
</span><a href="#local-6989586621680032161"><span class="hs-identifier hs-var">blockVersion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680032163"><span class="annot"><span class="annottext">NodeToNodeVersion
</span><a href="#local-6989586621680032163"><span class="hs-identifier hs-var">version</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680032161"><span class="annot"><span class="annottext">BlockNodeToNodeVersion blk
</span><a href="#local-6989586621680032161"><span class="hs-identifier hs-var">blockVersion</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
-&gt; [(NodeToNodeVersion, BlockNodeToNodeVersion blk)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
</span><a href="#local-6989586621680032267"><span class="hs-identifier hs-var">llrnNodeToNodeVersions</span></a></span><span>
</span><span id="line-478"></span><span>                </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-479"></span><span>            </span><span class="annot"><span class="annottext">daLocalResponderApplication :: Versions
  NodeToClientVersion
  versionDataNTC
  (OuroborosApplication 'ResponderMode addrNTC ByteString m Void ())
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">Diffusion.daLocalResponderApplication</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-480"></span><span>              </span><span class="annot"><span class="annottext">[Versions
   NodeToClientVersion
   versionDataNTC
   (OuroborosApplication 'ResponderMode addrNTC ByteString m Void ())]
-&gt; Versions
     NodeToClientVersion
     versionDataNTC
     (OuroborosApplication 'ResponderMode addrNTC ByteString m Void ())
forall vNum (f :: * -&gt; *) extra r.
(Ord vNum, Foldable f, HasCallStack) =&gt;
f (Versions vNum extra r) -&gt; Versions vNum extra r
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">combineVersions</span></a></span><span>
</span><span id="line-481"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion
-&gt; versionDataNTC
-&gt; OuroborosApplication 'ResponderMode addrNTC ByteString m Void ()
-&gt; Versions
     NodeToClientVersion
     versionDataNTC
     (OuroborosApplication 'ResponderMode addrNTC ByteString m Void ())
forall vNum vData r. vNum -&gt; vData -&gt; r -&gt; Versions vNum vData r
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">simpleSingletonVersions</span></a></span><span>
</span><span id="line-482"></span><span>                    </span><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680032159"><span class="hs-identifier hs-var">version</span></a></span><span>
</span><span id="line-483"></span><span>                    </span><span class="annot"><span class="annottext">versionDataNTC
</span><a href="#local-6989586621680032269"><span class="hs-identifier hs-var">llrnVersionDataNTC</span></a></span><span>
</span><span id="line-484"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeToClientVersion
-&gt; Apps
     m
     (ConnectionId addrNTC)
     ByteString
     ByteString
     ByteString
     ByteString
     ()
-&gt; OuroborosApplication 'ResponderMode addrNTC ByteString m Void ()
forall (m :: * -&gt; *) peer b a.
NodeToClientVersion
-&gt; Apps m (ConnectionId peer) b b b b a
-&gt; OuroborosApplication 'ResponderMode peer b m Void a
</span><a href="Ouroboros.Consensus.Network.NodeToClient.html#responder"><span class="hs-identifier hs-var">NTC.responder</span></a></span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680032159"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="annot"><span class="annottext">(Apps
   m
   (ConnectionId addrNTC)
   ByteString
   ByteString
   ByteString
   ByteString
   ()
 -&gt; OuroborosApplication
      'ResponderMode addrNTC ByteString m Void ())
-&gt; Apps
     m
     (ConnectionId addrNTC)
     ByteString
     ByteString
     ByteString
     ByteString
     ()
-&gt; OuroborosApplication 'ResponderMode addrNTC ByteString m Void ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
-&gt; NodeToClientVersion
-&gt; Apps
     m
     (ConnectionId addrNTC)
     ByteString
     ByteString
     ByteString
     ByteString
     ()
</span><a href="#local-6989586621680032188"><span class="hs-identifier hs-var">ntcApps</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680032157"><span class="hs-identifier hs-var">blockVersion</span></a></span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680032159"><span class="hs-identifier hs-var">version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680032159"><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="#local-6989586621680032159"><span class="hs-identifier hs-var">version</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680032157"><span class="annot"><span class="annottext">BlockNodeToClientVersion blk
</span><a href="#local-6989586621680032157"><span class="hs-identifier hs-var">blockVersion</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map NodeToClientVersion (BlockNodeToClientVersion blk)
-&gt; [(NodeToClientVersion, BlockNodeToClientVersion blk)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map NodeToClientVersion (BlockNodeToClientVersion blk)
</span><a href="#local-6989586621680032266"><span class="hs-identifier hs-var">llrnNodeToClientVersions</span></a></span><span>
</span><span id="line-486"></span><span>                </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-487"></span><span>            </span><span class="annot"><span class="annottext">daLedgerPeersCtx :: LedgerPeersConsensusInterface m
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">Diffusion.daLedgerPeersCtx</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-488"></span><span>              </span><span class="annot"><span class="annottext">(SlotNo -&gt; STM m (Maybe [(PoolStake, NonEmpty RelayAccessPoint)]))
-&gt; LedgerPeersConsensusInterface m
forall (m :: * -&gt; *).
(SlotNo -&gt; STM m (Maybe [(PoolStake, NonEmpty RelayAccessPoint)]))
-&gt; LedgerPeersConsensusInterface m
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">LedgerPeersConsensusInterface</span></a></span><span>
</span><span id="line-489"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeKernel m remotePeer localPeer blk
-&gt; SlotNo -&gt; STM m (Maybe [(PoolStake, NonEmpty RelayAccessPoint)])
forall (m :: * -&gt; *) blk localPeer remotePeer.
(IOLike m, LedgerSupportsPeerSelection blk, UpdateLedger blk) =&gt;
NodeKernel m remotePeer localPeer blk
-&gt; SlotNo -&gt; STM m (Maybe [(PoolStake, NonEmpty RelayAccessPoint)])
</span><a href="Ouroboros.Consensus.NodeKernel.html#getPeersFromCurrentLedgerAfterSlot"><span class="hs-identifier hs-var">getPeersFromCurrentLedgerAfterSlot</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernel m remotePeer localPeer blk
</span><a href="#local-6989586621680032187"><span class="hs-identifier hs-var">kernel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span>        </span><span class="annot"><a href="#local-6989586621680032178"><span class="hs-identifier hs-type">localRethrowPolicy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">RethrowPolicy</span></a></span><span>
</span><span id="line-493"></span><span>        </span><span id="local-6989586621680032178"><span class="annot"><span class="annottext">localRethrowPolicy :: RethrowPolicy
</span><a href="#local-6989586621680032178"><span class="hs-identifier hs-var hs-var">localRethrowPolicy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RethrowPolicy
forall a. Monoid a =&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-comment">-- | Check the DB marker, lock the DB and look for the clean shutdown marker.</span><span>
</span><span id="line-496"></span><span class="hs-comment">--</span><span>
</span><span id="line-497"></span><span class="hs-comment">-- Run the body action with the DB locked.</span><span>
</span><span id="line-498"></span><span class="hs-comment">--</span><span>
</span><span id="line-499"></span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdWithCheckedDB"><span class="hs-identifier hs-type">stdWithCheckedDB</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-500"></span><span>     </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680032381"><span class="annot"><a href="#local-6989586621680032381"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span id="local-6989586621680032380"><span class="annot"><a href="#local-6989586621680032380"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">StandardHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032381"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032381"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032381"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-503"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NetworkMagic</span></a></span><span>
</span><span id="line-504"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.Recovery.html#LastShutDownWasClean"><span class="hs-identifier hs-type">LastShutDownWasClean</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.API.html#ChainDB"><span class="hs-identifier hs-type">ChainDB</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032381"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032380"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032380"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032380"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Body action with last shutdown was clean.</span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032380"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-506"></span><span id="stdWithCheckedDB"><span class="annot"><span class="annottext">stdWithCheckedDB :: Proxy blk
-&gt; String
-&gt; NetworkMagic
-&gt; (LastShutDownWasClean
    -&gt; (ChainDB IO blk -&gt; IO a -&gt; IO a) -&gt; IO a)
-&gt; IO a
</span><a href="Ouroboros.Consensus.Node.html#stdWithCheckedDB"><span class="hs-identifier hs-var hs-var">stdWithCheckedDB</span></a></span></span><span> </span><span id="local-6989586621680032152"><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680032152"><span class="hs-identifier hs-var">pb</span></a></span></span><span> </span><span id="local-6989586621680032151"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680032151"><span class="hs-identifier hs-var">databasePath</span></a></span></span><span> </span><span id="local-6989586621680032150"><span class="annot"><span class="annottext">NetworkMagic
</span><a href="#local-6989586621680032150"><span class="hs-identifier hs-var">networkMagic</span></a></span></span><span> </span><span id="local-6989586621680032149"><span class="annot"><span class="annottext">LastShutDownWasClean -&gt; (ChainDB IO blk -&gt; IO a -&gt; IO a) -&gt; IO a
</span><a href="#local-6989586621680032149"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span>    </span><span class="hs-comment">-- Check the DB marker first, before doing the lock file, since if the</span><span>
</span><span id="line-509"></span><span>    </span><span class="hs-comment">-- marker is not present, it expects an empty DB dir.</span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><span class="annottext">(DbMarkerError -&gt; IO ())
-&gt; (() -&gt; IO ()) -&gt; Either DbMarkerError () -&gt; IO ()
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">DbMarkerError -&gt; IO ()
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/src"><span class="hs-identifier hs-var">throwIO</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Either DbMarkerError () -&gt; IO ())
-&gt; IO (Either DbMarkerError ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">HasFS IO HandleIO
-&gt; MountPoint -&gt; NetworkMagic -&gt; IO (Either DbMarkerError ())
forall (m :: * -&gt; *) h.
MonadThrow m =&gt;
HasFS m h
-&gt; MountPoint -&gt; NetworkMagic -&gt; m (Either DbMarkerError ())
</span><a href="Ouroboros.Consensus.Node.DbMarker.html#checkDbMarker"><span class="hs-identifier hs-var">checkDbMarker</span></a></span><span>
</span><span id="line-511"></span><span>      </span><span class="annot"><span class="annottext">HasFS IO HandleIO
</span><a href="#local-6989586621680032144"><span class="hs-identifier hs-var">hasFS</span></a></span><span>
</span><span id="line-512"></span><span>      </span><span class="annot"><span class="annottext">MountPoint
</span><a href="#local-6989586621680032143"><span class="hs-identifier hs-var">mountPoint</span></a></span><span>
</span><span id="line-513"></span><span>      </span><span class="annot"><span class="annottext">NetworkMagic
</span><a href="#local-6989586621680032150"><span class="hs-identifier hs-var">networkMagic</span></a></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-comment">-- Then create the lock file.</span><span>
</span><span id="line-516"></span><span>    </span><span class="annot"><span class="annottext">MountPoint -&gt; IO a -&gt; IO a
forall a. MountPoint -&gt; IO a -&gt; IO a
</span><a href="Ouroboros.Consensus.Node.DbLock.html#withLockDB"><span class="hs-identifier hs-var">withLockDB</span></a></span><span> </span><span class="annot"><span class="annottext">MountPoint
</span><a href="#local-6989586621680032143"><span class="hs-identifier hs-var">mountPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; IO a) -&gt; IO a -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
-&gt; HasFS IO HandleIO
-&gt; (LastShutDownWasClean
    -&gt; (ChainDB IO blk -&gt; IO a -&gt; IO a) -&gt; IO a)
-&gt; IO a
forall a (m :: * -&gt; *) h blk.
(IOLike m, StandardHash blk, Typeable blk) =&gt;
Proxy blk
-&gt; HasFS m h
-&gt; (LastShutDownWasClean -&gt; (ChainDB m blk -&gt; m a -&gt; m a) -&gt; m a)
-&gt; m a
</span><a href="Ouroboros.Consensus.Node.Recovery.html#runWithCheckedDB"><span class="hs-identifier hs-var">runWithCheckedDB</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk
</span><a href="#local-6989586621680032152"><span class="hs-identifier hs-var">pb</span></a></span><span> </span><span class="annot"><span class="annottext">HasFS IO HandleIO
</span><a href="#local-6989586621680032144"><span class="hs-identifier hs-var">hasFS</span></a></span><span> </span><span class="annot"><span class="annottext">LastShutDownWasClean -&gt; (ChainDB IO blk -&gt; IO a -&gt; IO a) -&gt; IO a
</span><a href="#local-6989586621680032149"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-517"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-518"></span><span>    </span><span id="local-6989586621680032143"><span class="annot"><span class="annottext">mountPoint :: MountPoint
</span><a href="#local-6989586621680032143"><span class="hs-identifier hs-var hs-var">mountPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; MountPoint
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MountPoint"><span class="hs-identifier hs-var">MountPoint</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680032151"><span class="hs-identifier hs-var">databasePath</span></a></span><span>
</span><span id="line-519"></span><span>    </span><span id="local-6989586621680032144"><span class="annot"><span class="annottext">hasFS :: HasFS IO HandleIO
</span><a href="#local-6989586621680032144"><span class="hs-identifier hs-var hs-var">hasFS</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MountPoint -&gt; HasFS IO HandleIO
</span><a href="Ouroboros.Consensus.Storage.FS.IO.html#ioHasFS"><span class="hs-identifier hs-var">ioHasFS</span></a></span><span> </span><span class="annot"><span class="annottext">MountPoint
</span><a href="#local-6989586621680032143"><span class="hs-identifier hs-var">mountPoint</span></a></span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span class="annot"><a href="Ouroboros.Consensus.Node.html#openChainDB"><span class="hs-identifier hs-type">openChainDB</span></a></span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680032719"><span class="annot"><a href="#local-6989586621680032719"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680032720"><span class="annot"><a href="#local-6989586621680032720"><span class="hs-identifier hs-type">blk</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html#RunNode"><span class="hs-identifier hs-type">RunNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032720"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.IOLike.html#IOLike"><span class="hs-identifier hs-type">IOLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032719"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.ResourceRegistry.html#ResourceRegistry"><span class="hs-identifier hs-type">ResourceRegistry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032719"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Fragment.InFuture.html#CheckInFuture"><span class="hs-identifier hs-type">CheckInFuture</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032719"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032720"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Config.html#TopLevelConfig"><span class="hs-identifier hs-type">TopLevelConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032720"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Extended.html#ExtLedgerState"><span class="hs-identifier hs-type">ExtLedgerState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032720"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-527"></span><span>     </span><span class="hs-comment">-- ^ Initial ledger</span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#ChainDbArgs"><span class="hs-identifier hs-type">ChainDbArgs</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.Args.html#Defaults"><span class="hs-identifier hs-type">Defaults</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032719"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032720"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#ChainDbArgs"><span class="hs-identifier hs-type">ChainDbArgs</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032719"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032720"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#ChainDbArgs"><span class="hs-identifier hs-type">ChainDbArgs</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032719"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032720"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>      </span><span class="hs-comment">-- ^ Customise the 'ChainDbArgs'</span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680032719"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.API.html#ChainDB"><span class="hs-identifier hs-type">ChainDB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032719"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032720"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span id="openChainDB"><span class="annot"><span class="annottext">openChainDB :: ResourceRegistry m
-&gt; CheckInFuture m blk
-&gt; TopLevelConfig blk
-&gt; ExtLedgerState blk
-&gt; ChainDbArgs Defaults m blk
-&gt; (ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk)
-&gt; m (ChainDB m blk)
</span><a href="Ouroboros.Consensus.Node.html#openChainDB"><span class="hs-identifier hs-var hs-var">openChainDB</span></a></span></span><span> </span><span id="local-6989586621680032139"><span class="annot"><span class="annottext">ResourceRegistry m
</span><a href="#local-6989586621680032139"><span class="hs-identifier hs-var">registry</span></a></span></span><span> </span><span id="local-6989586621680032138"><span class="annot"><span class="annottext">CheckInFuture m blk
</span><a href="#local-6989586621680032138"><span class="hs-identifier hs-var">inFuture</span></a></span></span><span> </span><span id="local-6989586621680032137"><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032137"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621680032136"><span class="annot"><span class="annottext">ExtLedgerState blk
</span><a href="#local-6989586621680032136"><span class="hs-identifier hs-var">initLedger</span></a></span></span><span> </span><span id="local-6989586621680032135"><span class="annot"><span class="annottext">ChainDbArgs Defaults m blk
</span><a href="#local-6989586621680032135"><span class="hs-identifier hs-var">defArgs</span></a></span></span><span> </span><span id="local-6989586621680032134"><span class="annot"><span class="annottext">ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk
</span><a href="#local-6989586621680032134"><span class="hs-identifier hs-var">customiseArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-533"></span><span>    </span><span class="annot"><span class="annottext">ChainDbArgs Identity m blk -&gt; m (ChainDB m blk)
forall (m :: * -&gt; *) blk.
(IOLike m, LedgerSupportsProtocol blk, InspectLedger blk,
 HasHardForkHistory blk, ConvertRawHash blk,
 SerialiseDiskConstraints blk) =&gt;
ChainDbArgs Identity m blk -&gt; m (ChainDB m blk)
</span><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.html#openDB"><span class="hs-identifier hs-var">ChainDB.openDB</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDbArgs Identity m blk
</span><a href="#local-6989586621680032132"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-535"></span><span>    </span><span class="annot"><a href="#local-6989586621680032132"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#ChainDbArgs"><span class="hs-identifier hs-type">ChainDbArgs</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032719"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032720"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-536"></span><span>    </span><span id="local-6989586621680032132"><span class="annot"><span class="annottext">args :: ChainDbArgs Identity m blk
</span><a href="#local-6989586621680032132"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk
</span><a href="#local-6989586621680032134"><span class="hs-identifier hs-var">customiseArgs</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk)
-&gt; ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-537"></span><span>             </span><span class="annot"><span class="annottext">ResourceRegistry m
-&gt; CheckInFuture m blk
-&gt; TopLevelConfig blk
-&gt; ExtLedgerState blk
-&gt; ChunkInfo
-&gt; ChainDbArgs Defaults m blk
-&gt; ChainDbArgs Identity m blk
forall (m :: * -&gt; *) blk.
(RunNode blk, IOLike m) =&gt;
ResourceRegistry m
-&gt; CheckInFuture m blk
-&gt; TopLevelConfig blk
-&gt; ExtLedgerState blk
-&gt; ChunkInfo
-&gt; ChainDbArgs Defaults m blk
-&gt; ChainDbArgs Identity m blk
</span><a href="Ouroboros.Consensus.Node.html#mkChainDbArgs"><span class="hs-identifier hs-var">mkChainDbArgs</span></a></span><span> </span><span class="annot"><span class="annottext">ResourceRegistry m
</span><a href="#local-6989586621680032139"><span class="hs-identifier hs-var">registry</span></a></span><span> </span><span class="annot"><span class="annottext">CheckInFuture m blk
</span><a href="#local-6989586621680032138"><span class="hs-identifier hs-var">inFuture</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032137"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">ExtLedgerState blk
</span><a href="#local-6989586621680032136"><span class="hs-identifier hs-var">initLedger</span></a></span><span>
</span><span id="line-538"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageConfig blk -&gt; ChunkInfo
forall blk. NodeInitStorage blk =&gt; StorageConfig blk -&gt; ChunkInfo
</span><a href="Ouroboros.Consensus.Node.InitStorage.html#nodeImmutableDbChunkInfo"><span class="hs-identifier hs-var">nodeImmutableDbChunkInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelConfig blk -&gt; StorageConfig blk
forall blk. TopLevelConfig blk -&gt; StorageConfig blk
</span><a href="Ouroboros.Consensus.Config.html#configStorage"><span class="hs-identifier hs-var">configStorage</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032137"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>             </span><span class="annot"><span class="annottext">ChainDbArgs Defaults m blk
</span><a href="#local-6989586621680032135"><span class="hs-identifier hs-var">defArgs</span></a></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="annot"><a href="Ouroboros.Consensus.Node.html#mkChainDbArgs"><span class="hs-identifier hs-type">mkChainDbArgs</span></a></span><span>
</span><span id="line-542"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680032495"><span class="annot"><a href="#local-6989586621680032495"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680032496"><span class="annot"><a href="#local-6989586621680032496"><span class="hs-identifier hs-type">blk</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html#RunNode"><span class="hs-identifier hs-type">RunNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032496"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.IOLike.html#IOLike"><span class="hs-identifier hs-type">IOLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032495"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.ResourceRegistry.html#ResourceRegistry"><span class="hs-identifier hs-type">ResourceRegistry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032495"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Fragment.InFuture.html#CheckInFuture"><span class="hs-identifier hs-type">CheckInFuture</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032495"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032496"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Config.html#TopLevelConfig"><span class="hs-identifier hs-type">TopLevelConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032496"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Ledger.Extended.html#ExtLedgerState"><span class="hs-identifier hs-type">ExtLedgerState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032496"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-547"></span><span>     </span><span class="hs-comment">-- ^ Initial ledger</span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ImmutableDB.Chunks.Internal.html#ChunkInfo"><span class="hs-identifier hs-type">ChunkInfo</span></a></span><span>
</span><span id="line-549"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#ChainDbArgs"><span class="hs-identifier hs-type">ChainDbArgs</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.Args.html#Defaults"><span class="hs-identifier hs-type">Defaults</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032495"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032496"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-550"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#ChainDbArgs"><span class="hs-identifier hs-type">ChainDbArgs</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032495"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032496"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-551"></span><span id="mkChainDbArgs"><span class="annot"><span class="annottext">mkChainDbArgs :: ResourceRegistry m
-&gt; CheckInFuture m blk
-&gt; TopLevelConfig blk
-&gt; ExtLedgerState blk
-&gt; ChunkInfo
-&gt; ChainDbArgs Defaults m blk
-&gt; ChainDbArgs Identity m blk
</span><a href="Ouroboros.Consensus.Node.html#mkChainDbArgs"><span class="hs-identifier hs-var hs-var">mkChainDbArgs</span></a></span></span><span>
</span><span id="line-552"></span><span>  </span><span id="local-6989586621680032129"><span class="annot"><span class="annottext">ResourceRegistry m
</span><a href="#local-6989586621680032129"><span class="hs-identifier hs-var">registry</span></a></span></span><span>
</span><span id="line-553"></span><span>  </span><span id="local-6989586621680032128"><span class="annot"><span class="annottext">CheckInFuture m blk
</span><a href="#local-6989586621680032128"><span class="hs-identifier hs-var">inFuture</span></a></span></span><span>
</span><span id="line-554"></span><span>  </span><span id="local-6989586621680032127"><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032127"><span class="hs-identifier hs-var">cfg</span></a></span></span><span>
</span><span id="line-555"></span><span>  </span><span id="local-6989586621680032126"><span class="annot"><span class="annottext">ExtLedgerState blk
</span><a href="#local-6989586621680032126"><span class="hs-identifier hs-var">initLedger</span></a></span></span><span>
</span><span id="line-556"></span><span>  </span><span id="local-6989586621680032125"><span class="annot"><span class="annottext">ChunkInfo
</span><a href="#local-6989586621680032125"><span class="hs-identifier hs-var">chunkInfo</span></a></span></span><span>
</span><span id="line-557"></span><span>  </span><span id="local-6989586621680032124"><span class="annot"><span class="annottext">ChainDbArgs Defaults m blk
</span><a href="#local-6989586621680032124"><span class="hs-identifier hs-var">defArgs</span></a></span></span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainDbArgs Defaults m blk
</span><a href="#local-6989586621680032124"><span class="hs-identifier hs-var">defArgs</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-559"></span><span>      </span><span class="annot"><span class="annottext">cdbTopLevelConfig :: HKD Identity (TopLevelConfig blk)
</span><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#cdbTopLevelConfig"><span class="hs-identifier hs-var">ChainDB.cdbTopLevelConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HKD Identity (TopLevelConfig blk)
TopLevelConfig blk
</span><a href="#local-6989586621680032127"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-560"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cdbChunkInfo :: HKD Identity ChunkInfo
</span><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#cdbChunkInfo"><span class="hs-identifier hs-var">ChainDB.cdbChunkInfo</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HKD Identity ChunkInfo
ChunkInfo
</span><a href="#local-6989586621680032125"><span class="hs-identifier hs-var">chunkInfo</span></a></span><span>
</span><span id="line-561"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cdbCheckIntegrity :: HKD Identity (blk -&gt; Bool)
</span><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#cdbCheckIntegrity"><span class="hs-identifier hs-var">ChainDB.cdbCheckIntegrity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StorageConfig blk -&gt; blk -&gt; Bool
forall blk. NodeInitStorage blk =&gt; StorageConfig blk -&gt; blk -&gt; Bool
</span><a href="Ouroboros.Consensus.Node.InitStorage.html#nodeCheckIntegrity"><span class="hs-identifier hs-var">nodeCheckIntegrity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelConfig blk -&gt; StorageConfig blk
forall blk. TopLevelConfig blk -&gt; StorageConfig blk
</span><a href="Ouroboros.Consensus.Config.html#configStorage"><span class="hs-identifier hs-var">configStorage</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032127"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cdbGenesis :: HKD Identity (m (ExtLedgerState blk))
</span><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#cdbGenesis"><span class="hs-identifier hs-var">ChainDB.cdbGenesis</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExtLedgerState blk -&gt; m (ExtLedgerState blk)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">ExtLedgerState blk
</span><a href="#local-6989586621680032126"><span class="hs-identifier hs-var">initLedger</span></a></span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cdbCheckInFuture :: HKD Identity (CheckInFuture m blk)
</span><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#cdbCheckInFuture"><span class="hs-identifier hs-var">ChainDB.cdbCheckInFuture</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HKD Identity (CheckInFuture m blk)
CheckInFuture m blk
</span><a href="#local-6989586621680032128"><span class="hs-identifier hs-var">inFuture</span></a></span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cdbRegistry :: HKD Identity (ResourceRegistry m)
</span><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#cdbRegistry"><span class="hs-identifier hs-var">ChainDB.cdbRegistry</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HKD Identity (ResourceRegistry m)
ResourceRegistry m
</span><a href="#local-6989586621680032129"><span class="hs-identifier hs-var">registry</span></a></span><span>
</span><span id="line-566"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span class="annot"><a href="Ouroboros.Consensus.Node.html#mkNodeKernelArgs"><span class="hs-identifier hs-type">mkNodeKernelArgs</span></a></span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680032683"><span class="annot"><a href="#local-6989586621680032683"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680032682"><span class="annot"><a href="#local-6989586621680032682"><span class="hs-identifier hs-type">addrNTN</span></a></span></span><span> </span><span id="local-6989586621680032681"><span class="annot"><a href="#local-6989586621680032681"><span class="hs-identifier hs-type">addrNTC</span></a></span></span><span> </span><span id="local-6989586621680032684"><span class="annot"><a href="#local-6989586621680032684"><span class="hs-identifier hs-type">blk</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html#RunNode"><span class="hs-identifier hs-type">RunNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032684"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.IOLike.html#IOLike"><span class="hs-identifier hs-type">IOLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032683"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.ResourceRegistry.html#ResourceRegistry"><span class="hs-identifier hs-type">ResourceRegistry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032683"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span>
</span><span id="line-573"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Config.html#TopLevelConfig"><span class="hs-identifier hs-type">TopLevelConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032684"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680032683"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Block.Forging.html#BlockForging"><span class="hs-identifier hs-type">BlockForging</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032683"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032684"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-575"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Tracers.html#Tracers"><span class="hs-identifier hs-type">Tracers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032683"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032682"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032681"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032684"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.BlockchainTime.API.html#BlockchainTime"><span class="hs-identifier hs-type">BlockchainTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032683"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.API.html#ChainDB"><span class="hs-identifier hs-type">ChainDB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032683"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032684"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680032683"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032683"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032682"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032681"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032684"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span id="mkNodeKernelArgs"><span class="annot"><span class="annottext">mkNodeKernelArgs :: ResourceRegistry m
-&gt; Int
-&gt; StdGen
-&gt; TopLevelConfig blk
-&gt; m [BlockForging m blk]
-&gt; Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; BlockchainTime m
-&gt; ChainDB m blk
-&gt; m (NodeKernelArgs
        m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
</span><a href="Ouroboros.Consensus.Node.html#mkNodeKernelArgs"><span class="hs-identifier hs-var hs-var">mkNodeKernelArgs</span></a></span></span><span>
</span><span id="line-580"></span><span>  </span><span id="local-6989586621680032116"><span class="annot"><span class="annottext">ResourceRegistry m
</span><a href="#local-6989586621680032116"><span class="hs-identifier hs-var">registry</span></a></span></span><span>
</span><span id="line-581"></span><span>  </span><span id="local-6989586621680032115"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680032115"><span class="hs-identifier hs-var">bfcSalt</span></a></span></span><span>
</span><span id="line-582"></span><span>  </span><span id="local-6989586621680032114"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621680032114"><span class="hs-identifier hs-var">keepAliveRng</span></a></span></span><span>
</span><span id="line-583"></span><span>  </span><span id="local-6989586621680032113"><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032113"><span class="hs-identifier hs-var">cfg</span></a></span></span><span>
</span><span id="line-584"></span><span>  </span><span id="local-6989586621680032112"><span class="annot"><span class="annottext">m [BlockForging m blk]
</span><a href="#local-6989586621680032112"><span class="hs-identifier hs-var">initBlockForging</span></a></span></span><span>
</span><span id="line-585"></span><span>  </span><span id="local-6989586621680032111"><span class="annot"><span class="annottext">Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032111"><span class="hs-identifier hs-var">tracers</span></a></span></span><span>
</span><span id="line-586"></span><span>  </span><span id="local-6989586621680032110"><span class="annot"><span class="annottext">BlockchainTime m
</span><a href="#local-6989586621680032110"><span class="hs-identifier hs-var">btime</span></a></span></span><span>
</span><span id="line-587"></span><span>  </span><span id="local-6989586621680032109"><span class="annot"><span class="annottext">ChainDB m blk
</span><a href="#local-6989586621680032109"><span class="hs-identifier hs-var">chainDB</span></a></span></span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-589"></span><span>    </span><span id="local-6989586621680032108"><span class="annot"><span class="annottext">[BlockForging m blk]
</span><a href="#local-6989586621680032108"><span class="hs-identifier hs-var">blockForging</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m [BlockForging m blk]
</span><a href="#local-6989586621680032112"><span class="hs-identifier hs-var">initBlockForging</span></a></span><span>
</span><span id="line-590"></span><span>    </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; m (NodeKernelArgs
        m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
Tracers m remotePeer localPeer blk
-&gt; ResourceRegistry m
-&gt; TopLevelConfig blk
-&gt; BlockchainTime m
-&gt; ChainDB m blk
-&gt; (StorageConfig blk -&gt; InitChainDB m blk -&gt; m ())
-&gt; (Header blk -&gt; SizeInBytes)
-&gt; [BlockForging m blk]
-&gt; MempoolCapacityBytesOverride
-&gt; MiniProtocolParameters
-&gt; BlockFetchConfiguration
-&gt; StdGen
-&gt; NodeKernelArgs m remotePeer localPeer blk
</span><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span>
</span><span id="line-591"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
$sel:tracers:NodeKernelArgs :: Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
tracers :: Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3Atracers%3ANodeKernelArgs"><span class="hs-identifier hs-var hs-var">tracers</span></a></span><span>
</span><span id="line-592"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ResourceRegistry m
$sel:registry:NodeKernelArgs :: ResourceRegistry m
registry :: ResourceRegistry m
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3Aregistry%3ANodeKernelArgs"><span class="hs-identifier hs-var hs-var">registry</span></a></span><span>
</span><span id="line-593"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk
$sel:cfg:NodeKernelArgs :: TopLevelConfig blk
cfg :: TopLevelConfig blk
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3Acfg%3ANodeKernelArgs"><span class="hs-identifier hs-var hs-var">cfg</span></a></span><span>
</span><span id="line-594"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockchainTime m
$sel:btime:NodeKernelArgs :: BlockchainTime m
btime :: BlockchainTime m
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3Abtime%3ANodeKernelArgs"><span class="hs-identifier hs-var hs-var">btime</span></a></span><span>
</span><span id="line-595"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainDB m blk
$sel:chainDB:NodeKernelArgs :: ChainDB m blk
chainDB :: ChainDB m blk
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AchainDB%3ANodeKernelArgs"><span class="hs-identifier hs-var hs-var">chainDB</span></a></span><span>
</span><span id="line-596"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[BlockForging m blk]
$sel:blockForging:NodeKernelArgs :: [BlockForging m blk]
blockForging :: [BlockForging m blk]
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AblockForging%3ANodeKernelArgs"><span class="hs-identifier hs-var hs-var">blockForging</span></a></span><span>
</span><span id="line-597"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:initChainDB:NodeKernelArgs :: StorageConfig blk -&gt; InitChainDB m blk -&gt; m ()
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AinitChainDB%3ANodeKernelArgs"><span class="hs-identifier hs-var">initChainDB</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StorageConfig blk -&gt; InitChainDB m blk -&gt; m ()
forall blk (m :: * -&gt; *).
(NodeInitStorage blk, IOLike m) =&gt;
StorageConfig blk -&gt; InitChainDB m blk -&gt; m ()
</span><a href="Ouroboros.Consensus.Node.InitStorage.html#nodeInitChainDB"><span class="hs-identifier hs-var">nodeInitChainDB</span></a></span><span>
</span><span id="line-598"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:blockFetchSize:NodeKernelArgs :: Header blk -&gt; SizeInBytes
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AblockFetchSize%3ANodeKernelArgs"><span class="hs-identifier hs-var">blockFetchSize</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Header blk -&gt; SizeInBytes
forall blk.
SerialiseNodeToNodeConstraints blk =&gt;
Header blk -&gt; SizeInBytes
</span><a href="Ouroboros.Consensus.Node.Run.html#estimateBlockSize"><span class="hs-identifier hs-var">estimateBlockSize</span></a></span><span>
</span><span id="line-599"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:mempoolCapacityOverride:NodeKernelArgs :: MempoolCapacityBytesOverride
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AmempoolCapacityOverride%3ANodeKernelArgs"><span class="hs-identifier hs-var">mempoolCapacityOverride</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MempoolCapacityBytesOverride
</span><a href="Ouroboros.Consensus.Mempool.API.html#NoMempoolCapacityBytesOverride"><span class="hs-identifier hs-var">NoMempoolCapacityBytesOverride</span></a></span><span>
</span><span id="line-600"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:miniProtocolParameters:NodeKernelArgs :: MiniProtocolParameters
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AminiProtocolParameters%3ANodeKernelArgs"><span class="hs-identifier hs-var">miniProtocolParameters</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MiniProtocolParameters
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">defaultMiniProtocolParameters</span></a></span><span>
</span><span id="line-601"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:blockFetchConfiguration:NodeKernelArgs :: BlockFetchConfiguration
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AblockFetchConfiguration%3ANodeKernelArgs"><span class="hs-identifier hs-var">blockFetchConfiguration</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockFetchConfiguration
</span><a href="#local-6989586621680032093"><span class="hs-identifier hs-var">defaultBlockFetchConfiguration</span></a></span><span>
</span><span id="line-602"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StdGen
$sel:keepAliveRng:NodeKernelArgs :: StdGen
keepAliveRng :: StdGen
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AkeepAliveRng%3ANodeKernelArgs"><span class="hs-identifier hs-var hs-var">keepAliveRng</span></a></span><span>
</span><span id="line-603"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-605"></span><span>    </span><span class="annot"><a href="#local-6989586621680032093"><span class="hs-identifier hs-type">defaultBlockFetchConfiguration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">BlockFetchConfiguration</span></a></span><span>
</span><span id="line-606"></span><span>    </span><span id="local-6989586621680032093"><span class="annot"><span class="annottext">defaultBlockFetchConfiguration :: BlockFetchConfiguration
</span><a href="#local-6989586621680032093"><span class="hs-identifier hs-var hs-var">defaultBlockFetchConfiguration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockFetchConfiguration :: Word -&gt; Word -&gt; Word -&gt; DiffTime -&gt; Int -&gt; BlockFetchConfiguration
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">BlockFetchConfiguration</span></a></span><span>
</span><span id="line-607"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bfcMaxConcurrencyBulkSync :: Word
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">bfcMaxConcurrencyBulkSync</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span>
</span><span id="line-608"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bfcMaxConcurrencyDeadline :: Word
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">bfcMaxConcurrencyDeadline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span>
</span><span id="line-609"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bfcMaxRequestsInflight :: Word
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">bfcMaxRequestsInflight</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MiniProtocolParameters -&gt; Word
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var hs-var">blockFetchPipeliningMax</span></a></span><span> </span><span class="annot"><span class="annottext">MiniProtocolParameters
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">defaultMiniProtocolParameters</span></a></span><span>
</span><span id="line-610"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bfcDecisionLoopInterval :: DiffTime
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">bfcDecisionLoopInterval</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><span class="hs-number">0.01</span></span><span> </span><span class="hs-comment">-- 10ms</span><span>
</span><span id="line-611"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
bfcSalt :: Int
bfcSalt :: Int
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var hs-var">bfcSalt</span></a></span><span>
</span><span id="line-612"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span class="hs-comment">-- | We allow the user running the node to customise the 'NodeKernelArgs'</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- through 'llrnCustomiseNodeKernelArgs', but there are some limits to some</span><span>
</span><span id="line-616"></span><span class="hs-comment">-- values. This function makes sure we don't exceed those limits and that the</span><span>
</span><span id="line-617"></span><span class="hs-comment">-- values are consistent.</span><span>
</span><span id="line-618"></span><span id="local-6989586621680032689"><span id="local-6989586621680032690"><span id="local-6989586621680032691"><span id="local-6989586621680032692"><span class="annot"><a href="Ouroboros.Consensus.Node.html#nodeKernelArgsEnforceInvariants"><span class="hs-identifier hs-type">nodeKernelArgsEnforceInvariants</span></a></span><span>
</span><span id="line-619"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032692"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032691"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032690"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032689"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032692"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032691"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032690"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032689"><span class="hs-identifier hs-type">blk</span></a></span></span></span></span></span><span>
</span><span id="line-621"></span><span id="nodeKernelArgsEnforceInvariants"><span class="annot"><span class="annottext">nodeKernelArgsEnforceInvariants :: NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="Ouroboros.Consensus.Node.html#nodeKernelArgsEnforceInvariants"><span class="hs-identifier hs-var hs-var">nodeKernelArgsEnforceInvariants</span></a></span></span><span> </span><span id="local-6989586621680032085"><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032085"><span class="hs-identifier hs-var">nodeKernelArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032085"><span class="hs-identifier hs-var">nodeKernelArgs</span></a></span><span>
</span><span id="line-622"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:miniProtocolParameters:NodeKernelArgs :: MiniProtocolParameters
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AminiProtocolParameters%3ANodeKernelArgs"><span class="hs-identifier hs-var">miniProtocolParameters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MiniProtocolParameters
</span><a href="#local-6989586621680032084"><span class="hs-identifier hs-var">miniProtocolParameters</span></a></span><span>
</span><span id="line-623"></span><span>        </span><span class="hs-comment">-- If 'blockFetchPipeliningMax' exceeds the configured default, it</span><span>
</span><span id="line-624"></span><span>        </span><span class="hs-comment">-- would be a protocol violation.</span><span>
</span><span id="line-625"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">blockFetchPipeliningMax :: Word
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">blockFetchPipeliningMax</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-626"></span><span>            </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MiniProtocolParameters -&gt; Word
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var hs-var">blockFetchPipeliningMax</span></a></span><span> </span><span class="annot"><span class="annottext">MiniProtocolParameters
</span><a href="#local-6989586621680032084"><span class="hs-identifier hs-var">miniProtocolParameters</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MiniProtocolParameters -&gt; Word
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var hs-var">blockFetchPipeliningMax</span></a></span><span> </span><span class="annot"><span class="annottext">MiniProtocolParameters
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">defaultMiniProtocolParameters</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-629"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:blockFetchConfiguration:NodeKernelArgs :: BlockFetchConfiguration
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AblockFetchConfiguration%3ANodeKernelArgs"><span class="hs-identifier hs-var">blockFetchConfiguration</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockFetchConfiguration
</span><a href="#local-6989586621680032082"><span class="hs-identifier hs-var">blockFetchConfiguration</span></a></span><span>
</span><span id="line-630"></span><span>        </span><span class="hs-comment">-- 'bfcMaxRequestsInflight' must be &lt;= 'blockFetchPipeliningMax'</span><span>
</span><span id="line-631"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bfcMaxRequestsInflight :: Word
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">bfcMaxRequestsInflight</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-632"></span><span>            </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockFetchConfiguration -&gt; Word
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var hs-var">bfcMaxRequestsInflight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockFetchConfiguration
</span><a href="#local-6989586621680032082"><span class="hs-identifier hs-var">blockFetchConfiguration</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MiniProtocolParameters -&gt; Word
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var hs-var">blockFetchPipeliningMax</span></a></span><span> </span><span class="annot"><span class="annottext">MiniProtocolParameters
</span><a href="#local-6989586621680032084"><span class="hs-identifier hs-var">miniProtocolParameters</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-635"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-637"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span class="hs-special">{</span><span id="local-6989586621680032072"><span id="local-6989586621680032073"><span id="local-6989586621680032074"><span id="local-6989586621680032075"><span id="local-6989586621680032076"><span id="local-6989586621680032077"><span id="local-6989586621680032078"><span id="local-6989586621680032079"><span id="local-6989586621680032080"><span id="local-6989586621680032081"><span id="local-6989586621680032082"><span id="local-6989586621680032084"><span class="annot"><span class="annottext">[BlockForging m blk]
MiniProtocolParameters
BlockFetchConfiguration
StdGen
TopLevelConfig blk
MempoolCapacityBytesOverride
ResourceRegistry m
BlockchainTime m
ChainDB m blk
Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
Header blk -&gt; SizeInBytes
StorageConfig blk -&gt; InitChainDB m blk -&gt; m ()
keepAliveRng :: StdGen
mempoolCapacityOverride :: MempoolCapacityBytesOverride
blockForging :: [BlockForging m blk]
blockFetchSize :: Header blk -&gt; SizeInBytes
initChainDB :: StorageConfig blk -&gt; InitChainDB m blk -&gt; m ()
chainDB :: ChainDB m blk
btime :: BlockchainTime m
cfg :: TopLevelConfig blk
registry :: ResourceRegistry m
tracers :: Tracers m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
blockFetchConfiguration :: BlockFetchConfiguration
miniProtocolParameters :: MiniProtocolParameters
$sel:keepAliveRng:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk -&gt; StdGen
$sel:blockFetchConfiguration:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk
-&gt; BlockFetchConfiguration
$sel:mempoolCapacityOverride:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk
-&gt; MempoolCapacityBytesOverride
$sel:blockFetchSize:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk
-&gt; Header blk -&gt; SizeInBytes
$sel:initChainDB:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk
-&gt; StorageConfig blk -&gt; InitChainDB m blk -&gt; m ()
$sel:blockForging:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk -&gt; [BlockForging m blk]
$sel:chainDB:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk -&gt; ChainDB m blk
$sel:btime:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk -&gt; BlockchainTime m
$sel:cfg:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk -&gt; TopLevelConfig blk
$sel:registry:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk -&gt; ResourceRegistry m
$sel:tracers:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk
-&gt; Tracers m remotePeer localPeer blk
$sel:miniProtocolParameters:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk -&gt; MiniProtocolParameters
</span><a href="#local-6989586621680032072"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032085"><span class="hs-identifier hs-var">nodeKernelArgs</span></a></span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Arguments for use in the real node
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span class="hs-comment">-- | How to locate the ChainDB on disk</span><span>
</span><span id="line-644"></span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdMkChainDbHasFS"><span class="hs-identifier hs-type">stdMkChainDbHasFS</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-645"></span><span>     </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-646"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#RelativeMountPoint"><span class="hs-identifier hs-type">ChainDB.RelativeMountPoint</span></a></span><span>
</span><span id="line-647"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.html#SomeHasFS"><span class="hs-identifier hs-type">SomeHasFS</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span>
</span><span id="line-648"></span><span id="stdMkChainDbHasFS"><span class="annot"><span class="annottext">stdMkChainDbHasFS :: String -&gt; RelativeMountPoint -&gt; SomeHasFS IO
</span><a href="Ouroboros.Consensus.Node.html#stdMkChainDbHasFS"><span class="hs-identifier hs-var hs-var">stdMkChainDbHasFS</span></a></span></span><span> </span><span id="local-6989586621680032071"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680032071"><span class="hs-identifier hs-var">rootPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#RelativeMountPoint"><span class="hs-identifier hs-type">ChainDB.RelativeMountPoint</span></a></span><span> </span><span id="local-6989586621680032069"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680032069"><span class="hs-identifier hs-var">relPath</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-649"></span><span>    </span><span class="annot"><span class="annottext">HasFS IO HandleIO -&gt; SomeHasFS IO
forall h (m :: * -&gt; *). Eq h =&gt; HasFS m h -&gt; SomeHasFS m
</span><a href="Ouroboros.Consensus.Storage.FS.API.html#SomeHasFS"><span class="hs-identifier hs-var">SomeHasFS</span></a></span><span> </span><span class="annot"><span class="annottext">(HasFS IO HandleIO -&gt; SomeHasFS IO)
-&gt; HasFS IO HandleIO -&gt; SomeHasFS IO
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MountPoint -&gt; HasFS IO HandleIO
</span><a href="Ouroboros.Consensus.Storage.FS.IO.html#ioHasFS"><span class="hs-identifier hs-var">ioHasFS</span></a></span><span> </span><span class="annot"><span class="annottext">(MountPoint -&gt; HasFS IO HandleIO)
-&gt; MountPoint -&gt; HasFS IO HandleIO
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; MountPoint
</span><a href="Ouroboros.Consensus.Storage.FS.API.Types.html#MountPoint"><span class="hs-identifier hs-var">MountPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; MountPoint) -&gt; String -&gt; MountPoint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680032071"><span class="hs-identifier hs-var">rootPath</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/filepath-1.4.2.1/src"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680032069"><span class="hs-identifier hs-var">relPath</span></a></span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdBfcSaltIO"><span class="hs-identifier hs-type">stdBfcSaltIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-652"></span><span id="stdBfcSaltIO"><span class="annot"><span class="annottext">stdBfcSaltIO :: IO Int
</span><a href="Ouroboros.Consensus.Node.html#stdBfcSaltIO"><span class="hs-identifier hs-var hs-var">stdBfcSaltIO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Int
forall a (m :: * -&gt; *). (Random a, MonadIO m) =&gt; m a
</span><span class="hs-identifier hs-var">randomIO</span></span><span>
</span><span id="line-653"></span><span>
</span><span id="line-654"></span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdKeepAliveRngIO"><span class="hs-identifier hs-type">stdKeepAliveRngIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span>
</span><span id="line-655"></span><span id="stdKeepAliveRngIO"><span class="annot"><span class="annottext">stdKeepAliveRngIO :: IO StdGen
</span><a href="Ouroboros.Consensus.Node.html#stdKeepAliveRngIO"><span class="hs-identifier hs-var hs-var">stdKeepAliveRngIO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO StdGen
forall (m :: * -&gt; *). MonadIO m =&gt; m StdGen
</span><span class="hs-identifier hs-var">newStdGen</span></span><span>
</span><span id="line-656"></span><span>
</span><span id="line-657"></span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdChainSyncTimeout"><span class="hs-identifier hs-type">stdChainSyncTimeout</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NTN.ChainSyncTimeout</span></a></span><span>
</span><span id="line-658"></span><span id="stdChainSyncTimeout"><span class="annot"><span class="annottext">stdChainSyncTimeout :: IO ChainSyncTimeout
</span><a href="Ouroboros.Consensus.Node.html#stdChainSyncTimeout"><span class="hs-identifier hs-var hs-var">stdChainSyncTimeout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-659"></span><span>    </span><span class="hs-comment">-- These values approximately correspond to false positive</span><span>
</span><span id="line-660"></span><span>    </span><span class="hs-comment">-- thresholds for streaks of empty slots with 99% probability,</span><span>
</span><span id="line-661"></span><span>    </span><span class="hs-comment">-- 99.9% probability up to 99.999% probability.</span><span>
</span><span id="line-662"></span><span>    </span><span class="hs-comment">-- t = T_s [log (1-Y) / log (1-f)]</span><span>
</span><span id="line-663"></span><span>    </span><span class="hs-comment">-- Y = [0.99, 0.999...]</span><span>
</span><span id="line-664"></span><span>    </span><span class="hs-comment">-- T_s = slot length of 1s.</span><span>
</span><span id="line-665"></span><span>    </span><span class="hs-comment">-- f = 0.05</span><span>
</span><span id="line-666"></span><span>    </span><span class="hs-comment">-- The timeout is randomly picked per bearer to avoid all bearers</span><span>
</span><span id="line-667"></span><span>    </span><span class="hs-comment">-- going down at the same time in case of a long streak of empty</span><span>
</span><span id="line-668"></span><span>    </span><span class="hs-comment">-- slots. TODO: workaround until peer selection governor.</span><span>
</span><span id="line-669"></span><span>    </span><span id="local-6989586621680032067"><span class="annot"><span class="annottext">Maybe DiffTime
</span><a href="#local-6989586621680032067"><span class="hs-identifier hs-var">mustReplyTimeout</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DiffTime -&gt; Maybe DiffTime
forall a. a -&gt; Maybe a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(DiffTime -&gt; Maybe DiffTime) -&gt; IO DiffTime -&gt; IO (Maybe DiffTime)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[DiffTime] -&gt; IO DiffTime
forall (m :: * -&gt; *) b. MonadIO m =&gt; [b] -&gt; m b
</span><a href="#local-6989586621680032066"><span class="hs-identifier hs-var">randomElem</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DiffTime
</span><span class="hs-number">90</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><span class="hs-number">135</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><span class="hs-number">180</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><span class="hs-number">224</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><span class="hs-number">269</span></span><span class="hs-special">]</span><span>
</span><span id="line-670"></span><span>    </span><span class="annot"><span class="annottext">ChainSyncTimeout -&gt; IO ChainSyncTimeout
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">ChainSyncTimeout :: Maybe DiffTime
-&gt; Maybe DiffTime -&gt; Maybe DiffTime -&gt; ChainSyncTimeout
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NTN.ChainSyncTimeout</span></a></span><span>
</span><span id="line-671"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">canAwaitTimeout :: Maybe DiffTime
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">canAwaitTimeout</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DiffTime
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">shortWait</span></a></span><span>
</span><span id="line-672"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">intersectTimeout :: Maybe DiffTime
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">intersectTimeout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DiffTime
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-var">shortWait</span></a></span><span>
</span><span id="line-673"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DiffTime
mustReplyTimeout :: Maybe DiffTime
mustReplyTimeout :: Maybe DiffTime
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var hs-var">mustReplyTimeout</span></a></span><span>
</span><span id="line-674"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-675"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-676"></span><span>    </span><span id="local-6989586621680032066"><span class="annot"><span class="annottext">randomElem :: [b] -&gt; m b
</span><a href="#local-6989586621680032066"><span class="hs-identifier hs-var hs-var">randomElem</span></a></span></span><span> </span><span id="local-6989586621680032061"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680032061"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-677"></span><span>      </span><span id="local-6989586621680032060"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680032060"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; m Int
forall a (m :: * -&gt; *). (Random a, MonadIO m) =&gt; (a, a) -&gt; m a
</span><span class="hs-identifier hs-var">randomRIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[b] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680032061"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>      </span><span class="annot"><span class="annottext">b -&gt; m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; m b) -&gt; b -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680032061"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; Int -&gt; b
forall a. [a] -&gt; Int -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680032060"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-679"></span><span>
</span><span id="line-680"></span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdVersionDataNTN"><span class="hs-identifier hs-type">stdVersionDataNTN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NetworkMagic</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">DiffusionMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToNodeVersionData</span></a></span><span>
</span><span id="line-681"></span><span id="stdVersionDataNTN"><span class="annot"><span class="annottext">stdVersionDataNTN :: NetworkMagic -&gt; DiffusionMode -&gt; NodeToNodeVersionData
</span><a href="Ouroboros.Consensus.Node.html#stdVersionDataNTN"><span class="hs-identifier hs-var hs-var">stdVersionDataNTN</span></a></span></span><span> </span><span id="local-6989586621680032057"><span class="annot"><span class="annottext">NetworkMagic
</span><a href="#local-6989586621680032057"><span class="hs-identifier hs-var">networkMagic</span></a></span></span><span> </span><span id="local-6989586621680032056"><span class="annot"><span class="annottext">DiffusionMode
</span><a href="#local-6989586621680032056"><span class="hs-identifier hs-var">diffusionMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeToNodeVersionData :: NetworkMagic -&gt; DiffusionMode -&gt; NodeToNodeVersionData
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToNodeVersionData</span></a></span><span>
</span><span id="line-682"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">NetworkMagic
networkMagic :: NetworkMagic
networkMagic :: NetworkMagic
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var hs-var">networkMagic</span></a></span><span>
</span><span id="line-683"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DiffusionMode
diffusionMode :: DiffusionMode
diffusionMode :: DiffusionMode
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var hs-var">diffusionMode</span></a></span><span>
</span><span id="line-684"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdVersionDataNTC"><span class="hs-identifier hs-type">stdVersionDataNTC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NetworkMagic</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientVersionData</span></a></span><span>
</span><span id="line-687"></span><span id="stdVersionDataNTC"><span class="annot"><span class="annottext">stdVersionDataNTC :: NetworkMagic -&gt; NodeToClientVersionData
</span><a href="Ouroboros.Consensus.Node.html#stdVersionDataNTC"><span class="hs-identifier hs-var hs-var">stdVersionDataNTC</span></a></span></span><span> </span><span id="local-6989586621680032052"><span class="annot"><span class="annottext">NetworkMagic
</span><a href="#local-6989586621680032052"><span class="hs-identifier hs-var">networkMagic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeToClientVersionData :: NetworkMagic -&gt; NodeToClientVersionData
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientVersionData</span></a></span><span>
</span><span id="line-688"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">NetworkMagic
networkMagic :: NetworkMagic
networkMagic :: NetworkMagic
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var hs-var">networkMagic</span></a></span><span>
</span><span id="line-689"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span id="local-6989586621680032049"><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdRunDataDiffusion"><span class="hs-identifier hs-type">stdRunDataDiffusion</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-692"></span><span>     </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.Tracers</span></a></span><span>
</span><span id="line-693"></span><span>       </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">RemoteAddress</span></a></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToNodeVersion</span></a></span><span>
</span><span id="line-694"></span><span>       </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">LocalAddress</span></a></span><span>   </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientVersion</span></a></span><span>
</span><span id="line-695"></span><span>       </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span>
</span><span id="line-696"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.ExtraTracers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032049"><span class="hs-identifier hs-type">p2p</span></a></span><span>
</span><span id="line-697"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.Arguments</span></a></span><span>
</span><span id="line-698"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">Socket</span></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">RemoteAddress</span></a></span><span>
</span><span id="line-699"></span><span>       </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">LocalSocket</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">LocalAddress</span></a></span><span>
</span><span id="line-700"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.ExtraArguments</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032049"><span class="hs-identifier hs-type">p2p</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span>
</span><span id="line-701"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.Applications</span></a></span><span>
</span><span id="line-702"></span><span>       </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">RemoteAddress</span></a></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToNodeVersion</span></a></span><span>   </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToNodeVersionData</span></a></span><span>
</span><span id="line-703"></span><span>       </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">LocalAddress</span></a></span><span>   </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientVersion</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientVersionData</span></a></span><span>
</span><span id="line-704"></span><span>       </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span>
</span><span id="line-705"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.ExtraApplications</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032049"><span class="hs-identifier hs-type">p2p</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">RemoteAddress</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span>
</span><span id="line-706"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-707"></span><span id="stdRunDataDiffusion"><span class="annot"><span class="annottext">stdRunDataDiffusion :: Tracers
  RemoteAddress NodeToNodeVersion LocalAddress NodeToClientVersion IO
-&gt; ExtraTracers p2p
-&gt; Arguments Socket RemoteAddress LocalSocket LocalAddress
-&gt; ExtraArguments p2p IO
-&gt; Applications
     RemoteAddress
     NodeToNodeVersion
     NodeToNodeVersionData
     LocalAddress
     NodeToClientVersion
     NodeToClientVersionData
     IO
-&gt; ExtraApplications p2p RemoteAddress IO
-&gt; IO ()
</span><a href="Ouroboros.Consensus.Node.html#stdRunDataDiffusion"><span class="hs-identifier hs-var hs-var">stdRunDataDiffusion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracers
  RemoteAddress NodeToNodeVersion LocalAddress NodeToClientVersion IO
-&gt; ExtraTracers p2p
-&gt; Arguments Socket RemoteAddress LocalSocket LocalAddress
-&gt; ExtraArguments p2p IO
-&gt; Applications
     RemoteAddress
     NodeToNodeVersion
     NodeToNodeVersionData
     LocalAddress
     NodeToClientVersion
     NodeToClientVersionData
     IO
-&gt; ExtraApplications p2p RemoteAddress IO
-&gt; IO ()
forall (p2p :: P2P).
Tracers
  RemoteAddress NodeToNodeVersion LocalAddress NodeToClientVersion IO
-&gt; ExtraTracers p2p
-&gt; Arguments Socket RemoteAddress LocalSocket LocalAddress
-&gt; ExtraArguments p2p IO
-&gt; Applications
     RemoteAddress
     NodeToNodeVersion
     NodeToNodeVersionData
     LocalAddress
     NodeToClientVersion
     NodeToClientVersionData
     IO
-&gt; ExtraApplications p2p RemoteAddress IO
-&gt; IO ()
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">Diffusion.run</span></a></span><span>
</span><span id="line-708"></span><span>
</span><span id="line-709"></span><span class="hs-comment">-- | Higher-level arguments that can determine the 'LowLevelRunNodeArgs' under</span><span>
</span><span id="line-710"></span><span class="hs-comment">-- some usual assumptions for realistic use cases such as in @cardano-node@.</span><span>
</span><span id="line-711"></span><span class="hs-comment">--</span><span>
</span><span id="line-712"></span><span class="hs-comment">-- See 'stdLowLevelRunNodeArgsIO'.</span><span>
</span><span id="line-713"></span><span class="hs-keyword">data</span><span> </span><span id="StdRunNodeArgs"><span class="annot"><a href="Ouroboros.Consensus.Node.html#StdRunNodeArgs"><span class="hs-identifier hs-var">StdRunNodeArgs</span></a></span></span><span> </span><span id="local-6989586621680032404"><span class="annot"><a href="#local-6989586621680032404"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680032403"><span class="annot"><a href="#local-6989586621680032403"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680032402"><span class="annot"><a href="#local-6989586621680032402"><span class="hs-identifier hs-type">p2p</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.P2P</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="StdRunNodeArgs"><span class="annot"><a href="Ouroboros.Consensus.Node.html#StdRunNodeArgs"><span class="hs-identifier hs-var">StdRunNodeArgs</span></a></span></span><span>
</span><span id="line-714"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="srnBfcMaxConcurrencyBulkSync"><span class="annot"><span class="annottext">StdRunNodeArgs m blk p2p -&gt; Maybe Word
</span><a href="Ouroboros.Consensus.Node.html#srnBfcMaxConcurrencyBulkSync"><span class="hs-identifier hs-var hs-var">srnBfcMaxConcurrencyBulkSync</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Word</span></a></span><span>
</span><span id="line-715"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="srnBfcMaxConcurrencyDeadline"><span class="annot"><span class="annottext">StdRunNodeArgs m blk p2p -&gt; Maybe Word
</span><a href="Ouroboros.Consensus.Node.html#srnBfcMaxConcurrencyDeadline"><span class="hs-identifier hs-var hs-var">srnBfcMaxConcurrencyDeadline</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Word</span></a></span><span>
</span><span id="line-716"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="srnChainDbValidateOverride"><span class="annot"><span class="annottext">StdRunNodeArgs m blk p2p -&gt; Bool
</span><a href="Ouroboros.Consensus.Node.html#srnChainDbValidateOverride"><span class="hs-identifier hs-var hs-var">srnChainDbValidateOverride</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-717"></span><span>    </span><span class="hs-comment">-- ^ If @True@, validate the ChainDB on init no matter what</span><span>
</span><span id="line-718"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="srnSnapshotInterval"><span class="annot"><span class="annottext">StdRunNodeArgs m blk p2p -&gt; SnapshotInterval
</span><a href="Ouroboros.Consensus.Node.html#srnSnapshotInterval"><span class="hs-identifier hs-var hs-var">srnSnapshotInterval</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.LedgerDB.DiskPolicy.html#SnapshotInterval"><span class="hs-identifier hs-type">SnapshotInterval</span></a></span><span>
</span><span id="line-719"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="srnDatabasePath"><span class="annot"><span class="annottext">StdRunNodeArgs m blk p2p -&gt; String
</span><a href="Ouroboros.Consensus.Node.html#srnDatabasePath"><span class="hs-identifier hs-var hs-var">srnDatabasePath</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-720"></span><span>    </span><span class="hs-comment">-- ^ Location of the DBs</span><span>
</span><span id="line-721"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="srnDiffusionArguments"><span class="annot"><span class="annottext">StdRunNodeArgs m blk p2p
-&gt; Arguments Socket RemoteAddress LocalSocket LocalAddress
</span><a href="Ouroboros.Consensus.Node.html#srnDiffusionArguments"><span class="hs-identifier hs-var hs-var">srnDiffusionArguments</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.Arguments</span></a></span><span>
</span><span id="line-722"></span><span>                                         </span><span class="annot"><span class="hs-identifier hs-type">Socket</span></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">RemoteAddress</span></a></span><span>
</span><span id="line-723"></span><span>                                         </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">LocalSocket</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">LocalAddress</span></a></span><span>
</span><span id="line-724"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="srnDiffusionArgumentsExtra"><span class="annot"><span class="annottext">StdRunNodeArgs m blk p2p -&gt; ExtraArguments p2p m
</span><a href="Ouroboros.Consensus.Node.html#srnDiffusionArgumentsExtra"><span class="hs-identifier hs-var hs-var">srnDiffusionArgumentsExtra</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.ExtraArguments</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032402"><span class="hs-identifier hs-type">p2p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032404"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-725"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="srnDiffusionTracers"><span class="annot"><span class="annottext">StdRunNodeArgs m blk p2p
-&gt; Tracers
     RemoteAddress NodeToNodeVersion LocalAddress NodeToClientVersion IO
</span><a href="Ouroboros.Consensus.Node.html#srnDiffusionTracers"><span class="hs-identifier hs-var hs-var">srnDiffusionTracers</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.Tracers</span></a></span><span>
</span><span id="line-726"></span><span>                                         </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">RemoteAddress</span></a></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToNodeVersion</span></a></span><span>
</span><span id="line-727"></span><span>                                         </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">LocalAddress</span></a></span><span>   </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientVersion</span></a></span><span>
</span><span id="line-728"></span><span>                                         </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="srnDiffusionTracersExtra"><span class="annot"><span class="annottext">StdRunNodeArgs m blk p2p -&gt; ExtraTracers p2p
</span><a href="Ouroboros.Consensus.Node.html#srnDiffusionTracersExtra"><span class="hs-identifier hs-var hs-var">srnDiffusionTracersExtra</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">Diffusion.ExtraTracers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032402"><span class="hs-identifier hs-type">p2p</span></a></span><span>
</span><span id="line-730"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="srnEnableInDevelopmentVersions"><span class="annot"><span class="annottext">StdRunNodeArgs m blk p2p -&gt; Bool
</span><a href="Ouroboros.Consensus.Node.html#srnEnableInDevelopmentVersions"><span class="hs-identifier hs-var hs-var">srnEnableInDevelopmentVersions</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-731"></span><span>    </span><span class="hs-comment">-- ^ If @False@, then the node will limit the negotiated NTN and NTC</span><span>
</span><span id="line-732"></span><span>    </span><span class="hs-comment">-- versions to the latest &quot; official &quot; release (as chosen by Network and</span><span>
</span><span id="line-733"></span><span>    </span><span class="hs-comment">-- Consensus Team, with input from Node Team)</span><span>
</span><span id="line-734"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="srnTraceChainDB"><span class="annot"><span class="annottext">StdRunNodeArgs m blk p2p -&gt; Tracer m (TraceEvent blk)
</span><a href="Ouroboros.Consensus.Node.html#srnTraceChainDB"><span class="hs-identifier hs-var hs-var">srnTraceChainDB</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tracer</span></span><span> </span><span class="annot"><a href="#local-6989586621680032404"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Types.html#TraceEvent"><span class="hs-identifier hs-type">ChainDB.TraceEvent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032403"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-735"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="srnMaybeMempoolCapacityOverride"><span class="annot"><span class="annottext">StdRunNodeArgs m blk p2p -&gt; Maybe MempoolCapacityBytesOverride
</span><a href="Ouroboros.Consensus.Node.html#srnMaybeMempoolCapacityOverride"><span class="hs-identifier hs-var hs-var">srnMaybeMempoolCapacityOverride</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mempool.API.html#MempoolCapacityBytesOverride"><span class="hs-identifier hs-type">MempoolCapacityBytesOverride</span></a></span><span>
</span><span id="line-736"></span><span>    </span><span class="hs-comment">-- ^ Determine whether to use the system default mempool capacity or explicitly set</span><span>
</span><span id="line-737"></span><span>    </span><span class="hs-comment">-- capacity of the mempool.</span><span>
</span><span id="line-738"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span class="hs-comment">-- | Conveniently packaged 'LowLevelRunNodeArgs' arguments from a standard</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- non-testing invocation.</span><span>
</span><span id="line-742"></span><span class="annot"><a href="Ouroboros.Consensus.Node.html#stdLowLevelRunNodeArgsIO"><span class="hs-identifier hs-type">stdLowLevelRunNodeArgsIO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-743"></span><span>     </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680032789"><span class="annot"><a href="#local-6989586621680032789"><span class="hs-identifier hs-type">blk</span></a></span></span><span> </span><span id="local-6989586621680032787"><span class="annot"><a href="#local-6989586621680032787"><span class="hs-identifier hs-type">p2p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.Run.html#RunNode"><span class="hs-identifier hs-type">RunNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032789"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-744"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#RunNodeArgs"><span class="hs-identifier hs-type">RunNodeArgs</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">RemoteAddress</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">LocalAddress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032789"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032787"><span class="hs-identifier hs-type">p2p</span></a></span><span>
</span><span id="line-745"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#StdRunNodeArgs"><span class="hs-identifier hs-type">StdRunNodeArgs</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032789"><span class="hs-identifier hs-type">blk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032787"><span class="hs-identifier hs-type">p2p</span></a></span><span>
</span><span id="line-746"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Node.html#LowLevelRunNodeArgs"><span class="hs-identifier hs-type">LowLevelRunNodeArgs</span></a></span><span>
</span><span id="line-747"></span><span>          </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span>
</span><span id="line-748"></span><span>          </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">RemoteAddress</span></a></span><span>
</span><span id="line-749"></span><span>          </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">LocalAddress</span></a></span><span>
</span><span id="line-750"></span><span>          </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToNodeVersionData</span></a></span><span>
</span><span id="line-751"></span><span>          </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientVersionData</span></a></span><span>
</span><span id="line-752"></span><span>          </span><span class="annot"><a href="#local-6989586621680032789"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-753"></span><span>          </span><span class="annot"><a href="#local-6989586621680032787"><span class="hs-identifier hs-type">p2p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-754"></span><span id="stdLowLevelRunNodeArgsIO"><span class="annot"><span class="annottext">stdLowLevelRunNodeArgsIO :: RunNodeArgs IO RemoteAddress LocalAddress blk p2p
-&gt; StdRunNodeArgs IO blk p2p
-&gt; IO
     (LowLevelRunNodeArgs
        IO
        RemoteAddress
        LocalAddress
        NodeToNodeVersionData
        NodeToClientVersionData
        blk
        p2p)
</span><a href="Ouroboros.Consensus.Node.html#stdLowLevelRunNodeArgsIO"><span class="hs-identifier hs-var hs-var">stdLowLevelRunNodeArgsIO</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#RunNodeArgs"><span class="hs-identifier hs-type">RunNodeArgs</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621680032034"><span class="annot"><span class="annottext">ProtocolInfo IO blk
rnProtocolInfo :: ProtocolInfo IO blk
rnProtocolInfo :: forall (m :: * -&gt; *) addrNTN addrNTC blk (p2p :: P2P).
RunNodeArgs m addrNTN addrNTC blk p2p -&gt; ProtocolInfo m blk
</span><a href="#local-6989586621680032034"><span class="hs-identifier hs-var hs-var">rnProtocolInfo</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Node.html#StdRunNodeArgs"><span class="hs-identifier hs-type">StdRunNodeArgs</span></a></span><span class="hs-special">{</span><span id="local-6989586621680032022"><span id="local-6989586621680032023"><span id="local-6989586621680032024"><span id="local-6989586621680032025"><span id="local-6989586621680032026"><span id="local-6989586621680032027"><span id="local-6989586621680032028"><span id="local-6989586621680032029"><span id="local-6989586621680032030"><span id="local-6989586621680032031"><span id="local-6989586621680032032"><span id="local-6989586621680032033"><span class="annot"><span class="annottext">Bool
String
Maybe Word
Maybe MempoolCapacityBytesOverride
ExtraTracers p2p
ExtraArguments p2p IO
Tracers
  RemoteAddress NodeToNodeVersion LocalAddress NodeToClientVersion IO
Arguments Socket RemoteAddress LocalSocket LocalAddress
Tracer IO (TraceEvent blk)
SnapshotInterval
srnMaybeMempoolCapacityOverride :: Maybe MempoolCapacityBytesOverride
srnTraceChainDB :: Tracer IO (TraceEvent blk)
srnEnableInDevelopmentVersions :: Bool
srnDiffusionTracersExtra :: ExtraTracers p2p
srnDiffusionTracers :: Tracers
  RemoteAddress NodeToNodeVersion LocalAddress NodeToClientVersion IO
srnDiffusionArgumentsExtra :: ExtraArguments p2p IO
srnDiffusionArguments :: Arguments Socket RemoteAddress LocalSocket LocalAddress
srnDatabasePath :: String
srnSnapshotInterval :: SnapshotInterval
srnChainDbValidateOverride :: Bool
srnBfcMaxConcurrencyDeadline :: Maybe Word
srnBfcMaxConcurrencyBulkSync :: Maybe Word
srnMaybeMempoolCapacityOverride :: forall (m :: * -&gt; *) blk (p2p :: P2P).
StdRunNodeArgs m blk p2p -&gt; Maybe MempoolCapacityBytesOverride
srnTraceChainDB :: forall (m :: * -&gt; *) blk (p2p :: P2P).
StdRunNodeArgs m blk p2p -&gt; Tracer m (TraceEvent blk)
srnEnableInDevelopmentVersions :: forall (m :: * -&gt; *) blk (p2p :: P2P).
StdRunNodeArgs m blk p2p -&gt; Bool
srnDiffusionTracersExtra :: forall (m :: * -&gt; *) blk (p2p :: P2P).
StdRunNodeArgs m blk p2p -&gt; ExtraTracers p2p
srnDiffusionTracers :: forall (m :: * -&gt; *) blk (p2p :: P2P).
StdRunNodeArgs m blk p2p
-&gt; Tracers
     RemoteAddress NodeToNodeVersion LocalAddress NodeToClientVersion IO
srnDiffusionArgumentsExtra :: forall (m :: * -&gt; *) blk (p2p :: P2P).
StdRunNodeArgs m blk p2p -&gt; ExtraArguments p2p m
srnDiffusionArguments :: forall (m :: * -&gt; *) blk (p2p :: P2P).
StdRunNodeArgs m blk p2p
-&gt; Arguments Socket RemoteAddress LocalSocket LocalAddress
srnDatabasePath :: forall (m :: * -&gt; *) blk (p2p :: P2P).
StdRunNodeArgs m blk p2p -&gt; String
srnSnapshotInterval :: forall (m :: * -&gt; *) blk (p2p :: P2P).
StdRunNodeArgs m blk p2p -&gt; SnapshotInterval
srnChainDbValidateOverride :: forall (m :: * -&gt; *) blk (p2p :: P2P).
StdRunNodeArgs m blk p2p -&gt; Bool
srnBfcMaxConcurrencyDeadline :: forall (m :: * -&gt; *) blk (p2p :: P2P).
StdRunNodeArgs m blk p2p -&gt; Maybe Word
srnBfcMaxConcurrencyBulkSync :: forall (m :: * -&gt; *) blk (p2p :: P2P).
StdRunNodeArgs m blk p2p -&gt; Maybe Word
</span><a href="#local-6989586621680032022"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-755"></span><span>    </span><span id="local-6989586621680032021"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680032021"><span class="hs-identifier hs-var">llrnBfcSalt</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Int
</span><a href="Ouroboros.Consensus.Node.html#stdBfcSaltIO"><span class="hs-identifier hs-var">stdBfcSaltIO</span></a></span><span>
</span><span id="line-756"></span><span>    </span><span id="local-6989586621680032020"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621680032020"><span class="hs-identifier hs-var">llrnKeepAliveRng</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO StdGen
</span><a href="Ouroboros.Consensus.Node.html#stdKeepAliveRngIO"><span class="hs-identifier hs-var">stdKeepAliveRngIO</span></a></span><span>
</span><span id="line-757"></span><span>    </span><span class="annot"><span class="annottext">LowLevelRunNodeArgs
  IO
  RemoteAddress
  LocalAddress
  NodeToNodeVersionData
  NodeToClientVersionData
  blk
  p2p
-&gt; IO
     (LowLevelRunNodeArgs
        IO
        RemoteAddress
        LocalAddress
        NodeToNodeVersionData
        NodeToClientVersionData
        blk
        p2p)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">LowLevelRunNodeArgs :: forall (m :: * -&gt; *) addrNTN addrNTC versionDataNTN versionDataNTC
       blk (p2p :: P2P).
(forall a.
 (LastShutDownWasClean -&gt; (ChainDB m blk -&gt; m a -&gt; m a) -&gt; m a)
 -&gt; m a)
-&gt; ChainDbArgs Defaults m blk
-&gt; (ChainDbArgs Identity m blk -&gt; ChainDbArgs Identity m blk)
-&gt; (NodeKernelArgs
      m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
    -&gt; NodeKernelArgs
         m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
-&gt; Int
-&gt; StdGen
-&gt; (HardForkBlockchainTimeArgs m blk
    -&gt; HardForkBlockchainTimeArgs m blk)
-&gt; m ChainSyncTimeout
-&gt; (ResourceRegistry m
    -&gt; Applications
         addrNTN
         NodeToNodeVersion
         versionDataNTN
         addrNTC
         NodeToClientVersion
         versionDataNTC
         m
    -&gt; ExtraApplications p2p addrNTN m
    -&gt; m ())
-&gt; versionDataNTC
-&gt; versionDataNTN
-&gt; Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
-&gt; Map NodeToClientVersion (BlockNodeToClientVersion blk)
-&gt; ClockSkew
-&gt; LowLevelRunNodeArgs
     m addrNTN addrNTC versionDataNTN versionDataNTC blk p2p
</span><a href="Ouroboros.Consensus.Node.html#LowLevelRunNodeArgs"><span class="hs-identifier hs-type">LowLevelRunNodeArgs</span></a></span><span>
</span><span id="line-758"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Int
llrnBfcSalt :: Int
llrnBfcSalt :: Int
</span><a href="#local-6989586621680032021"><span class="hs-identifier hs-var hs-var">llrnBfcSalt</span></a></span><span>
</span><span id="line-759"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">llrnChainSyncTimeout :: IO ChainSyncTimeout
</span><a href="Ouroboros.Consensus.Node.html#llrnChainSyncTimeout"><span class="hs-identifier hs-var">llrnChainSyncTimeout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ChainSyncTimeout
</span><a href="Ouroboros.Consensus.Node.html#stdChainSyncTimeout"><span class="hs-identifier hs-var">stdChainSyncTimeout</span></a></span><span>
</span><span id="line-760"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">llrnCustomiseHardForkBlockchainTimeArgs :: HardForkBlockchainTimeArgs IO blk
-&gt; HardForkBlockchainTimeArgs IO blk
</span><a href="Ouroboros.Consensus.Node.html#llrnCustomiseHardForkBlockchainTimeArgs"><span class="hs-identifier hs-var">llrnCustomiseHardForkBlockchainTimeArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HardForkBlockchainTimeArgs IO blk
-&gt; HardForkBlockchainTimeArgs IO blk
forall a. a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-761"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StdGen
llrnKeepAliveRng :: StdGen
llrnKeepAliveRng :: StdGen
</span><a href="#local-6989586621680032020"><span class="hs-identifier hs-var hs-var">llrnKeepAliveRng</span></a></span><span>
</span><span id="line-762"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">llrnChainDbArgsDefaults :: ChainDbArgs Defaults IO blk
</span><a href="Ouroboros.Consensus.Node.html#llrnChainDbArgsDefaults"><span class="hs-identifier hs-var">llrnChainDbArgsDefaults</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-763"></span><span>          </span><span class="annot"><span class="annottext">ChainDbArgs Defaults IO blk -&gt; ChainDbArgs Defaults IO blk
</span><a href="#local-6989586621680032018"><span class="hs-identifier hs-var">updateChainDbDefaults</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainDbArgs Defaults IO blk -&gt; ChainDbArgs Defaults IO blk)
-&gt; ChainDbArgs Defaults IO blk -&gt; ChainDbArgs Defaults IO blk
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(RelativeMountPoint -&gt; SomeHasFS IO)
-&gt; DiskPolicy -&gt; ChainDbArgs Defaults IO blk
forall (m :: * -&gt; *) blk.
Monad m =&gt;
(RelativeMountPoint -&gt; SomeHasFS m)
-&gt; DiskPolicy -&gt; ChainDbArgs Defaults m blk
</span><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#defaultArgs"><span class="hs-identifier hs-var">ChainDB.defaultArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RelativeMountPoint -&gt; SomeHasFS IO
</span><a href="#local-6989586621680032016"><span class="hs-identifier hs-var">mkHasFS</span></a></span><span> </span><span class="annot"><span class="annottext">DiskPolicy
</span><a href="#local-6989586621680032015"><span class="hs-identifier hs-var">diskPolicy</span></a></span><span>
</span><span id="line-764"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">llrnCustomiseChainDbArgs :: ChainDbArgs Identity IO blk -&gt; ChainDbArgs Identity IO blk
</span><a href="Ouroboros.Consensus.Node.html#llrnCustomiseChainDbArgs"><span class="hs-identifier hs-var">llrnCustomiseChainDbArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainDbArgs Identity IO blk -&gt; ChainDbArgs Identity IO blk
forall a. a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-765"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs
  IO (ConnectionId RemoteAddress) (ConnectionId LocalAddress) blk
-&gt; NodeKernelArgs
     IO (ConnectionId RemoteAddress) (ConnectionId LocalAddress) blk
forall (m :: * -&gt; *) addrNTN addrNTC.
NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
llrnCustomiseNodeKernelArgs :: forall (m :: * -&gt; *) addrNTN addrNTC.
NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
llrnCustomiseNodeKernelArgs :: NodeKernelArgs
  IO (ConnectionId RemoteAddress) (ConnectionId LocalAddress) blk
-&gt; NodeKernelArgs
     IO (ConnectionId RemoteAddress) (ConnectionId LocalAddress) blk
</span><a href="#local-6989586621680032014"><span class="hs-identifier hs-var hs-var">llrnCustomiseNodeKernelArgs</span></a></span><span>
</span><span id="line-766"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">llrnRunDataDiffusion :: ResourceRegistry IO
-&gt; Applications
     RemoteAddress
     NodeToNodeVersion
     NodeToNodeVersionData
     LocalAddress
     NodeToClientVersion
     NodeToClientVersionData
     IO
-&gt; ExtraApplications p2p RemoteAddress IO
-&gt; IO ()
</span><a href="Ouroboros.Consensus.Node.html#llrnRunDataDiffusion"><span class="hs-identifier hs-var">llrnRunDataDiffusion</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-767"></span><span>          </span><span class="hs-glyph">\</span><span id="local-6989586621680032013"><span class="annot"><span class="annottext">ResourceRegistry IO
</span><a href="#local-6989586621680032013"><span class="hs-identifier hs-var">_reg</span></a></span></span><span> </span><span id="local-6989586621680032012"><span class="annot"><span class="annottext">Applications
  RemoteAddress
  NodeToNodeVersion
  NodeToNodeVersionData
  LocalAddress
  NodeToClientVersion
  NodeToClientVersionData
  IO
</span><a href="#local-6989586621680032012"><span class="hs-identifier hs-var">apps</span></a></span></span><span> </span><span id="local-6989586621680032011"><span class="annot"><span class="annottext">ExtraApplications p2p RemoteAddress IO
</span><a href="#local-6989586621680032011"><span class="hs-identifier hs-var">extraApps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-768"></span><span>            </span><span class="annot"><span class="annottext">Tracers
  RemoteAddress NodeToNodeVersion LocalAddress NodeToClientVersion IO
-&gt; ExtraTracers p2p
-&gt; Arguments Socket RemoteAddress LocalSocket LocalAddress
-&gt; ExtraArguments p2p IO
-&gt; Applications
     RemoteAddress
     NodeToNodeVersion
     NodeToNodeVersionData
     LocalAddress
     NodeToClientVersion
     NodeToClientVersionData
     IO
-&gt; ExtraApplications p2p RemoteAddress IO
-&gt; IO ()
forall (p2p :: P2P).
Tracers
  RemoteAddress NodeToNodeVersion LocalAddress NodeToClientVersion IO
-&gt; ExtraTracers p2p
-&gt; Arguments Socket RemoteAddress LocalSocket LocalAddress
-&gt; ExtraArguments p2p IO
-&gt; Applications
     RemoteAddress
     NodeToNodeVersion
     NodeToNodeVersionData
     LocalAddress
     NodeToClientVersion
     NodeToClientVersionData
     IO
-&gt; ExtraApplications p2p RemoteAddress IO
-&gt; IO ()
</span><a href="Ouroboros.Consensus.Node.html#stdRunDataDiffusion"><span class="hs-identifier hs-var">stdRunDataDiffusion</span></a></span><span> </span><span class="annot"><span class="annottext">Tracers
  RemoteAddress NodeToNodeVersion LocalAddress NodeToClientVersion IO
</span><a href="#local-6989586621680032026"><span class="hs-identifier hs-var">srnDiffusionTracers</span></a></span><span>
</span><span id="line-769"></span><span>                                </span><span class="annot"><span class="annottext">ExtraTracers p2p
</span><a href="#local-6989586621680032025"><span class="hs-identifier hs-var">srnDiffusionTracersExtra</span></a></span><span>
</span><span id="line-770"></span><span>                                </span><span class="annot"><span class="annottext">Arguments Socket RemoteAddress LocalSocket LocalAddress
</span><a href="#local-6989586621680032028"><span class="hs-identifier hs-var">srnDiffusionArguments</span></a></span><span>
</span><span id="line-771"></span><span>                                </span><span class="annot"><span class="annottext">ExtraArguments p2p IO
</span><a href="#local-6989586621680032027"><span class="hs-identifier hs-var">srnDiffusionArgumentsExtra</span></a></span><span>
</span><span id="line-772"></span><span>                                </span><span class="annot"><span class="annottext">Applications
  RemoteAddress
  NodeToNodeVersion
  NodeToNodeVersionData
  LocalAddress
  NodeToClientVersion
  NodeToClientVersionData
  IO
</span><a href="#local-6989586621680032012"><span class="hs-identifier hs-var">apps</span></a></span><span> </span><span class="annot"><span class="annottext">ExtraApplications p2p RemoteAddress IO
</span><a href="#local-6989586621680032011"><span class="hs-identifier hs-var">extraApps</span></a></span><span>
</span><span id="line-773"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">llrnVersionDataNTC :: NodeToClientVersionData
</span><a href="Ouroboros.Consensus.Node.html#llrnVersionDataNTC"><span class="hs-identifier hs-var">llrnVersionDataNTC</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-774"></span><span>          </span><span class="annot"><span class="annottext">NetworkMagic -&gt; NodeToClientVersionData
</span><a href="Ouroboros.Consensus.Node.html#stdVersionDataNTC"><span class="hs-identifier hs-var">stdVersionDataNTC</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkMagic
</span><a href="#local-6989586621680032010"><span class="hs-identifier hs-var">networkMagic</span></a></span><span>
</span><span id="line-775"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">llrnVersionDataNTN :: NodeToNodeVersionData
</span><a href="Ouroboros.Consensus.Node.html#llrnVersionDataNTN"><span class="hs-identifier hs-var">llrnVersionDataNTN</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-776"></span><span>          </span><span class="annot"><span class="annottext">NetworkMagic -&gt; DiffusionMode -&gt; NodeToNodeVersionData
</span><a href="Ouroboros.Consensus.Node.html#stdVersionDataNTN"><span class="hs-identifier hs-var">stdVersionDataNTN</span></a></span><span>
</span><span id="line-777"></span><span>            </span><span class="annot"><span class="annottext">NetworkMagic
</span><a href="#local-6989586621680032010"><span class="hs-identifier hs-var">networkMagic</span></a></span><span>
</span><span id="line-778"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arguments Socket RemoteAddress LocalSocket LocalAddress
-&gt; DiffusionMode
forall ntnFd ntnAddr ntcFd ntcAddr.
Arguments ntnFd ntnAddr ntcFd ntcAddr -&gt; DiffusionMode
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var hs-var">Diffusion.daMode</span></a></span><span> </span><span class="annot"><span class="annottext">Arguments Socket RemoteAddress LocalSocket LocalAddress
</span><a href="#local-6989586621680032028"><span class="hs-identifier hs-var">srnDiffusionArguments</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">llrnNodeToNodeVersions :: Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
</span><a href="Ouroboros.Consensus.Node.html#llrnNodeToNodeVersions"><span class="hs-identifier hs-var">llrnNodeToNodeVersions</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-780"></span><span>          </span><span class="annot"><span class="annottext">((Maybe NodeToNodeVersion, Maybe NodeToClientVersion)
 -&gt; Maybe NodeToNodeVersion)
-&gt; Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
-&gt; Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
forall k v.
Ord k =&gt;
((Maybe NodeToNodeVersion, Maybe NodeToClientVersion) -&gt; Maybe k)
-&gt; Map k v -&gt; Map k v
</span><a href="#local-6989586621680032008"><span class="hs-identifier hs-var">limitToLatestReleasedVersion</span></a></span><span>
</span><span id="line-781"></span><span>            </span><span class="annot"><span class="annottext">(Maybe NodeToNodeVersion, Maybe NodeToClientVersion)
-&gt; Maybe NodeToNodeVersion
forall a b. (a, b) -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span>
</span><span id="line-782"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
forall blk.
SupportedNetworkProtocolVersion blk =&gt;
Proxy blk -&gt; Map NodeToNodeVersion (BlockNodeToNodeVersion blk)
</span><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#supportedNodeToNodeVersions"><span class="hs-identifier hs-var">supportedNodeToNodeVersions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk
forall k (t :: k). Proxy t
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680032789"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">llrnNodeToClientVersions :: Map NodeToClientVersion (BlockNodeToClientVersion blk)
</span><a href="Ouroboros.Consensus.Node.html#llrnNodeToClientVersions"><span class="hs-identifier hs-var">llrnNodeToClientVersions</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-784"></span><span>          </span><span class="annot"><span class="annottext">((Maybe NodeToNodeVersion, Maybe NodeToClientVersion)
 -&gt; Maybe NodeToClientVersion)
-&gt; Map NodeToClientVersion (BlockNodeToClientVersion blk)
-&gt; Map NodeToClientVersion (BlockNodeToClientVersion blk)
forall k v.
Ord k =&gt;
((Maybe NodeToNodeVersion, Maybe NodeToClientVersion) -&gt; Maybe k)
-&gt; Map k v -&gt; Map k v
</span><a href="#local-6989586621680032008"><span class="hs-identifier hs-var">limitToLatestReleasedVersion</span></a></span><span>
</span><span id="line-785"></span><span>            </span><span class="annot"><span class="annottext">(Maybe NodeToNodeVersion, Maybe NodeToClientVersion)
-&gt; Maybe NodeToClientVersion
forall a b. (a, b) -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span>
</span><span id="line-786"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk -&gt; Map NodeToClientVersion (BlockNodeToClientVersion blk)
forall blk.
SupportedNetworkProtocolVersion blk =&gt;
Proxy blk -&gt; Map NodeToClientVersion (BlockNodeToClientVersion blk)
</span><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#supportedNodeToClientVersions"><span class="hs-identifier hs-var">supportedNodeToClientVersions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk
forall k (t :: k). Proxy t
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680032789"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">llrnWithCheckedDB :: forall a.
(LastShutDownWasClean -&gt; (ChainDB IO blk -&gt; IO a -&gt; IO a) -&gt; IO a)
-&gt; IO a
</span><a href="Ouroboros.Consensus.Node.html#llrnWithCheckedDB"><span class="hs-identifier hs-var">llrnWithCheckedDB</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-788"></span><span>          </span><span class="annot"><span class="annottext">Proxy blk
-&gt; String
-&gt; NetworkMagic
-&gt; (LastShutDownWasClean
    -&gt; (ChainDB IO blk -&gt; IO a -&gt; IO a) -&gt; IO a)
-&gt; IO a
forall blk a.
(StandardHash blk, Typeable blk) =&gt;
Proxy blk
-&gt; String
-&gt; NetworkMagic
-&gt; (LastShutDownWasClean
    -&gt; (ChainDB IO blk -&gt; IO a -&gt; IO a) -&gt; IO a)
-&gt; IO a
</span><a href="Ouroboros.Consensus.Node.html#stdWithCheckedDB"><span class="hs-identifier hs-var">stdWithCheckedDB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk
forall k (t :: k). Proxy t
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680032789"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680032029"><span class="hs-identifier hs-var">srnDatabasePath</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkMagic
</span><a href="#local-6989586621680032010"><span class="hs-identifier hs-var">networkMagic</span></a></span><span>
</span><span id="line-789"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">llrnMaxClockSkew :: ClockSkew
</span><a href="Ouroboros.Consensus.Node.html#llrnMaxClockSkew"><span class="hs-identifier hs-var">llrnMaxClockSkew</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-790"></span><span>          </span><span class="annot"><span class="annottext">ClockSkew
</span><a href="Ouroboros.Consensus.Fragment.InFuture.html#defaultClockSkew"><span class="hs-identifier hs-var">InFuture.defaultClockSkew</span></a></span><span>
</span><span id="line-791"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-792"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-793"></span><span>    </span><span id="local-6989586621680032015"><span class="annot"><span class="annottext">diskPolicy :: DiskPolicy
</span><a href="#local-6989586621680032015"><span class="hs-identifier hs-var hs-var">diskPolicy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-794"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-795"></span><span>        </span><span id="local-6989586621680032004"><span class="annot"><span class="annottext">cfg :: TopLevelConfig blk
</span><a href="#local-6989586621680032004"><span class="hs-identifier hs-var hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProtocolInfo IO blk -&gt; TopLevelConfig blk
forall (m :: * -&gt; *) b. ProtocolInfo m b -&gt; TopLevelConfig b
</span><a href="Ouroboros.Consensus.Node.ProtocolInfo.html#pInfoConfig"><span class="hs-identifier hs-var hs-var">pInfoConfig</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolInfo IO blk
</span><a href="#local-6989586621680032034"><span class="hs-identifier hs-var">rnProtocolInfo</span></a></span><span>
</span><span id="line-796"></span><span>        </span><span id="local-6989586621680032003"><span class="annot"><span class="annottext">k :: SecurityParam
</span><a href="#local-6989586621680032003"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk -&gt; SecurityParam
forall blk.
ConsensusProtocol (BlockProtocol blk) =&gt;
TopLevelConfig blk -&gt; SecurityParam
</span><a href="Ouroboros.Consensus.Config.html#configSecurityParam"><span class="hs-identifier hs-var">configSecurityParam</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk
</span><a href="#local-6989586621680032004"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-797"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">SecurityParam -&gt; SnapshotInterval -&gt; DiskPolicy
</span><a href="Ouroboros.Consensus.Storage.LedgerDB.DiskPolicy.html#defaultDiskPolicy"><span class="hs-identifier hs-var">defaultDiskPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">SecurityParam
</span><a href="#local-6989586621680032003"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">SnapshotInterval
</span><a href="#local-6989586621680032030"><span class="hs-identifier hs-var">srnSnapshotInterval</span></a></span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span>    </span><span class="annot"><a href="#local-6989586621680032016"><span class="hs-identifier hs-type">mkHasFS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#RelativeMountPoint"><span class="hs-identifier hs-type">ChainDB.RelativeMountPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.FS.API.html#SomeHasFS"><span class="hs-identifier hs-type">SomeHasFS</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span>
</span><span id="line-800"></span><span>    </span><span id="local-6989586621680032016"><span class="annot"><span class="annottext">mkHasFS :: RelativeMountPoint -&gt; SomeHasFS IO
</span><a href="#local-6989586621680032016"><span class="hs-identifier hs-var hs-var">mkHasFS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RelativeMountPoint -&gt; SomeHasFS IO
</span><a href="Ouroboros.Consensus.Node.html#stdMkChainDbHasFS"><span class="hs-identifier hs-var">stdMkChainDbHasFS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680032029"><span class="hs-identifier hs-var">srnDatabasePath</span></a></span><span>
</span><span id="line-801"></span><span>
</span><span id="line-802"></span><span>    </span><span class="annot"><a href="#local-6989586621680032010"><span class="hs-identifier hs-type">networkMagic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NetworkMagic</span></a></span><span>
</span><span id="line-803"></span><span>    </span><span id="local-6989586621680032010"><span class="annot"><span class="annottext">networkMagic :: NetworkMagic
</span><a href="#local-6989586621680032010"><span class="hs-identifier hs-var hs-var">networkMagic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockConfig blk -&gt; NetworkMagic
forall blk.
ConfigSupportsNode blk =&gt;
BlockConfig blk -&gt; NetworkMagic
</span><a href="Ouroboros.Consensus.Config.SupportsNode.html#getNetworkMagic"><span class="hs-identifier hs-var">getNetworkMagic</span></a></span><span> </span><span class="annot"><span class="annottext">(BlockConfig blk -&gt; NetworkMagic)
-&gt; BlockConfig blk -&gt; NetworkMagic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig blk -&gt; BlockConfig blk
forall blk. TopLevelConfig blk -&gt; BlockConfig blk
</span><a href="Ouroboros.Consensus.Config.html#configBlock"><span class="hs-identifier hs-var">configBlock</span></a></span><span> </span><span class="annot"><span class="annottext">(TopLevelConfig blk -&gt; BlockConfig blk)
-&gt; TopLevelConfig blk -&gt; BlockConfig blk
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolInfo IO blk -&gt; TopLevelConfig blk
forall (m :: * -&gt; *) b. ProtocolInfo m b -&gt; TopLevelConfig b
</span><a href="Ouroboros.Consensus.Node.ProtocolInfo.html#pInfoConfig"><span class="hs-identifier hs-var hs-var">pInfoConfig</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolInfo IO blk
</span><a href="#local-6989586621680032034"><span class="hs-identifier hs-var">rnProtocolInfo</span></a></span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span>    </span><span class="annot"><a href="#local-6989586621680032018"><span class="hs-identifier hs-type">updateChainDbDefaults</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-806"></span><span>         </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#ChainDbArgs"><span class="hs-identifier hs-type">ChainDbArgs</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.Args.html#Defaults"><span class="hs-identifier hs-type">Defaults</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032789"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-807"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#ChainDbArgs"><span class="hs-identifier hs-type">ChainDbArgs</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Util.Args.html#Defaults"><span class="hs-identifier hs-type">Defaults</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032789"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-808"></span><span>    </span><span id="local-6989586621680032018"><span class="annot"><span class="annottext">updateChainDbDefaults :: ChainDbArgs Defaults IO blk -&gt; ChainDbArgs Defaults IO blk
</span><a href="#local-6989586621680032018"><span class="hs-identifier hs-var hs-var">updateChainDbDefaults</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-809"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680032000"><span class="annot"><span class="annottext">ChainDbArgs Defaults IO blk
</span><a href="#local-6989586621680032000"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChainDbArgs Defaults IO blk
</span><a href="#local-6989586621680032000"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cdbTracer :: Tracer IO (TraceEvent blk)
</span><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#cdbTracer"><span class="hs-identifier hs-var">ChainDB.cdbTracer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracer IO (TraceEvent blk)
</span><a href="#local-6989586621680032023"><span class="hs-identifier hs-var">srnTraceChainDB</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ChainDbArgs Defaults IO blk -&gt; ChainDbArgs Defaults IO blk)
-&gt; (ChainDbArgs Defaults IO blk -&gt; ChainDbArgs Defaults IO blk)
-&gt; ChainDbArgs Defaults IO blk
-&gt; ChainDbArgs Defaults IO blk
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-810"></span><span>        </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680032031"><span class="hs-identifier hs-var">srnChainDbValidateOverride</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ChainDbArgs Defaults IO blk -&gt; ChainDbArgs Defaults IO blk
forall a. a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680031997"><span class="annot"><span class="annottext">ChainDbArgs Defaults IO blk
</span><a href="#local-6989586621680031997"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChainDbArgs Defaults IO blk
</span><a href="#local-6989586621680031997"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-811"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cdbImmutableDbValidation :: ValidationPolicy
</span><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#cdbImmutableDbValidation"><span class="hs-identifier hs-var">ChainDB.cdbImmutableDbValidation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ValidationPolicy
</span><a href="Ouroboros.Consensus.Storage.ImmutableDB.Impl.Types.html#ValidateAllChunks"><span class="hs-identifier hs-var">ValidateAllChunks</span></a></span><span>
</span><span id="line-812"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cdbVolatileDbValidation :: BlockValidationPolicy
</span><a href="Ouroboros.Consensus.Storage.ChainDB.Impl.Args.html#cdbVolatileDbValidation"><span class="hs-identifier hs-var">ChainDB.cdbVolatileDbValidation</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockValidationPolicy
</span><a href="Ouroboros.Consensus.Storage.VolatileDB.Impl.Types.html#ValidateAll"><span class="hs-identifier hs-var">ValidateAll</span></a></span><span>
</span><span id="line-813"></span><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-814"></span><span>
</span><span id="line-815"></span><span>    </span><span id="local-6989586621680032395"><span id="local-6989586621680032396"><span id="local-6989586621680032397"><span class="annot"><a href="#local-6989586621680032014"><span class="hs-identifier hs-type">llrnCustomiseNodeKernelArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-816"></span><span>         </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032397"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032396"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032395"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032789"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-817"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032397"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032396"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032395"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032789"><span class="hs-identifier hs-type">blk</span></a></span></span></span></span><span>
</span><span id="line-818"></span><span>    </span><span id="local-6989586621680032014"><span class="annot"><span class="annottext">llrnCustomiseNodeKernelArgs :: NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680032014"><span class="hs-identifier hs-var hs-var">llrnCustomiseNodeKernelArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-819"></span><span>        </span><span class="annot"><span class="annottext">(BlockFetchConfiguration -&gt; BlockFetchConfiguration)
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
forall (m :: * -&gt; *) addrNTN addrNTC blk.
(BlockFetchConfiguration -&gt; BlockFetchConfiguration)
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="Ouroboros.Consensus.Node.html#overBlockFetchConfiguration"><span class="hs-identifier hs-var">overBlockFetchConfiguration</span></a></span><span> </span><span class="annot"><span class="annottext">BlockFetchConfiguration -&gt; BlockFetchConfiguration
</span><a href="#local-6989586621680031995"><span class="hs-identifier hs-var">modifyBlockFetchConfiguration</span></a></span><span>
</span><span id="line-820"></span><span>      </span><span class="annot"><span class="annottext">(NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
 -&gt; NodeKernelArgs
      m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
-&gt; (NodeKernelArgs
      m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
    -&gt; NodeKernelArgs
         m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680031994"><span class="hs-identifier hs-var">modifyMempoolCapacityOverride</span></a></span><span>
</span><span id="line-821"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-822"></span><span>        </span><span id="local-6989586621680031995"><span class="annot"><span class="annottext">modifyBlockFetchConfiguration :: BlockFetchConfiguration -&gt; BlockFetchConfiguration
</span><a href="#local-6989586621680031995"><span class="hs-identifier hs-var hs-var">modifyBlockFetchConfiguration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-823"></span><span>            </span><span class="annot"><span class="annottext">(BlockFetchConfiguration -&gt; BlockFetchConfiguration)
-&gt; (Word -&gt; BlockFetchConfiguration -&gt; BlockFetchConfiguration)
-&gt; Maybe Word
-&gt; BlockFetchConfiguration
-&gt; BlockFetchConfiguration
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">BlockFetchConfiguration -&gt; BlockFetchConfiguration
forall a. a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-824"></span><span>              </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680031992"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621680031992"><span class="hs-identifier hs-var">mc</span></a></span></span><span> </span><span id="local-6989586621680031991"><span class="annot"><span class="annottext">BlockFetchConfiguration
</span><a href="#local-6989586621680031991"><span class="hs-identifier hs-var">bfc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BlockFetchConfiguration
</span><a href="#local-6989586621680031991"><span class="hs-identifier hs-var">bfc</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bfcMaxConcurrencyDeadline :: Word
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">bfcMaxConcurrencyDeadline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621680031992"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-825"></span><span>              </span><span class="annot"><span class="annottext">Maybe Word
</span><a href="#local-6989586621680032032"><span class="hs-identifier hs-var">srnBfcMaxConcurrencyDeadline</span></a></span><span>
</span><span id="line-826"></span><span>          </span><span class="annot"><span class="annottext">(BlockFetchConfiguration -&gt; BlockFetchConfiguration)
-&gt; (BlockFetchConfiguration -&gt; BlockFetchConfiguration)
-&gt; BlockFetchConfiguration
-&gt; BlockFetchConfiguration
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(BlockFetchConfiguration -&gt; BlockFetchConfiguration)
-&gt; (Word -&gt; BlockFetchConfiguration -&gt; BlockFetchConfiguration)
-&gt; Maybe Word
-&gt; BlockFetchConfiguration
-&gt; BlockFetchConfiguration
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">BlockFetchConfiguration -&gt; BlockFetchConfiguration
forall a. a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-827"></span><span>              </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680031990"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621680031990"><span class="hs-identifier hs-var">mc</span></a></span></span><span> </span><span id="local-6989586621680031989"><span class="annot"><span class="annottext">BlockFetchConfiguration
</span><a href="#local-6989586621680031989"><span class="hs-identifier hs-var">bfc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BlockFetchConfiguration
</span><a href="#local-6989586621680031989"><span class="hs-identifier hs-var">bfc</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bfcMaxConcurrencyBulkSync :: Word
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">bfcMaxConcurrencyBulkSync</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621680031990"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-828"></span><span>              </span><span class="annot"><span class="annottext">Maybe Word
</span><a href="#local-6989586621680032033"><span class="hs-identifier hs-var">srnBfcMaxConcurrencyBulkSync</span></a></span><span>
</span><span id="line-829"></span><span>        </span><span id="local-6989586621680031994"><span class="annot"><span class="annottext">modifyMempoolCapacityOverride :: NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680031994"><span class="hs-identifier hs-var hs-var">modifyMempoolCapacityOverride</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-830"></span><span>            </span><span class="annot"><span class="annottext">(NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
 -&gt; NodeKernelArgs
      m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
-&gt; (MempoolCapacityBytesOverride
    -&gt; NodeKernelArgs
         m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
    -&gt; NodeKernelArgs
         m (ConnectionId addrNTN) (ConnectionId addrNTC) blk)
-&gt; Maybe MempoolCapacityBytesOverride
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
forall a. a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-831"></span><span>              </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680031988"><span class="annot"><span class="annottext">MempoolCapacityBytesOverride
</span><a href="#local-6989586621680031988"><span class="hs-identifier hs-var">mc</span></a></span></span><span> </span><span id="local-6989586621680031987"><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680031987"><span class="hs-identifier hs-var">nka</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680031987"><span class="hs-identifier hs-var">nka</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:mempoolCapacityOverride:NodeKernelArgs :: MempoolCapacityBytesOverride
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AmempoolCapacityOverride%3ANodeKernelArgs"><span class="hs-identifier hs-var">mempoolCapacityOverride</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MempoolCapacityBytesOverride
</span><a href="#local-6989586621680031988"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-832"></span><span>              </span><span class="annot"><span class="annottext">Maybe MempoolCapacityBytesOverride
</span><a href="#local-6989586621680032022"><span class="hs-identifier hs-var">srnMaybeMempoolCapacityOverride</span></a></span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span>    </span><span class="hs-comment">-- Limit the node version unless srnEnableInDevelopmentVersions is set</span><span>
</span><span id="line-835"></span><span>    </span><span class="annot"><a href="#local-6989586621680032008"><span class="hs-identifier hs-type">limitToLatestReleasedVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680032390"><span class="annot"><a href="#local-6989586621680032390"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621680032389"><span class="annot"><a href="#local-6989586621680032389"><span class="hs-identifier hs-type">v</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-836"></span><span>         </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032390"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-837"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToNodeVersion</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">NodeToClientVersion</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032390"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-838"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032390"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032389"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-839"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032390"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032389"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-840"></span><span>    </span><span id="local-6989586621680032008"><span class="annot"><span class="annottext">limitToLatestReleasedVersion :: ((Maybe NodeToNodeVersion, Maybe NodeToClientVersion) -&gt; Maybe k)
-&gt; Map k v -&gt; Map k v
</span><a href="#local-6989586621680032008"><span class="hs-identifier hs-var hs-var">limitToLatestReleasedVersion</span></a></span></span><span> </span><span id="local-6989586621680031986"><span class="annot"><span class="annottext">(Maybe NodeToNodeVersion, Maybe NodeToClientVersion) -&gt; Maybe k
</span><a href="#local-6989586621680031986"><span class="hs-identifier hs-var">prj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-841"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680032024"><span class="hs-identifier hs-var">srnEnableInDevelopmentVersions</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v
forall a. a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-842"></span><span>        </span><span class="hs-keyword">else</span><span>
</span><span id="line-843"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Maybe NodeToNodeVersion, Maybe NodeToClientVersion) -&gt; Maybe k
</span><a href="#local-6989586621680031986"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe NodeToNodeVersion, Maybe NodeToClientVersion) -&gt; Maybe k)
-&gt; (Maybe NodeToNodeVersion, Maybe NodeToClientVersion) -&gt; Maybe k
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy blk -&gt; (Maybe NodeToNodeVersion, Maybe NodeToClientVersion)
forall blk.
SupportedNetworkProtocolVersion blk =&gt;
Proxy blk -&gt; (Maybe NodeToNodeVersion, Maybe NodeToClientVersion)
</span><a href="Ouroboros.Consensus.Node.NetworkProtocolVersion.html#latestReleasedNodeVersion"><span class="hs-identifier hs-var">latestReleasedNodeVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy blk
forall k (t :: k). Proxy t
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680032789"><span class="hs-identifier hs-type">blk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-844"></span><span>          </span><span class="annot"><span class="annottext">Maybe k
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v
forall a. a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-845"></span><span>          </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680031984"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621680031984"><span class="hs-identifier hs-var">version</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k -&gt; Bool) -&gt; Map k v -&gt; Map k v
forall k a. (k -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-var">Map.takeWhileAntitone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621680031984"><span class="hs-identifier hs-var">version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-846"></span><span>
</span><span id="line-847"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Miscellany
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-850"></span><span>
</span><span id="line-851"></span><span id="local-6989586621680032369"><span id="local-6989586621680032370"><span id="local-6989586621680032371"><span id="local-6989586621680032372"><span class="annot"><a href="Ouroboros.Consensus.Node.html#overBlockFetchConfiguration"><span class="hs-identifier hs-type">overBlockFetchConfiguration</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-852"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">BlockFetchConfiguration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">BlockFetchConfiguration</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-853"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032372"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032371"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032370"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032369"><span class="hs-identifier hs-type">blk</span></a></span><span>
</span><span id="line-854"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032372"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032371"><span class="hs-identifier hs-type">addrNTN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-framework-0.1.0.0/noopt/doc/html/ouroboros-network-framework/src"><span class="hs-identifier hs-type">ConnectionId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680032370"><span class="hs-identifier hs-type">addrNTC</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680032369"><span class="hs-identifier hs-type">blk</span></a></span></span></span></span></span><span>
</span><span id="line-855"></span><span id="overBlockFetchConfiguration"><span class="annot"><span class="annottext">overBlockFetchConfiguration :: (BlockFetchConfiguration -&gt; BlockFetchConfiguration)
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
-&gt; NodeKernelArgs
     m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="Ouroboros.Consensus.Node.html#overBlockFetchConfiguration"><span class="hs-identifier hs-var hs-var">overBlockFetchConfiguration</span></a></span></span><span> </span><span id="local-6989586621680031981"><span class="annot"><span class="annottext">BlockFetchConfiguration -&gt; BlockFetchConfiguration
</span><a href="#local-6989586621680031981"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680031980"><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680031980"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680031980"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-856"></span><span>      </span><span class="annot"><span class="annottext">$sel:blockFetchConfiguration:NodeKernelArgs :: BlockFetchConfiguration
</span><a href="Ouroboros.Consensus.NodeKernel.html#%24sel%3AblockFetchConfiguration%3ANodeKernelArgs"><span class="hs-identifier hs-var">blockFetchConfiguration</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockFetchConfiguration -&gt; BlockFetchConfiguration
</span><a href="#local-6989586621680031981"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">BlockFetchConfiguration
</span><a href="#local-6989586621680031979"><span class="hs-identifier hs-var">blockFetchConfiguration</span></a></span><span>
</span><span id="line-857"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-858"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-859"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.NodeKernel.html#NodeKernelArgs"><span class="hs-identifier hs-type">NodeKernelArgs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680031979"><span class="annot"><span class="annottext">BlockFetchConfiguration
blockFetchConfiguration :: BlockFetchConfiguration
$sel:blockFetchConfiguration:NodeKernelArgs :: forall (m :: * -&gt; *) remotePeer localPeer blk.
NodeKernelArgs m remotePeer localPeer blk
-&gt; BlockFetchConfiguration
</span><a href="#local-6989586621680031979"><span class="hs-identifier hs-var hs-var">blockFetchConfiguration</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeKernelArgs m (ConnectionId addrNTN) (ConnectionId addrNTC) blk
</span><a href="#local-6989586621680031980"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-860"></span></pre></body></html>