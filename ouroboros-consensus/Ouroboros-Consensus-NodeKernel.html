<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ouroboros.Consensus.NodeKernel</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Ouroboros.Consensus.NodeKernel.html">Source</a></li><li><a href="&quot;../index.html&quot;">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ouroboros-consensus-0.1.0.0: Consensus layer for the Ouroboros blockchain protocol</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Ouroboros.Consensus.NodeKernel</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Node kernel</a></li></ul></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:NodeKernel">NodeKernel</a> m remotePeer localPeer blk = <a href="#v:NodeKernel">NodeKernel</a> {<ul class="subs"><li><a href="#v:getChainDB">getChainDB</a> &#8759; <a href="Ouroboros-Consensus-Storage-ChainDB-API.html#t:ChainDB" title="Ouroboros.Consensus.Storage.ChainDB.API">ChainDB</a> m blk</li><li><a href="#v:getMempool">getMempool</a> &#8759; <a href="Ouroboros-Consensus-Mempool-API.html#t:Mempool" title="Ouroboros.Consensus.Mempool.API">Mempool</a> m blk <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a></li><li><a href="#v:getTopLevelConfig">getTopLevelConfig</a> &#8759; <a href="Ouroboros-Consensus-Config.html#t:TopLevelConfig" title="Ouroboros.Consensus.Config">TopLevelConfig</a> blk</li><li><a href="#v:getFetchClientRegistry">getFetchClientRegistry</a> &#8759; <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-BlockFetch-ClientRegistry.html#t:FetchClientRegistry" title="Ouroboros.Network.BlockFetch.ClientRegistry">FetchClientRegistry</a> remotePeer (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk) blk m</li><li><a href="#v:getNodeCandidates">getNodeCandidates</a> &#8759; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:StrictTVar" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">StrictTVar</a> m (<a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/Cardano-Prelude-Base.html#t:Map" title="Cardano.Prelude.Base">Map</a> remotePeer (<a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:StrictTVar" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">StrictTVar</a> m (<a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-AnchoredFragment.html#t:AnchoredFragment" title="Ouroboros.Network.AnchoredFragment">AnchoredFragment</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk))))</li><li><a href="#v:getTracers">getTracers</a> &#8759; <a href="Ouroboros-Consensus-Node-Tracers.html#t:Tracers" title="Ouroboros.Consensus.Node.Tracers">Tracers</a> m remotePeer localPeer blk</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:BlockProduction">BlockProduction</a> m blk = <a href="#v:BlockProduction">BlockProduction</a> {<ul class="subs"><li><a href="#v:produceBlock">produceBlock</a> &#8759; &#8704; n. <a href="Ouroboros-Consensus-Util-Random.html#t:MonadRandom" title="Ouroboros.Consensus.Util.Random">MonadRandom</a> n &#8658; (&#8704; a. m a &#8594; n a) &#8594; <a href="Ouroboros-Consensus-Node-State.html#t:Update" title="Ouroboros.Consensus.Node.State">Update</a> n (<a href="Ouroboros-Consensus-Node-State.html#t:NodeState" title="Ouroboros.Consensus.Node.State">NodeState</a> blk) &#8594; <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/Cardano-Slotting-Block.html#t:BlockNo" title="Cardano.Slotting.Block">BlockNo</a> &#8594; <a href="Ouroboros-Consensus-Ledger-Abstract.html#t:TickedLedgerState" title="Ouroboros.Consensus.Ledger.Abstract">TickedLedgerState</a> blk &#8594; [<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTx" title="Ouroboros.Consensus.Mempool.API">GenTx</a> blk] &#8594; <a href="Ouroboros-Consensus-Protocol-Abstract.html#t:IsLeader" title="Ouroboros.Consensus.Protocol.Abstract">IsLeader</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:BlockProtocol" title="Ouroboros.Consensus.Block.Abstract">BlockProtocol</a> blk) &#8594; n blk</li><li><a href="#v:runMonadRandomDict">runMonadRandomDict</a> &#8759; <a href="Ouroboros-Consensus-Util-Random.html#t:RunMonadRandom" title="Ouroboros.Consensus.Util.Random">RunMonadRandom</a> m</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:MaxBlockSizeOverride">MaxBlockSizeOverride</a><ul class="subs"><li>= <a href="#v:NoOverride">NoOverride</a></li><li>| <a href="#v:MaxBlockSize">MaxBlockSize</a> !<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li><li>| <a href="#v:MaxBlockBodySize">MaxBlockBodySize</a> !<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:MempoolCapacityBytesOverride">MempoolCapacityBytesOverride</a><ul class="subs"><li>= <a href="#v:NoMempoolCapacityBytesOverride">NoMempoolCapacityBytesOverride</a></li><li>| <a href="#v:MempoolCapacityBytesOverride">MempoolCapacityBytesOverride</a> !<a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolCapacityBytes" title="Ouroboros.Consensus.Mempool.API">MempoolCapacityBytes</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:NodeArgs">NodeArgs</a> m remotePeer localPeer blk = <a href="#v:NodeArgs">NodeArgs</a> {<ul class="subs"><li><a href="#v:tracers">tracers</a> &#8759; <a href="Ouroboros-Consensus-Node-Tracers.html#t:Tracers" title="Ouroboros.Consensus.Node.Tracers">Tracers</a> m remotePeer localPeer blk</li><li><a href="#v:registry">registry</a> &#8759; <a href="Ouroboros-Consensus-Util-ResourceRegistry.html#t:ResourceRegistry" title="Ouroboros.Consensus.Util.ResourceRegistry">ResourceRegistry</a> m</li><li><a href="#v:maxClockSkew">maxClockSkew</a> &#8759; <a href="Ouroboros-Consensus-MiniProtocol-ChainSync-Client.html#t:ClockSkew" title="Ouroboros.Consensus.MiniProtocol.ChainSync.Client">ClockSkew</a></li><li><a href="#v:cfg">cfg</a> &#8759; <a href="Ouroboros-Consensus-Config.html#t:TopLevelConfig" title="Ouroboros.Consensus.Config">TopLevelConfig</a> blk</li><li><a href="#v:initState">initState</a> &#8759; <a href="Ouroboros-Consensus-Node-State.html#t:NodeState" title="Ouroboros.Consensus.Node.State">NodeState</a> blk</li><li><a href="#v:btime">btime</a> &#8759; <a href="Ouroboros-Consensus-BlockchainTime-API.html#t:BlockchainTime" title="Ouroboros.Consensus.BlockchainTime.API">BlockchainTime</a> m</li><li><a href="#v:chainDB">chainDB</a> &#8759; <a href="Ouroboros-Consensus-Storage-ChainDB-API.html#t:ChainDB" title="Ouroboros.Consensus.Storage.ChainDB.API">ChainDB</a> m blk</li><li><a href="#v:initChainDB">initChainDB</a> &#8759; <a href="Ouroboros-Consensus-Config.html#t:TopLevelConfig" title="Ouroboros.Consensus.Config">TopLevelConfig</a> blk &#8594; <a href="Ouroboros-Consensus-Storage-ChainDB-API.html#t:ChainDB" title="Ouroboros.Consensus.Storage.ChainDB.API">ChainDB</a> m blk &#8594; m ()</li><li><a href="#v:blockFetchSize">blockFetchSize</a> &#8759; <a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk &#8594; <a href="Ouroboros-Consensus-Storage-Common.html#t:SizeInBytes" title="Ouroboros.Consensus.Storage.Common">SizeInBytes</a></li><li><a href="#v:blockProduction">blockProduction</a> &#8759; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-NodeKernel.html#t:BlockProduction" title="Ouroboros.Consensus.NodeKernel">BlockProduction</a> m blk)</li><li><a href="#v:blockMatchesHeader">blockMatchesHeader</a> &#8759; <a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk &#8594; blk &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li><a href="#v:maxBlockSize">maxBlockSize</a> &#8759; <a href="Ouroboros-Consensus-NodeKernel.html#t:MaxBlockSizeOverride" title="Ouroboros.Consensus.NodeKernel">MaxBlockSizeOverride</a></li><li><a href="#v:mempoolCap">mempoolCap</a> &#8759; <a href="Ouroboros-Consensus-NodeKernel.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.NodeKernel">MempoolCapacityBytesOverride</a></li><li><a href="#v:miniProtocolParameters">miniProtocolParameters</a> &#8759; <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-NodeToNode.html#t:MiniProtocolParameters" title="Ouroboros.Network.NodeToNode">MiniProtocolParameters</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:TraceForgeEvent">TraceForgeEvent</a> blk tx<ul class="subs"><li>= <a href="#v:TraceStartLeadershipCheck">TraceStartLeadershipCheck</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a></li><li>| <a href="#v:TraceNodeNotLeader">TraceNodeNotLeader</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a></li><li>| <a href="#v:TraceNoLedgerState">TraceNoLedgerState</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> (<a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-Block.html#t:Point" title="Ouroboros.Network.Block">Point</a> blk)</li><li>| <a href="#v:TraceNoLedgerView">TraceNoLedgerView</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a></li><li>| <a href="#v:TraceBlockFromFuture">TraceBlockFromFuture</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a></li><li>| <a href="#v:TraceSlotIsImmutable">TraceSlotIsImmutable</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> (<a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-Block.html#t:Point" title="Ouroboros.Network.Block">Point</a> blk) <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/Cardano-Slotting-Block.html#t:BlockNo" title="Cardano.Slotting.Block">BlockNo</a></li><li>| <a href="#v:TraceNodeIsLeader">TraceNodeIsLeader</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a></li><li>| <a href="#v:TraceForgedBlock">TraceForgedBlock</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> (<a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-Block.html#t:Point" title="Ouroboros.Network.Block">Point</a> blk) blk <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolSize" title="Ouroboros.Consensus.Mempool.API">MempoolSize</a></li><li>| <a href="#v:TraceAdoptedBlock">TraceAdoptedBlock</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> blk [tx]</li><li>| <a href="#v:TraceDidntAdoptBlock">TraceDidntAdoptBlock</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> blk</li><li>| <a href="#v:TraceForgedInvalidBlock">TraceForgedInvalidBlock</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> blk (<a href="Ouroboros-Consensus-Storage-ChainDB-API.html#t:InvalidBlockReason" title="Ouroboros.Consensus.Storage.ChainDB.API">InvalidBlockReason</a> blk)</li></ul></li><li class="src short"><a href="#v:initNodeKernel">initNodeKernel</a> &#8759; &#8704; m remotePeer localPeer blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Node-Run.html#t:RunNode" title="Ouroboros.Consensus.Node.Run">RunNode</a> blk, <a href="Ouroboros-Consensus-Util-IOLike.html#t:NoUnexpectedThunks" title="Ouroboros.Consensus.Util.IOLike">NoUnexpectedThunks</a> remotePeer, <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> remotePeer) &#8658; <a href="Ouroboros-Consensus-NodeKernel.html#t:NodeArgs" title="Ouroboros.Consensus.NodeKernel">NodeArgs</a> m remotePeer localPeer blk &#8594; m (<a href="Ouroboros-Consensus-NodeKernel.html#t:NodeKernel" title="Ouroboros.Consensus.NodeKernel">NodeKernel</a> m remotePeer localPeer blk)</li><li class="src short"><a href="#v:getMempoolReader">getMempoolReader</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Mempool-API.html#t:ApplyTx" title="Ouroboros.Consensus.Mempool.API">ApplyTx</a> blk, <a href="Ouroboros-Consensus-Mempool-API.html#t:HasTxId" title="Ouroboros.Consensus.Mempool.API">HasTxId</a> (<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTx" title="Ouroboros.Consensus.Mempool.API">GenTx</a> blk)) &#8658; <a href="Ouroboros-Consensus-Mempool-API.html#t:Mempool" title="Ouroboros.Consensus.Mempool.API">Mempool</a> m blk <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a> &#8594; <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-TxSubmission-Mempool-Reader.html#t:TxSubmissionMempoolReader" title="Ouroboros.Network.TxSubmission.Mempool.Reader">TxSubmissionMempoolReader</a> (<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTxId" title="Ouroboros.Consensus.Mempool.API">GenTxId</a> blk) (<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTx" title="Ouroboros.Consensus.Mempool.API">GenTx</a> blk) <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a> m</li><li class="src short"><a href="#v:getMempoolWriter">getMempoolWriter</a> &#8759; (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Mempool-API.html#t:ApplyTx" title="Ouroboros.Consensus.Mempool.API">ApplyTx</a> blk, <a href="Ouroboros-Consensus-Mempool-API.html#t:HasTxId" title="Ouroboros.Consensus.Mempool.API">HasTxId</a> (<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTx" title="Ouroboros.Consensus.Mempool.API">GenTx</a> blk)) &#8658; <a href="Ouroboros-Consensus-Mempool-API.html#t:Mempool" title="Ouroboros.Consensus.Mempool.API">Mempool</a> m blk <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a> &#8594; <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-TxSubmission-Inbound.html#t:TxSubmissionMempoolWriter" title="Ouroboros.Network.TxSubmission.Inbound">TxSubmissionMempoolWriter</a> (<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTxId" title="Ouroboros.Consensus.Mempool.API">GenTxId</a> blk) (<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTx" title="Ouroboros.Consensus.Mempool.API">GenTx</a> blk) <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a> m</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Node kernel</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:NodeKernel" class="def">NodeKernel</a> m remotePeer localPeer blk <a href="src/Ouroboros.Consensus.NodeKernel.html#NodeKernel" class="link">Source</a> <a href="#t:NodeKernel" class="selflink">#</a></p><div class="doc"><p>Interface against running relay node</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:NodeKernel" class="def">NodeKernel</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:getChainDB" class="def">getChainDB</a> &#8759; <a href="Ouroboros-Consensus-Storage-ChainDB-API.html#t:ChainDB" title="Ouroboros.Consensus.Storage.ChainDB.API">ChainDB</a> m blk</dfn><div class="doc"><p>The <code><a href="Ouroboros-Consensus-Storage-ChainDB-API.html#t:ChainDB" title="Ouroboros.Consensus.Storage.ChainDB.API">ChainDB</a></code> of the node</p></div></li><li><dfn class="src"><a id="v:getMempool" class="def">getMempool</a> &#8759; <a href="Ouroboros-Consensus-Mempool-API.html#t:Mempool" title="Ouroboros.Consensus.Mempool.API">Mempool</a> m blk <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a></dfn><div class="doc"><p>The node's mempool</p></div></li><li><dfn class="src"><a id="v:getTopLevelConfig" class="def">getTopLevelConfig</a> &#8759; <a href="Ouroboros-Consensus-Config.html#t:TopLevelConfig" title="Ouroboros.Consensus.Config">TopLevelConfig</a> blk</dfn><div class="doc"><p>The node's top-level static configuration</p></div></li><li><dfn class="src"><a id="v:getFetchClientRegistry" class="def">getFetchClientRegistry</a> &#8759; <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-BlockFetch-ClientRegistry.html#t:FetchClientRegistry" title="Ouroboros.Network.BlockFetch.ClientRegistry">FetchClientRegistry</a> remotePeer (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk) blk m</dfn><div class="doc"><p>The fetch client registry, used for the block fetch clients.</p></div></li><li><dfn class="src"><a id="v:getNodeCandidates" class="def">getNodeCandidates</a> &#8759; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:StrictTVar" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">StrictTVar</a> m (<a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/Cardano-Prelude-Base.html#t:Map" title="Cardano.Prelude.Base">Map</a> remotePeer (<a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:StrictTVar" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">StrictTVar</a> m (<a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-AnchoredFragment.html#t:AnchoredFragment" title="Ouroboros.Network.AnchoredFragment">AnchoredFragment</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk))))</dfn><div class="doc"><p>Read the current candidates</p></div></li><li><dfn class="src"><a id="v:getTracers" class="def">getTracers</a> &#8759; <a href="Ouroboros-Consensus-Node-Tracers.html#t:Tracers" title="Ouroboros.Consensus.Node.Tracers">Tracers</a> m remotePeer localPeer blk</dfn><div class="doc"><p>The node's tracers</p></div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:BlockProduction" class="def">BlockProduction</a> m blk <a href="src/Ouroboros.Consensus.NodeKernel.html#BlockProduction" class="link">Source</a> <a href="#t:BlockProduction" class="selflink">#</a></p><div class="doc"><p>Callbacks required to produce blocks</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:BlockProduction" class="def">BlockProduction</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:produceBlock" class="def">produceBlock</a> &#8759; &#8704; n. <a href="Ouroboros-Consensus-Util-Random.html#t:MonadRandom" title="Ouroboros.Consensus.Util.Random">MonadRandom</a> n &#8658; (&#8704; a. m a &#8594; n a) &#8594; <a href="Ouroboros-Consensus-Node-State.html#t:Update" title="Ouroboros.Consensus.Node.State">Update</a> n (<a href="Ouroboros-Consensus-Node-State.html#t:NodeState" title="Ouroboros.Consensus.Node.State">NodeState</a> blk) &#8594; <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/Cardano-Slotting-Block.html#t:BlockNo" title="Cardano.Slotting.Block">BlockNo</a> &#8594; <a href="Ouroboros-Consensus-Ledger-Abstract.html#t:TickedLedgerState" title="Ouroboros.Consensus.Ledger.Abstract">TickedLedgerState</a> blk &#8594; [<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTx" title="Ouroboros.Consensus.Mempool.API">GenTx</a> blk] &#8594; <a href="Ouroboros-Consensus-Protocol-Abstract.html#t:IsLeader" title="Ouroboros.Consensus.Protocol.Abstract">IsLeader</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:BlockProtocol" title="Ouroboros.Consensus.Block.Abstract">BlockProtocol</a> blk) &#8594; n blk</dfn><div class="doc"><p>Produce a block</p><p>The function is passed the contents of the mempool; this is a set of
 transactions that is guaranteed to be consistent with the ledger state
 (also provided as an argument) and with each other (when applied in
 order). In principle <em>all</em> of them could be included in the block (up
 to maximum block size).</p><p>Note that this function is not run in <code>m</code>, but in some monad <code>n</code>
 which only has the ability to produce random number and access to the
 <code><a href="Ouroboros-Consensus-Node-State.html#t:NodeState" title="Ouroboros.Consensus.Node.State">NodeState</a></code>.</p></div></li><li><dfn class="src"><a id="v:runMonadRandomDict" class="def">runMonadRandomDict</a> &#8759; <a href="Ouroboros-Consensus-Util-Random.html#t:RunMonadRandom" title="Ouroboros.Consensus.Util.Random">RunMonadRandom</a> m</dfn><div class="doc"><p>How to run a computation requiring <code><a href="Ouroboros-Consensus-Util-Random.html#t:MonadRandom" title="Ouroboros.Consensus.Util.Random">MonadRandom</a></code>.</p><p>When <code>m = IO</code>, this can be <code><a href="Ouroboros-Consensus-Util-Random.html#v:runMonadRandomIO" title="Ouroboros.Consensus.Util.Random">runMonadRandomIO</a></code>, because the
 <code><a href="Ouroboros-Consensus-Util-Random.html#t:MonadRandom" title="Ouroboros.Consensus.Util.Random">MonadRandom</a></code> instance for <code><a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a></code> can be used.</p><p>In the tests, we can simulate a <code><a href="Ouroboros-Consensus-Util-Random.html#t:MonadRandom" title="Ouroboros.Consensus.Util.Random">MonadRandom</a></code> by keeping track of a
 DRG in a <code>TVar</code>.</p></div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MaxBlockSizeOverride" class="def">MaxBlockSizeOverride</a> <a href="src/Ouroboros.Consensus.NodeKernel.html#MaxBlockSizeOverride" class="link">Source</a> <a href="#t:MaxBlockSizeOverride" class="selflink">#</a></p><div class="doc"><p>An override for the maximum block size from the protocol parameters in
 the ledger.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:NoOverride" class="def">NoOverride</a></td><td class="doc"><p>Use the maximum block size in bytes from the protocol parameters in
 the ledger.</p></td></tr><tr><td class="src"><a id="v:MaxBlockSize" class="def">MaxBlockSize</a> !<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></td><td class="doc"><p>Use the following maximum size in bytes for the whole block.</p></td></tr><tr><td class="src"><a id="v:MaxBlockBodySize" class="def">MaxBlockBodySize</a> !<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></td><td class="doc"><p>Use the following maximum size in bytes for the block body.</p></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MempoolCapacityBytesOverride" class="def">MempoolCapacityBytesOverride</a> <a href="src/Ouroboros.Consensus.NodeKernel.html#MempoolCapacityBytesOverride" class="link">Source</a> <a href="#t:MempoolCapacityBytesOverride" class="selflink">#</a></p><div class="doc"><p>An override for the default <code><a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolCapacityBytes" title="Ouroboros.Consensus.Mempool.API">MempoolCapacityBytes</a></code> which is 2x the
 maximum block size from the protocol parameters in the ledger.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:NoMempoolCapacityBytesOverride" class="def">NoMempoolCapacityBytesOverride</a></td><td class="doc"><p>Use 2x the maximum block size from the protocol parameters in the
 ledger.</p></td></tr><tr><td class="src"><a id="v:MempoolCapacityBytesOverride" class="def">MempoolCapacityBytesOverride</a> !<a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolCapacityBytes" title="Ouroboros.Consensus.Mempool.API">MempoolCapacityBytes</a></td><td class="doc"><p>Use the following <code><a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolCapacityBytes" title="Ouroboros.Consensus.Mempool.API">MempoolCapacityBytes</a></code>.</p></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:NodeArgs" class="def">NodeArgs</a> m remotePeer localPeer blk <a href="src/Ouroboros.Consensus.NodeKernel.html#NodeArgs" class="link">Source</a> <a href="#t:NodeArgs" class="selflink">#</a></p><div class="doc"><p>Arguments required when initializing a node</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:NodeArgs" class="def">NodeArgs</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:tracers" class="def">tracers</a> &#8759; <a href="Ouroboros-Consensus-Node-Tracers.html#t:Tracers" title="Ouroboros.Consensus.Node.Tracers">Tracers</a> m remotePeer localPeer blk</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:registry" class="def">registry</a> &#8759; <a href="Ouroboros-Consensus-Util-ResourceRegistry.html#t:ResourceRegistry" title="Ouroboros.Consensus.Util.ResourceRegistry">ResourceRegistry</a> m</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:maxClockSkew" class="def">maxClockSkew</a> &#8759; <a href="Ouroboros-Consensus-MiniProtocol-ChainSync-Client.html#t:ClockSkew" title="Ouroboros.Consensus.MiniProtocol.ChainSync.Client">ClockSkew</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:cfg" class="def">cfg</a> &#8759; <a href="Ouroboros-Consensus-Config.html#t:TopLevelConfig" title="Ouroboros.Consensus.Config">TopLevelConfig</a> blk</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:initState" class="def">initState</a> &#8759; <a href="Ouroboros-Consensus-Node-State.html#t:NodeState" title="Ouroboros.Consensus.Node.State">NodeState</a> blk</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:btime" class="def">btime</a> &#8759; <a href="Ouroboros-Consensus-BlockchainTime-API.html#t:BlockchainTime" title="Ouroboros.Consensus.BlockchainTime.API">BlockchainTime</a> m</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:chainDB" class="def">chainDB</a> &#8759; <a href="Ouroboros-Consensus-Storage-ChainDB-API.html#t:ChainDB" title="Ouroboros.Consensus.Storage.ChainDB.API">ChainDB</a> m blk</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:initChainDB" class="def">initChainDB</a> &#8759; <a href="Ouroboros-Consensus-Config.html#t:TopLevelConfig" title="Ouroboros.Consensus.Config">TopLevelConfig</a> blk &#8594; <a href="Ouroboros-Consensus-Storage-ChainDB-API.html#t:ChainDB" title="Ouroboros.Consensus.Storage.ChainDB.API">ChainDB</a> m blk &#8594; m ()</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:blockFetchSize" class="def">blockFetchSize</a> &#8759; <a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk &#8594; <a href="Ouroboros-Consensus-Storage-Common.html#t:SizeInBytes" title="Ouroboros.Consensus.Storage.Common">SizeInBytes</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:blockProduction" class="def">blockProduction</a> &#8759; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-NodeKernel.html#t:BlockProduction" title="Ouroboros.Consensus.NodeKernel">BlockProduction</a> m blk)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:blockMatchesHeader" class="def">blockMatchesHeader</a> &#8759; <a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk &#8594; blk &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:maxBlockSize" class="def">maxBlockSize</a> &#8759; <a href="Ouroboros-Consensus-NodeKernel.html#t:MaxBlockSizeOverride" title="Ouroboros.Consensus.NodeKernel">MaxBlockSizeOverride</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:mempoolCap" class="def">mempoolCap</a> &#8759; <a href="Ouroboros-Consensus-NodeKernel.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.NodeKernel">MempoolCapacityBytesOverride</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:miniProtocolParameters" class="def">miniProtocolParameters</a> &#8759; <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-NodeToNode.html#t:MiniProtocolParameters" title="Ouroboros.Network.NodeToNode">MiniProtocolParameters</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TraceForgeEvent" class="def">TraceForgeEvent</a> blk tx <a href="src/Ouroboros.Consensus.Node.Tracers.html#TraceForgeEvent" class="link">Source</a> <a href="#t:TraceForgeEvent" class="selflink">#</a></p><div class="doc"><p>Trace the forging of a block as a slot leader.</p><p>The flow of trace events here can be visualized as follows:</p><pre>TraceStartLeadershipCheck
         |
         +--- TraceNodeNotLeader
         |
         +--- TraceBlockFromFuture (leadership check failed)
         |
         +--- TraceSlotIsImmutable (leadership check failed)
         |
         +--- TraceNoLedgerState (leadership check failed)
         |
         +--- TraceNoLedgerView (leadership check failed)-- &gt;
         |
  TraceNodeIsLeader
         |
   TraceForgedBlock
         |
         +--- TraceDidntAdoptBlock
         |
         +--- TraceForgedInvalidBlock
         |
 TraceAdoptedBlock</pre></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TraceStartLeadershipCheck" class="def">TraceStartLeadershipCheck</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a></td><td class="doc"><p>Start of the leadership check</p><p>We record the current slot number.</p><p>This event terminates with one of the following concluding trace messages:</p><ul><li>TraceNodeNotLeader if we are not the leader</li><li>TraceNodeIsLeader if we are the leader</li><li>TraceBlockFromFuture (rarely)</li><li>TraceSlotIsImmutable (leadership check failed)</li><li>TraceNoLedgerState (rarely)</li><li>TraceNoLedgerView (rarely)</li></ul></td></tr><tr><td class="src"><a id="v:TraceNodeNotLeader" class="def">TraceNodeNotLeader</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a></td><td class="doc"><p>We did the leadership check and concluded we are not the leader</p><p>We record the current slot number</p></td></tr><tr><td class="src"><a id="v:TraceNoLedgerState" class="def">TraceNoLedgerState</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> (<a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-Block.html#t:Point" title="Ouroboros.Network.Block">Point</a> blk)</td><td class="doc"><p>Leadership check failed: we were unable to get the ledger state
 for the point of the block we want to connect to</p><p>This can happen if after choosing which block to connect to the node
 switched to a different fork. We expect this to happen only rather rarely,
 so this certainly merits a warning; if it happens a lot, that merits an
 investigation.</p><p>We record both the current slot number as well as the point of the block
 we attempt to connect the new block to (that we requested the ledger state
 for).</p></td></tr><tr><td class="src"><a id="v:TraceNoLedgerView" class="def">TraceNoLedgerView</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a></td><td class="doc"><p>Leadership check failed: we were unable to get the ledger view for the
 current slot number</p><p>This will only happen if there are many missing blocks between the tip of
 our chain and the current slot.</p><p>We record also the failure returned by <code>forecastFor</code>.</p></td></tr><tr><td class="src"><a id="v:TraceBlockFromFuture" class="def">TraceBlockFromFuture</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a></td><td class="doc"><p>Leadership check failed: the current chain contains a block from a slot
 <em>after</em> the current slot</p><p>This can only happen if the system is under heavy load.</p><p>We record both the current slot number as well as the slot number of the
 block at the tip of the chain.</p><p>See also <a href="https://github.com/input-output-hk/ouroboros-network/issues/1462">https://github.com/input-output-hk/ouroboros-network/issues/1462</a></p></td></tr><tr><td class="src"><a id="v:TraceSlotIsImmutable" class="def">TraceSlotIsImmutable</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> (<a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-Block.html#t:Point" title="Ouroboros.Network.Block">Point</a> blk) <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/Cardano-Slotting-Block.html#t:BlockNo" title="Cardano.Slotting.Block">BlockNo</a></td><td class="doc"><p>Leadership check failed: the tip of the ImmDB inhabits the current slot</p><p>This might happen in two cases.</p><ol><li>the clock moved backwards, on restart we ignored everything from the
     VolatileDB since it's all in the future, and now the tip of the
     ImmutableDB points to a block produced in the same slot we're trying
     to produce a block in</li><li>k = 0 and we already adopted a block from another leader of the same
     slot.</li></ol><p>We record both the current slot number as well as the tip of the ImmDB.</p><p>See also <a href="https://github.com/input-output-hk/ouroboros-network/issues/1462">https://github.com/input-output-hk/ouroboros-network/issues/1462</a></p></td></tr><tr><td class="src"><a id="v:TraceNodeIsLeader" class="def">TraceNodeIsLeader</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a></td><td class="doc"><p>We did the leadership check and concluded we <em>are</em> the leader</p><p>The node will soon forge; it is about to read its transactions and
 current DB. This will be followed by TraceForgedBlock.</p></td></tr><tr><td class="src"><a id="v:TraceForgedBlock" class="def">TraceForgedBlock</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> (<a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-Block.html#t:Point" title="Ouroboros.Network.Block">Point</a> blk) blk <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolSize" title="Ouroboros.Consensus.Mempool.API">MempoolSize</a></td><td class="doc"><p>We forged a block</p><p>We record the current slot number, the point of the predecessor, the block
 itself, and the total size of the mempool snapshot at the time we produced
 the block (which may be significantly larger than the block, due to
 maximum block size)</p><p>This will be followed by one of three messages:</p><ul><li>TraceAdoptedBlock (normally)</li><li>TraceDidntAdoptBlock (rarely)</li><li>TraceForgedInvalidBlock (hopefully never -- this would indicate a bug)</li></ul></td></tr><tr><td class="src"><a id="v:TraceAdoptedBlock" class="def">TraceAdoptedBlock</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> blk [tx]</td><td class="doc"><p>We adopted the block we produced, we also trace the transactions
 that were adopted.</p></td></tr><tr><td class="src"><a id="v:TraceDidntAdoptBlock" class="def">TraceDidntAdoptBlock</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> blk</td><td class="doc"><p>We did not adopt the block we produced, but the block was valid. We
 must have adopted a block that another leader of the same slot produced
 before we got the chance of adopting our own block. This is very rare,
 this warrants a warning.</p></td></tr><tr><td class="src"><a id="v:TraceForgedInvalidBlock" class="def">TraceForgedInvalidBlock</a> <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> blk (<a href="Ouroboros-Consensus-Storage-ChainDB-API.html#t:InvalidBlockReason" title="Ouroboros.Consensus.Storage.ChainDB.API">InvalidBlockReason</a> blk)</td><td class="doc"><p>We forged a block that is invalid according to the ledger in the
 ChainDB. This means there is an inconsistency between the mempool
 validation and the ledger validation. This is a serious error!</p></td></tr></table></div><div class="subs instances"><details id="i:TraceForgeEvent" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TraceForgeEvent:Eq:1"></span> (<a href="Ouroboros-Consensus-Ledger-SupportsProtocol.html#t:LedgerSupportsProtocol" title="Ouroboros.Consensus.Ledger.SupportsProtocol">LedgerSupportsProtocol</a> blk, <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> blk, <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> tx) &#8658; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk tx)</span> <a href="src/Ouroboros.Consensus.Node.Tracers.html#line-258" class="link">Source</a> <a href="#t:TraceForgeEvent" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TraceForgeEvent:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Node-Tracers.html">Ouroboros.Consensus.Node.Tracers</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> &#8759; <a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk tx &#8594; <a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk tx &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> &#8759; <a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk tx &#8594; <a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk tx &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TraceForgeEvent:Show:2"></span> (<a href="Ouroboros-Consensus-Ledger-SupportsProtocol.html#t:LedgerSupportsProtocol" title="Ouroboros.Consensus.Ledger.SupportsProtocol">LedgerSupportsProtocol</a> blk, <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> blk, <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> tx) &#8658; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk tx)</span> <a href="src/Ouroboros.Consensus.Node.Tracers.html#line-258" class="link">Source</a> <a href="#t:TraceForgeEvent" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TraceForgeEvent:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Node-Tracers.html">Ouroboros.Consensus.Node.Tracers</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> &#8759; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> &#8594; <a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk tx &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> &#8759; <a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk tx &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> &#8759; [<a href="Ouroboros-Consensus-NodeKernel.html#t:TraceForgeEvent" title="Ouroboros.Consensus.NodeKernel">TraceForgeEvent</a> blk tx] &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:initNodeKernel" class="def">initNodeKernel</a> &#8759; &#8704; m remotePeer localPeer blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Node-Run.html#t:RunNode" title="Ouroboros.Consensus.Node.Run">RunNode</a> blk, <a href="Ouroboros-Consensus-Util-IOLike.html#t:NoUnexpectedThunks" title="Ouroboros.Consensus.Util.IOLike">NoUnexpectedThunks</a> remotePeer, <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> remotePeer) &#8658; <a href="Ouroboros-Consensus-NodeKernel.html#t:NodeArgs" title="Ouroboros.Consensus.NodeKernel">NodeArgs</a> m remotePeer localPeer blk &#8594; m (<a href="Ouroboros-Consensus-NodeKernel.html#t:NodeKernel" title="Ouroboros.Consensus.NodeKernel">NodeKernel</a> m remotePeer localPeer blk) <a href="src/Ouroboros.Consensus.NodeKernel.html#initNodeKernel" class="link">Source</a> <a href="#v:initNodeKernel" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getMempoolReader" class="def">getMempoolReader</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Mempool-API.html#t:ApplyTx" title="Ouroboros.Consensus.Mempool.API">ApplyTx</a> blk, <a href="Ouroboros-Consensus-Mempool-API.html#t:HasTxId" title="Ouroboros.Consensus.Mempool.API">HasTxId</a> (<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTx" title="Ouroboros.Consensus.Mempool.API">GenTx</a> blk)) &#8658; <a href="Ouroboros-Consensus-Mempool-API.html#t:Mempool" title="Ouroboros.Consensus.Mempool.API">Mempool</a> m blk <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a> &#8594; <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-TxSubmission-Mempool-Reader.html#t:TxSubmissionMempoolReader" title="Ouroboros.Network.TxSubmission.Mempool.Reader">TxSubmissionMempoolReader</a> (<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTxId" title="Ouroboros.Consensus.Mempool.API">GenTxId</a> blk) (<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTx" title="Ouroboros.Consensus.Mempool.API">GenTx</a> blk) <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a> m <a href="src/Ouroboros.Consensus.NodeKernel.html#getMempoolReader" class="link">Source</a> <a href="#v:getMempoolReader" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getMempoolWriter" class="def">getMempoolWriter</a> &#8759; (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Mempool-API.html#t:ApplyTx" title="Ouroboros.Consensus.Mempool.API">ApplyTx</a> blk, <a href="Ouroboros-Consensus-Mempool-API.html#t:HasTxId" title="Ouroboros.Consensus.Mempool.API">HasTxId</a> (<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTx" title="Ouroboros.Consensus.Mempool.API">GenTx</a> blk)) &#8658; <a href="Ouroboros-Consensus-Mempool-API.html#t:Mempool" title="Ouroboros.Consensus.Mempool.API">Mempool</a> m blk <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a> &#8594; <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-TxSubmission-Inbound.html#t:TxSubmissionMempoolWriter" title="Ouroboros.Network.TxSubmission.Inbound">TxSubmissionMempoolWriter</a> (<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTxId" title="Ouroboros.Consensus.Mempool.API">GenTxId</a> blk) (<a href="Ouroboros-Consensus-Mempool-API.html#t:GenTx" title="Ouroboros.Consensus.Mempool.API">GenTx</a> blk) <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a> m <a href="src/Ouroboros.Consensus.NodeKernel.html#getMempoolWriter" class="link">Source</a> <a href="#v:getMempoolWriter" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>