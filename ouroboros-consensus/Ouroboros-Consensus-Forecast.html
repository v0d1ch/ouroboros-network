<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Ouroboros.Consensus.Forecast</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ouroboros-consensus-0.1.0.0: Consensus layer for the Ouroboros blockchain protocol</span><ul class="links" id="page-menu"><li><a href="src/Ouroboros.Consensus.Forecast.html">Source</a></li><li><a href="&quot;../index.html&quot;">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Ouroboros.Consensus.Forecast</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Utilities for constructing forecasts</a></li></ul></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Forecast">Forecast</a> a = <a href="#v:Forecast">Forecast</a> {<ul class="subs"><li><a href="#v:forecastAt">forecastAt</a> &#8759; <a href="Ouroboros-Consensus-Block-Abstract.html#t:WithOrigin" title="Ouroboros.Consensus.Block.Abstract">WithOrigin</a> <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></li><li><a href="#v:forecastFor">forecastFor</a> &#8759; <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a> &#8594; <a href="Ouroboros-Consensus-HardFork-Combinator-PartialConfig.html#t:Except" title="Ouroboros.Consensus.HardFork.Combinator.PartialConfig">Except</a> <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a> (<a href="Ouroboros-Consensus-Ticked.html#t:Ticked" title="Ouroboros.Consensus.Ticked">Ticked</a> a)</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:OutsideForecastRange">OutsideForecastRange</a> = <a href="#v:OutsideForecastRange">OutsideForecastRange</a> {<ul class="subs"><li><a href="#v:outsideForecastAt">outsideForecastAt</a> &#8759; !(<a href="Ouroboros-Consensus-Block-Abstract.html#t:WithOrigin" title="Ouroboros.Consensus.Block.Abstract">WithOrigin</a> <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a>)</li><li><a href="#v:outsideForecastMaxFor">outsideForecastMaxFor</a> &#8759; !<a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></li><li><a href="#v:outsideForecastFor">outsideForecastFor</a> &#8759; !<a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></li></ul>}</li><li class="src short"><a href="#v:constantForecastOf">constantForecastOf</a> &#8759; <a href="Ouroboros-Consensus-Ticked.html#t:Ticked" title="Ouroboros.Consensus.Ticked">Ticked</a> a &#8594; <a href="Ouroboros-Consensus-Block-Abstract.html#t:WithOrigin" title="Ouroboros.Consensus.Block.Abstract">WithOrigin</a> <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a> &#8594; <a href="Ouroboros-Consensus-Forecast.html#t:Forecast" title="Ouroboros.Consensus.Forecast">Forecast</a> a</li><li class="src short"><a href="#v:mapForecast">mapForecast</a> &#8759; (<a href="Ouroboros-Consensus-Ticked.html#t:Ticked" title="Ouroboros.Consensus.Ticked">Ticked</a> a &#8594; <a href="Ouroboros-Consensus-Ticked.html#t:Ticked" title="Ouroboros.Consensus.Ticked">Ticked</a> b) &#8594; <a href="Ouroboros-Consensus-Forecast.html#t:Forecast" title="Ouroboros.Consensus.Forecast">Forecast</a> a &#8594; <a href="Ouroboros-Consensus-Forecast.html#t:Forecast" title="Ouroboros.Consensus.Forecast">Forecast</a> b</li><li class="src short"><a href="#v:trivialForecast">trivialForecast</a> &#8759; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:GetTip" title="Ouroboros.Consensus.Ledger.Basics">GetTip</a> b &#8658; b &#8594; <a href="Ouroboros-Consensus-Forecast.html#t:Forecast" title="Ouroboros.Consensus.Forecast">Forecast</a> ()</li><li class="src short"><a href="#v:crossEraForecastBound">crossEraForecastBound</a> &#8759; <a href="Ouroboros-Consensus-Block-Abstract.html#t:WithOrigin" title="Ouroboros.Consensus.Block.Abstract">WithOrigin</a> <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a> &#8594; <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a> &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Word.html#t:Word64" title="Data.Word">Word64</a> &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Word.html#t:Word64" title="Data.Word">Word64</a> &#8594; <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Forecast" class="def">Forecast</a> a <a href="src/Ouroboros.Consensus.Forecast.html#Forecast" class="link">Source</a> <a href="#t:Forecast" class="selflink">#</a></p><div class="doc"><p>Forecast the effect of time ticking</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Forecast" class="def">Forecast</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:forecastAt" class="def">forecastAt</a> &#8759; <a href="Ouroboros-Consensus-Block-Abstract.html#t:WithOrigin" title="Ouroboros.Consensus.Block.Abstract">WithOrigin</a> <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:forecastFor" class="def">forecastFor</a> &#8759; <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a> &#8594; <a href="Ouroboros-Consensus-HardFork-Combinator-PartialConfig.html#t:Except" title="Ouroboros.Consensus.HardFork.Combinator.PartialConfig">Except</a> <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a> (<a href="Ouroboros-Consensus-Ticked.html#t:Ticked" title="Ouroboros.Consensus.Ticked">Ticked</a> a)</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:OutsideForecastRange" class="def">OutsideForecastRange</a> <a href="src/Ouroboros.Consensus.Forecast.html#OutsideForecastRange" class="link">Source</a> <a href="#t:OutsideForecastRange" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:OutsideForecastRange" class="def">OutsideForecastRange</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:outsideForecastAt" class="def">outsideForecastAt</a> &#8759; !(<a href="Ouroboros-Consensus-Block-Abstract.html#t:WithOrigin" title="Ouroboros.Consensus.Block.Abstract">WithOrigin</a> <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a>)</dfn><div class="doc"><p>The slot for which the forecast was obtained</p></div></li><li><dfn class="src"><a id="v:outsideForecastMaxFor" class="def">outsideForecastMaxFor</a> &#8759; !<a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></dfn><div class="doc"><p>Exclusive upper bound on the range of the forecast</p></div></li><li><dfn class="src"><a id="v:outsideForecastFor" class="def">outsideForecastFor</a> &#8759; !<a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></dfn><div class="doc"><p>The slot for which we requested a value</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:OutsideForecastRange">Instances</h4><details id="i:OutsideForecastRange" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:OutsideForecastRange:Eq:1"></span> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a></span> <a href="src/Ouroboros.Consensus.Forecast.html#line-67" class="link">Source</a> <a href="#t:OutsideForecastRange" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:OutsideForecastRange:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Forecast.html">Ouroboros.Consensus.Forecast</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> &#8759; <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a> &#8594; <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a> &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> &#8759; <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a> &#8594; <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a> &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:OutsideForecastRange:Show:2"></span> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a></span> <a href="src/Ouroboros.Consensus.Forecast.html#line-67" class="link">Source</a> <a href="#t:OutsideForecastRange" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:OutsideForecastRange:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Forecast.html">Ouroboros.Consensus.Forecast</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> &#8759; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> &#8594; <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a> &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> &#8759; <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a> &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> &#8759; [<a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a>] &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:OutsideForecastRange:Exception:3"></span> <a href="Ouroboros-Consensus-Util-IOLike.html#t:Exception" title="Ouroboros.Consensus.Util.IOLike">Exception</a> <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a></span> <a href="src/Ouroboros.Consensus.Forecast.html#line-69" class="link">Source</a> <a href="#t:OutsideForecastRange" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:OutsideForecastRange:Exception:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Forecast.html">Ouroboros.Consensus.Forecast</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toException">toException</a> &#8759; <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a> &#8594; <a href="Ouroboros-Consensus-Util-IOLike.html#t:SomeException" title="Ouroboros.Consensus.Util.IOLike">SomeException</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src" class="link">Source</a> <a href="#v:toException" class="selflink">#</a></p><p class="src"><a href="#v:fromException">fromException</a> &#8759; <a href="Ouroboros-Consensus-Util-IOLike.html#t:SomeException" title="Ouroboros.Consensus.Util.IOLike">SomeException</a> &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src" class="link">Source</a> <a href="#v:fromException" class="selflink">#</a></p><p class="src"><a href="#v:displayException">displayException</a> &#8759; <a href="Ouroboros-Consensus-Forecast.html#t:OutsideForecastRange" title="Ouroboros.Consensus.Forecast">OutsideForecastRange</a> &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src" class="link">Source</a> <a href="#v:displayException" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:constantForecastOf" class="def">constantForecastOf</a> &#8759; <a href="Ouroboros-Consensus-Ticked.html#t:Ticked" title="Ouroboros.Consensus.Ticked">Ticked</a> a &#8594; <a href="Ouroboros-Consensus-Block-Abstract.html#t:WithOrigin" title="Ouroboros.Consensus.Block.Abstract">WithOrigin</a> <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a> &#8594; <a href="Ouroboros-Consensus-Forecast.html#t:Forecast" title="Ouroboros.Consensus.Forecast">Forecast</a> a <a href="src/Ouroboros.Consensus.Forecast.html#constantForecastOf" class="link">Source</a> <a href="#v:constantForecastOf" class="selflink">#</a></p><div class="doc"><p>Forecast where the values are never changing</p><p>This is primarily useful for tests; the forecast range is infinite, but we
 do still check the precondition, to catch any bugs.</p></div></div><div class="top"><p class="src"><a id="v:mapForecast" class="def">mapForecast</a> &#8759; (<a href="Ouroboros-Consensus-Ticked.html#t:Ticked" title="Ouroboros.Consensus.Ticked">Ticked</a> a &#8594; <a href="Ouroboros-Consensus-Ticked.html#t:Ticked" title="Ouroboros.Consensus.Ticked">Ticked</a> b) &#8594; <a href="Ouroboros-Consensus-Forecast.html#t:Forecast" title="Ouroboros.Consensus.Forecast">Forecast</a> a &#8594; <a href="Ouroboros-Consensus-Forecast.html#t:Forecast" title="Ouroboros.Consensus.Forecast">Forecast</a> b <a href="src/Ouroboros.Consensus.Forecast.html#mapForecast" class="link">Source</a> <a href="#v:mapForecast" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:trivialForecast" class="def">trivialForecast</a> &#8759; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:GetTip" title="Ouroboros.Consensus.Ledger.Basics">GetTip</a> b &#8658; b &#8594; <a href="Ouroboros-Consensus-Forecast.html#t:Forecast" title="Ouroboros.Consensus.Forecast">Forecast</a> () <a href="src/Ouroboros.Consensus.Forecast.html#trivialForecast" class="link">Source</a> <a href="#v:trivialForecast" class="selflink">#</a></p><div class="doc"><p>Trivial forecast of values of type <code>()</code> performed by an instance of
 <code><a href="Ouroboros-Consensus-Ledger-Basics.html#t:GetTip" title="Ouroboros.Consensus.Ledger.Basics">GetTip</a></code>.</p><p>Specialization of <code>constantForecast</code>.</p></div></div><a href="#g:1" id="g:1"><h1>Utilities for constructing forecasts</h1></a><div class="top"><p class="src"><a id="v:crossEraForecastBound" class="def">crossEraForecastBound</a> <a href="src/Ouroboros.Consensus.Forecast.html#crossEraForecastBound" class="link">Source</a> <a href="#v:crossEraForecastBound" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">&#8759; <a href="Ouroboros-Consensus-Block-Abstract.html#t:WithOrigin" title="Ouroboros.Consensus.Block.Abstract">WithOrigin</a> <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></td><td class="doc"><p>Current tip (the slot the forecast is at)</p></td></tr><tr><td class="src">&#8594; <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></td><td class="doc"><p>Slot at which the transition to the next era happens</p></td></tr><tr><td class="src">&#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Word.html#t:Word64" title="Data.Word">Word64</a></td><td class="doc"><p>Max lookeahead in the current era</p></td></tr><tr><td class="src">&#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Word.html#t:Word64" title="Data.Word">Word64</a></td><td class="doc"><p>Max lookeahead in the next era</p></td></tr><tr><td class="src">&#8594; <a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Compute the upper bound for a range for a forecast across eras.</p><p>We have to be very careful here in how we compute the maximum lookahead.
 As long as we are in a single era, things look like this:</p><pre>                                         /-------------------\
                                         |                   |
chain     ... - block - block - block [block]                |
                                  |                          v
ledger                           TIP                  VIEW</pre><p>where <code>TIP</code> is the current ledger tip and <code>VIEW</code> is the last ledger view we
 can forecast, because the next block <code>[block]</code> to arrive will take effect in
 the next leger state after <code>VIEW</code>. Note that if the maximum lookahead is
 zero, this looks like</p><pre>chain     ... - block - block - block [block]
                                  |      |
ledger                           TIP</pre><p>where <code>[block]</code> can have immediate changes on the ledger, and so we can't
 look ahead at all (of course, we always know the <em>current</em> <code>TIP</code>).</p><p>Note that blocks arriving <em>after</em> <code>[block]</code> can only take effect <em>later</em> than
 <code>[block]</code>, and so they are not relevant for computing the maximum slot number
 we can compute a ledger view for.</p><p>Now, if we are near an era transition, this picture gets a bit more
 complicated. <em>If</em> the next block is still in this era (that is, unless we are
 <em>right</em> at the edge), then that imposes <em>one</em> constraint, as before. However,
 the first block in the <em>next</em> era imposes an <em>additional</em> constraint:</p><pre>                     ~
                     ~    /------------------\
                     ~    |                  |
         /---------- ~ ---|----------\       |
         |           ~    |          |       |
block [block]        ~ [block']      |       |
  |                  ~               v       v
 TIP                 ~         VIEW
                     ~</pre><p>There are no restrictions on the relative values of these two maximum
 lookahead values. This means that it's quite possible for the next era to
 have a <em>smaller</em> lookahead (to re-iterate, since that era has not yet begun,
 the first block in that era is at the transition, and so the maximum
 lookahead applies from the transition point):</p><pre>                     ~
                     ~    /----------\
                     ~    |          |
         /---------- ~ ---|----------|-------\
         |           ~    |          |       |
block [block]        ~ [block']      |       |
  |                  ~               v       v
 TIP                 ~         VIEW
                     ~</pre><p>Indeed, if the next era has zero lookahead, when the first block of the next
 era comes it, it can make changes immediately, and so we can't even know what
 the view at the transition point is.</p><p>Note that if there can be no more blocks in this era, the maximum lookahead
 of the current era is irrelevant:</p><pre>      ~
      ~    /----------\
      ~    |          |
      ~    |          |
      ~    |          |
block ~ [block']      |
  |   ~               v
 TIP  ~         VIEW
      ~</pre><p>We can therefore compute the earliest <code><a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></code> the next block in this era
 (if any) can make changes to the ledger state, as well as the earliest
 <code><a href="Ouroboros-Consensus-Block-Abstract.html#t:SlotNo" title="Ouroboros.Consensus.Block.Abstract">SlotNo</a></code> the first block in the next era can; their <code>minimum</code> will serve as
 an exclusive upper bound for the forecast range.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.0</p></div></body></html>