<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Ouroboros.Consensus.Storage.ChainDB.Impl.Query</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ouroboros-consensus-0.1.0.0: Consensus layer for the Ouroboros blockchain protocol</span><ul class="links" id="page-menu"><li><a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html">Source</a></li><li><a href="&quot;../index.html&quot;">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Ouroboros.Consensus.Storage.ChainDB.Impl.Query</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Queries</a></li><li><a href="#g:2">Low-level queries</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Queries</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:getBlockComponent">getBlockComponent</a> &#8759; &#8704; m blk b. <a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Storage-Common.html#t:BlockComponent" title="Ouroboros.Consensus.Storage.Common">BlockComponent</a> blk b &#8594; <a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk &#8594; m (<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> b)</li><li class="src short"><a href="#v:getCurrentChain">getCurrentChain</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk), <a href="Ouroboros-Consensus-Protocol-Abstract.html#t:ConsensusProtocol" title="Ouroboros.Consensus.Protocol.Abstract">ConsensusProtocol</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:BlockProtocol" title="Ouroboros.Consensus.Block.Abstract">BlockProtocol</a> blk)) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-AnchoredFragment.html#t:AnchoredFragment" title="Ouroboros.Network.AnchoredFragment">AnchoredFragment</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk))</li><li class="src short"><a href="#v:getIsFetched">getIsFetched</a> &#8759; &#8704; m blk. <a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Point" title="Ouroboros.Consensus.Block.Abstract">Point</a> blk &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>)</li><li class="src short"><a href="#v:getIsInvalidBlock">getIsInvalidBlock</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> blk) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="Ouroboros-Consensus-Util-STM.html#t:WithFingerprint" title="Ouroboros.Consensus.Util.STM">WithFingerprint</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:HeaderHash" title="Ouroboros.Consensus.Block.Abstract">HeaderHash</a> blk &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-Storage-ChainDB-API.html#t:InvalidBlockReason" title="Ouroboros.Consensus.Storage.ChainDB.API">InvalidBlockReason</a> blk)))</li><li class="src short"><a href="#v:getIsValid">getIsValid</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> blk) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>)</li><li class="src short"><a href="#v:getLedgerDB">getLedgerDB</a> &#8759; <a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="Ouroboros-Consensus-Storage-LedgerDB-OnDisk.html#t:LedgerDB-39-" title="Ouroboros.Consensus.Storage.LedgerDB.OnDisk">LedgerDB'</a> blk)</li><li class="src short"><a href="#v:getMaxSlotNo">getMaxSlotNo</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk)) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-Block.html#t:MaxSlotNo" title="Ouroboros.Network.Block">MaxSlotNo</a></li><li class="src short"><a href="#v:getTipBlock">getTipBlock</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> blk, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk)) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; m (<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> blk)</li><li class="src short"><a href="#v:getTipHeader">getTipHeader</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> blk, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk)) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; m (<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk))</li><li class="src short"><a href="#v:getTipPoint">getTipPoint</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk)) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Point" title="Ouroboros.Consensus.Block.Abstract">Point</a> blk)</li><li class="src short"><a href="#v:getAnyBlockComponent">getAnyBlockComponent</a> &#8759; &#8704; m blk b. <a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m &#8658; <a href="Ouroboros-Consensus-Storage-ImmutableDB-API.html#t:ImmutableDB" title="Ouroboros.Consensus.Storage.ImmutableDB.API">ImmutableDB</a> m blk &#8594; <a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> m blk &#8594; <a href="Ouroboros-Consensus-Storage-Common.html#t:BlockComponent" title="Ouroboros.Consensus.Storage.Common">BlockComponent</a> blk b &#8594; <a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk &#8594; m (<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> b)</li><li class="src short"><a href="#v:getAnyKnownBlock">getAnyKnownBlock</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> blk) &#8658; <a href="Ouroboros-Consensus-Storage-ImmutableDB-API.html#t:ImmutableDB" title="Ouroboros.Consensus.Storage.ImmutableDB.API">ImmutableDB</a> m blk &#8594; <a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> m blk &#8594; <a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk &#8594; m blk</li><li class="src short"><a href="#v:getAnyKnownBlockComponent">getAnyKnownBlockComponent</a> &#8759; &#8704; m blk b. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> blk) &#8658; <a href="Ouroboros-Consensus-Storage-ImmutableDB-API.html#t:ImmutableDB" title="Ouroboros.Consensus.Storage.ImmutableDB.API">ImmutableDB</a> m blk &#8594; <a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> m blk &#8594; <a href="Ouroboros-Consensus-Storage-Common.html#t:BlockComponent" title="Ouroboros.Consensus.Storage.Common">BlockComponent</a> blk b &#8594; <a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk &#8594; m b</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Queries</h1></a><div class="top"><p class="src"><a id="v:getBlockComponent" class="def">getBlockComponent</a> &#8759; &#8704; m blk b. <a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Storage-Common.html#t:BlockComponent" title="Ouroboros.Consensus.Storage.Common">BlockComponent</a> blk b &#8594; <a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk &#8594; m (<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> b) <a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html#getBlockComponent" class="link">Source</a> <a href="#v:getBlockComponent" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getCurrentChain" class="def">getCurrentChain</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk), <a href="Ouroboros-Consensus-Protocol-Abstract.html#t:ConsensusProtocol" title="Ouroboros.Consensus.Protocol.Abstract">ConsensusProtocol</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:BlockProtocol" title="Ouroboros.Consensus.Block.Abstract">BlockProtocol</a> blk)) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-AnchoredFragment.html#t:AnchoredFragment" title="Ouroboros.Network.AnchoredFragment">AnchoredFragment</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk)) <a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html#getCurrentChain" class="link">Source</a> <a href="#v:getCurrentChain" class="selflink">#</a></p><div class="doc"><p>Return the last <code>k</code> headers.</p><p>While the in-memory fragment (<code><a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#v:cdbChain" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">cdbChain</a></code>) might temporarily be longer than
 <code>k</code> (until the background thread has copied those blocks to the
 ImmutableDB), this function will never return a fragment longer than <code>k</code>.</p><p>The anchor point of the returned fragment will be the most recent
 &quot;immutable&quot; block, i.e. a block that cannot be rolled back. In
 ChainDB.md, we call this block <code>i</code>.</p><p>Note that the returned fragment may be shorter than <code>k</code> in case the whole
 chain itself is shorter than <code>k</code> or in case the VolatileDB was corrupted.
 In the latter case, we don't take blocks already in the ImmutableDB into
 account, as we know they <em>must</em> have been &quot;immutable&quot; at some point, and,
 therefore, <em>must</em> still be &quot;immutable&quot;.</p></div></div><div class="top"><p class="src"><a id="v:getIsFetched" class="def">getIsFetched</a> &#8759; &#8704; m blk. <a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Point" title="Ouroboros.Consensus.Block.Abstract">Point</a> blk &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) <a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html#getIsFetched" class="link">Source</a> <a href="#v:getIsFetched" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getIsInvalidBlock" class="def">getIsInvalidBlock</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> blk) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="Ouroboros-Consensus-Util-STM.html#t:WithFingerprint" title="Ouroboros.Consensus.Util.STM">WithFingerprint</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:HeaderHash" title="Ouroboros.Consensus.Block.Abstract">HeaderHash</a> blk &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-Storage-ChainDB-API.html#t:InvalidBlockReason" title="Ouroboros.Consensus.Storage.ChainDB.API">InvalidBlockReason</a> blk))) <a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html#getIsInvalidBlock" class="link">Source</a> <a href="#v:getIsInvalidBlock" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getIsValid" class="def">getIsValid</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> blk) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) <a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html#getIsValid" class="link">Source</a> <a href="#v:getIsValid" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getLedgerDB" class="def">getLedgerDB</a> &#8759; <a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="Ouroboros-Consensus-Storage-LedgerDB-OnDisk.html#t:LedgerDB-39-" title="Ouroboros.Consensus.Storage.LedgerDB.OnDisk">LedgerDB'</a> blk) <a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html#getLedgerDB" class="link">Source</a> <a href="#v:getLedgerDB" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getMaxSlotNo" class="def">getMaxSlotNo</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk)) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-Block.html#t:MaxSlotNo" title="Ouroboros.Network.Block">MaxSlotNo</a> <a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html#getMaxSlotNo" class="link">Source</a> <a href="#v:getMaxSlotNo" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getTipBlock" class="def">getTipBlock</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> blk, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk)) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; m (<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> blk) <a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html#getTipBlock" class="link">Source</a> <a href="#v:getTipBlock" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getTipHeader" class="def">getTipHeader</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> blk, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk)) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; m (<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk)) <a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html#getTipHeader" class="link">Source</a> <a href="#v:getTipHeader" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getTipPoint" class="def">getTipPoint</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Header" title="Ouroboros.Consensus.Block.Abstract">Header</a> blk)) &#8658; <a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Types.html#t:ChainDbEnv" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Types">ChainDbEnv</a> m blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="Ouroboros-Consensus-Block-Abstract.html#t:Point" title="Ouroboros.Consensus.Block.Abstract">Point</a> blk) <a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html#getTipPoint" class="link">Source</a> <a href="#v:getTipPoint" class="selflink">#</a></p></div><a href="#g:2" id="g:2"><h1>Low-level queries</h1></a><div class="top"><p class="src"><a id="v:getAnyBlockComponent" class="def">getAnyBlockComponent</a> &#8759; &#8704; m blk b. <a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m &#8658; <a href="Ouroboros-Consensus-Storage-ImmutableDB-API.html#t:ImmutableDB" title="Ouroboros.Consensus.Storage.ImmutableDB.API">ImmutableDB</a> m blk &#8594; <a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> m blk &#8594; <a href="Ouroboros-Consensus-Storage-Common.html#t:BlockComponent" title="Ouroboros.Consensus.Storage.Common">BlockComponent</a> blk b &#8594; <a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk &#8594; m (<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> b) <a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html#getAnyBlockComponent" class="link">Source</a> <a href="#v:getAnyBlockComponent" class="selflink">#</a></p><div class="doc"><p>Get a block component from either the immutable DB or volatile DB.</p><p>Returns <code><a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#v:Nothing" title="Data.Maybe">Nothing</a></code> if the <code><a href="Ouroboros-Consensus-Block-Abstract.html#t:Point" title="Ouroboros.Consensus.Block.Abstract">Point</a></code> is unknown.
 Throws <code>NoGenesisBlockException</code> if the <code><a href="Ouroboros-Consensus-Block-Abstract.html#t:Point" title="Ouroboros.Consensus.Block.Abstract">Point</a></code> refers to the genesis block.</p></div></div><div class="top"><p class="src"><a id="v:getAnyKnownBlock" class="def">getAnyKnownBlock</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> blk) &#8658; <a href="Ouroboros-Consensus-Storage-ImmutableDB-API.html#t:ImmutableDB" title="Ouroboros.Consensus.Storage.ImmutableDB.API">ImmutableDB</a> m blk &#8594; <a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> m blk &#8594; <a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk &#8594; m blk <a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html#getAnyKnownBlock" class="link">Source</a> <a href="#v:getAnyKnownBlock" class="selflink">#</a></p><div class="doc"><p>Variant of <code><a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Query.html#v:getAnyBlockComponent" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Query">getAnyBlockComponent</a></code> instantiated with <code><a href="Ouroboros-Consensus-Storage-Common.html#v:GetBlock" title="Ouroboros.Consensus.Storage.Common">GetBlock</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:getAnyKnownBlockComponent" class="def">getAnyKnownBlockComponent</a> &#8759; &#8704; m blk b. (<a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m, <a href="Ouroboros-Consensus-Block-Abstract.html#t:HasHeader" title="Ouroboros.Consensus.Block.Abstract">HasHeader</a> blk) &#8658; <a href="Ouroboros-Consensus-Storage-ImmutableDB-API.html#t:ImmutableDB" title="Ouroboros.Consensus.Storage.ImmutableDB.API">ImmutableDB</a> m blk &#8594; <a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> m blk &#8594; <a href="Ouroboros-Consensus-Storage-Common.html#t:BlockComponent" title="Ouroboros.Consensus.Storage.Common">BlockComponent</a> blk b &#8594; <a href="Ouroboros-Consensus-Block-RealPoint.html#t:RealPoint" title="Ouroboros.Consensus.Block.RealPoint">RealPoint</a> blk &#8594; m b <a href="src/Ouroboros.Consensus.Storage.ChainDB.Impl.Query.html#getAnyKnownBlockComponent" class="link">Source</a> <a href="#v:getAnyKnownBlockComponent" class="selflink">#</a></p><div class="doc"><p>Wrapper around <code><a href="Ouroboros-Consensus-Storage-ChainDB-Impl-Query.html#v:getAnyBlockComponent" title="Ouroboros.Consensus.Storage.ChainDB.Impl.Query">getAnyBlockComponent</a></code> for blocks we know should exist.</p><p>If the block does not exist, this indicates disk failure.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.0</p></div></body></html>