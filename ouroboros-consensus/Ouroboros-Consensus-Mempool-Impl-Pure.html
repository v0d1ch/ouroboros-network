<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Ouroboros.Consensus.Mempool.Impl.Pure</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ouroboros-consensus-0.1.0.0: Consensus layer for the Ouroboros blockchain protocol</span><ul class="links" id="page-menu"><li><a href="src/Ouroboros.Consensus.Mempool.Impl.Pure.html">Source</a></li><li><a href="&quot;../index.html&quot;">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Ouroboros.Consensus.Mempool.Impl.Pure</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Mempool</a></li><li><a href="#g:2">MempoolSnapshot</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Pure side of the Mempool implementation.</p><p>Operations are performed in a pure style returning data types that model
 the control flow through the operation and can then be interpreted to perform
 the actual STM/IO operations.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:implTryAddTxs">implTryAddTxs</a> &#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:MonadSTM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">MonadSTM</a> m, <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:LedgerSupportsMempool" title="Ouroboros.Consensus.Ledger.SupportsMempool">LedgerSupportsMempool</a> blk, <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:HasTxId" title="Ouroboros.Consensus.Ledger.SupportsMempool">HasTxId</a> (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk)) &#8658; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:StrictTVar" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">StrictTVar</a> m (<a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk) &#8594; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:LedgerConfig" title="Ouroboros.Consensus.Ledger.Basics">LedgerConfig</a> blk &#8594; (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:TxSizeInBytes" title="Ouroboros.Consensus.Mempool.API">TxSizeInBytes</a>) &#8594; Tracer m (<a href="Ouroboros-Consensus-Mempool-API.html#t:TraceEventMempool" title="Ouroboros.Consensus.Mempool.API">TraceEventMempool</a> blk) &#8594; <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:WhetherToIntervene" title="Ouroboros.Consensus.Ledger.SupportsMempool">WhetherToIntervene</a> &#8594; [<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk] &#8594; m ([<a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolAddTxResult" title="Ouroboros.Consensus.Mempool.API">MempoolAddTxResult</a> blk], [<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk])</li><li class="src short"><a href="#v:pureGetSnapshotFor">pureGetSnapshotFor</a> &#8759; &#8704; blk. (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:LedgerSupportsMempool" title="Ouroboros.Consensus.Ledger.SupportsMempool">LedgerSupportsMempool</a> blk, <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:HasTxId" title="Ouroboros.Consensus.Ledger.SupportsMempool">HasTxId</a> (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk), <a href="Ouroboros-Consensus-HeaderValidation.html#t:ValidateEnvelope" title="Ouroboros.Consensus.HeaderValidation">ValidateEnvelope</a> blk) &#8658; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:LedgerConfig" title="Ouroboros.Consensus.Ledger.Basics">LedgerConfig</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:ForgeLedgerState" title="Ouroboros.Consensus.Mempool.API">ForgeLedgerState</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.Mempool.API">MempoolCapacityBytesOverride</a> &#8594; <a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolSnapshot" title="Ouroboros.Consensus.Mempool.API">MempoolSnapshot</a> blk <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a></li><li class="src short"><a href="#v:pureRemoveTxs">pureRemoveTxs</a> &#8759; (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:LedgerSupportsMempool" title="Ouroboros.Consensus.Ledger.SupportsMempool">LedgerSupportsMempool</a> blk, <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:HasTxId" title="Ouroboros.Consensus.Ledger.SupportsMempool">HasTxId</a> (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk), <a href="Ouroboros-Consensus-HeaderValidation.html#t:ValidateEnvelope" title="Ouroboros.Consensus.HeaderValidation">ValidateEnvelope</a> blk) &#8658; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:LedgerConfig" title="Ouroboros.Consensus.Ledger.Basics">LedgerConfig</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.Mempool.API">MempoolCapacityBytesOverride</a> &#8594; [<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTxId" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTxId</a> blk] &#8594; <a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk &#8594; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:LedgerState" title="Ouroboros.Consensus.Ledger.Basics">LedgerState</a> blk &#8594; RemoveTxs blk</li><li class="src short"><a href="#v:pureSyncWithLedger">pureSyncWithLedger</a> &#8759; (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:LedgerSupportsMempool" title="Ouroboros.Consensus.Ledger.SupportsMempool">LedgerSupportsMempool</a> blk, <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:HasTxId" title="Ouroboros.Consensus.Ledger.SupportsMempool">HasTxId</a> (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk), <a href="Ouroboros-Consensus-HeaderValidation.html#t:ValidateEnvelope" title="Ouroboros.Consensus.HeaderValidation">ValidateEnvelope</a> blk) &#8658; <a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk &#8594; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:LedgerState" title="Ouroboros.Consensus.Ledger.Basics">LedgerState</a> blk &#8594; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:LedgerConfig" title="Ouroboros.Consensus.Ledger.Basics">LedgerConfig</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.Mempool.API">MempoolCapacityBytesOverride</a> &#8594; SyncWithLedger blk</li><li class="src short"><a href="#v:runRemoveTxs">runRemoveTxs</a> &#8759; &#8704; m blk. <a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m &#8658; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:StrictTVar" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">StrictTVar</a> m (<a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk) &#8594; RemoveTxs blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-Mempool-API.html#t:TraceEventMempool" title="Ouroboros.Consensus.Mempool.API">TraceEventMempool</a> blk))</li><li class="src short"><a href="#v:runSyncWithLedger">runSyncWithLedger</a> &#8759; &#8704; m blk. <a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m &#8658; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:StrictTVar" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">StrictTVar</a> m (<a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk) &#8594; SyncWithLedger blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-Mempool-API.html#t:TraceEventMempool" title="Ouroboros.Consensus.Mempool.API">TraceEventMempool</a> blk), <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolSnapshot" title="Ouroboros.Consensus.Mempool.API">MempoolSnapshot</a> blk <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a>)</li><li class="src short"><a href="#v:implSnapshotFromIS">implSnapshotFromIS</a> &#8759; <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:HasTxId" title="Ouroboros.Consensus.Ledger.SupportsMempool">HasTxId</a> (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk) &#8658; <a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolSnapshot" title="Ouroboros.Consensus.Mempool.API">MempoolSnapshot</a> blk <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Mempool</h1></a><div class="top"><p class="src"><a id="v:implTryAddTxs" class="def">implTryAddTxs</a> <a href="src/Ouroboros.Consensus.Mempool.Impl.Pure.html#implTryAddTxs" class="link">Source</a> <a href="#v:implTryAddTxs" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">&#8759; &#8704; m blk. (<a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:MonadSTM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">MonadSTM</a> m, <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:LedgerSupportsMempool" title="Ouroboros.Consensus.Ledger.SupportsMempool">LedgerSupportsMempool</a> blk, <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:HasTxId" title="Ouroboros.Consensus.Ledger.SupportsMempool">HasTxId</a> (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk))</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">&#8658; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:StrictTVar" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">StrictTVar</a> m (<a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk)</td><td class="doc"><p>The InternalState TVar.</p></td></tr><tr><td class="src">&#8594; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:LedgerConfig" title="Ouroboros.Consensus.Ledger.Basics">LedgerConfig</a> blk</td><td class="doc"><p>The configuration of the ledger.</p></td></tr><tr><td class="src">&#8594; (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:TxSizeInBytes" title="Ouroboros.Consensus.Mempool.API">TxSizeInBytes</a>)</td><td class="doc"><p>The function to calculate the size of a
 transaction.</p></td></tr><tr><td class="src">&#8594; Tracer m (<a href="Ouroboros-Consensus-Mempool-API.html#t:TraceEventMempool" title="Ouroboros.Consensus.Mempool.API">TraceEventMempool</a> blk)</td><td class="doc"><p>The tracer.</p></td></tr><tr><td class="src">&#8594; <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:WhetherToIntervene" title="Ouroboros.Consensus.Ledger.SupportsMempool">WhetherToIntervene</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">&#8594; [<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk]</td><td class="doc"><p>The list of transactions to add to the mempool.</p></td></tr><tr><td class="src">&#8594; m ([<a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolAddTxResult" title="Ouroboros.Consensus.Mempool.API">MempoolAddTxResult</a> blk], [<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk])</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Add a list of transactions (oldest to newest) by interpreting a <code>TryAddTxs</code>
 from <code>pureTryAddTxs</code>.</p><p>This function returns two lists: the transactions that were added or
 rejected, and the transactions that could not yet be added, because the
 Mempool capacity was reached. See <code><a href="Ouroboros-Consensus-Mempool-API.html#v:addTxs" title="Ouroboros.Consensus.Mempool.API">addTxs</a></code> for a function that blocks in
 case the Mempool capacity is reached.</p><p>Transactions are added one by one, updating the Mempool each time one was
 added successfully.</p><p>See the necessary invariants on the Haddock for <code><a href="API.html#v:tryAddTxs" title="API">tryAddTxs</a></code>.</p><p>This function does not sync the Mempool contents with the ledger state in
 case the latter changes, it relies on the background thread to do that.</p><p>INVARIANT: The code needs that read and writes on the state are coupled
 together or inconsistencies will arise. To ensure that STM transactions are
 short, each iteration of the helper function is a separate STM transaction.</p></div></div><div class="top"><p class="src"><a id="v:pureGetSnapshotFor" class="def">pureGetSnapshotFor</a> &#8759; &#8704; blk. (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:LedgerSupportsMempool" title="Ouroboros.Consensus.Ledger.SupportsMempool">LedgerSupportsMempool</a> blk, <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:HasTxId" title="Ouroboros.Consensus.Ledger.SupportsMempool">HasTxId</a> (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk), <a href="Ouroboros-Consensus-HeaderValidation.html#t:ValidateEnvelope" title="Ouroboros.Consensus.HeaderValidation">ValidateEnvelope</a> blk) &#8658; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:LedgerConfig" title="Ouroboros.Consensus.Ledger.Basics">LedgerConfig</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:ForgeLedgerState" title="Ouroboros.Consensus.Mempool.API">ForgeLedgerState</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.Mempool.API">MempoolCapacityBytesOverride</a> &#8594; <a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolSnapshot" title="Ouroboros.Consensus.Mempool.API">MempoolSnapshot</a> blk <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a> <a href="src/Ouroboros.Consensus.Mempool.Impl.Pure.html#pureGetSnapshotFor" class="link">Source</a> <a href="#v:pureGetSnapshotFor" class="selflink">#</a></p><div class="doc"><p>Get a snapshot of the mempool state that is valid with respect to
 the given ledger state</p></div></div><div class="top"><p class="src"><a id="v:pureRemoveTxs" class="def">pureRemoveTxs</a> &#8759; (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:LedgerSupportsMempool" title="Ouroboros.Consensus.Ledger.SupportsMempool">LedgerSupportsMempool</a> blk, <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:HasTxId" title="Ouroboros.Consensus.Ledger.SupportsMempool">HasTxId</a> (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk), <a href="Ouroboros-Consensus-HeaderValidation.html#t:ValidateEnvelope" title="Ouroboros.Consensus.HeaderValidation">ValidateEnvelope</a> blk) &#8658; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:LedgerConfig" title="Ouroboros.Consensus.Ledger.Basics">LedgerConfig</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.Mempool.API">MempoolCapacityBytesOverride</a> &#8594; [<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTxId" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTxId</a> blk] &#8594; <a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk &#8594; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:LedgerState" title="Ouroboros.Consensus.Ledger.Basics">LedgerState</a> blk &#8594; RemoveTxs blk <a href="src/Ouroboros.Consensus.Mempool.Impl.Pure.html#pureRemoveTxs" class="link">Source</a> <a href="#v:pureRemoveTxs" class="selflink">#</a></p><div class="doc"><p>Craft a <code>RemoveTxs</code> that manually removes the given transactions from the
 mempool, returning inside it an updated InternalState.</p></div></div><div class="top"><p class="src"><a id="v:pureSyncWithLedger" class="def">pureSyncWithLedger</a> &#8759; (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:LedgerSupportsMempool" title="Ouroboros.Consensus.Ledger.SupportsMempool">LedgerSupportsMempool</a> blk, <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:HasTxId" title="Ouroboros.Consensus.Ledger.SupportsMempool">HasTxId</a> (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk), <a href="Ouroboros-Consensus-HeaderValidation.html#t:ValidateEnvelope" title="Ouroboros.Consensus.HeaderValidation">ValidateEnvelope</a> blk) &#8658; <a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk &#8594; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:LedgerState" title="Ouroboros.Consensus.Ledger.Basics">LedgerState</a> blk &#8594; <a href="Ouroboros-Consensus-Ledger-Basics.html#t:LedgerConfig" title="Ouroboros.Consensus.Ledger.Basics">LedgerConfig</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolCapacityBytesOverride" title="Ouroboros.Consensus.Mempool.API">MempoolCapacityBytesOverride</a> &#8594; SyncWithLedger blk <a href="src/Ouroboros.Consensus.Mempool.Impl.Pure.html#pureSyncWithLedger" class="link">Source</a> <a href="#v:pureSyncWithLedger" class="selflink">#</a></p><div class="doc"><p>Create a <code>SyncWithLedger</code> value representing the values that will need to
 be stored for committing this synchronization with the Ledger.</p><p>See the documentation of <code><a href="Ouroboros-Consensus-Mempool-Impl-Pure.html#v:runSyncWithLedger" title="Ouroboros.Consensus.Mempool.Impl.Pure">runSyncWithLedger</a></code> for more context.</p></div></div><div class="top"><p class="src"><a id="v:runRemoveTxs" class="def">runRemoveTxs</a> &#8759; &#8704; m blk. <a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m &#8658; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:StrictTVar" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">StrictTVar</a> m (<a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk) &#8594; RemoveTxs blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-Mempool-API.html#t:TraceEventMempool" title="Ouroboros.Consensus.Mempool.API">TraceEventMempool</a> blk)) <a href="src/Ouroboros.Consensus.Mempool.Impl.Pure.html#runRemoveTxs" class="link">Source</a> <a href="#v:runRemoveTxs" class="selflink">#</a></p><div class="doc"><p>Intepret a <code>RemoveTxs</code> with the resulting values produced by manually
 removing the transactions given to <code><a href="Ouroboros-Consensus-Mempool-Impl-Pure.html#v:pureRemoveTxs" title="Ouroboros.Consensus.Mempool.Impl.Pure">pureRemoveTxs</a></code> from the mempool.</p></div></div><div class="top"><p class="src"><a id="v:runSyncWithLedger" class="def">runSyncWithLedger</a> &#8759; &#8704; m blk. <a href="Ouroboros-Consensus-Util-IOLike.html#t:IOLike" title="Ouroboros.Consensus.Util.IOLike">IOLike</a> m &#8658; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:StrictTVar" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">StrictTVar</a> m (<a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk) &#8594; SyncWithLedger blk &#8594; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-Mempool-API.html#t:TraceEventMempool" title="Ouroboros.Consensus.Mempool.API">TraceEventMempool</a> blk), <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolSnapshot" title="Ouroboros.Consensus.Mempool.API">MempoolSnapshot</a> blk <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a>) <a href="src/Ouroboros.Consensus.Mempool.Impl.Pure.html#runSyncWithLedger" class="link">Source</a> <a href="#v:runSyncWithLedger" class="selflink">#</a></p><div class="doc"><p>Intepret a <code>SyncWithLedger</code> value produced by syncing the transactions in
  the mempool with the current ledger state of the <code>ChainDB</code>.</p><p>The transactions that exist within the mempool will be revalidated
 against the current ledger state. Transactions which are found to be
 invalid with respect to the current ledger state, will be dropped
 from the mempool, whereas valid transactions will remain.</p><p>n.b. in our current implementation, when one opens a mempool, we
 spawn a thread which performs this action whenever the <code>ChainDB</code> tip
 point changes.</p></div></div><a href="#g:2" id="g:2"><h1>MempoolSnapshot</h1></a><div class="top"><p class="src"><a id="v:implSnapshotFromIS" class="def">implSnapshotFromIS</a> &#8759; <a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:HasTxId" title="Ouroboros.Consensus.Ledger.SupportsMempool">HasTxId</a> (<a href="Ouroboros-Consensus-Ledger-SupportsMempool.html#t:GenTx" title="Ouroboros.Consensus.Ledger.SupportsMempool">GenTx</a> blk) &#8658; <a href="Ouroboros-Consensus-Mempool-Impl-Types.html#t:InternalState" title="Ouroboros.Consensus.Mempool.Impl.Types">InternalState</a> blk &#8594; <a href="Ouroboros-Consensus-Mempool-API.html#t:MempoolSnapshot" title="Ouroboros.Consensus.Mempool.API">MempoolSnapshot</a> blk <a href="Ouroboros-Consensus-Mempool-TxSeq.html#t:TicketNo" title="Ouroboros.Consensus.Mempool.TxSeq">TicketNo</a> <a href="src/Ouroboros.Consensus.Mempool.Impl.Pure.html#implSnapshotFromIS" class="link">Source</a> <a href="#v:implSnapshotFromIS" class="selflink">#</a></p><div class="doc"><p>Create a Mempool Snapshot from a given Internal State of the mempool.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.0</p></div></body></html>