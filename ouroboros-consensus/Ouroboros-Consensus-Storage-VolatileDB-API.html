<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ouroboros.Consensus.Storage.VolatileDB.API</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Ouroboros.Consensus.Storage.VolatileDB.API.html">Source</a></li><li><a href="&quot;../index.html&quot;">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ouroboros-consensus-0.1.0.0: Consensus layer for the Ouroboros blockchain protocol</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Ouroboros.Consensus.Storage.VolatileDB.API</p></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:VolatileDB">VolatileDB</a> blockId m = <a href="#v:VolatileDB">VolatileDB</a> {<ul class="subs"><li><a href="#v:closeDB">closeDB</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; m ()</li><li><a href="#v:isOpenDB">isOpenDB</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; m <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li><a href="#v:reOpenDB">reOpenDB</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; m ()</li><li><a href="#v:getBlockComponent">getBlockComponent</a> &#8759; &#8704; b. <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; <a href="Ouroboros-Consensus-Storage-Common.html#t:BlockComponent" title="Ouroboros.Consensus.Storage.Common">BlockComponent</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m) b &#8594; blockId &#8594; m (<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> b)</li><li><a href="#v:putBlock">putBlock</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; <a href="Ouroboros-Consensus-Storage-VolatileDB-Types.html#t:BlockInfo" title="Ouroboros.Consensus.Storage.VolatileDB.Types">BlockInfo</a> blockId &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/binary-0.8.6.0/Data-Binary-Builder.html#t:Builder" title="Data.Binary.Builder">Builder</a> &#8594; m ()</li><li><a href="#v:filterByPredecessor">filterByPredecessor</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/Cardano-Slotting-Slot.html#t:WithOrigin" title="Cardano.Slotting.Slot">WithOrigin</a> blockId &#8594; <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/Cardano-Prelude-Base.html#t:Set" title="Cardano.Prelude.Base">Set</a> blockId)</li><li><a href="#v:getBlockInfo">getBlockInfo</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (blockId &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-Types.html#t:BlockInfo" title="Ouroboros.Consensus.Storage.VolatileDB.Types">BlockInfo</a> blockId))</li><li><a href="#v:garbageCollect">garbageCollect</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> &#8594; m ()</li><li><a href="#v:getMaxSlotNo">getMaxSlotNo</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-Block.html#t:MaxSlotNo" title="Ouroboros.Network.Block">MaxSlotNo</a></li></ul>}</li><li class="src short"><a href="#v:withDB">withDB</a> &#8759; (<a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a>, <a href="Ouroboros-Consensus-Util-IOLike.html#t:MonadThrow" title="Ouroboros.Consensus.Util.IOLike">MonadThrow</a> m) &#8658; m (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m) &#8594; (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m &#8594; m a) &#8594; m a</li><li class="src short">module <a href="Ouroboros-Consensus-Storage-VolatileDB-Types.html">Ouroboros.Consensus.Storage.VolatileDB.Types</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:VolatileDB" class="def">VolatileDB</a> blockId m <a href="src/Ouroboros.Consensus.Storage.VolatileDB.API.html#VolatileDB" class="link">Source</a> <a href="#t:VolatileDB" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:VolatileDB" class="def">VolatileDB</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:closeDB" class="def">closeDB</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; m ()</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:isOpenDB" class="def">isOpenDB</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; m <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:reOpenDB" class="def">reOpenDB</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; m ()</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:getBlockComponent" class="def">getBlockComponent</a> &#8759; &#8704; b. <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; <a href="Ouroboros-Consensus-Storage-Common.html#t:BlockComponent" title="Ouroboros.Consensus.Storage.Common">BlockComponent</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m) b &#8594; blockId &#8594; m (<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> b)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:putBlock" class="def">putBlock</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; <a href="Ouroboros-Consensus-Storage-VolatileDB-Types.html#t:BlockInfo" title="Ouroboros.Consensus.Storage.VolatileDB.Types">BlockInfo</a> blockId &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/binary-0.8.6.0/Data-Binary-Builder.html#t:Builder" title="Data.Binary.Builder">Builder</a> &#8594; m ()</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:filterByPredecessor" class="def">filterByPredecessor</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (<a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-slotting-0.1.0.0/noopt/doc/html/cardano-slotting/Cardano-Slotting-Slot.html#t:WithOrigin" title="Cardano.Slotting.Slot">WithOrigin</a> blockId &#8594; <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/Cardano-Prelude-Base.html#t:Set" title="Cardano.Prelude.Base">Set</a> blockId)</dfn><div class="doc"><p>Return a function that returns the successors of the block with the
 given <code>blockId</code>.</p><p>This function will return a non-empty set for any block of which a
 predecessor has been added to the VolatileDB and will return an empty
 set if no successors for the given block have been added to the
 VolatileDB (yet).</p><p>Note that it is not required that the given block has been added to
 the VolatileDB.</p></div></li><li><dfn class="src"><a id="v:getBlockInfo" class="def">getBlockInfo</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m (blockId &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-Types.html#t:BlockInfo" title="Ouroboros.Consensus.Storage.VolatileDB.Types">BlockInfo</a> blockId))</dfn><div class="doc"><p>Return a function that returns the <code><a href="Ouroboros-Consensus-Storage-VolatileDB-Types.html#t:BlockInfo" title="Ouroboros.Consensus.Storage.VolatileDB.Types">BlockInfo</a></code> of the block with
 the given <code>blockId</code> or <code><a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/GHC-Maybe.html#v:Nothing" title="GHC.Maybe">Nothing</a></code> if the <code>blockId</code> is not found in the
 VolatileDB.</p></div></li><li><dfn class="src"><a id="v:garbageCollect" class="def">garbageCollect</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; <a href="Ouroboros-Consensus-Storage-ImmutableDB-Types.html#t:SlotNo" title="Ouroboros.Consensus.Storage.ImmutableDB.Types">SlotNo</a> &#8594; m ()</dfn><div class="doc"><p>Try to remove all blocks with a slot number less than the given
 one.</p><h1>Context</h1><p>When the current chain changes, blocks older than <code>k</code>, i.e., blocks
 that are followed by <code>k</code> blocks or more, become <em>immutable</em>. Whenever
 this happens, we schedule a garbage collection on the VolatileDB that
 will try to remove blocks older than the most recent immutable block,
 as such blocks will never be adopted. There's no point in storing
 them anymore.</p><h1>Block number vs slot number</h1><p>While we typically talk in terms of <em>block numbers</em> when discussing
 immutability, i.e., <em><code>k</code> blocks</em>, we use <em>slot number</em> for garbage
 collection. We schedule a garbage collection for blocks with a /slot
 number/ less than the slot number of the immutable block, as opposed
 to the block number. The reason for this is that the VolatileDB is
 not aware of block numbers, only of slot numbers.</p><p>By using slot numbers for garbage collection, we might not <em>yet</em> have
 garbage collected some blocks that could never be adopted again and
 that we would have garbage collected when using block numbers. This
 is harmless. The opposite direction is more important and
 problematic: garbage collecting a block that we might want to adopt
 after all. Say we have mistakenly garbage collected such a block, in
 that case the following would be true:</p><ol><li>The block has a slot number older than the immutable block's slot
    number: otherwise we wouldn't have mistakenly garbage collected
    it.</li><li>The block has a block number greater than the immutable block's
    block number: otherwise we wouldn't want to adopt it, as it would
    have been older than <code>k</code>.</li><li>The block is a part of a fork fitting on the immutable block. As
    we cannot roll back this block, all forks we could ever adopt
    would have to go through this block.</li></ol><p>As slot numbers grow monotonically within a chain, all forks starting
 after the immutable block will only contain blocks with slot numbers
 greater (or equal to in case of EBBs) than the immutable block's slot
 number. This directly contradicts (1), so we will <em>never</em> garbage
 collect a block that we might still want to adopt.</p><h1>Less than vs. less than or equal to</h1><p>Note that we remove blocks with a slot number <em>less than</em> the given
 slot number, but not <em>equal to</em> it. In practice, this off-by-one
 difference will not matter in terms of disk space usage, because as
 soon as the chain grows again by at least one block, those blocks
 will be removed anyway. The reason for <code>&lt;</code> opposed to <code>&lt;=</code> is to
 avoid issues with <em>EBBs</em>, which have the same slot number as the
 block after it.</p></div></li><li><dfn class="src"><a id="v:getMaxSlotNo" class="def">getMaxSlotNo</a> &#8759; <a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a> &#8658; <a href="Ouroboros-Consensus-Util-MonadSTM-NormalForm.html#t:STM" title="Ouroboros.Consensus.Util.MonadSTM.NormalForm">STM</a> m <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/Ouroboros-Network-Block.html#t:MaxSlotNo" title="Ouroboros.Network.Block">MaxSlotNo</a></dfn><div class="doc"><p>Return the highest slot number ever stored by the VolatileDB.</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:VolatileDB" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:VolatileDB:NoUnexpectedThunks:1"></span> <a href="Ouroboros-Consensus-Util-IOLike.html#t:NoUnexpectedThunks" title="Ouroboros.Consensus.Util.IOLike">NoUnexpectedThunks</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m)</span> <a href="src/Ouroboros.Consensus.Storage.VolatileDB.API.html#line-122" class="link">Source</a> <a href="#t:VolatileDB" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:VolatileDB:NoUnexpectedThunks:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Storage-VolatileDB-API.html">Ouroboros.Consensus.Storage.VolatileDB.API</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:noUnexpectedThunks">noUnexpectedThunks</a> &#8759; [<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a>] &#8594; <a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/Cardano-Prelude-GHC-Heap-NormalForm-Classy.html#t:ThunkInfo" title="Cardano.Prelude.GHC.Heap.NormalForm.Classy">ThunkInfo</a> <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src" class="link">Source</a> <a href="#v:noUnexpectedThunks" class="selflink">#</a></p><p class="src"><a href="#v:whnfNoUnexpectedThunks">whnfNoUnexpectedThunks</a> &#8759; [<a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a>] &#8594; <a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/Cardano-Prelude-GHC-Heap-NormalForm-Classy.html#t:ThunkInfo" title="Cardano.Prelude.GHC.Heap.NormalForm.Classy">ThunkInfo</a> <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src" class="link">Source</a> <a href="#v:whnfNoUnexpectedThunks" class="selflink">#</a></p><p class="src"><a href="#v:showTypeOf">showTypeOf</a> &#8759; <a href="Ouroboros-Consensus-Util-RedundantConstraints.html#t:Proxy" title="Ouroboros.Consensus.Util.RedundantConstraints">Proxy</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m) &#8594; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.6.5/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src" class="link">Source</a> <a href="#v:showTypeOf" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:VolatileDB:DB:2"></span> <a href="Ouroboros-Consensus-Storage-Common.html#t:DB" title="Ouroboros.Consensus.Storage.Common">DB</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m)</span> <a href="src/Ouroboros.Consensus.Storage.VolatileDB.API.html#line-125" class="link">Source</a> <a href="#t:VolatileDB" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:VolatileDB:DB:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Storage-VolatileDB-API.html">Ouroboros.Consensus.Storage.VolatileDB.API</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="Ouroboros-Consensus-Storage-Common.html#t:DBBlock" title="Ouroboros.Consensus.Storage.Common">DBBlock</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m) &#8759; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="src/Ouroboros.Consensus.Storage.Common.html#DBBlock" class="link">Source</a> <a href="#t:DBBlock" class="selflink">#</a></p><p class="src"><span class="keyword">type</span> <a href="Ouroboros-Consensus-Storage-Common.html#t:DBHeader" title="Ouroboros.Consensus.Storage.Common">DBHeader</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m) &#8759; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="src/Ouroboros.Consensus.Storage.Common.html#DBHeader" class="link">Source</a> <a href="#t:DBHeader" class="selflink">#</a></p><p class="src"><span class="keyword">type</span> <a href="Ouroboros-Consensus-Storage-Common.html#t:DBHeaderHash" title="Ouroboros.Consensus.Storage.Common">DBHeaderHash</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m) &#8759; <a href="file:///opt/ghc/8.6.5/share/doc/ghc-8.6.5/html/libraries/base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="src/Ouroboros.Consensus.Storage.Common.html#DBHeaderHash" class="link">Source</a> <a href="#t:DBHeaderHash" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:VolatileDB:DBBlock:3"></span> <span class="keyword">type</span> <a href="Ouroboros-Consensus-Storage-Common.html#t:DBBlock" title="Ouroboros.Consensus.Storage.Common">DBBlock</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m)</span> <a href="src/Ouroboros.Consensus.Storage.VolatileDB.API.html#line-128" class="link">Source</a> <a href="#t:VolatileDB" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:VolatileDB:DBBlock:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Storage-VolatileDB-API.html">Ouroboros.Consensus.Storage.VolatileDB.API</a></p> <div class="src"><span class="keyword">type</span> <a href="Ouroboros-Consensus-Storage-Common.html#t:DBBlock" title="Ouroboros.Consensus.Storage.Common">DBBlock</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m) = ()</div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:VolatileDB:DBHeader:4"></span> <span class="keyword">type</span> <a href="Ouroboros-Consensus-Storage-Common.html#t:DBHeader" title="Ouroboros.Consensus.Storage.Common">DBHeader</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m)</span> <a href="src/Ouroboros.Consensus.Storage.VolatileDB.API.html#line-129" class="link">Source</a> <a href="#t:VolatileDB" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:VolatileDB:DBHeader:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Storage-VolatileDB-API.html">Ouroboros.Consensus.Storage.VolatileDB.API</a></p> <div class="src"><span class="keyword">type</span> <a href="Ouroboros-Consensus-Storage-Common.html#t:DBHeader" title="Ouroboros.Consensus.Storage.Common">DBHeader</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m) = ()</div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:VolatileDB:DBHeaderHash:5"></span> <span class="keyword">type</span> <a href="Ouroboros-Consensus-Storage-Common.html#t:DBHeaderHash" title="Ouroboros.Consensus.Storage.Common">DBHeaderHash</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m)</span> <a href="src/Ouroboros.Consensus.Storage.VolatileDB.API.html#line-130" class="link">Source</a> <a href="#t:VolatileDB" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:VolatileDB:DBHeaderHash:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Consensus-Storage-VolatileDB-API.html">Ouroboros.Consensus.Storage.VolatileDB.API</a></p> <div class="src"><span class="keyword">type</span> <a href="Ouroboros-Consensus-Storage-Common.html#t:DBHeaderHash" title="Ouroboros.Consensus.Storage.Common">DBHeaderHash</a> (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m) = blockId</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:withDB" class="def">withDB</a> <a href="src/Ouroboros.Consensus.Storage.VolatileDB.API.html#withDB" class="link">Source</a> <a href="#v:withDB" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">&#8759; (<a href="Ouroboros-Consensus-Util-CallStack.html#t:HasCallStack" title="Ouroboros.Consensus.Util.CallStack">HasCallStack</a>, <a href="Ouroboros-Consensus-Util-IOLike.html#t:MonadThrow" title="Ouroboros.Consensus.Util.IOLike">MonadThrow</a> m)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">&#8658; m (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m)</td><td class="doc"><p>How to open the database</p></td></tr><tr><td class="src">&#8594; (<a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#t:VolatileDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">VolatileDB</a> blockId m &#8594; m a)</td><td class="doc"><p>Action to perform using the database</p></td></tr><tr><td class="src">&#8594; m a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Open the database using the given function, perform the given action
 using the database, and closes the database using its <code><a href="Ouroboros-Consensus-Storage-VolatileDB-API.html#v:closeDB" title="Ouroboros.Consensus.Storage.VolatileDB.API">closeDB</a></code> function,
 in case of success or when an exception was raised.</p></div></div><div class="top"><p class="src">module <a href="Ouroboros-Consensus-Storage-VolatileDB-Types.html">Ouroboros.Consensus.Storage.VolatileDB.Types</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>