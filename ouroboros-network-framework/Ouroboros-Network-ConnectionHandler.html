<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Ouroboros.Network.ConnectionHandler</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ouroboros-network-framework-0.1.0.0</span><ul class="links" id="page-menu"><li><a href="src/Ouroboros.Network.ConnectionHandler.html">Source</a></li><li><a href="&quot;../index.html&quot;">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Ouroboros.Network.ConnectionHandler</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">tracing</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Implementation of <code><a href="Ouroboros-Network-ConnectionManager-Types.html#t:ConnectionHandler" title="Ouroboros.Network.ConnectionManager.Types">ConnectionHandler</a></code></p><p>While connection manager responsibility is to keep track of resources:
 sockets and threads running connection and their state changes (including
 changes imposed by <code><a href="Ouroboros-Network-ConnectionManager-Types.html#t:ConnectionHandler" title="Ouroboros.Network.ConnectionManager.Types">ConnectionHandler</a></code>, e.g. weather a uni- or duplex- data
 flow was negotiated), the responsibility of <code><a href="Ouroboros-Network-ConnectionManager-Types.html#t:ConnectionHandler" title="Ouroboros.Network.ConnectionManager.Types">ConnectionHandler</a></code> is to:</p><ul><li>run handshake protocol on the underlying bearer</li><li>start mux</li></ul><p><code><a href="Ouroboros-Network-ConnectionManager-Types.html#t:ConnectionHandler" title="Ouroboros.Network.ConnectionManager.Types">ConnectionHandler</a></code> is run on each inbound or outbound connection and returns
 <code><a href="Ouroboros-Network-ConnectionHandler.html#t:Handle" title="Ouroboros.Network.ConnectionHandler">Handle</a></code>.  Upon successful handshake negotiation it returns all the
 necessary information to run mini-protocols.  Note that it is not responsible
 for running them: that's what a server does or p2p-governor by means of
 <code>PeerStateActions</code>.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Handle">Handle</a> (muxMode &#8759; <a href="Ouroboros-Network-Mux.html#t:MuxMode" title="Ouroboros.Network.Mux">MuxMode</a>) peerAddr bytes m a b = <a href="#v:Handle">Handle</a> {<ul class="subs"><li><a href="#v:hMux">hMux</a> &#8759; !(<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/Network-Mux.html#t:Mux" title="Network.Mux">Mux</a> muxMode m)</li><li><a href="#v:hMuxBundle">hMuxBundle</a> &#8759; !(<a href="Ouroboros-Network-Mux.html#t:MuxBundle" title="Ouroboros.Network.Mux">MuxBundle</a> muxMode bytes m a b)</li><li><a href="#v:hControlMessage">hControlMessage</a> &#8759; !(<a href="Ouroboros-Network-Mux.html#t:Bundle" title="Ouroboros.Network.Mux">Bundle</a> (<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/strict-stm-0.1.0.0/noopt/doc/html/strict-stm/Control-Monad-Class-MonadSTM-Strict.html#t:StrictTVar" title="Control.Monad.Class.MonadSTM.Strict">StrictTVar</a> m <a href="Ouroboros-Network-Mux.html#t:ControlMessage" title="Ouroboros.Network.Mux">ControlMessage</a>))</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:HandleError">HandleError</a> (muxMode &#8759; <a href="Ouroboros-Network-Mux.html#t:MuxMode" title="Ouroboros.Network.Mux">MuxMode</a>) versionNumber <span class="keyword">where</span><ul class="subs"><li><a href="#v:HandleHandshakeClientError">HandleHandshakeClientError</a> &#8759; <a href="Ouroboros-Network-Mux.html#t:HasInitiator" title="Ouroboros.Network.Mux">HasInitiator</a> muxMode ~ <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Bool.html#v:True" title="Data.Bool">True</a> &#8658; !(<a href="Ouroboros-Network-Protocol-Handshake.html#t:HandshakeException" title="Ouroboros.Network.Protocol.Handshake">HandshakeException</a> versionNumber) &#8594; <a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber</li><li><a href="#v:HandleHandshakeServerError">HandleHandshakeServerError</a> &#8759; <a href="Ouroboros-Network-Mux.html#t:HasResponder" title="Ouroboros.Network.Mux">HasResponder</a> muxMode ~ <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Bool.html#v:True" title="Data.Bool">True</a> &#8658; !(<a href="Ouroboros-Network-Protocol-Handshake.html#t:HandshakeException" title="Ouroboros.Network.Protocol.Handshake">HandshakeException</a> versionNumber) &#8594; <a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber</li><li><a href="#v:HandleError">HandleError</a> &#8759; !<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> &#8594; <a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber</li></ul></li><li class="src short"><a href="#v:classifyHandleError">classifyHandleError</a> &#8759; <a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber &#8594; <a href="Ouroboros-Network-ConnectionManager-Types.html#t:HandleErrorType" title="Ouroboros.Network.ConnectionManager.Types">HandleErrorType</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:MuxConnectionHandler">MuxConnectionHandler</a> muxMode socket peerAddr versionNumber versionData bytes m a b = <a href="Ouroboros-Network-ConnectionManager-Types.html#t:ConnectionHandler" title="Ouroboros.Network.ConnectionManager.Types">ConnectionHandler</a> muxMode (<a href="Ouroboros-Network-ConnectionHandler.html#t:ConnectionHandlerTrace" title="Ouroboros.Network.ConnectionHandler">ConnectionHandlerTrace</a> versionNumber versionData) socket peerAddr (<a href="Ouroboros-Network-ConnectionHandler.html#t:Handle" title="Ouroboros.Network.ConnectionHandler">Handle</a> muxMode peerAddr bytes m a b) (<a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber) (versionNumber, versionData) m</li><li class="src short"><a href="#v:makeConnectionHandler">makeConnectionHandler</a> &#8759; &#8704; peerAddr muxMode socket versionNumber versionData m a b. (<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadAsync.html#t:MonadAsync" title="Control.Monad.Class.MonadAsync">MonadAsync</a> m, <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadThrow.html#t:MonadCatch" title="Control.Monad.Class.MonadThrow">MonadCatch</a> m, <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadFork.html#t:MonadFork" title="Control.Monad.Class.MonadFork">MonadFork</a> m, <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadSTM.html#t:MonadLabelledSTM" title="Control.Monad.Class.MonadSTM">MonadLabelledSTM</a> m, <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadThrow.html#t:MonadThrow" title="Control.Monad.Class.MonadThrow">MonadThrow</a> (<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadSTM.html#t:STM" title="Control.Monad.Class.MonadSTM">STM</a> m), <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadTime.html#t:MonadTime" title="Control.Monad.Class.MonadTime">MonadTime</a> m, <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadTimer.html#t:MonadTimer" title="Control.Monad.Class.MonadTimer">MonadTimer</a> m, <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadThrow.html#t:MonadMask" title="Control.Monad.Class.MonadThrow">MonadMask</a> m, <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> versionNumber, <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> peerAddr, <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> peerAddr) &#8658; Tracer m (<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/Network-Mux-Trace.html#t:WithMuxBearer" title="Network.Mux.Trace">WithMuxBearer</a> (<a href="Ouroboros-Network-ConnectionId.html#t:ConnectionId" title="Ouroboros.Network.ConnectionId">ConnectionId</a> peerAddr) <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/Network-Mux-Trace.html#t:MuxTrace" title="Network.Mux.Trace">MuxTrace</a>) &#8594; <a href="Ouroboros-Network-MuxMode.html#t:SingMuxMode" title="Ouroboros.Network.MuxMode">SingMuxMode</a> muxMode &#8594; <a href="Ouroboros-Network-Protocol-Handshake.html#t:HandshakeArguments" title="Ouroboros.Network.Protocol.Handshake">HandshakeArguments</a> (<a href="Ouroboros-Network-ConnectionId.html#t:ConnectionId" title="Ouroboros.Network.ConnectionId">ConnectionId</a> peerAddr) versionNumber versionData m &#8594; <a href="Ouroboros-Network-Protocol-Handshake-Version.html#t:Versions" title="Ouroboros.Network.Protocol.Handshake.Version">Versions</a> versionNumber versionData (<a href="Ouroboros-Network-Mux.html#t:OuroborosBundle" title="Ouroboros.Network.Mux">OuroborosBundle</a> muxMode peerAddr <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> m a b) &#8594; (<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadFork.html#t:ThreadId" title="Control.Monad.Class.MonadFork">ThreadId</a> m, <a href="Ouroboros-Network-RethrowPolicy.html#t:RethrowPolicy" title="Ouroboros.Network.RethrowPolicy">RethrowPolicy</a>) &#8594; <a href="Ouroboros-Network-ConnectionHandler.html#t:MuxConnectionHandler" title="Ouroboros.Network.ConnectionHandler">MuxConnectionHandler</a> muxMode socket peerAddr versionNumber versionData <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> m a b</li><li class="src short"><span class="keyword">type</span> <a href="#t:MuxConnectionManager">MuxConnectionManager</a> muxMode socket peerAddr versionNumber bytes m a b = <a href="Ouroboros-Network-ConnectionManager-Types.html#t:ConnectionManager" title="Ouroboros.Network.ConnectionManager.Types">ConnectionManager</a> muxMode socket peerAddr (<a href="Ouroboros-Network-ConnectionHandler.html#t:Handle" title="Ouroboros.Network.ConnectionHandler">Handle</a> muxMode peerAddr bytes m a b) (<a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber) m</li><li class="src short"><span class="keyword">data</span> <a href="#t:ConnectionHandlerTrace">ConnectionHandlerTrace</a> versionNumber versionData<ul class="subs"><li>= <a href="#v:TrHandshakeSuccess">TrHandshakeSuccess</a> versionNumber versionData</li><li>| <a href="#v:TrHandshakeClientError">TrHandshakeClientError</a> (<a href="Ouroboros-Network-Protocol-Handshake.html#t:HandshakeException" title="Ouroboros.Network.Protocol.Handshake">HandshakeException</a> versionNumber)</li><li>| <a href="#v:TrHandshakeServerError">TrHandshakeServerError</a> (<a href="Ouroboros-Network-Protocol-Handshake.html#t:HandshakeException" title="Ouroboros.Network.Protocol.Handshake">HandshakeException</a> versionNumber)</li><li>| <a href="#v:TrError">TrError</a> <a href="Ouroboros-Network-RethrowPolicy.html#t:ErrorContext" title="Ouroboros.Network.RethrowPolicy">ErrorContext</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> <a href="Ouroboros-Network-RethrowPolicy.html#t:ErrorCommand" title="Ouroboros.Network.RethrowPolicy">ErrorCommand</a></li></ul></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Handle" class="def">Handle</a> (muxMode &#8759; <a href="Ouroboros-Network-Mux.html#t:MuxMode" title="Ouroboros.Network.Mux">MuxMode</a>) peerAddr bytes m a b <a href="src/Ouroboros.Network.ConnectionHandler.html#Handle" class="link">Source</a> <a href="#t:Handle" class="selflink">#</a></p><div class="doc"><p>States of the connection handler thread.</p><ul><li><code>MuxRunning</code> - successful Handshake, mux started</li><li><code><a href="Ouroboros-Network-ConnectionHandler.html#v:HandleHandshakeClientError" title="Ouroboros.Network.ConnectionHandler">HandleHandshakeClientError</a></code></li><li>the connection handler thread was running client side
                of the handshake negotiation, which failed with
                a <code><a href="Ouroboros-Network-Protocol-Handshake.html#t:HandshakeException" title="Ouroboros.Network.Protocol.Handshake">HandshakeException</a></code></li><li><code><a href="Ouroboros-Network-ConnectionHandler.html#v:HandleHandshakeServerError" title="Ouroboros.Network.ConnectionHandler">HandleHandshakeServerError</a></code></li><li>the connection handler thread was running server side of the
                handshake protocol, which fail with <code><a href="Ouroboros-Network-Protocol-Handshake.html#t:HandshakeException" title="Ouroboros.Network.Protocol.Handshake">HandshakeException</a></code></li><li><code><a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a></code></li><li>the multiplexer thrown <code><a href="Ouroboros-Network-Mux.html#t:MuxError" title="Ouroboros.Network.Mux">MuxError</a></code>.</li></ul></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Handle" class="def">Handle</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:hMux" class="def">hMux</a> &#8759; !(<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/Network-Mux.html#t:Mux" title="Network.Mux">Mux</a> muxMode m)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:hMuxBundle" class="def">hMuxBundle</a> &#8759; !(<a href="Ouroboros-Network-Mux.html#t:MuxBundle" title="Ouroboros.Network.Mux">MuxBundle</a> muxMode bytes m a b)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:hControlMessage" class="def">hControlMessage</a> &#8759; !(<a href="Ouroboros-Network-Mux.html#t:Bundle" title="Ouroboros.Network.Mux">Bundle</a> (<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/strict-stm-0.1.0.0/noopt/doc/html/strict-stm/Control-Monad-Class-MonadSTM-Strict.html#t:StrictTVar" title="Control.Monad.Class.MonadSTM.Strict">StrictTVar</a> m <a href="Ouroboros-Network-Mux.html#t:ControlMessage" title="Ouroboros.Network.Mux">ControlMessage</a>))</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:HandleError" class="def">HandleError</a> (muxMode &#8759; <a href="Ouroboros-Network-Mux.html#t:MuxMode" title="Ouroboros.Network.Mux">MuxMode</a>) versionNumber <span class="keyword">where</span> <a href="src/Ouroboros.Network.ConnectionHandler.html#HandleError" class="link">Source</a> <a href="#t:HandleError" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:HandleHandshakeClientError" class="def">HandleHandshakeClientError</a> &#8759; <a href="Ouroboros-Network-Mux.html#t:HasInitiator" title="Ouroboros.Network.Mux">HasInitiator</a> muxMode ~ <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Bool.html#v:True" title="Data.Bool">True</a> &#8658; !(<a href="Ouroboros-Network-Protocol-Handshake.html#t:HandshakeException" title="Ouroboros.Network.Protocol.Handshake">HandshakeException</a> versionNumber) &#8594; <a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:HandleHandshakeServerError" class="def">HandleHandshakeServerError</a> &#8759; <a href="Ouroboros-Network-Mux.html#t:HasResponder" title="Ouroboros.Network.Mux">HasResponder</a> muxMode ~ <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Bool.html#v:True" title="Data.Bool">True</a> &#8658; !(<a href="Ouroboros-Network-Protocol-Handshake.html#t:HandshakeException" title="Ouroboros.Network.Protocol.Handshake">HandshakeException</a> versionNumber) &#8594; <a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:HandleError" class="def">HandleError</a> &#8759; !<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> &#8594; <a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:HandleError">Instances</h4><details id="i:HandleError" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:HandleError:Show:1"></span> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> versionNumber &#8658; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber)</span> <a href="src/Ouroboros.Network.ConnectionHandler.html#line-123" class="link">Source</a> <a href="#t:HandleError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:HandleError:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Network-ConnectionHandler.html">Ouroboros.Network.ConnectionHandler</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> &#8759; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> &#8594; <a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> &#8759; <a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> &#8759; [<a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber] &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:classifyHandleError" class="def">classifyHandleError</a> &#8759; <a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber &#8594; <a href="Ouroboros-Network-ConnectionManager-Types.html#t:HandleErrorType" title="Ouroboros.Network.ConnectionManager.Types">HandleErrorType</a> <a href="src/Ouroboros.Network.ConnectionHandler.html#classifyHandleError" class="link">Source</a> <a href="#v:classifyHandleError" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:MuxConnectionHandler" class="def">MuxConnectionHandler</a> muxMode socket peerAddr versionNumber versionData bytes m a b = <a href="Ouroboros-Network-ConnectionManager-Types.html#t:ConnectionHandler" title="Ouroboros.Network.ConnectionManager.Types">ConnectionHandler</a> muxMode (<a href="Ouroboros-Network-ConnectionHandler.html#t:ConnectionHandlerTrace" title="Ouroboros.Network.ConnectionHandler">ConnectionHandlerTrace</a> versionNumber versionData) socket peerAddr (<a href="Ouroboros-Network-ConnectionHandler.html#t:Handle" title="Ouroboros.Network.ConnectionHandler">Handle</a> muxMode peerAddr bytes m a b) (<a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber) (versionNumber, versionData) m <a href="src/Ouroboros.Network.ConnectionHandler.html#MuxConnectionHandler" class="link">Source</a> <a href="#t:MuxConnectionHandler" class="selflink">#</a></p><div class="doc"><p>Type of <code><a href="Ouroboros-Network-ConnectionManager-Types.html#t:ConnectionHandler" title="Ouroboros.Network.ConnectionManager.Types">ConnectionHandler</a></code> implemented in this module.</p></div></div><div class="top"><p class="src"><a id="v:makeConnectionHandler" class="def">makeConnectionHandler</a> <a href="src/Ouroboros.Network.ConnectionHandler.html#makeConnectionHandler" class="link">Source</a> <a href="#v:makeConnectionHandler" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">&#8759; &#8704; peerAddr muxMode socket versionNumber versionData m a b. (<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadAsync.html#t:MonadAsync" title="Control.Monad.Class.MonadAsync">MonadAsync</a> m, <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadThrow.html#t:MonadCatch" title="Control.Monad.Class.MonadThrow">MonadCatch</a> m, <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadFork.html#t:MonadFork" title="Control.Monad.Class.MonadFork">MonadFork</a> m, <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadSTM.html#t:MonadLabelledSTM" title="Control.Monad.Class.MonadSTM">MonadLabelledSTM</a> m, <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadThrow.html#t:MonadThrow" title="Control.Monad.Class.MonadThrow">MonadThrow</a> (<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadSTM.html#t:STM" title="Control.Monad.Class.MonadSTM">STM</a> m), <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadTime.html#t:MonadTime" title="Control.Monad.Class.MonadTime">MonadTime</a> m, <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadTimer.html#t:MonadTimer" title="Control.Monad.Class.MonadTimer">MonadTimer</a> m, <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadThrow.html#t:MonadMask" title="Control.Monad.Class.MonadThrow">MonadMask</a> m, <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> versionNumber, <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> peerAddr, <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> peerAddr)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">&#8658; Tracer m (<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/Network-Mux-Trace.html#t:WithMuxBearer" title="Network.Mux.Trace">WithMuxBearer</a> (<a href="Ouroboros-Network-ConnectionId.html#t:ConnectionId" title="Ouroboros.Network.ConnectionId">ConnectionId</a> peerAddr) <a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/Network-Mux-Trace.html#t:MuxTrace" title="Network.Mux.Trace">MuxTrace</a>)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">&#8594; <a href="Ouroboros-Network-MuxMode.html#t:SingMuxMode" title="Ouroboros.Network.MuxMode">SingMuxMode</a> muxMode</td><td class="doc"><p>describe whether this is outbound or inbound connection, and bring
 evidence that we can use mux with it.</p></td></tr><tr><td class="src">&#8594; <a href="Ouroboros-Network-Protocol-Handshake.html#t:HandshakeArguments" title="Ouroboros.Network.Protocol.Handshake">HandshakeArguments</a> (<a href="Ouroboros-Network-ConnectionId.html#t:ConnectionId" title="Ouroboros.Network.ConnectionId">ConnectionId</a> peerAddr) versionNumber versionData m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">&#8594; <a href="Ouroboros-Network-Protocol-Handshake-Version.html#t:Versions" title="Ouroboros.Network.Protocol.Handshake.Version">Versions</a> versionNumber versionData (<a href="Ouroboros-Network-Mux.html#t:OuroborosBundle" title="Ouroboros.Network.Mux">OuroborosBundle</a> muxMode peerAddr <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> m a b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">&#8594; (<a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadFork.html#t:ThreadId" title="Control.Monad.Class.MonadFork">ThreadId</a> m, <a href="Ouroboros-Network-RethrowPolicy.html#t:RethrowPolicy" title="Ouroboros.Network.RethrowPolicy">RethrowPolicy</a>)</td><td class="doc"><p><code><a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/io-classes-0.2.0.0/noopt/doc/html/io-classes/Control-Monad-Class-MonadFork.html#t:ThreadId" title="Control.Monad.Class.MonadFork">ThreadId</a></code> and rethrow policy.  Rethrow policy might throw an async
 exception to that thread, when trying to terminate the process.</p></td></tr><tr><td class="src">&#8594; <a href="Ouroboros-Network-ConnectionHandler.html#t:MuxConnectionHandler" title="Ouroboros.Network.ConnectionHandler">MuxConnectionHandler</a> muxMode socket peerAddr versionNumber versionData <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/bytestring-0.10.12.0/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> m a b</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>To be used as <code><a href="Ouroboros-Network-ConnectionHandler.html#v:makeConnectionHandler" title="Ouroboros.Network.ConnectionHandler">makeConnectionHandler</a></code> field of <code>ConnectionManagerArguments</code>.</p><p>Note: We need to pass <code><a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/Network-Mux-Types.html#t:MiniProtocolBundle" title="Network.Mux.Types">MiniProtocolBundle</a></code> what forces us to have two
 different <code><a href="Ouroboros-Network-ConnectionManager-Types.html#t:ConnectionManager" title="Ouroboros.Network.ConnectionManager.Types">ConnectionManager</a></code>s: one for `node-to-client` and another for
 `node-to-node` connections.  But this is ok, as these resources are
 independent.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:MuxConnectionManager" class="def">MuxConnectionManager</a> muxMode socket peerAddr versionNumber bytes m a b = <a href="Ouroboros-Network-ConnectionManager-Types.html#t:ConnectionManager" title="Ouroboros.Network.ConnectionManager.Types">ConnectionManager</a> muxMode socket peerAddr (<a href="Ouroboros-Network-ConnectionHandler.html#t:Handle" title="Ouroboros.Network.ConnectionHandler">Handle</a> muxMode peerAddr bytes m a b) (<a href="Ouroboros-Network-ConnectionHandler.html#t:HandleError" title="Ouroboros.Network.ConnectionHandler">HandleError</a> muxMode versionNumber) m <a href="src/Ouroboros.Network.ConnectionHandler.html#MuxConnectionManager" class="link">Source</a> <a href="#t:MuxConnectionManager" class="selflink">#</a></p><div class="doc"><p>Type alias for <code><a href="Ouroboros-Network-ConnectionManager-Types.html#t:ConnectionManager" title="Ouroboros.Network.ConnectionManager.Types">ConnectionManager</a></code> using <code><a href="Ouroboros-Network-ConnectionHandler.html#t:Handle" title="Ouroboros.Network.ConnectionHandler">Handle</a></code>.</p></div></div><a href="#g:1" id="g:1"><h1>tracing</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ConnectionHandlerTrace" class="def">ConnectionHandlerTrace</a> versionNumber versionData <a href="src/Ouroboros.Network.ConnectionHandler.html#ConnectionHandlerTrace" class="link">Source</a> <a href="#t:ConnectionHandlerTrace" class="selflink">#</a></p><div class="doc"><p><code><a href="Ouroboros-Network-ConnectionHandler.html#t:ConnectionHandlerTrace" title="Ouroboros.Network.ConnectionHandler">ConnectionHandlerTrace</a></code> is embedded into <code><a href="Ouroboros-Network-ConnectionManager-Types.html#t:ConnectionManagerTrace" title="Ouroboros.Network.ConnectionManager.Types">ConnectionManagerTrace</a></code> with
 <code><a href="Ouroboros-Network-ConnectionManager-Types.html#v:ConnectionHandlerTrace" title="Ouroboros.Network.ConnectionManager.Types">ConnectionHandlerTrace</a></code>
 constructor.  It already includes <code><a href="Ouroboros-Network-ConnectionId.html#t:ConnectionId" title="Ouroboros.Network.ConnectionId">ConnectionId</a></code> so we don't need to take
 care of it here.</p><p>TODO: when <code>Handshake</code> will get its own tracer, independent of <code><a href="file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/network-mux-0.1.0.0/noopt/doc/html/network-mux/Network-Mux.html#t:Mux" title="Network.Mux">Mux</a></code>, it
 should be embedded into <code><a href="Ouroboros-Network-ConnectionHandler.html#t:ConnectionHandlerTrace" title="Ouroboros.Network.ConnectionHandler">ConnectionHandlerTrace</a></code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TrHandshakeSuccess" class="def">TrHandshakeSuccess</a> versionNumber versionData</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TrHandshakeClientError" class="def">TrHandshakeClientError</a> (<a href="Ouroboros-Network-Protocol-Handshake.html#t:HandshakeException" title="Ouroboros.Network.Protocol.Handshake">HandshakeException</a> versionNumber)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TrHandshakeServerError" class="def">TrHandshakeServerError</a> (<a href="Ouroboros-Network-Protocol-Handshake.html#t:HandshakeException" title="Ouroboros.Network.Protocol.Handshake">HandshakeException</a> versionNumber)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TrError" class="def">TrError</a> <a href="Ouroboros-Network-RethrowPolicy.html#t:ErrorContext" title="Ouroboros.Network.RethrowPolicy">ErrorContext</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> <a href="Ouroboros-Network-RethrowPolicy.html#t:ErrorCommand" title="Ouroboros.Network.RethrowPolicy">ErrorCommand</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ConnectionHandlerTrace">Instances</h4><details id="i:ConnectionHandlerTrace" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ConnectionHandlerTrace:Show:1"></span> (<a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> versionNumber, <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> versionData) &#8658; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Ouroboros-Network-ConnectionHandler.html#t:ConnectionHandlerTrace" title="Ouroboros.Network.ConnectionHandler">ConnectionHandlerTrace</a> versionNumber versionData)</span> <a href="src/Ouroboros.Network.ConnectionHandler.html#line-393" class="link">Source</a> <a href="#t:ConnectionHandlerTrace" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ConnectionHandlerTrace:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ouroboros-Network-ConnectionHandler.html">Ouroboros.Network.ConnectionHandler</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> &#8759; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> &#8594; <a href="Ouroboros-Network-ConnectionHandler.html#t:ConnectionHandlerTrace" title="Ouroboros.Network.ConnectionHandler">ConnectionHandlerTrace</a> versionNumber versionData &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> &#8759; <a href="Ouroboros-Network-ConnectionHandler.html#t:ConnectionHandlerTrace" title="Ouroboros.Network.ConnectionHandler">ConnectionHandlerTrace</a> versionNumber versionData &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> &#8759; [<a href="Ouroboros-Network-ConnectionHandler.html#t:ConnectionHandlerTrace" title="Ouroboros.Network.ConnectionHandler">ConnectionHandlerTrace</a> versionNumber versionData] &#8594; <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.0</p></div></body></html>