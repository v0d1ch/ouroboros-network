<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DefaultSignatures #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeInType #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-comment">-- | Generators for transition systems.</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">--   How should these work?</span><span>
</span><span id="line-19"></span><span class="hs-comment">--   - We start with some initial environment.</span><span>
</span><span id="line-20"></span><span class="hs-comment">--   - We start with some initial base state.</span><span>
</span><span id="line-21"></span><span class="hs-comment">--   - We generate a stream of signals. These might be influenced by some running state</span><span>
</span><span id="line-22"></span><span class="hs-comment">--   - We run each signal through</span><span>
</span><span id="line-23"></span><span class="hs-comment">--</span><span>
</span><span id="line-24"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.State.Transition.Generator</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier">HasTrace</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier">SignalGenerator</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier">BaseEnv</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#interpretSTS"><span class="hs-identifier">interpretSTS</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#envGen"><span class="hs-identifier">envGen</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#sigGen"><span class="hs-identifier">sigGen</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#traceSigGen"><span class="hs-identifier">traceSigGen</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#genTrace"><span class="hs-identifier">genTrace</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#trace"><span class="hs-identifier">trace</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#traceWithProfile"><span class="hs-identifier">traceWithProfile</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#traceOfLength"><span class="hs-identifier">traceOfLength</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#traceOfLengthWithInitState"><span class="hs-identifier">traceOfLengthWithInitState</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#traceSuchThat"><span class="hs-identifier">traceSuchThat</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#ofLengthAtLeast"><span class="hs-identifier">ofLengthAtLeast</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#suchThatLastState"><span class="hs-identifier">suchThatLastState</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#nonTrivialTrace"><span class="hs-identifier">nonTrivialTrace</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasSizeInfo"><span class="hs-identifier">HasSizeInfo</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#isTrivial"><span class="hs-identifier">isTrivial</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#sampleMaxTraceSize"><span class="hs-identifier">sampleMaxTraceSize</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#randomTrace"><span class="hs-identifier">randomTrace</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#randomTraceOfSize"><span class="hs-identifier">randomTraceOfSize</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceLength"><span class="hs-identifier">TraceLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Generator.html#Maximum"><span class="hs-identifier">Maximum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#Desired"><span class="hs-identifier">Desired</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceProfile"><span class="hs-identifier">TraceProfile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceProfile"><span class="hs-identifier">TraceProfile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#proportionOfValidSignals"><span class="hs-identifier">proportionOfValidSignals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#failures"><span class="hs-identifier">failures</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#proportionOfInvalidSignals"><span class="hs-identifier">proportionOfInvalidSignals</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Invalid trace generation</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#invalidTrace"><span class="hs-identifier">invalidTrace</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Trace classification</span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#classifyTraceLength"><span class="hs-identifier">classifyTraceLength</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#classifySize"><span class="hs-identifier">classifySize</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#mkIntervals"><span class="hs-identifier">mkIntervals</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#ratio"><span class="hs-identifier">ratio</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Trace properties</span></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#traceLengthsAreClassified"><span class="hs-identifier">traceLengthsAreClassified</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#onlyValidSignalsAreGenerated"><span class="hs-identifier">onlyValidSignalsAreGenerated</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#onlyValidSignalsAreGeneratedForTrace"><span class="hs-identifier">onlyValidSignalsAreGeneratedForTrace</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#invalidSignalsAreGenerated"><span class="hs-identifier">invalidSignalsAreGenerated</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Helpers</span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#tinkerWithSigGen"><span class="hs-identifier">tinkerWithSigGen</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#coverFailures"><span class="hs-identifier">coverFailures</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MaybeT</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">evalState</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Constr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Data</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toConstr</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isLeft</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">traverse_</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Identity</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromString</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word64</span></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Stack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasCallStack</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Hedgehog</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Gen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MonadTest</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Property</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PropertyT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">classify</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cover</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">evalEither</span></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>                     </span><span class="annot"><span class="hs-identifier">footnoteShow</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">forAll</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">property</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">success</span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Hedgehog.Gen</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Gen</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Hedgehog.Internal.Property</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CoverPercentage</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Hedgehog.Range</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Size</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Size</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Hedgehog.Range</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Range</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Hedgehog.Internal.Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">integral_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runDiscardEffectT</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Hedgehog.Internal.Tree</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NodeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NodeT</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TreeT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nodeChildren</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">treeValue</span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">Control.State.Transition.Extended</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">BaseM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">Environment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">IRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">IRC</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">PredicateFailure</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">STS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">Signal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>                     </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">State</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier">TRC</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Control.State.Transition.Invalid.Trace.html"><span class="hs-identifier">Control.State.Transition.Invalid.Trace</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Invalid</span></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Control.State.Transition.Trace.html"><span class="hs-identifier">Control.State.Transition.Trace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier">Trace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Trace.html#TraceOrder"><span class="hs-identifier">TraceOrder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#OldestFirst"><span class="hs-identifier">OldestFirst</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Trace.html#closure"><span class="hs-identifier">closure</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>                     </span><span class="annot"><a href="Control.State.Transition.Trace.html#extractValues"><span class="hs-identifier">extractValues</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Trace.html#lastState"><span class="hs-identifier">lastState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Trace.html#mkTrace"><span class="hs-identifier">mkTrace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Trace.html#traceLength"><span class="hs-identifier">traceLength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Trace.html#traceSignals"><span class="hs-identifier">traceSignals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Trace.html#_traceEnv"><span class="hs-identifier">_traceEnv</span></a></span><span>
</span><span id="line-95"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Trace.html#applySTSTest"><span class="hs-identifier">applySTSTest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Hedgehog.Extra.Manual.html"><span class="hs-identifier">Hedgehog.Extra.Manual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hedgehog.Extra.Manual.html#Manual"><span class="hs-identifier">Manual</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Hedgehog.Extra.Manual.html"><span class="hs-identifier">Hedgehog.Extra.Manual</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Manual</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/goblins-0.2.0.0/noopt/doc/html/goblins/src"><span class="hs-identifier">Test.Goblin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/goblins-0.2.0.0/noopt/doc/html/goblins/src"><span class="hs-identifier">Goblin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/goblins-0.2.0.0/noopt/doc/html/goblins/src"><span class="hs-identifier">GoblinData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/goblins-0.2.0.0/noopt/doc/html/goblins/src"><span class="hs-identifier">SeedGoblin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">STS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="HasTrace"><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-var">HasTrace</span></a></span></span><span> </span><span id="local-6989586621679109244"><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="BaseEnv"><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-var">BaseEnv</span></a></span></span><span> </span><span id="local-6989586621679109244"><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="BaseEnv"><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-var">BaseEnv</span></a></span></span><span> </span><span id="local-6989586621679108951"><span class="annot"><a href="#local-6989586621679108951"><span class="hs-identifier hs-type hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-comment">-- | Interpret the action from the base monad into a pure value, given some</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-comment">-- initial environment. This obviously places some contraints on the nature of</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-comment">-- the base monad for a trace to be completed.</span><span>
</span><span id="line-109"></span><span>  </span><span id="interpretSTS"><span class="annot"><a href="Control.State.Transition.Generator.html#interpretSTS"><span class="hs-identifier hs-type">interpretSTS</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108950"><span class="annot"><a href="#local-6989586621679108950"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">BaseM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108950"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679108950"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="interpretSTS"><span class="annot"><a href="Control.State.Transition.Generator.html#interpretSTS"><span class="hs-identifier hs-type">interpretSTS</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">BaseM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679109242"><span class="annot"><a href="#local-6989586621679109242"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">BaseM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109242"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109242"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621679108949"><span class="annot"><a href="Control.State.Transition.Generator.html#interpretSTS"><span class="hs-identifier hs-var hs-var">interpretSTS</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span id="local-6989586621679108947"><span class="annot"><a href="#local-6989586621679108947"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108947"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-comment">-- | Generate an initial environment that is based on the given trace length.</span></span><span>
</span><span id="line-114"></span><span>  </span><span id="envGen"><span class="annot"><a href="Control.State.Transition.Generator.html#envGen"><span class="hs-identifier hs-type">envGen</span></a></span></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- ^ Trace length that will be used by 'trace' or 'traceOfLength'.</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-comment">-- | Generate a (valid) signal given an environment and a pre-state.</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span>  </span><span id="sigGen"><span class="annot"><a href="Control.State.Transition.Generator.html#sigGen"><span class="hs-identifier hs-type">sigGen</span></a></span></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-type">SignalGenerator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>  </span><span id="trace"><span class="annot"><a href="Control.State.Transition.Generator.html#trace"><span class="hs-identifier hs-type">trace</span></a></span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">-- ^ Maximum length of the generated traces. The actual length will be</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-comment">-- between 0 and this maximum.</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679108946"><span class="annot"><a href="Control.State.Transition.Generator.html#trace"><span class="hs-identifier hs-var hs-var">trace</span></a></span><span> </span><span id="local-6989586621679108945"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108945"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108944"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108944"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseEnv s -&gt; Word64 -&gt; TraceProfile s -&gt; Gen (Trace s)
forall s.
HasTrace s =&gt;
BaseEnv s -&gt; Word64 -&gt; TraceProfile s -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#traceWithProfile"><span class="hs-identifier hs-var">traceWithProfile</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108945"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108944"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TraceProfile s
forall s. TraceProfile s
</span><a href="Control.State.Transition.Generator.html#allValid"><span class="hs-identifier hs-var">allValid</span></a></span></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>  </span><span id="traceWithProfile"><span class="annot"><a href="Control.State.Transition.Generator.html#traceWithProfile"><span class="hs-identifier hs-type">traceWithProfile</span></a></span></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceProfile"><span class="hs-identifier hs-type">TraceProfile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>  </span><span id="local-6989586621679108942"><span class="annot"><a href="Control.State.Transition.Generator.html#traceWithProfile"><span class="hs-identifier hs-var hs-var">traceWithProfile</span></a></span><span> </span><span id="local-6989586621679108941"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108941"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108940"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108940"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679108939"><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108939"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
forall s.
HasTrace s =&gt;
BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#traceSigGenWithProfile"><span class="hs-identifier hs-var">traceSigGenWithProfile</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108941"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; TraceLength
</span><a href="Control.State.Transition.Generator.html#Maximum"><span class="hs-identifier hs-var">Maximum</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108940"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108939"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasTrace s =&gt; SignalGenerator s
forall s. HasTrace s =&gt; SignalGenerator s
</span><a href="Control.State.Transition.Generator.html#sigGen"><span class="hs-identifier hs-var">sigGen</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>  </span><span id="traceOfLength"><span class="annot"><a href="Control.State.Transition.Generator.html#traceOfLength"><span class="hs-identifier hs-type">traceOfLength</span></a></span></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-comment">-- ^ Desired length of the generated trace. If the signal generator can generate invalid signals</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-comment">-- then the resulting trace might not have the given length.</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>  </span><span id="local-6989586621679108937"><span class="annot"><a href="Control.State.Transition.Generator.html#traceOfLength"><span class="hs-identifier hs-var hs-var">traceOfLength</span></a></span><span> </span><span id="local-6989586621679108936"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108936"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108935"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108935"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
forall s.
HasTrace s =&gt;
BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#traceSigGenWithProfile"><span class="hs-identifier hs-var">traceSigGenWithProfile</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108936"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; TraceLength
</span><a href="Control.State.Transition.Generator.html#Desired"><span class="hs-identifier hs-var">Desired</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108935"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TraceProfile s
forall s. TraceProfile s
</span><a href="Control.State.Transition.Generator.html#allValid"><span class="hs-identifier hs-var">allValid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasTrace s =&gt; SignalGenerator s
forall s. HasTrace s =&gt; SignalGenerator s
</span><a href="Control.State.Transition.Generator.html#sigGen"><span class="hs-identifier hs-var">sigGen</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>  </span><span id="traceOfLengthWithInitState"><span class="annot"><a href="Control.State.Transition.Generator.html#traceOfLengthWithInitState"><span class="hs-identifier hs-type">traceOfLengthWithInitState</span></a></span></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-comment">-- ^ Desired length of the generated trace. If the signal generator can generate invalid signals</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-comment">-- then the resulting trace might not have the given length.</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-comment">-- ^ A generator for Initial State, given the STS environment</span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621679108934"><span class="annot"><a href="Control.State.Transition.Generator.html#traceOfLengthWithInitState"><span class="hs-identifier hs-var hs-var">traceOfLengthWithInitState</span></a></span><span> </span><span id="local-6989586621679108933"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108933"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108932"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108932"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679108931"><span class="annot"><span class="annottext">Environment s -&gt; Gen (State s)
</span><a href="#local-6989586621679108931"><span class="hs-identifier hs-var">mkSt0</span></a></span></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; SignalGenerator s
-&gt; (Environment s -&gt; Gen (State s))
-&gt; Gen (Trace s)
forall s.
HasTrace s =&gt;
BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; SignalGenerator s
-&gt; (Environment s -&gt; Gen (State s))
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#traceSigGenWithProfileAndInitState"><span class="hs-identifier hs-var">traceSigGenWithProfileAndInitState</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108933"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; TraceLength
</span><a href="Control.State.Transition.Generator.html#Desired"><span class="hs-identifier hs-var">Desired</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108932"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TraceProfile s
forall s. TraceProfile s
</span><a href="Control.State.Transition.Generator.html#allValid"><span class="hs-identifier hs-var">allValid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasTrace s =&gt; SignalGenerator s
forall s. HasTrace s =&gt; SignalGenerator s
</span><a href="Control.State.Transition.Generator.html#sigGen"><span class="hs-identifier hs-var">sigGen</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109244"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Environment s -&gt; Gen (State s)
</span><a href="#local-6989586621679108931"><span class="hs-identifier hs-var">mkSt0</span></a></span></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-keyword">type</span><span> </span><span id="SignalGenerator"><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-var">SignalGenerator</span></a></span></span><span> </span><span id="local-6989586621679108929"><span class="annot"><a href="#local-6989586621679108929"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108929"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108929"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108929"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-keyword">data</span><span> </span><span id="TraceLength"><span class="annot"><a href="Control.State.Transition.Generator.html#TraceLength"><span class="hs-identifier hs-var">TraceLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Maximum"><span class="annot"><a href="Control.State.Transition.Generator.html#Maximum"><span class="hs-identifier hs-var">Maximum</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Desired"><span class="annot"><a href="Control.State.Transition.Generator.html#Desired"><span class="hs-identifier hs-var">Desired</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-keyword">data</span><span> </span><span id="TraceProfile"><span class="annot"><a href="Control.State.Transition.Generator.html#TraceProfile"><span class="hs-identifier hs-var">TraceProfile</span></a></span></span><span> </span><span id="local-6989586621679109214"><span class="annot"><a href="#local-6989586621679109214"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TraceProfile"><span class="annot"><a href="Control.State.Transition.Generator.html#TraceProfile"><span class="hs-identifier hs-var">TraceProfile</span></a></span></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="proportionOfValidSignals"><span class="annot"><span class="annottext">TraceProfile s -&gt; Int
</span><a href="Control.State.Transition.Generator.html#proportionOfValidSignals"><span class="hs-identifier hs-var hs-var">proportionOfValidSignals</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-comment">-- ^ Proportion of valid signals to generate.</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="failures"><span class="annot"><span class="annottext">TraceProfile s -&gt; [(Int, SignalGenerator s)]
</span><a href="Control.State.Transition.Generator.html#failures"><span class="hs-identifier hs-var hs-var">failures</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-type">SignalGenerator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109214"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-comment">-- ^ List of failure conditions to try generate when generating an invalid signal, and the</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-comment">-- proportion of each failure.</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span id="local-6989586621679108928"><span class="annot"><a href="Control.State.Transition.Generator.html#proportionOfInvalidSignals"><span class="hs-identifier hs-type">proportionOfInvalidSignals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceProfile"><span class="hs-identifier hs-type">TraceProfile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108928"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-172"></span><span id="proportionOfInvalidSignals"><span class="annot"><span class="annottext">proportionOfInvalidSignals :: TraceProfile s -&gt; Int
</span><a href="Control.State.Transition.Generator.html#proportionOfInvalidSignals"><span class="hs-identifier hs-var hs-var">proportionOfInvalidSignals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int)
-&gt; (TraceProfile s -&gt; [Int]) -&gt; TraceProfile s -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Int, Environment s -&gt; State s -&gt; Gen (Signal s)) -&gt; Int)
-&gt; [(Int, Environment s -&gt; State s -&gt; Gen (Signal s))] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Int, Environment s -&gt; State s -&gt; Gen (Signal s)) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(Int, Environment s -&gt; State s -&gt; Gen (Signal s))] -&gt; [Int])
-&gt; (TraceProfile s
    -&gt; [(Int, Environment s -&gt; State s -&gt; Gen (Signal s))])
-&gt; TraceProfile s
-&gt; [Int]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TraceProfile s
-&gt; [(Int, Environment s -&gt; State s -&gt; Gen (Signal s))]
forall s. TraceProfile s -&gt; [(Int, SignalGenerator s)]
</span><a href="Control.State.Transition.Generator.html#failures"><span class="hs-identifier hs-var hs-var">failures</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span id="local-6989586621679109235"><span class="annot"><a href="Control.State.Transition.Generator.html#allValid"><span class="hs-identifier hs-type">allValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceProfile"><span class="hs-identifier hs-type">TraceProfile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109235"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-175"></span><span id="allValid"><span class="annot"><span class="annottext">allValid :: TraceProfile s
</span><a href="Control.State.Transition.Generator.html#allValid"><span class="hs-identifier hs-var hs-var">allValid</span></a></span></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceProfile :: forall s. Int -&gt; [(Int, SignalGenerator s)] -&gt; TraceProfile s
</span><a href="Control.State.Transition.Generator.html#TraceProfile"><span class="hs-identifier hs-type">TraceProfile</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">proportionOfValidSignals :: Int
</span><a href="Control.State.Transition.Generator.html#proportionOfValidSignals"><span class="hs-identifier hs-var">proportionOfValidSignals</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">failures :: [(Int, SignalGenerator s)]
</span><a href="Control.State.Transition.Generator.html#failures"><span class="hs-identifier hs-var">failures</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | Generate a signal by combining the generators using @hedgehog@'s</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- 'frequency' combinator.</span><span>
</span><span id="line-183"></span><span id="local-6989586621679109162"><span class="annot"><a href="Control.State.Transition.Generator.html#generateSignalWithFailureProportions"><span class="hs-identifier hs-type">generateSignalWithFailureProportions</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-type">SignalGenerator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109162"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-comment">-- ^ Failure proportions. See 'failures' in 'TraceProfile'.</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-type">SignalGenerator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109162"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-187"></span><span id="generateSignalWithFailureProportions"><span class="annot"><span class="annottext">generateSignalWithFailureProportions :: [(Int, SignalGenerator s)] -&gt; SignalGenerator s
</span><a href="Control.State.Transition.Generator.html#generateSignalWithFailureProportions"><span class="hs-identifier hs-var hs-var">generateSignalWithFailureProportions</span></a></span></span><span> </span><span id="local-6989586621679108924"><span class="annot"><span class="annottext">[(Int, SignalGenerator s)]
</span><a href="#local-6989586621679108924"><span class="hs-identifier hs-var">proportions</span></a></span></span><span> </span><span id="local-6989586621679108923"><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108923"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621679108922"><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108922"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><span class="annottext">[(Int, GenT Identity (Signal s))] -&gt; GenT Identity (Signal s)
forall (m :: * -&gt; *) a. MonadGen m =&gt; [(Int, m a)] -&gt; m a
</span><span class="hs-identifier hs-var">Gen.frequency</span></span><span> </span><span class="annot"><span class="annottext">([(Int, GenT Identity (Signal s))] -&gt; GenT Identity (Signal s))
-&gt; [(Int, GenT Identity (Signal s))] -&gt; GenT Identity (Signal s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SignalGenerator s -&gt; GenT Identity (Signal s))
-&gt; (Int, SignalGenerator s) -&gt; (Int, GenT Identity (Signal s))
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">SignalGenerator s -&gt; GenT Identity (Signal s)
</span><a href="#local-6989586621679108920"><span class="hs-identifier hs-var">aSigGenWithFailure</span></a></span><span> </span><span class="annot"><span class="annottext">((Int, SignalGenerator s) -&gt; (Int, GenT Identity (Signal s)))
-&gt; [(Int, SignalGenerator s)] -&gt; [(Int, GenT Identity (Signal s))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Int, SignalGenerator s)]
</span><a href="#local-6989586621679108924"><span class="hs-identifier hs-var">proportions</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679108920"><span class="annot"><span class="annottext">aSigGenWithFailure :: SignalGenerator s -&gt; GenT Identity (Signal s)
</span><a href="#local-6989586621679108920"><span class="hs-identifier hs-var hs-var">aSigGenWithFailure</span></a></span></span><span> </span><span id="local-6989586621679108918"><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108918"><span class="hs-identifier hs-var">invalidSigGen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108918"><span class="hs-identifier hs-var">invalidSigGen</span></a></span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108923"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108922"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Extract the maximum or desired integer value of the trace length.</span><span>
</span><span id="line-193"></span><span class="annot"><a href="Control.State.Transition.Generator.html#traceLengthValue"><span class="hs-identifier hs-type">traceLengthValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceLength"><span class="hs-identifier hs-type">TraceLength</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-194"></span><span id="traceLengthValue"><span class="annot"><span class="annottext">traceLengthValue :: TraceLength -&gt; Word64
</span><a href="Control.State.Transition.Generator.html#traceLengthValue"><span class="hs-identifier hs-var hs-var">traceLengthValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Generator.html#Maximum"><span class="hs-identifier hs-type">Maximum</span></a></span><span> </span><span id="local-6989586621679108916"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108916"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108916"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Control.State.Transition.Generator.html#traceLengthValue"><span class="hs-identifier hs-var">traceLengthValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Generator.html#Desired"><span class="hs-identifier hs-type">Desired</span></a></span><span> </span><span id="local-6989586621679108915"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108915"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108915"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Control.State.Transition.Generator.html#traceSigGen"><span class="hs-identifier hs-type">traceSigGen</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679109181"><span class="annot"><a href="#local-6989586621679109181"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-199"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109181"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109181"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceLength"><span class="hs-identifier hs-type">TraceLength</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-type">SignalGenerator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109181"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109181"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span id="traceSigGen"><span class="annot"><span class="annottext">traceSigGen :: BaseEnv s -&gt; TraceLength -&gt; SignalGenerator s -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#traceSigGen"><span class="hs-identifier hs-var hs-var">traceSigGen</span></a></span></span><span> </span><span id="local-6989586621679108914"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108914"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108913"><span class="annot"><span class="annottext">TraceLength
</span><a href="#local-6989586621679108913"><span class="hs-identifier hs-var">aTraceLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
forall s.
HasTrace s =&gt;
BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#traceSigGenWithProfile"><span class="hs-identifier hs-var">traceSigGenWithProfile</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108914"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TraceLength
</span><a href="#local-6989586621679108913"><span class="hs-identifier hs-var">aTraceLength</span></a></span><span> </span><span class="annot"><span class="annottext">TraceProfile s
forall s. TraceProfile s
</span><a href="Control.State.Transition.Generator.html#allValid"><span class="hs-identifier hs-var">allValid</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Control.State.Transition.Generator.html#traceSigGenWithProfile"><span class="hs-identifier hs-type">traceSigGenWithProfile</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679109232"><span class="annot"><a href="#local-6989586621679109232"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-208"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109232"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109232"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceLength"><span class="hs-identifier hs-type">TraceLength</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceProfile"><span class="hs-identifier hs-type">TraceProfile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109232"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-type">SignalGenerator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109232"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109232"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span id="traceSigGenWithProfile"><span class="annot"><span class="annottext">traceSigGenWithProfile :: BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#traceSigGenWithProfile"><span class="hs-identifier hs-var hs-var">traceSigGenWithProfile</span></a></span></span><span> </span><span id="local-6989586621679108912"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108912"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108911"><span class="annot"><span class="annottext">TraceLength
</span><a href="#local-6989586621679108911"><span class="hs-identifier hs-var">aTraceLength</span></a></span></span><span> </span><span id="local-6989586621679108910"><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108910"><span class="hs-identifier hs-var">profile</span></a></span></span><span> </span><span id="local-6989586621679108909"><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108909"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-215"></span><span>  </span><span id="local-6989586621679108908"><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108908"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Gen (Environment s)
forall s. HasTrace s =&gt; Word64 -&gt; Gen (Environment s)
</span><a href="Control.State.Transition.Generator.html#envGen"><span class="hs-identifier hs-var">envGen</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109232"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TraceLength -&gt; Word64
</span><a href="Control.State.Transition.Generator.html#traceLengthValue"><span class="hs-identifier hs-var">traceLengthValue</span></a></span><span> </span><span class="annot"><span class="annottext">TraceLength
</span><a href="#local-6989586621679108911"><span class="hs-identifier hs-var">aTraceLength</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; BaseM s (Either [[PredicateFailure s]] (State s))
-&gt; Either [[PredicateFailure s]] (State s)
forall s a. HasTrace s =&gt; BaseEnv s -&gt; BaseM s a -&gt; a
</span><a href="Control.State.Transition.Generator.html#interpretSTS"><span class="hs-identifier hs-var">interpretSTS</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109232"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108912"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseM s (Either [[PredicateFailure s]] (State s))
 -&gt; Either [[PredicateFailure s]] (State s))
-&gt; BaseM s (Either [[PredicateFailure s]] (State s))
-&gt; Either [[PredicateFailure s]] (State s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RuleContext 'Initial s
-&gt; BaseM s (Either [[PredicateFailure s]] (State s))
forall s (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s -&gt; m (Either [[PredicateFailure s]] (State s))
</span><a href="Control.State.Transition.Trace.html#applySTSTest"><span class="hs-identifier hs-var">applySTSTest</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109232"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Environment s -&gt; IRC s
forall sts. Environment sts -&gt; IRC sts
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">IRC</span></a></span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108908"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-comment">-- Hedgehog will give up if the generators fail to produce any valid</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-comment">-- initial state, hence we don't have a risk of entering an infinite</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-comment">-- recursion.</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679108907"><span class="annot"><span class="annottext">[[PredicateFailure s]]
</span><a href="#local-6989586621679108907"><span class="hs-identifier hs-var">_pf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BaseEnv s -&gt; TraceLength -&gt; SignalGenerator s -&gt; Gen (Trace s)
forall s.
HasTrace s =&gt;
BaseEnv s -&gt; TraceLength -&gt; SignalGenerator s -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#traceSigGen"><span class="hs-identifier hs-var">traceSigGen</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108912"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TraceLength
</span><a href="#local-6989586621679108911"><span class="hs-identifier hs-var">aTraceLength</span></a></span><span> </span><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108909"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-comment">-- Applying an initial rule with an environment and state will simply</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-comment">-- validate that state, so we do not care which state 'applySTS' returns.</span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679108906"><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108906"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
forall s.
HasTrace s =&gt;
BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#genTraceOfMaxOrDesiredLength"><span class="hs-identifier hs-var">genTraceOfMaxOrDesiredLength</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108912"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TraceLength
</span><a href="#local-6989586621679108911"><span class="hs-identifier hs-var">aTraceLength</span></a></span><span> </span><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108910"><span class="hs-identifier hs-var">profile</span></a></span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108908"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108906"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108909"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- | A variation of 'traceSigGenWithProfile' which takes an argument generator</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- for the initial state of the given trace</span><span>
</span><span id="line-227"></span><span class="annot"><a href="Control.State.Transition.Generator.html#traceSigGenWithProfileAndInitState"><span class="hs-identifier hs-type">traceSigGenWithProfileAndInitState</span></a></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679109229"><span class="annot"><a href="#local-6989586621679109229"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-229"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109229"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109229"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceLength"><span class="hs-identifier hs-type">TraceLength</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceProfile"><span class="hs-identifier hs-type">TraceProfile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109229"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-type">SignalGenerator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109229"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109229"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109229"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109229"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span id="traceSigGenWithProfileAndInitState"><span class="annot"><span class="annottext">traceSigGenWithProfileAndInitState :: BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; SignalGenerator s
-&gt; (Environment s -&gt; Gen (State s))
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#traceSigGenWithProfileAndInitState"><span class="hs-identifier hs-var hs-var">traceSigGenWithProfileAndInitState</span></a></span></span><span> </span><span id="local-6989586621679108904"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108904"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108903"><span class="annot"><span class="annottext">TraceLength
</span><a href="#local-6989586621679108903"><span class="hs-identifier hs-var">aTraceLength</span></a></span></span><span> </span><span id="local-6989586621679108902"><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108902"><span class="hs-identifier hs-var">profile</span></a></span></span><span> </span><span id="local-6989586621679108901"><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108901"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679108900"><span class="annot"><span class="annottext">Environment s -&gt; Gen (State s)
</span><a href="#local-6989586621679108900"><span class="hs-identifier hs-var">mkSt0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621679108899"><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108899"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Gen (Environment s)
forall s. HasTrace s =&gt; Word64 -&gt; Gen (Environment s)
</span><a href="Control.State.Transition.Generator.html#envGen"><span class="hs-identifier hs-var">envGen</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109229"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TraceLength -&gt; Word64
</span><a href="Control.State.Transition.Generator.html#traceLengthValue"><span class="hs-identifier hs-var">traceLengthValue</span></a></span><span> </span><span class="annot"><span class="annottext">TraceLength
</span><a href="#local-6989586621679108903"><span class="hs-identifier hs-var">aTraceLength</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621679108898"><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108898"><span class="hs-identifier hs-var">st0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Environment s -&gt; Gen (State s)
</span><a href="#local-6989586621679108900"><span class="hs-identifier hs-var">mkSt0</span></a></span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108899"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
forall s.
HasTrace s =&gt;
BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#genTraceOfMaxOrDesiredLength"><span class="hs-identifier hs-var">genTraceOfMaxOrDesiredLength</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108904"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TraceLength
</span><a href="#local-6989586621679108903"><span class="hs-identifier hs-var">aTraceLength</span></a></span><span> </span><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108902"><span class="hs-identifier hs-var">profile</span></a></span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108899"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108898"><span class="hs-identifier hs-var">st0</span></a></span><span> </span><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108901"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Control.State.Transition.Generator.html#genTraceOfMaxOrDesiredLength"><span class="hs-identifier hs-type">genTraceOfMaxOrDesiredLength</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679109180"><span class="annot"><a href="#local-6989586621679109180"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-244"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109180"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109180"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceLength"><span class="hs-identifier hs-type">TraceLength</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceProfile"><span class="hs-identifier hs-type">TraceProfile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109180"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109180"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109180"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-type">SignalGenerator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109180"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109180"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span id="genTraceOfMaxOrDesiredLength"><span class="annot"><span class="annottext">genTraceOfMaxOrDesiredLength :: BaseEnv s
-&gt; TraceLength
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#genTraceOfMaxOrDesiredLength"><span class="hs-identifier hs-var hs-var">genTraceOfMaxOrDesiredLength</span></a></span></span><span> </span><span id="local-6989586621679108897"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108897"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108896"><span class="annot"><span class="annottext">TraceLength
</span><a href="#local-6989586621679108896"><span class="hs-identifier hs-var">aTraceLength</span></a></span></span><span> </span><span id="local-6989586621679108895"><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108895"><span class="hs-identifier hs-var">profile</span></a></span></span><span> </span><span id="local-6989586621679108894"><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108894"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621679108893"><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108893"><span class="hs-identifier hs-var">st0</span></a></span></span><span> </span><span id="local-6989586621679108892"><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108892"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TraceLength
</span><a href="#local-6989586621679108896"><span class="hs-identifier hs-var">aTraceLength</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><a href="Control.State.Transition.Generator.html#Maximum"><span class="hs-identifier hs-type">Maximum</span></a></span><span> </span><span id="local-6989586621679108891"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108891"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; Word64
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
forall s.
HasTrace s =&gt;
BaseEnv s
-&gt; Word64
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#genTraceWithProfile"><span class="hs-identifier hs-var">genTraceWithProfile</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108897"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108891"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108895"><span class="hs-identifier hs-var">profile</span></a></span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108894"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108893"><span class="hs-identifier hs-var">st0</span></a></span><span> </span><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108892"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="Control.State.Transition.Generator.html#Desired"><span class="hs-identifier hs-type">Desired</span></a></span><span> </span><span id="local-6989586621679108889"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108889"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; Word64
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
forall s.
HasTrace s =&gt;
BaseEnv s
-&gt; Word64
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#genTraceOfLength"><span class="hs-identifier hs-var">genTraceOfLength</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108897"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108889"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108895"><span class="hs-identifier hs-var">profile</span></a></span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108894"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108893"><span class="hs-identifier hs-var">st0</span></a></span><span> </span><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108892"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- | Return a (valid) trace generator given an initial state, environment, and</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- signal generator.</span><span>
</span><span id="line-259"></span><span class="hs-comment">--</span><span>
</span><span id="line-260"></span><span class="annot"><a href="Control.State.Transition.Generator.html#genTrace"><span class="hs-identifier hs-type">genTrace</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108887"><span class="annot"><a href="#local-6989586621679108887"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-262"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108887"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108887"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-comment">-- ^ Trace upper bound. This will be linearly scaled as a function of the</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-comment">-- generator size.</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108887"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-comment">-- ^ Environment, which remains constant in the system.</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108887"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-comment">-- ^ Initial state.</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-type">SignalGenerator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108887"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-comment">-- ^ Signal generator. This generator relies on an environment and a state to</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-comment">-- generate a signal.</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108887"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span id="genTrace"><span class="annot"><span class="annottext">genTrace :: BaseEnv s
-&gt; Word64
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#genTrace"><span class="hs-identifier hs-var hs-var">genTrace</span></a></span></span><span> </span><span id="local-6989586621679108886"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108886"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108885"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108885"><span class="hs-identifier hs-var">ub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; Word64
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
forall s.
HasTrace s =&gt;
BaseEnv s
-&gt; Word64
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#genTraceWithProfile"><span class="hs-identifier hs-var">genTraceWithProfile</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108886"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108885"><span class="hs-identifier hs-var">ub</span></a></span><span> </span><span class="annot"><span class="annottext">TraceProfile s
forall s. TraceProfile s
</span><a href="Control.State.Transition.Generator.html#allValid"><span class="hs-identifier hs-var">allValid</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">-- | Return a trace generator given an initial state, environment, and signal generator.</span><span>
</span><span id="line-278"></span><span class="hs-comment">--</span><span>
</span><span id="line-279"></span><span class="annot"><a href="Control.State.Transition.Generator.html#genTraceWithProfile"><span class="hs-identifier hs-type">genTraceWithProfile</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679109177"><span class="annot"><a href="#local-6989586621679109177"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-281"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109177"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109177"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-comment">-- ^ Trace upper bound. This will be linearly scaled as a function of the</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-comment">-- generator size.</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceProfile"><span class="hs-identifier hs-type">TraceProfile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109177"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109177"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-comment">-- ^ Environment, which remains constant in the system.</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109177"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-comment">-- ^ Initial state.</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-type">SignalGenerator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109177"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-comment">-- ^ Signal generator. This generator relies on an environment and a state to</span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-comment">-- generate a signal.</span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109177"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span id="genTraceWithProfile"><span class="annot"><span class="annottext">genTraceWithProfile :: BaseEnv s
-&gt; Word64
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#genTraceWithProfile"><span class="hs-identifier hs-var hs-var">genTraceWithProfile</span></a></span></span><span> </span><span id="local-6989586621679108884"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108884"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108883"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108883"><span class="hs-identifier hs-var">ub</span></a></span></span><span> </span><span id="local-6989586621679108882"><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108882"><span class="hs-identifier hs-var">profile</span></a></span></span><span> </span><span id="local-6989586621679108881"><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108881"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621679108880"><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108880"><span class="hs-identifier hs-var">st0</span></a></span></span><span> </span><span id="local-6989586621679108879"><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108879"><span class="hs-identifier hs-var">aSigGen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-comment">-- Generate the initial size of the trace, but don't shrink it (notice the</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-comment">-- use of 'integral_') since we will be shrinking the traces manually (so it</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-comment">-- doesn't make sense to shrink the trace size).</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-comment">-- Note that the length of the resulting trace might be less than the</span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-comment">-- generated value if invalid signals (according to some current state) are</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-comment">-- generated in 'loop'.</span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-comment">-- A linear range will generate about one third of empty traces, which does</span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-comment">-- not seem sensible. Furthermore, in most cases it won't generate any trace</span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-comment">-- of size @ub@. Hence we need to tweak the frequency of the trace lengths.</span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621679108878"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108878"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Int, GenT Identity Word64)] -&gt; GenT Identity Word64
forall (m :: * -&gt; *) a. MonadGen m =&gt; [(Int, m a)] -&gt; m a
</span><span class="hs-identifier hs-var">Gen.frequency</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GenT Identity Word64
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Range Word64 -&gt; GenT Identity Word64
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><span class="hs-identifier hs-var">integral_</span></span><span> </span><span class="annot"><span class="annottext">(Range Word64 -&gt; GenT Identity Word64)
-&gt; Range Word64 -&gt; GenT Identity Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Range Word64
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><span class="hs-identifier hs-var">Range.linear</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108883"><span class="hs-identifier hs-var">ub</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GenT Identity Word64
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108883"><span class="hs-identifier hs-var">ub</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; Word64
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
forall s.
HasTrace s =&gt;
BaseEnv s
-&gt; Word64
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#genTraceOfLength"><span class="hs-identifier hs-var">genTraceOfLength</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108884"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108878"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108882"><span class="hs-identifier hs-var">profile</span></a></span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108881"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108880"><span class="hs-identifier hs-var">st0</span></a></span><span> </span><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108879"><span class="hs-identifier hs-var">aSigGen</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-comment">-- | Return a (valid) trace generator that generates traces of the given size. If the signal</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- generator can generate invalid signals, then the size of resulting trace is not guaranteed.</span><span>
</span><span id="line-316"></span><span class="hs-comment">--</span><span>
</span><span id="line-317"></span><span class="annot"><a href="Control.State.Transition.Generator.html#genTraceOfLength"><span class="hs-identifier hs-type">genTraceOfLength</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108876"><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-319"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-comment">-- ^ Desired trace length.</span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#TraceProfile"><span class="hs-identifier hs-type">TraceProfile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-comment">-- ^ Environment, which remains constant in the system.</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-comment">-- ^ Initial state.</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-type">SignalGenerator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-comment">-- ^ Signal generator. This generator relies on an environment and a state to</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-comment">-- generate a signal.</span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span id="genTraceOfLength"><span class="annot"><span class="annottext">genTraceOfLength :: BaseEnv s
-&gt; Word64
-&gt; TraceProfile s
-&gt; Environment s
-&gt; State s
-&gt; SignalGenerator s
-&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#genTraceOfLength"><span class="hs-identifier hs-var hs-var">genTraceOfLength</span></a></span></span><span> </span><span id="local-6989586621679108875"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108875"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108874"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108874"><span class="hs-identifier hs-var">aTraceLength</span></a></span></span><span> </span><span id="local-6989586621679108873"><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108873"><span class="hs-identifier hs-var">profile</span></a></span></span><span> </span><span id="local-6989586621679108872"><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108872"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621679108871"><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108871"><span class="hs-identifier hs-var">st0</span></a></span></span><span> </span><span id="local-6989586621679108870"><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108870"><span class="hs-identifier hs-var">aSigGen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-333"></span><span>  </span><span class="annot"><span class="annottext">Manual (TreeT (MaybeT Identity) (Trace s)) -&gt; Gen (Trace s)
forall a. Manual (TreeT (MaybeT Identity) a) -&gt; Gen a
</span><a href="Hedgehog.Extra.Manual.html#fromManual"><span class="hs-identifier hs-var">Manual.fromManual</span></a></span><span> </span><span class="annot"><span class="annottext">(Manual (TreeT (MaybeT Identity) (Trace s)) -&gt; Gen (Trace s))
-&gt; Manual (TreeT (MaybeT Identity) (Trace s)) -&gt; Gen (Trace s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([(State s, TreeT (MaybeT Identity) (Signal s))]
 -&gt; TreeT (MaybeT Identity) (Trace s))
-&gt; Manual [(State s, TreeT (MaybeT Identity) (Signal s))]
-&gt; Manual (TreeT (MaybeT Identity) (Trace s))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[(State s, TreeT (MaybeT Identity) (Signal s))]
-&gt; TreeT (MaybeT Identity) (Trace s)
</span><a href="#local-6989586621679108868"><span class="hs-identifier hs-var">interleaveSigs</span></a></span><span> </span><span class="annot"><span class="annottext">(Manual [(State s, TreeT (MaybeT Identity) (Signal s))]
 -&gt; Manual (TreeT (MaybeT Identity) (Trace s)))
-&gt; Manual [(State s, TreeT (MaybeT Identity) (Signal s))]
-&gt; Manual (TreeT (MaybeT Identity) (Trace s))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64
-&gt; State s
-&gt; [(State s, TreeT (MaybeT Identity) (Signal s))]
-&gt; Manual [(State s, TreeT (MaybeT Identity) (Signal s))]
</span><a href="#local-6989586621679108867"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108874"><span class="hs-identifier hs-var">aTraceLength</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108871"><span class="hs-identifier hs-var">st0</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><a href="#local-6989586621679108867"><span class="hs-identifier hs-type">loop</span></a></span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-338"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-339"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hedgehog.Extra.Manual.html#Manual"><span class="hs-identifier hs-type">Manual</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621679108867"><span class="annot"><span class="annottext">loop :: Word64
-&gt; State s
-&gt; [(State s, TreeT (MaybeT Identity) (Signal s))]
-&gt; Manual [(State s, TreeT (MaybeT Identity) (Signal s))]
</span><a href="#local-6989586621679108867"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">State s
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679108866"><span class="annot"><span class="annottext">[(State s, TreeT (MaybeT Identity) (Signal s))]
</span><a href="#local-6989586621679108866"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(State s, TreeT (MaybeT Identity) (Signal s))]
-&gt; Manual [(State s, TreeT (MaybeT Identity) (Signal s))]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[(State s, TreeT (MaybeT Identity) (Signal s))]
</span><a href="#local-6989586621679108866"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><a href="#local-6989586621679108867"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679108865"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108865"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679108864"><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108864"><span class="hs-identifier hs-var">sti</span></a></span></span><span> </span><span id="local-6989586621679108863"><span class="annot"><span class="annottext">[(State s, TreeT (MaybeT Identity) (Signal s))]
</span><a href="#local-6989586621679108863"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-342"></span><span>      </span><span id="local-6989586621679108862"><span class="annot"><a href="#local-6989586621679108862"><span class="hs-identifier hs-var">sigTree</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Signal s) -&gt; Manual (TreeT (MaybeT Identity) (Signal s))
forall a. Gen a -&gt; Manual (TreeT (MaybeT Identity) a)
</span><a href="Hedgehog.Extra.Manual.html#toManual"><span class="hs-identifier hs-var">Manual.toManual</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen (Signal s) -&gt; Manual (TreeT (MaybeT Identity) (Signal s)))
-&gt; Gen (Signal s) -&gt; Manual (TreeT (MaybeT Identity) (Signal s))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-344"></span><span>             </span><span class="annot"><span class="annottext">[(Int, Gen (Signal s))] -&gt; Gen (Signal s)
forall (m :: * -&gt; *) a. MonadGen m =&gt; [(Int, m a)] -&gt; m a
</span><span class="hs-identifier hs-var">Gen.frequency</span></span><span>
</span><span id="line-345"></span><span>               </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TraceProfile s -&gt; Int
forall s. TraceProfile s -&gt; Int
</span><a href="Control.State.Transition.Generator.html#proportionOfValidSignals"><span class="hs-identifier hs-var hs-var">proportionOfValidSignals</span></a></span><span> </span><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108873"><span class="hs-identifier hs-var">profile</span></a></span><span>
</span><span id="line-346"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SignalGenerator s
</span><a href="#local-6989586621679108870"><span class="hs-identifier hs-var">aSigGen</span></a></span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108872"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108864"><span class="hs-identifier hs-var">sti</span></a></span><span>
</span><span id="line-347"></span><span>                 </span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TraceProfile s -&gt; Int
forall s. TraceProfile s -&gt; Int
</span><a href="Control.State.Transition.Generator.html#proportionOfInvalidSignals"><span class="hs-identifier hs-var">proportionOfInvalidSignals</span></a></span><span> </span><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108873"><span class="hs-identifier hs-var">profile</span></a></span><span>
</span><span id="line-349"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Int, SignalGenerator s)] -&gt; SignalGenerator s
forall s. [(Int, SignalGenerator s)] -&gt; SignalGenerator s
</span><a href="Control.State.Transition.Generator.html#generateSignalWithFailureProportions"><span class="hs-identifier hs-var">generateSignalWithFailureProportions</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TraceProfile s -&gt; [(Int, SignalGenerator s)]
forall s. TraceProfile s -&gt; [(Int, SignalGenerator s)]
</span><a href="Control.State.Transition.Generator.html#failures"><span class="hs-identifier hs-var hs-var">failures</span></a></span><span> </span><span class="annot"><span class="annottext">TraceProfile s
</span><a href="#local-6989586621679108873"><span class="hs-identifier hs-var">profile</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108872"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108864"><span class="hs-identifier hs-var">sti</span></a></span><span>
</span><span id="line-350"></span><span>                 </span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-352"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-353"></span><span>        </span><span class="hs-comment">--  Take the root of the next-state signal tree.</span><span>
</span><span id="line-354"></span><span>        </span><span id="local-6989586621679108860"><span class="annot"><span class="annottext">mSig :: Maybe (Signal s)
</span><a href="#local-6989586621679108860"><span class="hs-identifier hs-var hs-var">mSig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tree (Maybe (Signal s)) -&gt; Maybe (Signal s)
forall a. Tree a -&gt; a
</span><span class="hs-identifier hs-var">treeValue</span></span><span> </span><span class="annot"><span class="annottext">(Tree (Maybe (Signal s)) -&gt; Maybe (Signal s))
-&gt; Tree (Maybe (Signal s)) -&gt; Maybe (Signal s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TreeT (MaybeT Identity) (Signal s) -&gt; Tree (Maybe (Signal s))
forall (m :: * -&gt; *) a.
Monad m =&gt;
TreeT (MaybeT m) a -&gt; TreeT m (Maybe a)
</span><span class="hs-identifier hs-var">runDiscardEffectT</span></span><span> </span><span class="annot"><span class="annottext">TreeT (MaybeT Identity) (Signal s)
</span><a href="#local-6989586621679108862"><span class="hs-identifier hs-var">sigTree</span></a></span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Signal s)
</span><a href="#local-6989586621679108860"><span class="hs-identifier hs-var">mSig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Signal s)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-357"></span><span>          </span><span class="annot"><span class="annottext">Word64
-&gt; State s
-&gt; [(State s, TreeT (MaybeT Identity) (Signal s))]
-&gt; Manual [(State s, TreeT (MaybeT Identity) (Signal s))]
</span><a href="#local-6989586621679108867"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108865"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108864"><span class="hs-identifier hs-var">sti</span></a></span><span> </span><span class="annot"><span class="annottext">[(State s, TreeT (MaybeT Identity) (Signal s))]
</span><a href="#local-6989586621679108863"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679108859"><span class="annot"><span class="annottext">Signal s
</span><a href="#local-6989586621679108859"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-359"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; BaseM s (Either [[PredicateFailure s]] (State s))
-&gt; Either [[PredicateFailure s]] (State s)
forall s a. HasTrace s =&gt; BaseEnv s -&gt; BaseM s a -&gt; a
</span><a href="Control.State.Transition.Generator.html#interpretSTS"><span class="hs-identifier hs-var">interpretSTS</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108875"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseM s (Either [[PredicateFailure s]] (State s))
 -&gt; Either [[PredicateFailure s]] (State s))
-&gt; BaseM s (Either [[PredicateFailure s]] (State s))
-&gt; Either [[PredicateFailure s]] (State s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RuleContext 'Transition s
-&gt; BaseM s (Either [[PredicateFailure s]] (State s))
forall s (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s -&gt; m (Either [[PredicateFailure s]] (State s))
</span><a href="Control.State.Transition.Trace.html#applySTSTest"><span class="hs-identifier hs-var">applySTSTest</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Environment s, State s, Signal s) -&gt; TRC s
forall sts. (Environment sts, State sts, Signal sts) -&gt; TRC sts
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">TRC</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108872"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108864"><span class="hs-identifier hs-var">sti</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Signal s
</span><a href="#local-6989586621679108859"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-360"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679108858"><span class="annot"><span class="annottext">[[PredicateFailure s]]
</span><a href="#local-6989586621679108858"><span class="hs-identifier hs-var">_err</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word64
-&gt; State s
-&gt; [(State s, TreeT (MaybeT Identity) (Signal s))]
-&gt; Manual [(State s, TreeT (MaybeT Identity) (Signal s))]
</span><a href="#local-6989586621679108867"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108865"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108864"><span class="hs-identifier hs-var">sti</span></a></span><span> </span><span class="annot"><span class="annottext">[(State s, TreeT (MaybeT Identity) (Signal s))]
</span><a href="#local-6989586621679108863"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-361"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679108857"><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108857"><span class="hs-identifier hs-var">sti'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word64
-&gt; State s
-&gt; [(State s, TreeT (MaybeT Identity) (Signal s))]
-&gt; Manual [(State s, TreeT (MaybeT Identity) (Signal s))]
</span><a href="#local-6989586621679108867"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108865"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108857"><span class="hs-identifier hs-var">sti'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108857"><span class="hs-identifier hs-var">sti'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TreeT (MaybeT Identity) (Signal s)
</span><a href="#local-6989586621679108862"><span class="hs-identifier hs-var">sigTree</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(State s, TreeT (MaybeT Identity) (Signal s))
-&gt; [(State s, TreeT (MaybeT Identity) (Signal s))]
-&gt; [(State s, TreeT (MaybeT Identity) (Signal s))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(State s, TreeT (MaybeT Identity) (Signal s))]
</span><a href="#local-6989586621679108863"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span>    </span><span class="annot"><a href="#local-6989586621679108868"><span class="hs-identifier hs-type">interleaveSigs</span></a></span><span>
</span><span id="line-364"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-365"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>    </span><span id="local-6989586621679108868"><span class="annot"><span class="annottext">interleaveSigs :: [(State s, TreeT (MaybeT Identity) (Signal s))]
-&gt; TreeT (MaybeT Identity) (Trace s)
</span><a href="#local-6989586621679108868"><span class="hs-identifier hs-var hs-var">interleaveSigs</span></a></span></span><span> </span><span id="local-6989586621679108856"><span class="annot"><span class="annottext">[(State s, TreeT (MaybeT Identity) (Signal s))]
</span><a href="#local-6989586621679108856"><span class="hs-identifier hs-var">stateSignalTrees</span></a></span></span><span>
</span><span id="line-367"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (NodeT (MaybeT Identity) (Trace s))
-&gt; TreeT (MaybeT Identity) (Trace s)
forall a.
Maybe (NodeT (MaybeT Identity) a) -&gt; TreeT (MaybeT Identity) a
</span><a href="Hedgehog.Extra.Manual.html#wrapTreeT"><span class="hs-identifier hs-var">Manual.wrapTreeT</span></a></span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><span class="annottext">(Maybe (NodeT (MaybeT Identity) (Trace s))
 -&gt; TreeT (MaybeT Identity) (Trace s))
-&gt; Maybe (NodeT (MaybeT Identity) (Trace s))
-&gt; TreeT (MaybeT Identity) (Trace s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NodeT (MaybeT Identity) (Trace s)
-&gt; Maybe (NodeT (MaybeT Identity) (Trace s))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-369"></span><span>      </span><span class="annot"><span class="annottext">(NodeT (MaybeT Identity) (Trace s)
 -&gt; Maybe (NodeT (MaybeT Identity) (Trace s)))
-&gt; NodeT (MaybeT Identity) (Trace s)
-&gt; Maybe (NodeT (MaybeT Identity) (Trace s))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Trace s
-&gt; [TreeT (MaybeT Identity) (Trace s)]
-&gt; NodeT (MaybeT Identity) (Trace s)
forall (m :: * -&gt; *) a. a -&gt; [TreeT m a] -&gt; NodeT m a
</span><span class="hs-identifier hs-var">NodeT</span></span><span>
</span><span id="line-370"></span><span>          </span><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108854"><span class="hs-identifier hs-var">rootTrace</span></a></span><span>
</span><span id="line-371"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TreeT (MaybeT Identity) [Signal s]
 -&gt; TreeT (MaybeT Identity) (Trace s))
-&gt; [TreeT (MaybeT Identity) [Signal s]]
-&gt; [TreeT (MaybeT Identity) (Trace s)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Signal s] -&gt; Trace s)
-&gt; TreeT (MaybeT Identity) [Signal s]
-&gt; TreeT (MaybeT Identity) (Trace s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseEnv s -&gt; BaseM s (Trace s) -&gt; Trace s
forall s a. HasTrace s =&gt; BaseEnv s -&gt; BaseM s a -&gt; a
</span><a href="Control.State.Transition.Generator.html#interpretSTS"><span class="hs-identifier hs-var">interpretSTS</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108875"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseM s (Trace s) -&gt; Trace s)
-&gt; ([Signal s] -&gt; BaseM s (Trace s)) -&gt; [Signal s] -&gt; Trace s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Environment s -&gt; State s -&gt; [Signal s] -&gt; BaseM s (Trace s)
forall s (m :: * -&gt; *).
(STS s, m ~ BaseM s) =&gt;
Environment s -&gt; State s -&gt; [Signal s] -&gt; m (Trace s)
</span><a href="Control.State.Transition.Trace.html#closure"><span class="hs-identifier hs-var">closure</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108872"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108871"><span class="hs-identifier hs-var">st0</span></a></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TreeT (MaybeT Identity) [Signal s]]
</span><a href="#local-6989586621679108853"><span class="hs-identifier hs-var">signalShrinksChilren</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-373"></span><span>        </span><span class="annot"><a href="#local-6989586621679108852"><span class="hs-identifier hs-type">rootStates</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-374"></span><span>        </span><span class="annot"><a href="#local-6989586621679108851"><span class="hs-identifier hs-type">signalTrees</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-375"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679108852"><span class="annot"><span class="annottext">[State s]
</span><a href="#local-6989586621679108852"><span class="hs-identifier hs-var">rootStates</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679108851"><span class="annot"><span class="annottext">[TreeT (MaybeT Identity) (Signal s)]
</span><a href="#local-6989586621679108851"><span class="hs-identifier hs-var">signalTrees</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(State s, TreeT (MaybeT Identity) (Signal s))]
-&gt; ([State s], [TreeT (MaybeT Identity) (Signal s)])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[(State s, TreeT (MaybeT Identity) (Signal s))]
</span><a href="#local-6989586621679108856"><span class="hs-identifier hs-var">stateSignalTrees</span></a></span><span>
</span><span id="line-376"></span><span>        </span><span class="annot"><a href="#local-6989586621679108849"><span class="hs-identifier hs-type">rootSignals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-377"></span><span>        </span><span id="local-6989586621679108849"><span class="annot"><span class="annottext">rootSignals :: [Signal s]
</span><a href="#local-6989586621679108849"><span class="hs-identifier hs-var hs-var">rootSignals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TreeT (MaybeT Identity) (Signal s) -&gt; Signal s)
-&gt; [TreeT (MaybeT Identity) (Signal s)] -&gt; [Signal s]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Signal s -&gt; Maybe (Signal s) -&gt; Signal s
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Signal s
forall a. a
</span><a href="#local-6989586621679108848"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Signal s) -&gt; Signal s)
-&gt; (TreeT (MaybeT Identity) (Signal s) -&gt; Maybe (Signal s))
-&gt; TreeT (MaybeT Identity) (Signal s)
-&gt; Signal s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tree (Maybe (Signal s)) -&gt; Maybe (Signal s)
forall a. Tree a -&gt; a
</span><span class="hs-identifier hs-var">treeValue</span></span><span> </span><span class="annot"><span class="annottext">(Tree (Maybe (Signal s)) -&gt; Maybe (Signal s))
-&gt; (TreeT (MaybeT Identity) (Signal s) -&gt; Tree (Maybe (Signal s)))
-&gt; TreeT (MaybeT Identity) (Signal s)
-&gt; Maybe (Signal s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TreeT (MaybeT Identity) (Signal s) -&gt; Tree (Maybe (Signal s))
forall (m :: * -&gt; *) a.
Monad m =&gt;
TreeT (MaybeT m) a -&gt; TreeT m (Maybe a)
</span><span class="hs-identifier hs-var">runDiscardEffectT</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TreeT (MaybeT Identity) (Signal s)]
</span><a href="#local-6989586621679108851"><span class="hs-identifier hs-var">signalTrees</span></a></span><span>
</span><span id="line-378"></span><span>        </span><span id="local-6989586621679108848"><span class="annot"><span class="annottext">err :: a
</span><a href="#local-6989586621679108848"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;genTraceOfLength: the tree nodes must always contain a signal&quot;</span></span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-comment">-- The states ensuing the root signals were calculated at 'loop'</span><span>
</span><span id="line-380"></span><span>        </span><span class="hs-comment">-- already, so there is no need to apply the STS again.</span><span>
</span><span id="line-381"></span><span>        </span><span class="annot"><a href="#local-6989586621679108854"><span class="hs-identifier hs-type">rootTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-382"></span><span>        </span><span id="local-6989586621679108854"><span class="annot"><span class="annottext">rootTrace :: Trace s
</span><a href="#local-6989586621679108854"><span class="hs-identifier hs-var hs-var">rootTrace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Environment s -&gt; State s -&gt; [(State s, Signal s)] -&gt; Trace s
forall s.
Environment s -&gt; State s -&gt; [(State s, Signal s)] -&gt; Trace s
</span><a href="Control.State.Transition.Trace.html#mkTrace"><span class="hs-identifier hs-var">mkTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108872"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108871"><span class="hs-identifier hs-var">st0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[State s] -&gt; [Signal s] -&gt; [(State s, Signal s)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[State s]
</span><a href="#local-6989586621679108852"><span class="hs-identifier hs-var">rootStates</span></a></span><span> </span><span class="annot"><span class="annottext">[Signal s]
</span><a href="#local-6989586621679108849"><span class="hs-identifier hs-var">rootSignals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>        </span><span class="annot"><a href="#local-6989586621679108846"><span class="hs-identifier hs-type">signalShrinks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-384"></span><span>        </span><span id="local-6989586621679108846"><span class="annot"><span class="annottext">signalShrinks :: TreeT (MaybeT Identity) [Signal s]
</span><a href="#local-6989586621679108846"><span class="hs-identifier hs-var hs-var">signalShrinks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TreeT (MaybeT Identity) (Signal s)]
-&gt; TreeT (MaybeT Identity) [Signal s]
forall a.
[TreeT (MaybeT Identity) a] -&gt; TreeT (MaybeT Identity) [a]
</span><a href="Hedgehog.Extra.Manual.html#interleave"><span class="hs-identifier hs-var">Manual.interleave</span></a></span><span> </span><span class="annot"><span class="annottext">[TreeT (MaybeT Identity) (Signal s)]
</span><a href="#local-6989586621679108851"><span class="hs-identifier hs-var">signalTrees</span></a></span><span>
</span><span id="line-385"></span><span>        </span><span class="hs-comment">-- The signals at the root of 'signalShrinks' are already included in</span><span>
</span><span id="line-386"></span><span>        </span><span class="hs-comment">-- the 'rootTrace' so there is no need to include them again in the tree</span><span>
</span><span id="line-387"></span><span>        </span><span class="hs-comment">-- of traces. Thus we only need to apply 'closure' to the children of</span><span>
</span><span id="line-388"></span><span>        </span><span class="hs-comment">-- the shrink tree.</span><span>
</span><span id="line-389"></span><span>        </span><span class="annot"><a href="#local-6989586621679108853"><span class="hs-identifier hs-type">signalShrinksChilren</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TreeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-390"></span><span>        </span><span id="local-6989586621679108853"><span class="annot"><span class="annottext">signalShrinksChilren :: [TreeT (MaybeT Identity) [Signal s]]
</span><a href="#local-6989586621679108853"><span class="hs-identifier hs-var hs-var">signalShrinksChilren</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeT (MaybeT Identity) [Signal s]
-&gt; [TreeT (MaybeT Identity) [Signal s]]
forall (m :: * -&gt; *) a. NodeT m a -&gt; [TreeT m a]
</span><span class="hs-identifier hs-var hs-var">nodeChildren</span></span><span> </span><span class="annot"><span class="annottext">(NodeT (MaybeT Identity) [Signal s]
 -&gt; [TreeT (MaybeT Identity) [Signal s]])
-&gt; NodeT (MaybeT Identity) [Signal s]
-&gt; [TreeT (MaybeT Identity) [Signal s]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NodeT (MaybeT Identity) [Signal s]
-&gt; Maybe (NodeT (MaybeT Identity) [Signal s])
-&gt; NodeT (MaybeT Identity) [Signal s]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">NodeT (MaybeT Identity) [Signal s]
forall a. a
</span><a href="#local-6989586621679108848"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (NodeT (MaybeT Identity) [Signal s])
 -&gt; NodeT (MaybeT Identity) [Signal s])
-&gt; Maybe (NodeT (MaybeT Identity) [Signal s])
-&gt; NodeT (MaybeT Identity) [Signal s]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TreeT (MaybeT Identity) [Signal s]
-&gt; Maybe (NodeT (MaybeT Identity) [Signal s])
forall a.
TreeT (MaybeT Identity) a -&gt; Maybe (NodeT (MaybeT Identity) a)
</span><a href="Hedgehog.Extra.Manual.html#unwrapTreeT"><span class="hs-identifier hs-var">Manual.unwrapTreeT</span></a></span><span> </span><span class="annot"><span class="annottext">TreeT (MaybeT Identity) [Signal s]
</span><a href="#local-6989586621679108846"><span class="hs-identifier hs-var">signalShrinks</span></a></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- | Generate an invalid trace</span><span>
</span><span id="line-394"></span><span class="hs-comment">--</span><span>
</span><span id="line-395"></span><span class="annot"><a href="Control.State.Transition.Generator.html#invalidTrace"><span class="hs-identifier hs-type">invalidTrace</span></a></span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679109042"><span class="annot"><a href="#local-6989586621679109042"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-397"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109042"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109042"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-comment">-- ^ Maximum length of the generated traces.</span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-type">SignalGenerator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109042"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-comment">-- ^ Trace failure profile to be used to get an invalid signal.</span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Invalid.Trace.html#Trace"><span class="hs-identifier hs-type">Invalid.Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109042"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span id="invalidTrace"><span class="annot"><span class="annottext">invalidTrace :: BaseEnv s -&gt; Word64 -&gt; [(Int, SignalGenerator s)] -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#invalidTrace"><span class="hs-identifier hs-var hs-var">invalidTrace</span></a></span></span><span> </span><span id="local-6989586621679108843"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108843"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108842"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108842"><span class="hs-identifier hs-var">maxTraceLength</span></a></span></span><span> </span><span id="local-6989586621679108841"><span class="annot"><span class="annottext">[(Int, SignalGenerator s)]
</span><a href="#local-6989586621679108841"><span class="hs-identifier hs-var">failureProfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>  </span><span id="local-6989586621679108840"><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108840"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
forall s. HasTrace s =&gt; BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#trace"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109042"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108843"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108842"><span class="hs-identifier hs-var">maxTraceLength</span></a></span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679108839"><span class="annot"><span class="annottext">env :: Environment s
</span><a href="#local-6989586621679108839"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Trace s -&gt; Environment s
forall s. Trace s -&gt; Environment s
</span><a href="Control.State.Transition.Trace.html#_traceEnv"><span class="hs-identifier hs-var hs-var">_traceEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108840"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-407"></span><span>      </span><span id="local-6989586621679108838"><span class="annot"><span class="annottext">st :: State s
</span><a href="#local-6989586621679108838"><span class="hs-identifier hs-var hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Trace s -&gt; State s
forall s. Trace s -&gt; State s
</span><a href="Control.State.Transition.Trace.html#lastState"><span class="hs-identifier hs-var">lastState</span></a></span><span> </span><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108840"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span id="local-6989586621679108837"><span class="annot"><span class="annottext">Signal s
</span><a href="#local-6989586621679108837"><span class="hs-identifier hs-var">iSig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Int, SignalGenerator s)] -&gt; SignalGenerator s
forall s. [(Int, SignalGenerator s)] -&gt; SignalGenerator s
</span><a href="Control.State.Transition.Generator.html#generateSignalWithFailureProportions"><span class="hs-identifier hs-var">generateSignalWithFailureProportions</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109042"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, SignalGenerator s)]
</span><a href="#local-6989586621679108841"><span class="hs-identifier hs-var">failureProfile</span></a></span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108839"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108838"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679108836"><span class="annot"><span class="annottext">est' :: Either [[PredicateFailure s]] (State s)
</span><a href="#local-6989586621679108836"><span class="hs-identifier hs-var hs-var">est'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; BaseM s (Either [[PredicateFailure s]] (State s))
-&gt; Either [[PredicateFailure s]] (State s)
forall s a. HasTrace s =&gt; BaseEnv s -&gt; BaseM s a -&gt; a
</span><a href="Control.State.Transition.Generator.html#interpretSTS"><span class="hs-identifier hs-var">interpretSTS</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109042"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108843"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseM s (Either [[PredicateFailure s]] (State s))
 -&gt; Either [[PredicateFailure s]] (State s))
-&gt; BaseM s (Either [[PredicateFailure s]] (State s))
-&gt; Either [[PredicateFailure s]] (State s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s -&gt; m (Either [[PredicateFailure s]] (State s))
forall (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s -&gt; m (Either [[PredicateFailure s]] (State s))
</span><a href="Control.State.Transition.Trace.html#applySTSTest"><span class="hs-identifier hs-var">applySTSTest</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109042"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">(RuleContext 'Transition s
 -&gt; BaseM s (Either [[PredicateFailure s]] (State s)))
-&gt; RuleContext 'Transition s
-&gt; BaseM s (Either [[PredicateFailure s]] (State s))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Environment s, State s, Signal s) -&gt; TRC s
forall sts. (Environment sts, State sts, Signal sts) -&gt; TRC sts
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108839"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108838"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Signal s
</span><a href="#local-6989586621679108837"><span class="hs-identifier hs-var">iSig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>  </span><span class="annot"><span class="annottext">Trace s -&gt; Gen (Trace s)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Trace s -&gt; Gen (Trace s)) -&gt; Trace s -&gt; Gen (Trace s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Trace :: forall s.
Trace s
-&gt; Signal s -&gt; Either [[PredicateFailure s]] (State s) -&gt; Trace s
</span><a href="Control.State.Transition.Invalid.Trace.html#Trace"><span class="hs-identifier hs-type">Invalid.Trace</span></a></span><span>
</span><span id="line-411"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">validPrefix :: Trace s
</span><a href="Control.State.Transition.Invalid.Trace.html#validPrefix"><span class="hs-identifier hs-var">Invalid.validPrefix</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108840"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-412"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signal :: Signal s
</span><a href="Control.State.Transition.Invalid.Trace.html#signal"><span class="hs-identifier hs-var">Invalid.signal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Signal s
</span><a href="#local-6989586621679108837"><span class="hs-identifier hs-var">iSig</span></a></span><span>
</span><span id="line-413"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">errorOrLastState :: Either [[PredicateFailure s]] (State s)
</span><a href="Control.State.Transition.Invalid.Trace.html#errorOrLastState"><span class="hs-identifier hs-var">Invalid.errorOrLastState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either [[PredicateFailure s]] (State s)
</span><a href="#local-6989586621679108836"><span class="hs-identifier hs-var">est'</span></a></span><span>
</span><span id="line-414"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="annot"><a href="Control.State.Transition.Generator.html#traceSuchThat"><span class="hs-identifier hs-type">traceSuchThat</span></a></span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108830"><span class="annot"><a href="#local-6989586621679108830"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-419"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108830"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108830"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-422"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108830"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108830"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span id="traceSuchThat"><span class="annot"><span class="annottext">traceSuchThat :: BaseEnv s -&gt; Word64 -&gt; (Trace s -&gt; Bool) -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#traceSuchThat"><span class="hs-identifier hs-var hs-var">traceSuchThat</span></a></span></span><span> </span><span id="local-6989586621679108829"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108829"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108828"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108828"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679108827"><span class="annot"><span class="annottext">Trace s -&gt; Bool
</span><a href="#local-6989586621679108827"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Trace s -&gt; Bool) -&gt; Gen (Trace s) -&gt; Gen (Trace s)
forall (m :: * -&gt; *) a.
(MonadGen m, GenBase m ~ Identity) =&gt;
(a -&gt; Bool) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">Gen.filter</span></span><span> </span><span class="annot"><span class="annottext">Trace s -&gt; Bool
</span><a href="#local-6989586621679108827"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
forall s. HasTrace s =&gt; BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#trace"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679108830"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108829"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108828"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span id="local-6989586621679108825"><span class="annot"><a href="Control.State.Transition.Generator.html#ofLengthAtLeast"><span class="hs-identifier hs-type">ofLengthAtLeast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108825"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108825"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-428"></span><span id="ofLengthAtLeast"><span class="annot"><span class="annottext">ofLengthAtLeast :: Gen (Trace s) -&gt; Int -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#ofLengthAtLeast"><span class="hs-identifier hs-var hs-var">ofLengthAtLeast</span></a></span></span><span> </span><span id="local-6989586621679108824"><span class="annot"><span class="annottext">Gen (Trace s)
</span><a href="#local-6989586621679108824"><span class="hs-identifier hs-var">traceGen</span></a></span></span><span> </span><span id="local-6989586621679108823"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108823"><span class="hs-identifier hs-var">minLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-429"></span><span>  </span><span class="annot"><span class="annottext">(Trace s -&gt; Bool) -&gt; Gen (Trace s) -&gt; Gen (Trace s)
forall (m :: * -&gt; *) a.
(MonadGen m, GenBase m ~ Identity) =&gt;
(a -&gt; Bool) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">Gen.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108823"><span class="hs-identifier hs-var">minLength</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; (Trace s -&gt; Int) -&gt; Trace s -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Trace s -&gt; Int
forall s. Trace s -&gt; Int
</span><a href="Control.State.Transition.Trace.html#traceLength"><span class="hs-identifier hs-var">traceLength</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Gen (Trace s)
</span><a href="#local-6989586621679108824"><span class="hs-identifier hs-var">traceGen</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="annot"><a href="Control.State.Transition.Generator.html#suchThatLastState"><span class="hs-identifier hs-type">suchThatLastState</span></a></span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108821"><span class="annot"><a href="#local-6989586621679108821"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-434"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108821"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679108821"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108821"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span id="suchThatLastState"><span class="annot"><span class="annottext">suchThatLastState :: Gen (Trace s) -&gt; (State s -&gt; Bool) -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#suchThatLastState"><span class="hs-identifier hs-var hs-var">suchThatLastState</span></a></span></span><span> </span><span id="local-6989586621679108820"><span class="annot"><span class="annottext">Gen (Trace s)
</span><a href="#local-6989586621679108820"><span class="hs-identifier hs-var">traceGen</span></a></span></span><span> </span><span id="local-6989586621679108819"><span class="annot"><span class="annottext">State s -&gt; Bool
</span><a href="#local-6989586621679108819"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Trace s -&gt; Bool) -&gt; Gen (Trace s) -&gt; Gen (Trace s)
forall (m :: * -&gt; *) a.
(MonadGen m, GenBase m ~ Identity) =&gt;
(a -&gt; Bool) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">Gen.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State s -&gt; Bool
</span><a href="#local-6989586621679108819"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">(State s -&gt; Bool) -&gt; (Trace s -&gt; State s) -&gt; Trace s -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Trace s -&gt; State s
forall s. Trace s -&gt; State s
</span><a href="Control.State.Transition.Trace.html#lastState"><span class="hs-identifier hs-var">lastState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Gen (Trace s)
</span><a href="#local-6989586621679108820"><span class="hs-identifier hs-var">traceGen</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="hs-comment">-- | Generate a trace that contains at least one non-trivial signal. See</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- 'HasSizeInfo'.</span><span>
</span><span id="line-441"></span><span class="annot"><a href="Control.State.Transition.Generator.html#nonTrivialTrace"><span class="hs-identifier hs-type">nonTrivialTrace</span></a></span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108818"><span class="annot"><a href="#local-6989586621679108818"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-443"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108818"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasSizeInfo"><span class="hs-identifier hs-type">HasSizeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108818"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108818"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108818"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span id="nonTrivialTrace"><span class="annot"><span class="annottext">nonTrivialTrace :: BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#nonTrivialTrace"><span class="hs-identifier hs-var hs-var">nonTrivialTrace</span></a></span></span><span> </span><span id="local-6989586621679108817"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108817"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108816"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108816"><span class="hs-identifier hs-var">ub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><span class="annottext">(Trace s -&gt; Bool) -&gt; Gen (Trace s) -&gt; Gen (Trace s)
forall (m :: * -&gt; *) a.
(MonadGen m, GenBase m ~ Identity) =&gt;
(a -&gt; Bool) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">Gen.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Signal s -&gt; Bool) -&gt; [Signal s] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Signal s -&gt; Bool) -&gt; Signal s -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Signal s -&gt; Bool
forall sig. HasSizeInfo sig =&gt; sig -&gt; Bool
</span><a href="Control.State.Transition.Generator.html#isTrivial"><span class="hs-identifier hs-var">isTrivial</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Signal s] -&gt; Bool) -&gt; (Trace s -&gt; [Signal s]) -&gt; Trace s -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TraceOrder -&gt; Trace s -&gt; [Signal s]
forall s. TraceOrder -&gt; Trace s -&gt; [Signal s]
</span><a href="Control.State.Transition.Trace.html#traceSignals"><span class="hs-identifier hs-var">traceSignals</span></a></span><span> </span><span class="annot"><span class="annottext">TraceOrder
</span><a href="Control.State.Transition.Trace.html#OldestFirst"><span class="hs-identifier hs-var">OldestFirst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
forall s. HasTrace s =&gt; BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#trace"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108817"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108816"><span class="hs-identifier hs-var">ub</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="hs-keyword">class</span><span> </span><span id="HasSizeInfo"><span class="annot"><a href="Control.State.Transition.Generator.html#HasSizeInfo"><span class="hs-identifier hs-var">HasSizeInfo</span></a></span></span><span> </span><span id="local-6989586621679109117"><span class="annot"><a href="#local-6989586621679109117"><span class="hs-identifier hs-type">sig</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-451"></span><span>  </span><span id="isTrivial"><span class="annot"><a href="Control.State.Transition.Generator.html#isTrivial"><span class="hs-identifier hs-type">isTrivial</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679109117"><span class="hs-identifier hs-type">sig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span id="local-6989586621679108813"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasSizeInfo"><span class="hs-identifier hs-type">HasSizeInfo</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679108813"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-454"></span><span>  </span><span id="local-6989586621679108810"><span class="annot"><span class="annottext">isTrivial :: [a] -&gt; Bool
</span><a href="#local-6989586621679108810"><span class="hs-identifier hs-var hs-var hs-var hs-var">isTrivial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span></span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-457"></span><span class="hs-comment">-- Trace sampling utilities</span><span>
</span><span id="line-458"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="hs-comment">-- | Sample the maximum trace size, given the generator size and number of</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- samples.</span><span>
</span><span id="line-462"></span><span class="annot"><a href="Control.State.Transition.Generator.html#sampleMaxTraceSize"><span class="hs-identifier hs-type">sampleMaxTraceSize</span></a></span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108808"><span class="annot"><a href="#local-6989586621679108808"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-464"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108808"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108808"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-comment">-- ^ Trace's upper bound</span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-comment">-- ^ Generator size</span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-comment">-- ^ Number of samples to take</span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-473"></span><span id="sampleMaxTraceSize"><span class="annot"><span class="annottext">sampleMaxTraceSize :: BaseEnv s -&gt; Word64 -&gt; Int -&gt; Word64 -&gt; IO Int
</span><a href="Control.State.Transition.Generator.html#sampleMaxTraceSize"><span class="hs-identifier hs-var hs-var">sampleMaxTraceSize</span></a></span></span><span> </span><span id="local-6989586621679108807"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108807"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108806"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108806"><span class="hs-identifier hs-var">ub</span></a></span></span><span> </span><span id="local-6989586621679108805"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108805"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679108804"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108804"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-474"></span><span>  </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; IO [Int] -&gt; IO Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><span class="annottext">[Word64] -&gt; (Word64 -&gt; IO Int) -&gt; IO [Int]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108804"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO Int -&gt; Word64 -&gt; IO Int
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO Int -&gt; Word64 -&gt; IO Int) -&gt; IO Int -&gt; Word64 -&gt; IO Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Trace s -&gt; Int
forall s. Trace s -&gt; Int
</span><a href="Control.State.Transition.Trace.html#traceLength"><span class="hs-identifier hs-var">traceLength</span></a></span><span> </span><span class="annot"><span class="annottext">(Trace s -&gt; Int) -&gt; IO (Trace s) -&gt; IO Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen (Trace s) -&gt; IO (Trace s)
forall (m :: * -&gt; *) a. MonadIO m =&gt; Gen a -&gt; m a
</span><span class="hs-identifier hs-var">Gen.sample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Size -&gt; Gen (Trace s) -&gt; Gen (Trace s)
forall (m :: * -&gt; *) a. MonadGen m =&gt; Size -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">Gen.resize</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Size
</span><span class="hs-identifier hs-var">Size</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108805"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
forall s. HasTrace s =&gt; BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#trace"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679108808"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108807"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108806"><span class="hs-identifier hs-var">ub</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="annot"><a href="Control.State.Transition.Generator.html#randomTrace"><span class="hs-identifier hs-type">randomTrace</span></a></span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108799"><span class="annot"><a href="#local-6989586621679108799"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-479"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108799"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108799"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-481"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108799"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span id="randomTrace"><span class="annot"><span class="annottext">randomTrace :: BaseEnv s -&gt; Word64 -&gt; IO (Trace s)
</span><a href="Control.State.Transition.Generator.html#randomTrace"><span class="hs-identifier hs-var hs-var">randomTrace</span></a></span></span><span> </span><span id="local-6989586621679108798"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108798"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108797"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108797"><span class="hs-identifier hs-var">ub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen (Trace s) -&gt; IO (Trace s)
forall (m :: * -&gt; *) a. MonadIO m =&gt; Gen a -&gt; m a
</span><span class="hs-identifier hs-var">Gen.sample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
forall s. HasTrace s =&gt; BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#trace"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108798"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108797"><span class="hs-identifier hs-var">ub</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="annot"><a href="Control.State.Transition.Generator.html#randomTraceOfSize"><span class="hs-identifier hs-type">randomTraceOfSize</span></a></span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108796"><span class="annot"><a href="#local-6989586621679108796"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-488"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108796"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108796"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-490"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-491"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108796"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span id="randomTraceOfSize"><span class="annot"><span class="annottext">randomTraceOfSize :: BaseEnv s -&gt; Word64 -&gt; IO (Trace s)
</span><a href="Control.State.Transition.Generator.html#randomTraceOfSize"><span class="hs-identifier hs-var hs-var">randomTraceOfSize</span></a></span></span><span> </span><span id="local-6989586621679108795"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108795"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108794"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108794"><span class="hs-identifier hs-var">desiredTraceLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen (Trace s) -&gt; IO (Trace s)
forall (m :: * -&gt; *) a. MonadIO m =&gt; Gen a -&gt; m a
</span><span class="hs-identifier hs-var">Gen.sample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
forall s. HasTrace s =&gt; BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#traceOfLength"><span class="hs-identifier hs-var">traceOfLength</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108795"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108794"><span class="hs-identifier hs-var">desiredTraceLength</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-496"></span><span class="hs-comment">-- Trace classification</span><span>
</span><span id="line-497"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="hs-comment">-- | Classify the trace length as either:</span><span>
</span><span id="line-500"></span><span class="hs-comment">--</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- - being empty</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- - being a singleton</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- - having the given maximum size</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- - belonging to one of the intervals between 2 and the maximum size - 1. The</span><span>
</span><span id="line-505"></span><span class="hs-comment">--   number of intervals are determined by the @step@ parameter.</span><span>
</span><span id="line-506"></span><span class="hs-comment">--</span><span>
</span><span id="line-507"></span><span id="local-6989586621679109065"><span class="annot"><a href="Control.State.Transition.Generator.html#classifyTraceLength"><span class="hs-identifier hs-type">classifyTraceLength</span></a></span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109065"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-comment">-- ^ Maximum size of the traces</span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-comment">-- ^ Steps used to divide the interval</span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PropertyT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-514"></span><span id="classifyTraceLength"><span class="annot"><span class="annottext">classifyTraceLength :: Trace s -&gt; Word64 -&gt; Word64 -&gt; PropertyT IO ()
</span><a href="Control.State.Transition.Generator.html#classifyTraceLength"><span class="hs-identifier hs-var hs-var">classifyTraceLength</span></a></span></span><span> </span><span id="local-6989586621679108793"><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108793"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; Trace s
-&gt; (Trace s -&gt; Word64)
-&gt; Word64
-&gt; Word64
-&gt; PropertyT IO ()
forall n a.
(Ord n, Show n, Integral n) =&gt;
[Char] -&gt; a -&gt; (a -&gt; n) -&gt; n -&gt; n -&gt; PropertyT IO ()
</span><a href="Control.State.Transition.Generator.html#classifySize"><span class="hs-identifier hs-var">classifySize</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;trace length:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108793"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word64) -&gt; (Trace s -&gt; Int) -&gt; Trace s -&gt; Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Trace s -&gt; Int
forall s. Trace s -&gt; Int
</span><a href="Control.State.Transition.Trace.html#traceLength"><span class="hs-identifier hs-var">traceLength</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="hs-comment">-- | Classify the value size as either:</span><span>
</span><span id="line-517"></span><span class="hs-comment">--</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- - being empty</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- - being a singleton</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- - having the given maximum size</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- - belonging to one of the intervals between 2 and the maximum size - 1. The</span><span>
</span><span id="line-522"></span><span class="hs-comment">--   number of intervals are determined by the @step@ parameter.</span><span>
</span><span id="line-523"></span><span class="hs-comment">--</span><span>
</span><span id="line-524"></span><span id="local-6989586621679109092"><span id="local-6989586621679109093"><span class="annot"><a href="Control.State.Transition.Generator.html#classifySize"><span class="hs-identifier hs-type">classifySize</span></a></span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679109093"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679109093"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679109093"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-527"></span><span>  </span><span class="hs-comment">-- ^ Prefix to be added to the label intervals</span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109092"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-comment">-- ^ Value to classify</span><span>
</span><span id="line-530"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679109092"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109093"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-comment">-- ^ Size function</span><span>
</span><span id="line-532"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109093"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-533"></span><span>  </span><span class="hs-comment">-- ^ Maximum value size</span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109093"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-535"></span><span>  </span><span class="hs-comment">-- ^ Steps used to divide the size interval</span><span>
</span><span id="line-536"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PropertyT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-537"></span><span id="classifySize"><span class="annot"><span class="annottext">classifySize :: [Char] -&gt; a -&gt; (a -&gt; n) -&gt; n -&gt; n -&gt; PropertyT IO ()
</span><a href="Control.State.Transition.Generator.html#classifySize"><span class="hs-identifier hs-var hs-var">classifySize</span></a></span></span><span> </span><span id="local-6989586621679108791"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679108791"><span class="hs-identifier hs-var">prefixLabel</span></a></span></span><span> </span><span id="local-6989586621679108790"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108790"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span id="local-6989586621679108789"><span class="annot"><span class="annottext">a -&gt; n
</span><a href="#local-6989586621679108789"><span class="hs-identifier hs-var">sizeF</span></a></span></span><span> </span><span id="local-6989586621679108788"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108788"><span class="hs-identifier hs-var">upBound</span></a></span></span><span> </span><span id="local-6989586621679108787"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108787"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-538"></span><span>  </span><span class="annot"><span class="annottext">LabelName -&gt; Bool -&gt; PropertyT IO ()
forall (m :: * -&gt; *).
(MonadTest m, HasCallStack) =&gt;
LabelName -&gt; Bool -&gt; m ()
</span><span class="hs-identifier hs-var">classify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; LabelName
</span><a href="#local-6989586621679108786"><span class="hs-identifier hs-var">mkLabel</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;empty&quot;</span></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="annottext">(Bool -&gt; PropertyT IO ()) -&gt; Bool -&gt; PropertyT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; n
</span><a href="#local-6989586621679108789"><span class="hs-identifier hs-var">sizeF</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108790"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">0</span></span><span>
</span><span id="line-539"></span><span>  </span><span class="annot"><span class="annottext">LabelName -&gt; Bool -&gt; PropertyT IO ()
forall (m :: * -&gt; *).
(MonadTest m, HasCallStack) =&gt;
LabelName -&gt; Bool -&gt; m ()
</span><span class="hs-identifier hs-var">classify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; LabelName
</span><a href="#local-6989586621679108786"><span class="hs-identifier hs-var">mkLabel</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;singleton&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; PropertyT IO ()) -&gt; Bool -&gt; PropertyT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; n
</span><a href="#local-6989586621679108789"><span class="hs-identifier hs-var">sizeF</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108790"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">1</span></span><span>
</span><span id="line-540"></span><span>  </span><span class="annot"><span class="annottext">((n, n) -&gt; PropertyT IO ()) -&gt; [(n, n)] -&gt; PropertyT IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><span class="hs-identifier hs-var">traverse_</span></span><span> </span><span class="annot"><span class="annottext">(n, n) -&gt; PropertyT IO ()
</span><a href="#local-6989586621679108785"><span class="hs-identifier hs-var">classifySizeInterval</span></a></span><span> </span><span class="annot"><span class="annottext">([(n, n)] -&gt; PropertyT IO ()) -&gt; [(n, n)] -&gt; PropertyT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n -&gt; [(n, n)]
forall n. Integral n =&gt; n -&gt; n -&gt; n -&gt; [(n, n)]
</span><a href="Control.State.Transition.Generator.html#mkIntervals"><span class="hs-identifier hs-var">mkIntervals</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108788"><span class="hs-identifier hs-var">upBound</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108787"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-541"></span><span>  </span><span class="annot"><span class="annottext">LabelName -&gt; Bool -&gt; PropertyT IO ()
forall (m :: * -&gt; *).
(MonadTest m, HasCallStack) =&gt;
LabelName -&gt; Bool -&gt; m ()
</span><span class="hs-identifier hs-var">classify</span></span><span> </span><span class="annot"><span class="annottext">LabelName
</span><a href="#local-6989586621679108784"><span class="hs-identifier hs-var">upBoundLabel</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; PropertyT IO ()) -&gt; Bool -&gt; PropertyT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; n
</span><a href="#local-6989586621679108789"><span class="hs-identifier hs-var">sizeF</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108790"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108788"><span class="hs-identifier hs-var">upBound</span></a></span><span>
</span><span id="line-542"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-543"></span><span>    </span><span id="local-6989586621679108784"><span class="annot"><span class="annottext">upBoundLabel :: LabelName
</span><a href="#local-6989586621679108784"><span class="hs-identifier hs-var hs-var">upBoundLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; LabelName
</span><a href="#local-6989586621679108786"><span class="hs-identifier hs-var">mkLabel</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; LabelName) -&gt; [Char] -&gt; LabelName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108788"><span class="hs-identifier hs-var">upBound</span></a></span><span>
</span><span id="line-544"></span><span>    </span><span id="local-6989586621679108786"><span class="annot"><span class="annottext">mkLabel :: [Char] -&gt; LabelName
</span><a href="#local-6989586621679108786"><span class="hs-identifier hs-var hs-var">mkLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; LabelName
forall a. IsString a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; LabelName) -&gt; ([Char] -&gt; [Char]) -&gt; [Char] -&gt; LabelName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679108791"><span class="hs-identifier hs-var">prefixLabel</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>    </span><span id="local-6989586621679108785"><span class="annot"><span class="annottext">classifySizeInterval :: (n, n) -&gt; PropertyT IO ()
</span><a href="#local-6989586621679108785"><span class="hs-identifier hs-var hs-var">classifySizeInterval</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679108782"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108782"><span class="hs-identifier hs-var">low</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679108781"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108781"><span class="hs-identifier hs-var">high</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-546"></span><span>      </span><span class="annot"><span class="annottext">LabelName -&gt; Bool -&gt; PropertyT IO ()
forall (m :: * -&gt; *).
(MonadTest m, HasCallStack) =&gt;
LabelName -&gt; Bool -&gt; m ()
</span><span class="hs-identifier hs-var">classify</span></span><span> </span><span class="annot"><span class="annottext">LabelName
</span><a href="#local-6989586621679108780"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; PropertyT IO ()) -&gt; Bool -&gt; PropertyT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108782"><span class="hs-identifier hs-var">low</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; n
</span><a href="#local-6989586621679108789"><span class="hs-identifier hs-var">sizeF</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108790"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; n
</span><a href="#local-6989586621679108789"><span class="hs-identifier hs-var">sizeF</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108790"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108781"><span class="hs-identifier hs-var">high</span></a></span><span>
</span><span id="line-547"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-548"></span><span>        </span><span class="hs-comment">-- Hedgehog's LabelName doesn't have a monoid instance at the moment...</span><span>
</span><span id="line-549"></span><span>        </span><span id="local-6989586621679108780"><span class="annot"><span class="annottext">desc :: LabelName
</span><a href="#local-6989586621679108780"><span class="hs-identifier hs-var hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; LabelName
</span><a href="#local-6989586621679108786"><span class="hs-identifier hs-var">mkLabel</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; LabelName) -&gt; [Char] -&gt; LabelName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108782"><span class="hs-identifier hs-var">low</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108781"><span class="hs-identifier hs-var">high</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span class="hs-comment">-- | Given a lower bound @low@,  an upper bound @high@ and a step size @step@</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- (both of which must be positive), divide the interval @[0, ub]@ into</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- sub-intervals of @step@ size.</span><span>
</span><span id="line-555"></span><span class="hs-comment">--</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- If any of these values is negative the empty list will be returned.</span><span>
</span><span id="line-557"></span><span class="hs-comment">--</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- Examples:</span><span>
</span><span id="line-559"></span><span class="hs-comment">--</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- &gt;&gt;&gt; mkIntervals 0 0 0 :: [(Int, Int)]</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- []</span><span>
</span><span id="line-562"></span><span class="hs-comment">--</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- &gt;&gt;&gt; mkIntervals 0 10 2 :: [(Int, Int)]</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- [(0,2),(2,4),(4,6),(6,8),(8,10)]</span><span>
</span><span id="line-565"></span><span class="hs-comment">--</span><span>
</span><span id="line-566"></span><span class="hs-comment">-- &gt;&gt;&gt; mkIntervals 1 10 2 :: [(Int, Int)]</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- [(1,3),(3,5),(5,7),(7,9),(9,10)]</span><span>
</span><span id="line-568"></span><span class="hs-comment">--</span><span>
</span><span id="line-569"></span><span class="hs-comment">--</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- &gt;&gt;&gt; mkIntervals 3 10 3 :: [(Int, Int)]</span><span>
</span><span id="line-571"></span><span class="hs-comment">-- [(3,6),(6,9),(9,10)]</span><span>
</span><span id="line-572"></span><span class="hs-comment">--</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- &gt;&gt;&gt; mkIntervals 5 2 3 :: [(Int, Int)]</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- []</span><span>
</span><span id="line-575"></span><span class="hs-comment">--</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- &gt;&gt;&gt; mkIntervals (-1) 10 3 :: [(Int, Int)]</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- []</span><span>
</span><span id="line-578"></span><span class="hs-comment">--</span><span>
</span><span id="line-579"></span><span class="hs-comment">-- &gt;&gt;&gt; mkIntervals 1 (-10) 3 :: [(Int, Int)]</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- []</span><span>
</span><span id="line-581"></span><span class="hs-comment">--</span><span>
</span><span id="line-582"></span><span class="hs-comment">-- &gt;&gt;&gt; mkIntervals 1 1000 (-100) :: [(Int, Int)]</span><span>
</span><span id="line-583"></span><span class="hs-comment">-- []</span><span>
</span><span id="line-584"></span><span class="hs-comment">--</span><span>
</span><span id="line-585"></span><span id="local-6989586621679109079"><span class="annot"><a href="Control.State.Transition.Generator.html#mkIntervals"><span class="hs-identifier hs-type">mkIntervals</span></a></span><span>
</span><span id="line-586"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679109079"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-587"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109079"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-comment">-- ^ Interval lower bound</span><span>
</span><span id="line-589"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109079"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-comment">-- ^ Interval upper bound</span><span>
</span><span id="line-591"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109079"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-comment">-- ^ Step size, used to divide the interval in sub-intervals of the same</span><span>
</span><span id="line-593"></span><span>  </span><span class="hs-comment">-- length.</span><span>
</span><span id="line-594"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679109079"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679109079"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-595"></span><span id="mkIntervals"><span class="annot"><span class="annottext">mkIntervals :: n -&gt; n -&gt; n -&gt; [(n, n)]
</span><a href="Control.State.Transition.Generator.html#mkIntervals"><span class="hs-identifier hs-var hs-var">mkIntervals</span></a></span></span><span> </span><span id="local-6989586621679108777"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108777"><span class="hs-identifier hs-var">low</span></a></span></span><span> </span><span id="local-6989586621679108776"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108776"><span class="hs-identifier hs-var">high</span></a></span></span><span> </span><span id="local-6989586621679108775"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108775"><span class="hs-identifier hs-var">step</span></a></span></span><span>
</span><span id="line-596"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108777"><span class="hs-identifier hs-var">low</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108777"><span class="hs-identifier hs-var">low</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108776"><span class="hs-identifier hs-var">high</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108775"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-597"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108777"><span class="hs-identifier hs-var">low</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108773"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108775"><span class="hs-identifier hs-var">step</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108776"><span class="hs-identifier hs-var">high</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`min`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108777"><span class="hs-identifier hs-var">low</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108773"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108775"><span class="hs-identifier hs-var">step</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679108773"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108773"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">n
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108770"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-599"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-600"></span><span>    </span><span id="local-6989586621679108769"><span class="annot"><span class="annottext">highNorm :: n
</span><a href="#local-6989586621679108769"><span class="hs-identifier hs-var hs-var">highNorm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108776"><span class="hs-identifier hs-var">high</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108777"><span class="hs-identifier hs-var">low</span></a></span><span>
</span><span id="line-601"></span><span>    </span><span id="local-6989586621679108770"><span class="annot"><span class="annottext">n :: n
</span><a href="#local-6989586621679108770"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108769"><span class="hs-identifier hs-var">highNorm</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108775"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`min`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108769"><span class="hs-identifier hs-var">highNorm</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679108775"><span class="hs-identifier hs-var">step</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span class="hs-comment">-- | Given a function that computes an integral value from a trace, return that</span><span>
</span><span id="line-604"></span><span class="hs-comment">-- value as a ratio of the trace length.</span><span>
</span><span id="line-605"></span><span id="local-6989586621679108765"><span id="local-6989586621679108766"><span class="annot"><a href="Control.State.Transition.Generator.html#ratio"><span class="hs-identifier hs-type">ratio</span></a></span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679108766"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108765"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679108766"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108765"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-609"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span><span>
</span><span id="line-610"></span><span id="ratio"><span class="annot"><span class="annottext">ratio :: (Trace s -&gt; a) -&gt; Trace s -&gt; Double
</span><a href="Control.State.Transition.Generator.html#ratio"><span class="hs-identifier hs-var hs-var">ratio</span></a></span></span><span> </span><span id="local-6989586621679108764"><span class="annot"><span class="annottext">Trace s -&gt; a
</span><a href="#local-6989586621679108764"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679108763"><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108763"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace s -&gt; a
</span><a href="#local-6989586621679108764"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108763"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace s -&gt; Int
forall s. Trace s -&gt; Int
</span><a href="Control.State.Transition.Trace.html#traceLength"><span class="hs-identifier hs-var">traceLength</span></a></span><span> </span><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108763"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-613"></span><span class="hs-comment">-- Trace properties</span><span>
</span><span id="line-614"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-615"></span><span>
</span><span id="line-616"></span><span class="hs-comment">-- | Property that simply classifies the lengths of the generated traces.</span><span>
</span><span id="line-617"></span><span class="annot"><a href="Control.State.Transition.Generator.html#traceLengthsAreClassified"><span class="hs-identifier hs-type">traceLengthsAreClassified</span></a></span><span>
</span><span id="line-618"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108761"><span class="annot"><a href="#local-6989586621679108761"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-619"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108761"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108761"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108761"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108761"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108761"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-621"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-622"></span><span>  </span><span class="hs-comment">-- ^ Maximum trace length that the signal generator of 's' can generate.</span><span>
</span><span id="line-623"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-624"></span><span>  </span><span class="hs-comment">-- ^ Lengths of the intervals in which the lengths range should be split.</span><span>
</span><span id="line-625"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-626"></span><span id="traceLengthsAreClassified"><span class="annot"><span class="annottext">traceLengthsAreClassified :: BaseEnv s -&gt; Word64 -&gt; Word64 -&gt; Property
</span><a href="Control.State.Transition.Generator.html#traceLengthsAreClassified"><span class="hs-identifier hs-var hs-var">traceLengthsAreClassified</span></a></span></span><span> </span><span id="local-6989586621679108760"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108760"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108759"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108759"><span class="hs-identifier hs-var">maximumTraceLength</span></a></span></span><span> </span><span id="local-6989586621679108758"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108758"><span class="hs-identifier hs-var">intervalSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-627"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-628"></span><span>    </span><span id="local-6989586621679108757"><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108757"><span class="hs-identifier hs-var">traceSample</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Trace s) -&gt; PropertyT IO (Trace s)
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><span class="hs-identifier hs-var">forAll</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
forall s. HasTrace s =&gt; BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#trace"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679108761"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108760"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108759"><span class="hs-identifier hs-var">maximumTraceLength</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>    </span><span class="annot"><span class="annottext">Trace s -&gt; Word64 -&gt; Word64 -&gt; PropertyT IO ()
forall s. Trace s -&gt; Word64 -&gt; Word64 -&gt; PropertyT IO ()
</span><a href="Control.State.Transition.Generator.html#classifyTraceLength"><span class="hs-identifier hs-var">classifyTraceLength</span></a></span><span> </span><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108757"><span class="hs-identifier hs-var">traceSample</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108759"><span class="hs-identifier hs-var">maximumTraceLength</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108758"><span class="hs-identifier hs-var">intervalSize</span></a></span><span>
</span><span id="line-630"></span><span>    </span><span class="annot"><span class="annottext">PropertyT IO ()
forall (m :: * -&gt; *). MonadTest m =&gt; m ()
</span><span class="hs-identifier hs-var">success</span></span><span>
</span><span id="line-631"></span><span>
</span><span id="line-632"></span><span class="hs-comment">-- | Check that the signal generator of 's' only generate valid signals.</span><span>
</span><span id="line-633"></span><span class="annot"><a href="Control.State.Transition.Generator.html#onlyValidSignalsAreGenerated"><span class="hs-identifier hs-type">onlyValidSignalsAreGenerated</span></a></span><span>
</span><span id="line-634"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108756"><span class="annot"><a href="#local-6989586621679108756"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-635"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108756"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108756"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108756"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108756"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108756"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-comment">-- ^ Maximum trace length.</span><span>
</span><span id="line-639"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-640"></span><span id="onlyValidSignalsAreGenerated"><span class="annot"><span class="annottext">onlyValidSignalsAreGenerated :: BaseEnv s -&gt; Word64 -&gt; Property
</span><a href="Control.State.Transition.Generator.html#onlyValidSignalsAreGenerated"><span class="hs-identifier hs-var hs-var">onlyValidSignalsAreGenerated</span></a></span></span><span> </span><span id="local-6989586621679108755"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108755"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108754"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108754"><span class="hs-identifier hs-var">maximumTraceLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-641"></span><span>  </span><span class="annot"><span class="annottext">BaseEnv s -&gt; Gen (Trace s) -&gt; Property
forall s.
(HasTrace s, Show (Environment s), Show (State s), Show (Signal s),
 HasCallStack) =&gt;
BaseEnv s -&gt; Gen (Trace s) -&gt; Property
</span><a href="Control.State.Transition.Generator.html#onlyValidSignalsAreGeneratedForTrace"><span class="hs-identifier hs-var">onlyValidSignalsAreGeneratedForTrace</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108755"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
forall s. HasTrace s =&gt; BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#trace"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679108756"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108755"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108754"><span class="hs-identifier hs-var">maximumTraceLength</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span class="hs-comment">-- | Check that the signal generator of 's' only generate valid signals.</span><span>
</span><span id="line-644"></span><span class="annot"><a href="Control.State.Transition.Generator.html#onlyValidSignalsAreGeneratedForTrace"><span class="hs-identifier hs-type">onlyValidSignalsAreGeneratedForTrace</span></a></span><span>
</span><span id="line-645"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679109062"><span class="annot"><a href="#local-6989586621679109062"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-646"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109062"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109062"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109062"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109062"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109062"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-648"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109062"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-650"></span><span id="onlyValidSignalsAreGeneratedForTrace"><span class="annot"><span class="annottext">onlyValidSignalsAreGeneratedForTrace :: BaseEnv s -&gt; Gen (Trace s) -&gt; Property
</span><a href="Control.State.Transition.Generator.html#onlyValidSignalsAreGeneratedForTrace"><span class="hs-identifier hs-var hs-var">onlyValidSignalsAreGeneratedForTrace</span></a></span></span><span> </span><span id="local-6989586621679108753"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108753"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108752"><span class="annot"><span class="annottext">Gen (Trace s)
</span><a href="#local-6989586621679108752"><span class="hs-identifier hs-var">traceGen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-651"></span><span>  </span><span id="local-6989586621679108751"><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108751"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Trace s) -&gt; PropertyT IO (Trace s)
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><span class="hs-identifier hs-var">forAll</span></span><span> </span><span class="annot"><span class="annottext">Gen (Trace s)
</span><a href="#local-6989586621679108752"><span class="hs-identifier hs-var">traceGen</span></a></span><span>
</span><span id="line-652"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-653"></span><span>    </span><span class="annot"><a href="#local-6989586621679108750"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109062"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-654"></span><span>    </span><span id="local-6989586621679108750"><span class="annot"><span class="annottext">env :: Environment s
</span><a href="#local-6989586621679108750"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Trace s -&gt; Environment s
forall s. Trace s -&gt; Environment s
</span><a href="Control.State.Transition.Trace.html#_traceEnv"><span class="hs-identifier hs-var hs-var">_traceEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108751"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-655"></span><span>
</span><span id="line-656"></span><span>    </span><span class="annot"><a href="#local-6989586621679108749"><span class="hs-identifier hs-type">st'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109062"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-657"></span><span>    </span><span id="local-6989586621679108749"><span class="annot"><span class="annottext">st' :: State s
</span><a href="#local-6989586621679108749"><span class="hs-identifier hs-var hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Trace s -&gt; State s
forall s. Trace s -&gt; State s
</span><a href="Control.State.Transition.Trace.html#lastState"><span class="hs-identifier hs-var">lastState</span></a></span><span> </span><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108751"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-658"></span><span>  </span><span id="local-6989586621679108748"><span class="annot"><span class="annottext">Signal s
</span><a href="#local-6989586621679108748"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Signal s) -&gt; PropertyT IO (Signal s)
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><span class="hs-identifier hs-var">forAll</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignalGenerator s
forall s. HasTrace s =&gt; SignalGenerator s
</span><a href="Control.State.Transition.Generator.html#sigGen"><span class="hs-identifier hs-var">sigGen</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109062"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108750"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108749"><span class="hs-identifier hs-var">st'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-659"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679108747"><span class="annot"><span class="annottext">result :: Either [[PredicateFailure s]] (State s)
</span><a href="#local-6989586621679108747"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseEnv s
-&gt; BaseM s (Either [[PredicateFailure s]] (State s))
-&gt; Either [[PredicateFailure s]] (State s)
forall s a. HasTrace s =&gt; BaseEnv s -&gt; BaseM s a -&gt; a
</span><a href="Control.State.Transition.Generator.html#interpretSTS"><span class="hs-identifier hs-var">interpretSTS</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109062"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108753"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseM s (Either [[PredicateFailure s]] (State s))
 -&gt; Either [[PredicateFailure s]] (State s))
-&gt; BaseM s (Either [[PredicateFailure s]] (State s))
-&gt; Either [[PredicateFailure s]] (State s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RuleContext 'Transition s
-&gt; BaseM s (Either [[PredicateFailure s]] (State s))
forall s (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s -&gt; m (Either [[PredicateFailure s]] (State s))
</span><a href="Control.State.Transition.Trace.html#applySTSTest"><span class="hs-identifier hs-var">applySTSTest</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679109062"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Environment s, State s, Signal s) -&gt; TRC s
forall sts. (Environment sts, State sts, Signal sts) -&gt; TRC sts
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-var">TRC</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Environment s
</span><a href="#local-6989586621679108750"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108749"><span class="hs-identifier hs-var">st'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Signal s
</span><a href="#local-6989586621679108748"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-660"></span><span>  </span><span class="hs-comment">-- TODO: For some reason the result that led to the failure is not shown</span><span>
</span><span id="line-661"></span><span>  </span><span class="hs-comment">-- (even without using tasty, and setting the condition to True === False)</span><span>
</span><span id="line-662"></span><span>  </span><span class="annot"><span class="annottext">State s -&gt; PropertyT IO ()
forall (m :: * -&gt; *) a. (MonadTest m, Show a) =&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">footnoteShow</span></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679108749"><span class="hs-identifier hs-var">st'</span></a></span><span>
</span><span id="line-663"></span><span>  </span><span class="annot"><span class="annottext">Signal s -&gt; PropertyT IO ()
forall (m :: * -&gt; *) a. (MonadTest m, Show a) =&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">footnoteShow</span></span><span> </span><span class="annot"><span class="annottext">Signal s
</span><a href="#local-6989586621679108748"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-664"></span><span>  </span><span class="annot"><span class="annottext">Either [[PredicateFailure s]] (State s) -&gt; PropertyT IO ()
forall (m :: * -&gt; *) a. (MonadTest m, Show a) =&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">footnoteShow</span></span><span> </span><span class="annot"><span class="annottext">Either [[PredicateFailure s]] (State s)
</span><a href="#local-6989586621679108747"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-665"></span><span>  </span><span class="annot"><span class="annottext">PropertyT IO (State s) -&gt; PropertyT IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO (State s) -&gt; PropertyT IO ())
-&gt; PropertyT IO (State s) -&gt; PropertyT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Either [[PredicateFailure s]] (State s) -&gt; PropertyT IO (State s)
forall (m :: * -&gt; *) x a.
(MonadTest m, Show x, HasCallStack) =&gt;
Either x a -&gt; m a
</span><span class="hs-identifier hs-var">evalEither</span></span><span> </span><span class="annot"><span class="annottext">Either [[PredicateFailure s]] (State s)
</span><a href="#local-6989586621679108747"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-666"></span><span>
</span><span id="line-667"></span><span class="annot"><a href="Control.State.Transition.Generator.html#coverFailures"><span class="hs-identifier hs-type">coverFailures</span></a></span><span>
</span><span id="line-668"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108746"><span class="annot"><a href="#local-6989586621679108746"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679108745"><span class="annot"><a href="#local-6989586621679108745"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679108744"><span class="annot"><a href="#local-6989586621679108744"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-669"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadTest</span></span><span> </span><span class="annot"><a href="#local-6989586621679108746"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-670"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span>
</span><span id="line-671"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">PredicateFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108745"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-672"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679108744"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-673"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoverPercentage</span></span><span>
</span><span id="line-675"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">PredicateFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108745"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-676"></span><span>  </span><span class="hs-comment">-- ^ Target predicate failures</span><span>
</span><span id="line-677"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679108744"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-678"></span><span>  </span><span class="hs-comment">-- ^ Structure containing the failures</span><span>
</span><span id="line-679"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679108746"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span id="coverFailures"><span class="annot"><span class="annottext">coverFailures :: CoverPercentage -&gt; [PredicateFailure s] -&gt; a -&gt; m ()
</span><a href="Control.State.Transition.Generator.html#coverFailures"><span class="hs-identifier hs-var hs-var">coverFailures</span></a></span></span><span> </span><span id="local-6989586621679108743"><span class="annot"><span class="annottext">CoverPercentage
</span><a href="#local-6989586621679108743"><span class="hs-identifier hs-var">coverPercentage</span></a></span></span><span> </span><span id="local-6989586621679108742"><span class="annot"><span class="annottext">[PredicateFailure s]
</span><a href="#local-6989586621679108742"><span class="hs-identifier hs-var">targetFailures</span></a></span></span><span> </span><span id="local-6989586621679108741"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108741"><span class="hs-identifier hs-var">failureStructure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-681"></span><span>  </span><span class="annot"><span class="annottext">(Constr -&gt; m ()) -&gt; [Constr] -&gt; m ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><span class="hs-identifier hs-var">traverse_</span></span><span> </span><span class="annot"><span class="annottext">Constr -&gt; m ()
</span><a href="#local-6989586621679108740"><span class="hs-identifier hs-var">coverFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PredicateFailure s -&gt; Constr
forall a. Data a =&gt; a -&gt; Constr
</span><span class="hs-identifier hs-var">toConstr</span></span><span> </span><span class="annot"><span class="annottext">(PredicateFailure s -&gt; Constr) -&gt; [PredicateFailure s] -&gt; [Constr]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PredicateFailure s]
</span><a href="#local-6989586621679108742"><span class="hs-identifier hs-var">targetFailures</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-682"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-683"></span><span>    </span><span id="local-6989586621679108740"><span class="annot"><span class="annottext">coverFailure :: Constr -&gt; m ()
</span><a href="#local-6989586621679108740"><span class="hs-identifier hs-var hs-var">coverFailure</span></a></span></span><span> </span><span id="local-6989586621679108739"><span class="annot"><span class="annottext">Constr
</span><a href="#local-6989586621679108739"><span class="hs-identifier hs-var">predicateFailureConstructor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-684"></span><span>      </span><span class="annot"><span class="annottext">CoverPercentage -&gt; LabelName -&gt; Bool -&gt; m ()
forall (m :: * -&gt; *).
(MonadTest m, HasCallStack) =&gt;
CoverPercentage -&gt; LabelName -&gt; Bool -&gt; m ()
</span><span class="hs-identifier hs-var">cover</span></span><span> </span><span class="annot"><span class="annottext">CoverPercentage
</span><a href="#local-6989586621679108743"><span class="hs-identifier hs-var">coverPercentage</span></a></span><span>
</span><span id="line-685"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; LabelName
forall a. IsString a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; LabelName) -&gt; [Char] -&gt; LabelName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Constr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Constr
</span><a href="#local-6989586621679108739"><span class="hs-identifier hs-var">predicateFailureConstructor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Constr
</span><a href="#local-6989586621679108739"><span class="hs-identifier hs-var">predicateFailureConstructor</span></a></span><span> </span><span class="annot"><span class="annottext">Constr -&gt; [Constr] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Constr]
</span><a href="#local-6989586621679108737"><span class="hs-identifier hs-var">failuresConstructors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-688"></span><span>        </span><span class="annot"><a href="#local-6989586621679108736"><span class="hs-identifier hs-type">subFailures</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">PredicateFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108745"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-689"></span><span>        </span><span id="local-6989586621679108736"><span class="annot"><span class="annottext">subFailures :: [PredicateFailure s]
</span><a href="#local-6989586621679108736"><span class="hs-identifier hs-var hs-var">subFailures</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [PredicateFailure s]
forall d a. (Data d, Typeable a) =&gt; d -&gt; [a]
</span><a href="Control.State.Transition.Trace.html#extractValues"><span class="hs-identifier hs-var">extractValues</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108741"><span class="hs-identifier hs-var">failureStructure</span></a></span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span>        </span><span class="annot"><a href="#local-6989586621679108737"><span class="hs-identifier hs-type">failuresConstructors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Constr</span></span><span class="hs-special">]</span><span>
</span><span id="line-692"></span><span>        </span><span id="local-6989586621679108737"><span class="annot"><span class="annottext">failuresConstructors :: [Constr]
</span><a href="#local-6989586621679108737"><span class="hs-identifier hs-var hs-var">failuresConstructors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PredicateFailure s -&gt; Constr
forall a. Data a =&gt; a -&gt; Constr
</span><span class="hs-identifier hs-var">toConstr</span></span><span> </span><span class="annot"><span class="annottext">(PredicateFailure s -&gt; Constr) -&gt; [PredicateFailure s] -&gt; [Constr]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PredicateFailure s]
</span><a href="#local-6989586621679108736"><span class="hs-identifier hs-var">subFailures</span></a></span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span class="annot"><a href="Control.State.Transition.Generator.html#invalidSignalsAreGenerated"><span class="hs-identifier hs-type">invalidSignalsAreGenerated</span></a></span><span>
</span><span id="line-696"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108735"><span class="annot"><a href="#local-6989586621679108735"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-697"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108735"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108735"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108735"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108735"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108735"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-699"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#SignalGenerator"><span class="hs-identifier hs-type">SignalGenerator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108735"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-700"></span><span>  </span><span class="hs-comment">-- ^ Failure profile.</span><span>
</span><span id="line-701"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-702"></span><span>  </span><span class="hs-comment">-- ^ Maximum trace length.</span><span>
</span><span id="line-703"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">PredicateFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108735"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PropertyT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span>  </span><span class="hs-comment">-- ^ Action to run when the an invalid signal is generated.</span><span>
</span><span id="line-705"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-706"></span><span id="invalidSignalsAreGenerated"><span class="annot"><span class="annottext">invalidSignalsAreGenerated :: BaseEnv s
-&gt; [(Int, SignalGenerator s)]
-&gt; Word64
-&gt; ([[PredicateFailure s]] -&gt; PropertyT IO ())
-&gt; Property
</span><a href="Control.State.Transition.Generator.html#invalidSignalsAreGenerated"><span class="hs-identifier hs-var hs-var">invalidSignalsAreGenerated</span></a></span></span><span> </span><span id="local-6989586621679108734"><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108734"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621679108733"><span class="annot"><span class="annottext">[(Int, SignalGenerator s)]
</span><a href="#local-6989586621679108733"><span class="hs-identifier hs-var">failureProfile</span></a></span></span><span> </span><span id="local-6989586621679108732"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108732"><span class="hs-identifier hs-var">maximumTraceLength</span></a></span></span><span> </span><span id="local-6989586621679108731"><span class="annot"><span class="annottext">[[PredicateFailure s]] -&gt; PropertyT IO ()
</span><a href="#local-6989586621679108731"><span class="hs-identifier hs-var">checkFailures</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-707"></span><span>
</span><span id="line-708"></span><span>  </span><span id="local-6989586621679108730"><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108730"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Trace s) -&gt; PropertyT IO (Trace s)
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><span class="hs-identifier hs-var">forAll</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseEnv s -&gt; Word64 -&gt; [(Int, SignalGenerator s)] -&gt; Gen (Trace s)
forall s.
HasTrace s =&gt;
BaseEnv s -&gt; Word64 -&gt; [(Int, SignalGenerator s)] -&gt; Gen (Trace s)
</span><a href="Control.State.Transition.Generator.html#invalidTrace"><span class="hs-identifier hs-var">invalidTrace</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679108735"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv s
</span><a href="#local-6989586621679108734"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679108732"><span class="hs-identifier hs-var">maximumTraceLength</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, SignalGenerator s)]
</span><a href="#local-6989586621679108733"><span class="hs-identifier hs-var">failureProfile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span>  </span><span class="annot"><span class="annottext">CoverPercentage -&gt; LabelName -&gt; Bool -&gt; PropertyT IO ()
forall (m :: * -&gt; *).
(MonadTest m, HasCallStack) =&gt;
CoverPercentage -&gt; LabelName -&gt; Bool -&gt; m ()
</span><span class="hs-identifier hs-var">cover</span></span><span> </span><span class="annot"><span class="annottext">CoverPercentage
</span><span class="hs-number">80</span></span><span>
</span><span id="line-711"></span><span>    </span><span class="annot"><span class="annottext">LabelName
</span><span class="hs-string">&quot;Invalid signals are generated when requested&quot;</span></span><span>
</span><span id="line-712"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either [[PredicateFailure s]] (State s) -&gt; Bool
forall a b. Either a b -&gt; Bool
</span><span class="hs-identifier hs-var">isLeft</span></span><span> </span><span class="annot"><span class="annottext">(Either [[PredicateFailure s]] (State s) -&gt; Bool)
-&gt; Either [[PredicateFailure s]] (State s) -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Trace s -&gt; Either [[PredicateFailure s]] (State s)
forall s. Trace s -&gt; Either [[PredicateFailure s]] (State s)
</span><a href="Control.State.Transition.Invalid.Trace.html#errorOrLastState"><span class="hs-identifier hs-var hs-var">Invalid.errorOrLastState</span></a></span><span> </span><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108730"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span>
</span><span id="line-714"></span><span>  </span><span class="annot"><span class="annottext">([[PredicateFailure s]] -&gt; PropertyT IO ())
-&gt; (State s -&gt; PropertyT IO ())
-&gt; Either [[PredicateFailure s]] (State s)
-&gt; PropertyT IO ()
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">[[PredicateFailure s]] -&gt; PropertyT IO ()
</span><a href="#local-6989586621679108731"><span class="hs-identifier hs-var">checkFailures</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropertyT IO () -&gt; State s -&gt; PropertyT IO ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">PropertyT IO ()
forall (m :: * -&gt; *). MonadTest m =&gt; m ()
</span><span class="hs-identifier hs-var">success</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace s -&gt; Either [[PredicateFailure s]] (State s)
forall s. Trace s -&gt; Either [[PredicateFailure s]] (State s)
</span><a href="Control.State.Transition.Invalid.Trace.html#errorOrLastState"><span class="hs-identifier hs-var hs-var">Invalid.errorOrLastState</span></a></span><span> </span><span class="annot"><span class="annottext">Trace s
</span><a href="#local-6989586621679108730"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span>
</span><span id="line-717"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-718"></span><span class="hs-comment">-- Helpers</span><span>
</span><span id="line-719"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-720"></span><span>
</span><span id="line-721"></span><span class="annot"><a href="Control.State.Transition.Generator.html#tinkerWithSigGen"><span class="hs-identifier hs-type">tinkerWithSigGen</span></a></span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679108728"><span class="annot"><a href="#local-6989586621679108728"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679108727"><span class="annot"><a href="#local-6989586621679108727"><span class="hs-identifier hs-type">sts</span></a></span></span><span>
</span><span id="line-723"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108727"><span class="hs-identifier hs-type">sts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/goblins-0.2.0.0/noopt/doc/html/goblins/src"><span class="hs-identifier hs-type">Goblin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108728"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108727"><span class="hs-identifier hs-type">sts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-724"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/goblins-0.2.0.0/noopt/doc/html/goblins/src"><span class="hs-identifier hs-type">SeedGoblin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108727"><span class="hs-identifier hs-type">sts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/goblins-0.2.0.0/noopt/doc/html/goblins/src"><span class="hs-identifier hs-type">SeedGoblin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108727"><span class="hs-identifier hs-type">sts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-726"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/goblins-0.2.0.0/noopt/doc/html/goblins/src"><span class="hs-identifier hs-type">GoblinData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108728"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-727"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108727"><span class="hs-identifier hs-type">sts</span></a></span><span>
</span><span id="line-728"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108727"><span class="hs-identifier hs-type">sts</span></a></span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/small-steps-0.1.0.0/noopt/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679108727"><span class="hs-identifier hs-type">sts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-730"></span><span id="tinkerWithSigGen"><span class="annot"><span class="annottext">tinkerWithSigGen :: GoblinData g -&gt; Environment sts -&gt; State sts -&gt; Gen (Signal sts)
</span><a href="Control.State.Transition.Generator.html#tinkerWithSigGen"><span class="hs-identifier hs-var hs-var">tinkerWithSigGen</span></a></span></span><span> </span><span id="local-6989586621679108726"><span class="annot"><span class="annottext">GoblinData g
</span><a href="#local-6989586621679108726"><span class="hs-identifier hs-var">gd</span></a></span></span><span> </span><span id="local-6989586621679108725"><span class="annot"><span class="annottext">Environment sts
</span><a href="#local-6989586621679108725"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621679108724"><span class="annot"><span class="annottext">State sts
</span><a href="#local-6989586621679108724"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(State (GoblinData g) (Gen (Signal sts))
 -&gt; GoblinData g -&gt; Gen (Signal sts))
-&gt; GoblinData g
-&gt; State (GoblinData g) (Gen (Signal sts))
-&gt; Gen (Signal sts)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">State (GoblinData g) (Gen (Signal sts))
-&gt; GoblinData g -&gt; Gen (Signal sts)
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="annot"><span class="annottext">GoblinData g
</span><a href="#local-6989586621679108726"><span class="hs-identifier hs-var">gd</span></a></span><span> </span><span class="annot"><span class="annottext">(State (GoblinData g) (Gen (Signal sts)) -&gt; Gen (Signal sts))
-&gt; State (GoblinData g) (Gen (Signal sts)) -&gt; Gen (Signal sts)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-731"></span><span>  </span><span class="annot"><span class="annottext">Environment sts -&gt; TinkerM g ()
forall a g. SeedGoblin a =&gt; a -&gt; TinkerM g ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/goblins-0.2.0.0/noopt/doc/html/goblins/src"><span class="hs-identifier hs-var">seeder</span></a></span><span> </span><span class="annot"><span class="annottext">Environment sts
</span><a href="#local-6989586621679108725"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TinkerM g () -&gt; TinkerM g () -&gt; TinkerM g ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">State sts -&gt; TinkerM g ()
forall a g. SeedGoblin a =&gt; a -&gt; TinkerM g ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/goblins-0.2.0.0/noopt/doc/html/goblins/src"><span class="hs-identifier hs-var">seeder</span></a></span><span> </span><span class="annot"><span class="annottext">State sts
</span><a href="#local-6989586621679108724"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">TinkerM g ()
-&gt; State (GoblinData g) (Gen (Signal sts))
-&gt; State (GoblinData g) (Gen (Signal sts))
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen (Signal sts) -&gt; State (GoblinData g) (Gen (Signal sts))
forall g a. Goblin g a =&gt; Gen a -&gt; TinkerM g (Gen a)
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/goblins-0.2.0.0/noopt/doc/html/goblins/src"><span class="hs-identifier hs-var">tinker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Environment sts -&gt; State sts -&gt; Gen (Signal sts)
forall s. HasTrace s =&gt; SignalGenerator s
</span><a href="Control.State.Transition.Generator.html#sigGen"><span class="hs-identifier hs-var">sigGen</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679108727"><span class="hs-identifier hs-type">sts</span></a></span><span> </span><span class="annot"><span class="annottext">Environment sts
</span><a href="#local-6989586621679108725"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">State sts
</span><a href="#local-6989586621679108724"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-732"></span></pre></body></html>