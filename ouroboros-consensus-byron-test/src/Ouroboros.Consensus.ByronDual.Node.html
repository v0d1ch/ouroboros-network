<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleInstances   #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns      #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards     #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ouroboros.Consensus.ByronDual.Node</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.ByronDual.Node.html#protocolInfoDualByron"><span class="hs-identifier">protocolInfoDualByron</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromRight</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Byron.Spec.Ledger.Core</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Spec</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Byron.Spec.Ledger.Delegation</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Spec</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Byron.Spec.Ledger.UTxO</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Spec</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Byron.Spec.Ledger.Update</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Spec</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Test.Cardano.Chain.Elaboration.Block</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Spec.Test</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Test.Cardano.Chain.Elaboration.Delegation</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Spec.Test</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Test.Cardano.Chain.Elaboration.Keys</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Spec.Test</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Test.Cardano.Chain.Elaboration.Update</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Spec.Test</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Test.Cardano.Chain.UTxO.Model</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Spec.Test</span></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Chain.Block</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Impl</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Chain.Genesis</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Impl</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Chain.UTxO</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Impl</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Chain.Update</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Impl</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Chain.Update.Validation.Interface</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Impl</span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.HeaderValidation</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Block</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Config</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Ledger.Abstract</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Ledger.Dual</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Ledger.Extended</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Mempool.TxLimits</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TxLimits</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Node.InitStorage</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Node.ProtocolInfo</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Node.Run</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.NodeId</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Protocol.PBFT</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Protocol.PBFT.State</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Storage.ChainDB.Init</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">InitChainDB</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Util</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-operator">(.....:)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-operator">(.:)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier">Ouroboros.Consensus.Byron.Ledger</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier">Ouroboros.Consensus.Byron.Node</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier">Ouroboros.Consensus.Byron.Protocol</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byronspec-0.1.0.0/noopt/doc/html/ouroboros-consensus-byronspec/src"><span class="hs-identifier">Ouroboros.Consensus.ByronSpec.Ledger</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byronspec-0.1.0.0/noopt/doc/html/ouroboros-consensus-byronspec/src"><span class="hs-identifier">Ouroboros.Consensus.ByronSpec.Ledger.Genesis</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Genesis</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.ByronDual.Ledger.html"><span class="hs-identifier">Ouroboros.Consensus.ByronDual.Ledger</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.ByronDual.Node.Serialisation.html"><span class="hs-identifier">Ouroboros.Consensus.ByronDual.Node.Serialisation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  BlockForging
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span id="local-6989586621679175548"><span class="annot"><a href="Ouroboros.Consensus.ByronDual.Node.html#dualByronBlockForging"><span class="hs-identifier hs-type">dualByronBlockForging</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679175548"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-type">ByronLeaderCredentials</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">BlockForging</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679175548"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.ByronDual.Ledger.html#DualByronBlock"><span class="hs-identifier hs-type">DualByronBlock</span></a></span></span><span>
</span><span id="line-69"></span><span id="dualByronBlockForging"><span class="annot"><span class="annottext">dualByronBlockForging :: ByronLeaderCredentials -&gt; BlockForging m DualByronBlock
</span><a href="Ouroboros.Consensus.ByronDual.Node.html#dualByronBlockForging"><span class="hs-identifier hs-var hs-var">dualByronBlockForging</span></a></span></span><span> </span><span id="local-6989586621679175451"><span class="annot"><span class="annottext">ByronLeaderCredentials
</span><a href="#local-6989586621679175451"><span class="hs-identifier hs-var">creds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockForging :: forall (m :: * -&gt; *) blk.
Text
-&gt; CanBeLeader (BlockProtocol blk)
-&gt; (TopLevelConfig blk
    -&gt; SlotNo
    -&gt; Ticked (ChainDepState (BlockProtocol blk))
    -&gt; m (ForgeStateUpdateInfo blk))
-&gt; (TopLevelConfig blk
    -&gt; SlotNo
    -&gt; Ticked (ChainDepState (BlockProtocol blk))
    -&gt; IsLeader (BlockProtocol blk)
    -&gt; ForgeStateInfo blk
    -&gt; Either (CannotForge blk) ())
-&gt; (TopLevelConfig blk
    -&gt; BlockNo
    -&gt; SlotNo
    -&gt; TickedLedgerState blk
    -&gt; [Validated (GenTx blk)]
    -&gt; IsLeader (BlockProtocol blk)
    -&gt; m blk)
-&gt; BlockForging m blk
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">BlockForging</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-70"></span><span>      </span><span class="annot"><span class="annottext">forgeLabel :: Text
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">forgeLabel</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679175448"><span class="hs-identifier hs-var">forgeLabel</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">canBeLeader :: CanBeLeader (BlockProtocol DualByronBlock)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">canBeLeader</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanBeLeader (BlockProtocol DualByronBlock)
CanBeLeader (BlockProtocol ByronBlock)
</span><a href="#local-6989586621679175446"><span class="hs-identifier hs-var">canBeLeader</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">updateForgeState :: TopLevelConfig DualByronBlock
-&gt; SlotNo
-&gt; Ticked (ChainDepState (BlockProtocol DualByronBlock))
-&gt; m (ForgeStateUpdateInfo DualByronBlock)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">updateForgeState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679175444"><span class="annot"><span class="annottext">TopLevelConfig DualByronBlock
</span><a href="#local-6989586621679175444"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-73"></span><span>        </span><span class="annot"><span class="annottext">(ForgeStateUpdateInfo ByronBlock
 -&gt; ForgeStateUpdateInfo DualByronBlock)
-&gt; m (ForgeStateUpdateInfo ByronBlock)
-&gt; m (ForgeStateUpdateInfo DualByronBlock)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">ForgeStateUpdateInfo ByronBlock
-&gt; ForgeStateUpdateInfo DualByronBlock
forall blk blk'.
(ForgeStateInfo blk ~ ForgeStateInfo blk',
 ForgeStateUpdateError blk ~ ForgeStateUpdateError blk') =&gt;
ForgeStateUpdateInfo blk -&gt; ForgeStateUpdateInfo blk'
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">castForgeStateUpdateInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(m (ForgeStateUpdateInfo ByronBlock)
 -&gt; m (ForgeStateUpdateInfo DualByronBlock))
-&gt; (SlotNo
    -&gt; Ticked (PBftState PBftByronCrypto)
    -&gt; m (ForgeStateUpdateInfo ByronBlock))
-&gt; SlotNo
-&gt; Ticked (PBftState PBftByronCrypto)
-&gt; m (ForgeStateUpdateInfo DualByronBlock)
forall y z x0 x1. (y -&gt; z) -&gt; (x0 -&gt; x1 -&gt; y) -&gt; x0 -&gt; x1 -&gt; z
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig ByronBlock
-&gt; SlotNo
-&gt; Ticked (ChainDepState (BlockProtocol ByronBlock))
-&gt; m (ForgeStateUpdateInfo ByronBlock)
</span><a href="#local-6989586621679175442"><span class="hs-identifier hs-var">updateForgeState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelConfig DualByronBlock -&gt; TopLevelConfig ByronBlock
forall m a. TopLevelConfig (DualBlock m a) -&gt; TopLevelConfig m
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualTopLevelConfigMain</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig DualByronBlock
</span><a href="#local-6989586621679175444"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">checkCanForge :: TopLevelConfig DualByronBlock
-&gt; SlotNo
-&gt; Ticked (ChainDepState (BlockProtocol DualByronBlock))
-&gt; IsLeader (BlockProtocol DualByronBlock)
-&gt; ForgeStateInfo DualByronBlock
-&gt; Either (CannotForge DualByronBlock) ()
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">checkCanForge</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopLevelConfig ByronBlock
-&gt; SlotNo
-&gt; Ticked (PBftState PBftByronCrypto)
-&gt; PBftIsLeader PBftByronCrypto
-&gt; ()
-&gt; Either (PBftCannotForge PBftByronCrypto) ()
TopLevelConfig ByronBlock
-&gt; SlotNo
-&gt; Ticked (ChainDepState (BlockProtocol ByronBlock))
-&gt; IsLeader (BlockProtocol ByronBlock)
-&gt; ForgeStateInfo ByronBlock
-&gt; Either (CannotForge ByronBlock) ()
</span><a href="#local-6989586621679175439"><span class="hs-identifier hs-var">checkCanForge</span></a></span><span> </span><span class="annot"><span class="annottext">(TopLevelConfig ByronBlock
 -&gt; SlotNo
 -&gt; Ticked (PBftState PBftByronCrypto)
 -&gt; PBftIsLeader PBftByronCrypto
 -&gt; ()
 -&gt; Either (PBftCannotForge PBftByronCrypto) ())
-&gt; (TopLevelConfig DualByronBlock -&gt; TopLevelConfig ByronBlock)
-&gt; TopLevelConfig DualByronBlock
-&gt; SlotNo
-&gt; Ticked (PBftState PBftByronCrypto)
-&gt; PBftIsLeader PBftByronCrypto
-&gt; ()
-&gt; Either (PBftCannotForge PBftByronCrypto) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TopLevelConfig DualByronBlock -&gt; TopLevelConfig ByronBlock
forall m a. TopLevelConfig (DualBlock m a) -&gt; TopLevelConfig m
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualTopLevelConfigMain</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forgeBlock :: TopLevelConfig DualByronBlock
-&gt; BlockNo
-&gt; SlotNo
-&gt; TickedLedgerState DualByronBlock
-&gt; [Validated (GenTx DualByronBlock)]
-&gt; IsLeader (BlockProtocol DualByronBlock)
-&gt; m DualByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">forgeBlock</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DualByronBlock -&gt; m DualByronBlock
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DualByronBlock -&gt; m DualByronBlock)
-&gt; (TopLevelConfig DualByronBlock
    -&gt; BlockNo
    -&gt; SlotNo
    -&gt; TickedLedgerState DualByronBlock
    -&gt; [Validated (GenTx DualByronBlock)]
    -&gt; PBftIsLeader PBftByronCrypto
    -&gt; DualByronBlock)
-&gt; TopLevelConfig DualByronBlock
-&gt; BlockNo
-&gt; SlotNo
-&gt; TickedLedgerState DualByronBlock
-&gt; [Validated (GenTx DualByronBlock)]
-&gt; PBftIsLeader PBftByronCrypto
-&gt; m DualByronBlock
forall y z x0 x1 x2 x3 x4 x5.
(y -&gt; z)
-&gt; (x0 -&gt; x1 -&gt; x2 -&gt; x3 -&gt; x4 -&gt; x5 -&gt; y)
-&gt; x0
-&gt; x1
-&gt; x2
-&gt; x3
-&gt; x4
-&gt; x5
-&gt; z
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-operator hs-var">.....:</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt;
TopLevelConfig DualByronBlock
-&gt; BlockNo
-&gt; SlotNo
-&gt; TickedLedgerState DualByronBlock
-&gt; [Validated (GenTx DualByronBlock)]
-&gt; PBftIsLeader PBftByronCrypto
-&gt; DualByronBlock
TopLevelConfig DualByronBlock
-&gt; BlockNo
-&gt; SlotNo
-&gt; TickedLedgerState DualByronBlock
-&gt; [Validated (GenTx DualByronBlock)]
-&gt; PBftIsLeader PBftByronCrypto
-&gt; DualByronBlock
</span><a href="Ouroboros.Consensus.ByronDual.Ledger.html#forgeDualByronBlock"><span class="hs-identifier hs-var">forgeDualByronBlock</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">BlockForging</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679175435"><span id="local-6989586621679175439"><span id="local-6989586621679175442"><span id="local-6989586621679175446"><span id="local-6989586621679175448"><span class="annot"><span class="annottext">CanBeLeader (BlockProtocol ByronBlock)
Text
TopLevelConfig ByronBlock
-&gt; SlotNo
-&gt; Ticked (ChainDepState (BlockProtocol ByronBlock))
-&gt; m (ForgeStateUpdateInfo ByronBlock)
TopLevelConfig ByronBlock
-&gt; SlotNo
-&gt; Ticked (ChainDepState (BlockProtocol ByronBlock))
-&gt; IsLeader (BlockProtocol ByronBlock)
-&gt; ForgeStateInfo ByronBlock
-&gt; Either (CannotForge ByronBlock) ()
TopLevelConfig ByronBlock
-&gt; BlockNo
-&gt; SlotNo
-&gt; TickedLedgerState ByronBlock
-&gt; [Validated (GenTx ByronBlock)]
-&gt; IsLeader (BlockProtocol ByronBlock)
-&gt; m ByronBlock
forgeBlock :: TopLevelConfig ByronBlock
-&gt; BlockNo
-&gt; SlotNo
-&gt; TickedLedgerState ByronBlock
-&gt; [Validated (GenTx ByronBlock)]
-&gt; IsLeader (BlockProtocol ByronBlock)
-&gt; m ByronBlock
forgeBlock :: forall (m :: * -&gt; *) blk.
BlockForging m blk
-&gt; TopLevelConfig blk
-&gt; BlockNo
-&gt; SlotNo
-&gt; TickedLedgerState blk
-&gt; [Validated (GenTx blk)]
-&gt; IsLeader (BlockProtocol blk)
-&gt; m blk
checkCanForge :: TopLevelConfig ByronBlock
-&gt; SlotNo
-&gt; Ticked (ChainDepState (BlockProtocol ByronBlock))
-&gt; IsLeader (BlockProtocol ByronBlock)
-&gt; ForgeStateInfo ByronBlock
-&gt; Either (CannotForge ByronBlock) ()
checkCanForge :: forall (m :: * -&gt; *) blk.
BlockForging m blk
-&gt; TopLevelConfig blk
-&gt; SlotNo
-&gt; Ticked (ChainDepState (BlockProtocol blk))
-&gt; IsLeader (BlockProtocol blk)
-&gt; ForgeStateInfo blk
-&gt; Either (CannotForge blk) ()
updateForgeState :: TopLevelConfig ByronBlock
-&gt; SlotNo
-&gt; Ticked (ChainDepState (BlockProtocol ByronBlock))
-&gt; m (ForgeStateUpdateInfo ByronBlock)
updateForgeState :: forall (m :: * -&gt; *) blk.
BlockForging m blk
-&gt; TopLevelConfig blk
-&gt; SlotNo
-&gt; Ticked (ChainDepState (BlockProtocol blk))
-&gt; m (ForgeStateUpdateInfo blk)
canBeLeader :: CanBeLeader (BlockProtocol ByronBlock)
canBeLeader :: forall (m :: * -&gt; *) blk.
BlockForging m blk -&gt; CanBeLeader (BlockProtocol blk)
forgeLabel :: Text
forgeLabel :: forall (m :: * -&gt; *) blk. BlockForging m blk -&gt; Text
</span><a href="#local-6989586621679175435"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>      </span><span class="annot"><span class="annottext">Overrides ByronBlock
-&gt; ByronLeaderCredentials -&gt; BlockForging m ByronBlock
forall (m :: * -&gt; *).
Monad m =&gt;
Overrides ByronBlock
-&gt; ByronLeaderCredentials -&gt; BlockForging m ByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-var">byronBlockForging</span></a></span><span>
</span><span id="line-80"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMeasure ByronBlock -&gt; Overrides ByronBlock
forall blk. TxMeasure blk -&gt; Overrides blk
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">TxLimits.mkOverrides</span></a></span><span> </span><span class="annot"><span class="annottext">TxMeasure ByronBlock
forall a. BoundedMeasure a =&gt; a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">TxLimits.noOverridesMeasure</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>        </span><span class="annot"><span class="annottext">ByronLeaderCredentials
</span><a href="#local-6989586621679175451"><span class="hs-identifier hs-var">creds</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  ProtocolInfo

  Partly modelled after 'applyTrace' in &quot;Test.Cardano.Chain.Block.Model&quot;.
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Ouroboros.Consensus.ByronDual.Node.html#protocolInfoDualByron"><span class="hs-identifier hs-type">protocolInfoDualByron</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679175431"><span class="annot"><a href="#local-6989586621679175431"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679175431"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-90"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byronspec-0.1.0.0/noopt/doc/html/ouroboros-consensus-byronspec/src"><span class="hs-identifier hs-type">ByronSpecGenesis</span></a></span><span>
</span><span id="line-91"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">PBftParams</span></a></span><span>
</span><span id="line-92"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Are we a core node?</span><span>
</span><span id="line-93"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ProtocolInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679175431"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.ByronDual.Ledger.html#DualByronBlock"><span class="hs-identifier hs-type">DualByronBlock</span></a></span><span>
</span><span id="line-94"></span><span id="protocolInfoDualByron"><span class="annot"><span class="annottext">protocolInfoDualByron :: ByronSpecGenesis
-&gt; PBftParams -&gt; [CoreNodeId] -&gt; ProtocolInfo m DualByronBlock
</span><a href="Ouroboros.Consensus.ByronDual.Node.html#protocolInfoDualByron"><span class="hs-identifier hs-var hs-var">protocolInfoDualByron</span></a></span></span><span> </span><span id="local-6989586621679175430"><span class="annot"><span class="annottext">abstractGenesis :: ByronSpecGenesis
</span><a href="#local-6989586621679175430"><span class="hs-identifier hs-var">abstractGenesis</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byronspec-0.1.0.0/noopt/doc/html/ouroboros-consensus-byronspec/src"><span class="hs-identifier hs-type">ByronSpecGenesis</span></a></span><span class="hs-special">{</span><span id="local-6989586621679175424"><span id="local-6989586621679175425"><span id="local-6989586621679175426"><span id="local-6989586621679175427"><span id="local-6989586621679175428"><span class="annot"><span class="annottext">Natural
Set VKeyGenesis
BlockCount
UTxO
PParams
byronSpecGenesisDelegators :: ByronSpecGenesis -&gt; Set VKeyGenesis
byronSpecGenesisInitUtxo :: ByronSpecGenesis -&gt; UTxO
byronSpecGenesisInitPParams :: ByronSpecGenesis -&gt; PParams
byronSpecGenesisSecurityParam :: ByronSpecGenesis -&gt; BlockCount
byronSpecGenesisSlotLength :: ByronSpecGenesis -&gt; Natural
byronSpecGenesisSlotLength :: Natural
byronSpecGenesisSecurityParam :: BlockCount
byronSpecGenesisInitPParams :: PParams
byronSpecGenesisInitUtxo :: UTxO
byronSpecGenesisDelegators :: Set VKeyGenesis
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byronspec-0.1.0.0/noopt/doc/html/ouroboros-consensus-byronspec/src"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679175418"><span class="annot"><span class="annottext">PBftParams
</span><a href="#local-6989586621679175418"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679175417"><span class="annot"><span class="annottext">[CoreNodeId]
</span><a href="#local-6989586621679175417"><span class="hs-identifier hs-var">credss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="annottext">ProtocolInfo :: forall (m :: * -&gt; *) b.
TopLevelConfig b
-&gt; ExtLedgerState b -&gt; m [BlockForging m b] -&gt; ProtocolInfo m b
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ProtocolInfo</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-96"></span><span>        </span><span class="annot"><span class="annottext">pInfoConfig :: TopLevelConfig DualByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">pInfoConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopLevelConfig :: forall blk.
ConsensusConfig (BlockProtocol blk)
-&gt; LedgerConfig blk
-&gt; BlockConfig blk
-&gt; CodecConfig blk
-&gt; StorageConfig blk
-&gt; TopLevelConfig blk
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">TopLevelConfig</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-97"></span><span>            </span><span class="annot"><span class="annottext">topLevelConfigProtocol :: ConsensusConfig (BlockProtocol DualByronBlock)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">topLevelConfigProtocol</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PBftConfig :: forall c. PBftParams -&gt; ConsensusConfig (PBft c)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">PBftConfig</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-98"></span><span>                </span><span class="annot"><span class="annottext">pbftParams :: PBftParams
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">pbftParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PBftParams
</span><a href="#local-6989586621679175418"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-99"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-100"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">topLevelConfigLedger :: LedgerConfig DualByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">topLevelConfigLedger</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DualLedgerConfig :: forall m a.
LedgerConfig m -&gt; LedgerConfig a -&gt; DualLedgerConfig m a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">DualLedgerConfig</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-101"></span><span>                </span><span class="annot"><span class="annottext">dualLedgerConfigMain :: LedgerConfig ByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualLedgerConfigMain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerConfig ByronBlock
Config
</span><a href="#local-6989586621679175407"><span class="hs-identifier hs-var">concreteGenesis</span></a></span><span>
</span><span id="line-102"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dualLedgerConfigAux :: LedgerConfig ByronSpecBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualLedgerConfigAux</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerConfig ByronSpecBlock
</span><a href="#local-6989586621679175405"><span class="hs-identifier hs-var">abstractConfig</span></a></span><span>
</span><span id="line-103"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-104"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">topLevelConfigBlock :: BlockConfig DualByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">topLevelConfigBlock</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DualBlockConfig :: forall m a.
BlockConfig m -&gt; BlockConfig a -&gt; BlockConfig (DualBlock m a)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">DualBlockConfig</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-105"></span><span>                </span><span class="annot"><span class="annottext">dualBlockConfigMain :: BlockConfig ByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualBlockConfigMain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockConfig ByronBlock
</span><a href="#local-6989586621679175401"><span class="hs-identifier hs-var">concreteConfig</span></a></span><span>
</span><span id="line-106"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dualBlockConfigAux :: BlockConfig ByronSpecBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualBlockConfigAux</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockConfig ByronSpecBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byronspec-0.1.0.0/noopt/doc/html/ouroboros-consensus-byronspec/src"><span class="hs-identifier hs-var">ByronSpecBlockConfig</span></a></span><span>
</span><span id="line-107"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-108"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">topLevelConfigCodec :: CodecConfig DualByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">topLevelConfigCodec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DualCodecConfig :: forall m a.
CodecConfig m -&gt; CodecConfig a -&gt; CodecConfig (DualBlock m a)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">DualCodecConfig</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-109"></span><span>                </span><span class="annot"><span class="annottext">dualCodecConfigMain :: CodecConfig ByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualCodecConfigMain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config -&gt; CodecConfig ByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-var">mkByronCodecConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679175407"><span class="hs-identifier hs-var">concreteGenesis</span></a></span><span>
</span><span id="line-110"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dualCodecConfigAux :: CodecConfig ByronSpecBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualCodecConfigAux</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodecConfig ByronSpecBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byronspec-0.1.0.0/noopt/doc/html/ouroboros-consensus-byronspec/src"><span class="hs-identifier hs-var">ByronSpecCodecConfig</span></a></span><span>
</span><span id="line-111"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-112"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">topLevelConfigStorage :: StorageConfig DualByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">topLevelConfigStorage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DualStorageConfig :: forall m a.
StorageConfig m -&gt; StorageConfig a -&gt; StorageConfig (DualBlock m a)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">DualStorageConfig</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-113"></span><span>                </span><span class="annot"><span class="annottext">dualStorageConfigMain :: StorageConfig ByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualStorageConfigMain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockConfig ByronBlock -&gt; StorageConfig ByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-var">ByronStorageConfig</span></a></span><span> </span><span class="annot"><span class="annottext">BlockConfig ByronBlock
</span><a href="#local-6989586621679175401"><span class="hs-identifier hs-var">concreteConfig</span></a></span><span>
</span><span id="line-114"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dualStorageConfigAux :: StorageConfig ByronSpecBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualStorageConfigAux</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StorageConfig ByronSpecBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byronspec-0.1.0.0/noopt/doc/html/ouroboros-consensus-byronspec/src"><span class="hs-identifier hs-var">ByronSpecStorageConfig</span></a></span><span>
</span><span id="line-115"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-116"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-117"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pInfoInitLedger :: ExtLedgerState DualByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">pInfoInitLedger</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExtLedgerState :: forall blk.
LedgerState blk -&gt; HeaderState blk -&gt; ExtLedgerState blk
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ExtLedgerState</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-118"></span><span>             </span><span class="annot"><span class="annottext">ledgerState :: LedgerState DualByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">ledgerState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DualLedgerState :: forall m a.
LedgerState m
-&gt; LedgerState a -&gt; BridgeLedger m a -&gt; LedgerState (DualBlock m a)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">DualLedgerState</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-119"></span><span>                 </span><span class="annot"><span class="annottext">dualLedgerStateMain :: LedgerState ByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualLedgerStateMain</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621679175381"><span class="hs-identifier hs-var">initConcreteState</span></a></span><span>
</span><span id="line-120"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dualLedgerStateAux :: LedgerState ByronSpecBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualLedgerStateAux</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerState ByronSpecBlock
</span><a href="#local-6989586621679175379"><span class="hs-identifier hs-var">initAbstractState</span></a></span><span>
</span><span id="line-121"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dualLedgerStateBridge :: BridgeLedger ByronBlock ByronSpecBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualLedgerStateBridge</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BridgeLedger ByronBlock ByronSpecBlock
</span><a href="#local-6989586621679175377"><span class="hs-identifier hs-var">initBridge</span></a></span><span>
</span><span id="line-122"></span><span>               </span><span class="hs-special">}</span><span>
</span><span id="line-123"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">headerState :: HeaderState DualByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">headerState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainDepState (BlockProtocol DualByronBlock)
-&gt; HeaderState DualByronBlock
forall blk. ChainDepState (BlockProtocol blk) -&gt; HeaderState blk
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">genesisHeaderState</span></a></span><span> </span><span class="annot"><span class="annottext">ChainDepState (BlockProtocol DualByronBlock)
forall c. PBftState c
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">S.empty</span></a></span><span>
</span><span id="line-124"></span><span>           </span><span class="hs-special">}</span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pInfoBlockForging :: m [BlockForging m DualByronBlock]
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">pInfoBlockForging</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-126"></span><span>           </span><span class="annot"><span class="annottext">[BlockForging m DualByronBlock]
-&gt; m [BlockForging m DualByronBlock]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([BlockForging m DualByronBlock]
 -&gt; m [BlockForging m DualByronBlock])
-&gt; [BlockForging m DualByronBlock]
-&gt; m [BlockForging m DualByronBlock]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByronLeaderCredentials -&gt; BlockForging m DualByronBlock
forall (m :: * -&gt; *).
Monad m =&gt;
ByronLeaderCredentials -&gt; BlockForging m DualByronBlock
</span><a href="Ouroboros.Consensus.ByronDual.Node.html#dualByronBlockForging"><span class="hs-identifier hs-var">dualByronBlockForging</span></a></span><span> </span><span class="annot"><span class="annottext">(ByronLeaderCredentials -&gt; BlockForging m DualByronBlock)
-&gt; (CoreNodeId -&gt; ByronLeaderCredentials)
-&gt; CoreNodeId
-&gt; BlockForging m DualByronBlock
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CoreNodeId -&gt; ByronLeaderCredentials
</span><a href="#local-6989586621679175372"><span class="hs-identifier hs-var">byronLeaderCredentials</span></a></span><span> </span><span class="annot"><span class="annottext">(CoreNodeId -&gt; BlockForging m DualByronBlock)
-&gt; [CoreNodeId] -&gt; [BlockForging m DualByronBlock]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[CoreNodeId]
</span><a href="#local-6989586621679175417"><span class="hs-identifier hs-var">credss</span></a></span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><a href="#local-6989586621679175370"><span class="hs-identifier hs-type">initUtxo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Impl.UTxO</span></span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><a href="#local-6989586621679175369"><span class="hs-identifier hs-type">txIdMap</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Spec.TxId</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Impl.TxId</span></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679175370"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679175370"><span class="hs-identifier hs-var">initUtxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679175369"><span class="annot"><span class="annottext">Map TxId TxId
</span><a href="#local-6989586621679175369"><span class="hs-identifier hs-var">txIdMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; (UTxO, Map TxId TxId)
</span><span class="hs-identifier hs-var">Spec.Test.elaborateInitialUTxO</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679175427"><span class="hs-identifier hs-var">byronSpecGenesisInitUtxo</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-comment">-- 'Spec.Test.abEnvToCfg' ignores the UTxO, because the Byron genesis</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-comment">-- data doesn't contain a UTxO, but only a 'UTxOConfiguration'.</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-comment">-- It also ignores the slot length (the Byron spec does not talk about</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-comment">-- slot lengths at all) so we have to set this ourselves.</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><a href="#local-6989586621679175407"><span class="hs-identifier hs-type">concreteGenesis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Impl.Config</span></span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679175407"><span class="annot"><span class="annottext">concreteGenesis :: Config
</span><a href="#local-6989586621679175407"><span class="hs-identifier hs-var hs-var">concreteGenesis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679175367"><span class="hs-identifier hs-var">translated</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-140"></span><span>          </span><span class="annot"><span class="annottext">configGenesisData :: GenesisData
</span><span class="hs-identifier hs-var">Impl.configGenesisData</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenesisData
</span><a href="#local-6989586621679175365"><span class="hs-identifier hs-var">configGenesisData</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-141"></span><span>              </span><span class="annot"><span class="annottext">gdProtocolParameters :: ProtocolParameters
</span><span class="hs-identifier hs-var">Impl.gdProtocolParameters</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProtocolParameters
</span><a href="#local-6989586621679175363"><span class="hs-identifier hs-var">protocolParameters</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-142"></span><span>                   </span><span class="annot"><span class="annottext">ppSlotDuration :: Natural
</span><span class="hs-identifier hs-var">Impl.ppSlotDuration</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679175424"><span class="hs-identifier hs-var">byronSpecGenesisSlotLength</span></a></span><span>
</span><span id="line-143"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-144"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-146"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>        </span><span id="local-6989586621679175367"><span class="annot"><span class="annottext">translated :: Config
</span><a href="#local-6989586621679175367"><span class="hs-identifier hs-var hs-var">translated</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Environment CHAIN -&gt; Config
</span><span class="hs-identifier hs-var">Spec.Test.abEnvToCfg</span></span><span> </span><span class="annot"><span class="annottext">(Environment CHAIN -&gt; Config) -&gt; Environment CHAIN -&gt; Config
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByronSpecGenesis -&gt; Environment CHAIN
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byronspec-0.1.0.0/noopt/doc/html/ouroboros-consensus-byronspec/src"><span class="hs-identifier hs-var">Genesis.toChainEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ByronSpecGenesis
</span><a href="#local-6989586621679175430"><span class="hs-identifier hs-var">abstractGenesis</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span id="local-6989586621679175365"><span class="annot"><span class="annottext">configGenesisData :: GenesisData
</span><a href="#local-6989586621679175365"><span class="hs-identifier hs-var hs-var">configGenesisData</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config -&gt; GenesisData
</span><span class="hs-identifier hs-var hs-var">Impl.configGenesisData</span></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679175367"><span class="hs-identifier hs-var">translated</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span id="local-6989586621679175363"><span class="annot"><span class="annottext">protocolParameters :: ProtocolParameters
</span><a href="#local-6989586621679175363"><span class="hs-identifier hs-var hs-var">protocolParameters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenesisData -&gt; ProtocolParameters
</span><span class="hs-identifier hs-var hs-var">Impl.gdProtocolParameters</span></span><span> </span><span class="annot"><span class="annottext">GenesisData
</span><a href="#local-6989586621679175365"><span class="hs-identifier hs-var">configGenesisData</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><a href="#local-6989586621679175379"><span class="hs-identifier hs-type">initAbstractState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">LedgerState</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byronspec-0.1.0.0/noopt/doc/html/ouroboros-consensus-byronspec/src"><span class="hs-identifier hs-type">ByronSpecBlock</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="#local-6989586621679175381"><span class="hs-identifier hs-type">initConcreteState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">LedgerState</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621679175379"><span class="annot"><span class="annottext">initAbstractState :: LedgerState ByronSpecBlock
</span><a href="#local-6989586621679175379"><span class="hs-identifier hs-var hs-var">initAbstractState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByronSpecGenesis -&gt; LedgerState ByronSpecBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byronspec-0.1.0.0/noopt/doc/html/ouroboros-consensus-byronspec/src"><span class="hs-identifier hs-var">initByronSpecLedgerState</span></a></span><span> </span><span class="annot"><span class="annottext">ByronSpecGenesis
</span><a href="#local-6989586621679175430"><span class="hs-identifier hs-var">abstractGenesis</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621679175381"><span class="annot"><span class="annottext">initConcreteState :: LedgerState ByronBlock
</span><a href="#local-6989586621679175381"><span class="hs-identifier hs-var hs-var">initConcreteState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config -&gt; Maybe UTxO -&gt; LedgerState ByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-var">initByronLedgerState</span></a></span><span>     </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679175407"><span class="hs-identifier hs-var">concreteGenesis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO -&gt; Maybe UTxO
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679175370"><span class="hs-identifier hs-var">initUtxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><a href="#local-6989586621679175405"><span class="hs-identifier hs-type">abstractConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">LedgerConfig</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byronspec-0.1.0.0/noopt/doc/html/ouroboros-consensus-byronspec/src"><span class="hs-identifier hs-type">ByronSpecBlock</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><a href="#local-6989586621679175401"><span class="hs-identifier hs-type">concreteConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">BlockConfig</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621679175405"><span class="annot"><span class="annottext">abstractConfig :: LedgerConfig ByronSpecBlock
</span><a href="#local-6989586621679175405"><span class="hs-identifier hs-var hs-var">abstractConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerConfig ByronSpecBlock
ByronSpecGenesis
</span><a href="#local-6989586621679175430"><span class="hs-identifier hs-var">abstractGenesis</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621679175401"><span class="annot"><span class="annottext">concreteConfig :: BlockConfig ByronBlock
</span><a href="#local-6989586621679175401"><span class="hs-identifier hs-var hs-var">concreteConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config
-&gt; ProtocolVersion -&gt; SoftwareVersion -&gt; BlockConfig ByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-var">mkByronConfig</span></a></span><span>
</span><span id="line-162"></span><span>                       </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679175407"><span class="hs-identifier hs-var">concreteGenesis</span></a></span><span>
</span><span id="line-163"></span><span>                       </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679175356"><span class="hs-identifier hs-var">protocolVersion</span></a></span><span>
</span><span id="line-164"></span><span>                       </span><span class="annot"><span class="annottext">SoftwareVersion
</span><a href="#local-6989586621679175355"><span class="hs-identifier hs-var">softwareVersion</span></a></span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-comment">-- TODO: Take (spec) protocol version and (spec) software version</span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-comment">-- as arguments instead, and then translate /those/ to Impl types.</span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-comment">-- &lt;https://github.com/input-output-hk/ouroboros-network/issues/1495&gt;</span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><a href="#local-6989586621679175356"><span class="hs-identifier hs-type">protocolVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Impl.ProtocolVersion</span></span><span>
</span><span id="line-170"></span><span>        </span><span id="local-6989586621679175356"><span class="annot"><span class="annottext">protocolVersion :: ProtocolVersion
</span><a href="#local-6989586621679175356"><span class="hs-identifier hs-var hs-var">protocolVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-171"></span><span>            </span><span class="annot"><span class="annottext">State -&gt; ProtocolVersion
</span><span class="hs-identifier hs-var hs-var">Impl.adoptedProtocolVersion</span></span><span> </span><span class="annot"><span class="annottext">(State -&gt; ProtocolVersion) -&gt; State -&gt; ProtocolVersion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-172"></span><span>              </span><span class="annot"><span class="annottext">ChainValidationState -&gt; State
</span><span class="hs-identifier hs-var hs-var">Impl.cvsUpdateState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LedgerState ByronBlock -&gt; ChainValidationState
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-var hs-var">byronLedgerState</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState ByronBlock
</span><a href="#local-6989586621679175381"><span class="hs-identifier hs-var">initConcreteState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-comment">-- The spec has a TODO about this; we just copy what 'elaborate' does</span><span>
</span><span id="line-175"></span><span>        </span><span class="hs-comment">-- (Test.Cardano.Chain.Elaboration.Block)</span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><a href="#local-6989586621679175355"><span class="hs-identifier hs-type">softwareVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Impl.SoftwareVersion</span></span><span>
</span><span id="line-177"></span><span>        </span><span id="local-6989586621679175355"><span class="annot"><span class="annottext">softwareVersion :: SoftwareVersion
</span><a href="#local-6989586621679175355"><span class="hs-identifier hs-var hs-var">softwareVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-178"></span><span>            </span><span class="annot"><span class="annottext">SwVer -&gt; SoftwareVersion
</span><span class="hs-identifier hs-var">Spec.Test.elaborateSoftwareVersion</span></span><span> </span><span class="annot"><span class="annottext">(SwVer -&gt; SoftwareVersion) -&gt; SwVer -&gt; SoftwareVersion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-179"></span><span>              </span><span class="annot"><span class="annottext">ApName -&gt; ApVer -&gt; SwVer
</span><span class="hs-identifier hs-var">Spec.SwVer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ApName
</span><span class="hs-identifier hs-var">Spec.ApName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; ApVer
</span><span class="hs-identifier hs-var">Spec.ApVer</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><a href="#local-6989586621679175377"><span class="hs-identifier hs-type">initBridge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.ByronDual.Ledger.html#DualByronBridge"><span class="hs-identifier hs-type">DualByronBridge</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679175377"><span class="annot"><span class="annottext">initBridge :: BridgeLedger ByronBlock ByronSpecBlock
</span><a href="#local-6989586621679175377"><span class="hs-identifier hs-var hs-var">initBridge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByronSpecGenesis -&gt; Map TxId TxId -&gt; ByronSpecBridge
</span><a href="Ouroboros.Consensus.ByronDual.Ledger.html#initByronSpecBridge"><span class="hs-identifier hs-var">initByronSpecBridge</span></a></span><span> </span><span class="annot"><span class="annottext">ByronSpecGenesis
</span><a href="#local-6989586621679175430"><span class="hs-identifier hs-var">abstractGenesis</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxId TxId
</span><a href="#local-6989586621679175369"><span class="hs-identifier hs-var">txIdMap</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><a href="#local-6989586621679175372"><span class="hs-identifier hs-type">byronLeaderCredentials</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-type">ByronLeaderCredentials</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621679175372"><span class="annot"><span class="annottext">byronLeaderCredentials :: CoreNodeId -&gt; ByronLeaderCredentials
</span><a href="#local-6989586621679175372"><span class="hs-identifier hs-var hs-var">byronLeaderCredentials</span></a></span></span><span> </span><span id="local-6989586621679175345"><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679175345"><span class="hs-identifier hs-var">nid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><span class="annottext">ByronLeaderCredentials
-&gt; Either ByronLeaderCredentialsError ByronLeaderCredentials
-&gt; ByronLeaderCredentials
forall b a. b -&gt; Either a b -&gt; b
</span><span class="hs-identifier hs-var">fromRight</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ByronLeaderCredentials
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;byronLeaderCredentials: failed to construct credentials&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either ByronLeaderCredentialsError ByronLeaderCredentials
 -&gt; ByronLeaderCredentials)
-&gt; Either ByronLeaderCredentialsError ByronLeaderCredentials
-&gt; ByronLeaderCredentials
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-187"></span><span>          </span><span class="annot"><span class="annottext">Config
-&gt; SigningKey
-&gt; Certificate
-&gt; Text
-&gt; Either ByronLeaderCredentialsError ByronLeaderCredentials
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-var">mkByronLeaderCredentials</span></a></span><span>
</span><span id="line-188"></span><span>            </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679175407"><span class="hs-identifier hs-var">concreteGenesis</span></a></span><span>
</span><span id="line-189"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VKey -&gt; SigningKey
</span><span class="hs-identifier hs-var">Spec.Test.vKeyToSKey</span></span><span> </span><span class="annot"><span class="annottext">VKey
</span><a href="#local-6989586621679175341"><span class="hs-identifier hs-var">vkey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProtocolMagicId -&gt; DCert -&gt; Certificate
</span><span class="hs-identifier hs-var">Spec.Test.elaborateDCert</span></span><span>
</span><span id="line-191"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; ProtocolMagicId
</span><span class="hs-identifier hs-var">Impl.configProtocolMagicId</span></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679175407"><span class="hs-identifier hs-var">concreteGenesis</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>               </span><span class="annot"><span class="annottext">DCert
</span><a href="#local-6989586621679175338"><span class="hs-identifier hs-var">abstractDCert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>            </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;byronLeaderCredentials&quot;</span></span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-comment">-- PBFT constructs the core node ID by the implicit ordering of</span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-comment">-- the hashes of the verification keys in the genesis config. Here</span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-comment">-- we go the other way, looking up this hash, and then using our</span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-comment">-- translation map to find the corresponding abstract key.</span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-comment">-- TODO: We should be able to use keys that are /not/ in genesis</span><span>
</span><span id="line-201"></span><span>        </span><span class="hs-comment">-- (so that we can start the node with new delegated keys that aren't</span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-comment">-- present in the genesis config).</span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-comment">-- &lt;https://github.com/input-output-hk/ouroboros-network/issues/1495&gt;</span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><a href="#local-6989586621679175337"><span class="hs-identifier hs-type">keyHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">PBftVerKeyHash</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-type">PBftByronCrypto</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span id="local-6989586621679175337"><span class="annot"><span class="annottext">keyHash :: PBftVerKeyHash PBftByronCrypto
</span><a href="#local-6989586621679175337"><span class="hs-identifier hs-var hs-var">keyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyHash -&gt; Maybe KeyHash -&gt; KeyHash
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span>
</span><span id="line-206"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; KeyHash
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; KeyHash) -&gt; String -&gt; KeyHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkCredentials: invalid &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CoreNodeId -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679175345"><span class="hs-identifier hs-var">nid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; CoreNodeId -&gt; Maybe KeyHash
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-var">nodeIdToGenesisKey</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679175407"><span class="hs-identifier hs-var">concreteGenesis</span></a></span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679175345"><span class="hs-identifier hs-var">nid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><a href="#local-6989586621679175341"><span class="hs-identifier hs-type">vkey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Spec.VKey</span></span><span>
</span><span id="line-210"></span><span>        </span><span id="local-6989586621679175341"><span class="annot"><span class="annottext">vkey :: VKey
</span><a href="#local-6989586621679175341"><span class="hs-identifier hs-var hs-var">vkey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BridgeLedger ByronBlock ByronSpecBlock
-&gt; PBftVerKeyHash PBftByronCrypto -&gt; VKey
</span><a href="Ouroboros.Consensus.ByronDual.Ledger.html#bridgeToSpecKey"><span class="hs-identifier hs-var">bridgeToSpecKey</span></a></span><span> </span><span class="annot"><span class="annottext">BridgeLedger ByronBlock ByronSpecBlock
</span><a href="#local-6989586621679175377"><span class="hs-identifier hs-var">initBridge</span></a></span><span> </span><span class="annot"><span class="annottext">PBftVerKeyHash PBftByronCrypto
</span><a href="#local-6989586621679175337"><span class="hs-identifier hs-var">keyHash</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><a href="#local-6989586621679175338"><span class="hs-identifier hs-type">abstractDCert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Spec.DCert</span></span><span>
</span><span id="line-213"></span><span>        </span><span id="local-6989586621679175338"><span class="annot"><span class="annottext">abstractDCert :: DCert
</span><a href="#local-6989586621679175338"><span class="hs-identifier hs-var hs-var">abstractDCert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; VKey -&gt; BlockCount -&gt; State CHAIN -&gt; DCert
VKey -&gt; BlockCount -&gt; State CHAIN -&gt; DCert
</span><span class="hs-identifier hs-var">Spec.Test.rcDCert</span></span><span>
</span><span id="line-214"></span><span>                          </span><span class="annot"><span class="annottext">VKey
</span><a href="#local-6989586621679175341"><span class="hs-identifier hs-var">vkey</span></a></span><span>
</span><span id="line-215"></span><span>                          </span><span class="annot"><span class="annottext">BlockCount
</span><a href="#local-6989586621679175425"><span class="hs-identifier hs-var">byronSpecGenesisSecurityParam</span></a></span><span>
</span><span id="line-216"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LedgerState ByronSpecBlock -&gt; State CHAIN
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byronspec-0.1.0.0/noopt/doc/html/ouroboros-consensus-byronspec/src"><span class="hs-identifier hs-var hs-var">byronSpecLedgerState</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState ByronSpecBlock
</span><a href="#local-6989586621679175379"><span class="hs-identifier hs-var">initAbstractState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  NodeInitStorage instance
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">NodeInitStorage</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.ByronDual.Ledger.html#DualByronBlock"><span class="hs-identifier hs-type">DualByronBlock</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-comment">-- Just like Byron, we need to start with an EBB</span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621679175327"><span class="annot"><span class="annottext">nodeInitChainDB :: StorageConfig DualByronBlock
-&gt; InitChainDB m DualByronBlock -&gt; m ()
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">nodeInitChainDB</span></a></span></span><span> </span><span id="local-6989586621679175325"><span class="annot"><span class="annottext">StorageConfig DualByronBlock
</span><a href="#local-6989586621679175325"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">InitChainDB</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679175323"><span class="annot"><span class="annottext">m (LedgerState DualByronBlock)
getCurrentLedger :: forall (m :: * -&gt; *) blk. InitChainDB m blk -&gt; m (LedgerState blk)
getCurrentLedger :: m (LedgerState DualByronBlock)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var">getCurrentLedger</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679175321"><span class="annot"><span class="annottext">DualByronBlock -&gt; m ()
addBlock :: forall (m :: * -&gt; *) blk. InitChainDB m blk -&gt; blk -&gt; m ()
addBlock :: DualByronBlock -&gt; m ()
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var">addBlock</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>      </span><span id="local-6989586621679175319"><span class="annot"><span class="annottext">Point DualByronBlock
</span><a href="#local-6989586621679175319"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Proxy DualByronBlock
-&gt; LedgerState DualByronBlock -&gt; Point DualByronBlock
forall blk.
UpdateLedger blk =&gt;
Proxy blk -&gt; LedgerState blk -&gt; Point blk
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">ledgerTipPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy DualByronBlock
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Ouroboros.Consensus.ByronDual.Ledger.html#DualByronBlock"><span class="hs-identifier hs-type">DualByronBlock</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LedgerState DualByronBlock -&gt; Point DualByronBlock)
-&gt; m (LedgerState DualByronBlock) -&gt; m (Point DualByronBlock)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m (LedgerState DualByronBlock)
</span><a href="#local-6989586621679175323"><span class="hs-identifier hs-var">getCurrentLedger</span></a></span><span>
</span><span id="line-226"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Point DualByronBlock
</span><a href="#local-6989586621679175319"><span class="hs-identifier hs-var">tip</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-type">BlockPoint</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><span class="annottext">Point DualByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">GenesisPoint</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DualByronBlock -&gt; m ()
</span><a href="#local-6989586621679175321"><span class="hs-identifier hs-var">addBlock</span></a></span><span> </span><span class="annot"><span class="annottext">DualByronBlock
</span><a href="#local-6989586621679175314"><span class="hs-identifier hs-var">genesisEBB</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>      </span><span class="annot"><a href="#local-6989586621679175314"><span class="hs-identifier hs-type">genesisEBB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.ByronDual.Ledger.html#DualByronBlock"><span class="hs-identifier hs-type">DualByronBlock</span></a></span><span>
</span><span id="line-231"></span><span>      </span><span id="local-6989586621679175314"><span class="annot"><span class="annottext">genesisEBB :: DualByronBlock
</span><a href="#local-6989586621679175314"><span class="hs-identifier hs-var hs-var">genesisEBB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DualBlock :: forall m a. m -&gt; Maybe a -&gt; BridgeBlock m a -&gt; DualBlock m a
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">DualBlock</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-232"></span><span>            </span><span class="annot"><span class="annottext">dualBlockMain :: ByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">dualBlockMain</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByronBlock
</span><a href="#local-6989586621679175311"><span class="hs-identifier hs-var">byronEBB</span></a></span><span>
</span><span id="line-233"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dualBlockAux :: Maybe ByronSpecBlock
</span><a href="#local-6989586621679175310"><span class="hs-identifier hs-var">dualBlockAux</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByronSpecBlock
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-234"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dualBlockBridge :: BridgeBlock ByronBlock ByronSpecBlock
</span><a href="#local-6989586621679175309"><span class="hs-identifier hs-var">dualBlockBridge</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BridgeBlock ByronBlock ByronSpecBlock
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-235"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><a href="#local-6989586621679175311"><span class="hs-identifier hs-type">byronEBB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-type">ByronBlock</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span id="local-6989586621679175311"><span class="annot"><span class="annottext">byronEBB :: ByronBlock
</span><a href="#local-6989586621679175311"><span class="hs-identifier hs-var hs-var">byronEBB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockConfig ByronBlock
-&gt; SlotNo -&gt; BlockNo -&gt; ChainHash ByronBlock -&gt; ByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-var">forgeEBB</span></a></span><span>
</span><span id="line-239"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageConfig ByronBlock -&gt; BlockConfig ByronBlock
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-byron-0.1.0.0/noopt/doc/html/ouroboros-consensus-byron/src"><span class="hs-identifier hs-var hs-var">getByronBlockConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageConfig DualByronBlock -&gt; StorageConfig ByronBlock
forall m a. StorageConfig (DualBlock m a) -&gt; StorageConfig m
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var">dualStorageConfigMain</span></a></span><span> </span><span class="annot"><span class="annottext">StorageConfig DualByronBlock
</span><a href="#local-6989586621679175325"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><span class="hs-identifier hs-var">SlotNo</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; BlockNo
</span><span class="hs-identifier hs-var">BlockNo</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>                   </span><span class="annot"><span class="annottext">ChainHash ByronBlock
forall b. ChainHash b
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-network-0.1.0.0/noopt/doc/html/ouroboros-network/src"><span class="hs-identifier hs-var">GenesisHash</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-comment">-- Node config is a consensus concern, determined by the main block only</span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621679175303"><span class="annot"><span class="annottext">nodeImmutableDbChunkInfo :: StorageConfig DualByronBlock -&gt; ChunkInfo
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">nodeImmutableDbChunkInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StorageConfig ByronBlock -&gt; ChunkInfo
forall blk. NodeInitStorage blk =&gt; StorageConfig blk -&gt; ChunkInfo
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">nodeImmutableDbChunkInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(StorageConfig ByronBlock -&gt; ChunkInfo)
-&gt; (StorageConfig DualByronBlock -&gt; StorageConfig ByronBlock)
-&gt; StorageConfig DualByronBlock
-&gt; ChunkInfo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StorageConfig DualByronBlock -&gt; StorageConfig ByronBlock
forall m a. StorageConfig (DualBlock m a) -&gt; StorageConfig m
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var">dualStorageConfigMain</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-comment">-- We don't really care too much about data loss or malicious behaviour for</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-comment">-- the dual ledger tests, so integrity and match checks can just use the</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-comment">-- concrete implementation</span><span>
</span><span id="line-250"></span><span>  </span><span id="local-6989586621679175301"><span class="annot"><span class="annottext">nodeCheckIntegrity :: StorageConfig DualByronBlock -&gt; DualByronBlock -&gt; Bool
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">nodeCheckIntegrity</span></a></span></span><span> </span><span id="local-6989586621679175299"><span class="annot"><span class="annottext">StorageConfig DualByronBlock
</span><a href="#local-6989586621679175299"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StorageConfig ByronBlock -&gt; ByronBlock -&gt; Bool
forall blk. NodeInitStorage blk =&gt; StorageConfig blk -&gt; blk -&gt; Bool
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">nodeCheckIntegrity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StorageConfig DualByronBlock -&gt; StorageConfig ByronBlock
forall m a. StorageConfig (DualBlock m a) -&gt; StorageConfig m
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var">dualStorageConfigMain</span></a></span><span> </span><span class="annot"><span class="annottext">StorageConfig DualByronBlock
</span><a href="#local-6989586621679175299"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByronBlock -&gt; Bool)
-&gt; (DualByronBlock -&gt; ByronBlock) -&gt; DualByronBlock -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DualByronBlock -&gt; ByronBlock
forall m a. DualBlock m a -&gt; m
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var">dualBlockMain</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  RunNode instance
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">BlockSupportsMetrics</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.ByronDual.Ledger.html#DualByronBlock"><span class="hs-identifier hs-type">DualByronBlock</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679175296"><span class="annot"><span class="annottext">isSelfIssued :: BlockConfig DualByronBlock
-&gt; Header DualByronBlock -&gt; WhetherSelfIssued
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">isSelfIssued</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockConfig DualByronBlock
-&gt; Header DualByronBlock -&gt; WhetherSelfIssued
forall blk. BlockConfig blk -&gt; Header blk -&gt; WhetherSelfIssued
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">isSelfIssuedConstUnknown</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">RunNode</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.ByronDual.Ledger.html#DualByronBlock"><span class="hs-identifier hs-type">DualByronBlock</span></a></span><span>
</span><span id="line-260"></span></pre></body></html>