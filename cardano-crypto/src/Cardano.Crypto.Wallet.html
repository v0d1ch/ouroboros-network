<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Cardano.Crypto.Wallet</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Description : HD Wallet routines</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : vincent@typed.io</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- This provides similar functionality to BIP32 but using</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Ed25519 arithmetic instead of P256K1 arithmethic.</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Key can be hierarchically derived from private key in two</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- fashions: Hardened or Normal.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- In the hardened scheme, the child secret key is not linearly</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- derived, so that the child public key has no way</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- to be efficiently computed from the parent public key.</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- The normal scheme allows anyone to derive public keys from</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- public key.</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE GADTs               #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators       #-}</span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric       #-}</span><span>
</span><span id="line-24"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms     #-}</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Crypto.Wallet</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier">ChainCode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationScheme"><span class="hs-identifier">DerivationScheme</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationIndex"><span class="hs-identifier">DerivationIndex</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#LatestScheme"><span class="hs-identifier">LatestScheme</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Extended Private &amp; Public types</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier">XPrv</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier">XPub</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier">XSignature</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#generate"><span class="hs-identifier">generate</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#generateNew"><span class="hs-identifier">generateNew</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xprv"><span class="hs-identifier">xprv</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xpub"><span class="hs-identifier">xpub</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xsignature"><span class="hs-identifier">xsignature</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#unXPrv"><span class="hs-identifier">unXPrv</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#unXPub"><span class="hs-identifier">unXPub</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#unXSignature"><span class="hs-identifier">unXSignature</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#toXPub"><span class="hs-identifier">toXPub</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xPubGetPublicKey"><span class="hs-identifier">xPubGetPublicKey</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xPrvChangePass"><span class="hs-identifier">xPrvChangePass</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Derivation function</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#deriveXPrv"><span class="hs-identifier">deriveXPrv</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#deriveXPub"><span class="hs-identifier">deriveXPub</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Signature &amp; Verification from extended types</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#sign"><span class="hs-identifier">sign</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#verify"><span class="hs-identifier">verify</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Basement.Compat.Typeable</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Crypto.Error</span></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwCryptoError</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CryptoFailable</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CryptoError</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.MAC.HMAC</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HMAC</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.Ed25519</span></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ed25519</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Crypto.KDF.PBKDF2</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fastPBKDF2_SHA512</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Parameters</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteArrayAccess</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">convert</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">append</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">length</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">splitAt</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BC</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Hashable</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html"><span class="hs-identifier">Cardano.Crypto.Wallet.Encrypted</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Crypto.Wallet.Pure.html"><span class="hs-identifier">Cardano.Crypto.Wallet.Pure</span></a></span><span>      </span><span class="hs-special">(</span><span class="hs-comment">{-XPub (..),-}</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Pure.html#hFinalize"><span class="hs-identifier">hFinalize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>                                                  </span><span class="annot"><a href="Cardano.Crypto.Wallet.Pure.html#hInitSeed"><span class="hs-identifier">hInitSeed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html"><span class="hs-identifier">Cardano.Crypto.Wallet.Types</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Stack</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">newtype</span><span> </span><span id="XPrv"><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="XPrv"><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679086774"><span class="annot"><span class="annottext">XPrv -&gt; ()
(XPrv -&gt; ()) -&gt; NFData XPrv
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: XPrv -&gt; ()
$crnf :: XPrv -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086767"><span id="local-6989586621679086769"><span id="local-6989586621679086771"><span class="annot"><span class="annottext">XPrv -&gt; Int
XPrv -&gt; Ptr p -&gt; IO ()
XPrv -&gt; (Ptr p -&gt; IO a) -&gt; IO a
(XPrv -&gt; Int)
-&gt; (forall p a. XPrv -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. XPrv -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess XPrv
forall p. XPrv -&gt; Ptr p -&gt; IO ()
forall ba.
(ba -&gt; Int)
-&gt; (forall p a. ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. ba -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess ba
forall p a. XPrv -&gt; (Ptr p -&gt; IO a) -&gt; IO a
copyByteArrayToPtr :: XPrv -&gt; Ptr p -&gt; IO ()
$ccopyByteArrayToPtr :: forall p. XPrv -&gt; Ptr p -&gt; IO ()
withByteArray :: XPrv -&gt; (Ptr p -&gt; IO a) -&gt; IO a
$cwithByteArray :: forall p a. XPrv -&gt; (Ptr p -&gt; IO a) -&gt; IO a
length :: XPrv -&gt; Int
$clength :: XPrv -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ByteArrayAccess</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span id="local-6989586621679086764"><span id="local-6989586621679086765"></span></span><span class="hs-keyword">data</span><span> </span><span id="XPub"><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-var">XPub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="XPub"><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-var">XPub</span></a></span></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="xpubPublicKey"><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="Cardano.Crypto.Wallet.html#xpubPublicKey"><span class="hs-identifier hs-var hs-var">xpubPublicKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="xpubChaincode"><span class="annot"><span class="annottext">XPub -&gt; ChainCode
</span><a href="Cardano.Crypto.Wallet.html#xpubChaincode"><span class="hs-identifier hs-var hs-var">xpubChaincode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679086757"><span id="local-6989586621679086759"><span class="annot"><span class="annottext">XPub -&gt; XPub -&gt; Bool
(XPub -&gt; XPub -&gt; Bool) -&gt; (XPub -&gt; XPub -&gt; Bool) -&gt; Eq XPub
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: XPub -&gt; XPub -&gt; Bool
$c/= :: XPub -&gt; XPub -&gt; Bool
== :: XPub -&gt; XPub -&gt; Bool
$c== :: XPub -&gt; XPub -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086750"><span id="local-6989586621679086752"><span id="local-6989586621679086754"><span class="annot"><span class="annottext">Int -&gt; XPub -&gt; ShowS
[XPub] -&gt; ShowS
XPub -&gt; String
(Int -&gt; XPub -&gt; ShowS)
-&gt; (XPub -&gt; String) -&gt; ([XPub] -&gt; ShowS) -&gt; Show XPub
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [XPub] -&gt; ShowS
$cshowList :: [XPub] -&gt; ShowS
show :: XPub -&gt; String
$cshow :: XPub -&gt; String
showsPrec :: Int -&gt; XPub -&gt; ShowS
$cshowsPrec :: Int -&gt; XPub -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086734"><span id="local-6989586621679086736"><span id="local-6989586621679086738"><span id="local-6989586621679086740"><span id="local-6989586621679086742"><span id="local-6989586621679086744"><span id="local-6989586621679086746"><span class="annot"><span class="annottext">Eq XPub
Eq XPub
-&gt; (XPub -&gt; XPub -&gt; Ordering)
-&gt; (XPub -&gt; XPub -&gt; Bool)
-&gt; (XPub -&gt; XPub -&gt; Bool)
-&gt; (XPub -&gt; XPub -&gt; Bool)
-&gt; (XPub -&gt; XPub -&gt; Bool)
-&gt; (XPub -&gt; XPub -&gt; XPub)
-&gt; (XPub -&gt; XPub -&gt; XPub)
-&gt; Ord XPub
XPub -&gt; XPub -&gt; Bool
XPub -&gt; XPub -&gt; Ordering
XPub -&gt; XPub -&gt; XPub
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: XPub -&gt; XPub -&gt; XPub
$cmin :: XPub -&gt; XPub -&gt; XPub
max :: XPub -&gt; XPub -&gt; XPub
$cmax :: XPub -&gt; XPub -&gt; XPub
&gt;= :: XPub -&gt; XPub -&gt; Bool
$c&gt;= :: XPub -&gt; XPub -&gt; Bool
&gt; :: XPub -&gt; XPub -&gt; Bool
$c&gt; :: XPub -&gt; XPub -&gt; Bool
&lt;= :: XPub -&gt; XPub -&gt; Bool
$c&lt;= :: XPub -&gt; XPub -&gt; Bool
&lt; :: XPub -&gt; XPub -&gt; Bool
$c&lt; :: XPub -&gt; XPub -&gt; Bool
compare :: XPub -&gt; XPub -&gt; Ordering
$ccompare :: XPub -&gt; XPub -&gt; Ordering
$cp1Ord :: Eq XPub
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. XPub -&gt; Rep XPub x)
-&gt; (forall x. Rep XPub x -&gt; XPub) -&gt; Generic XPub
forall x. Rep XPub x -&gt; XPub
forall x. XPub -&gt; Rep XPub x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep XPub x -&gt; XPub
$cfrom :: forall x. XPub -&gt; Rep XPub x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679086728"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span></span><span>
</span><span id="line-85"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679086724"><span id="local-6989586621679086726"><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span></span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">newtype</span><span> </span><span id="XSignature"><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-var">XSignature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="XSignature"><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-var">XSignature</span></a></span></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="unXSignature"><span class="annot"><span class="annottext">XSignature -&gt; ByteString
</span><a href="Cardano.Crypto.Wallet.html#unXSignature"><span class="hs-identifier hs-var hs-var">unXSignature</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679086716"><span id="local-6989586621679086718"><span id="local-6989586621679086720"><span class="annot"><span class="annottext">Int -&gt; XSignature -&gt; ShowS
[XSignature] -&gt; ShowS
XSignature -&gt; String
(Int -&gt; XSignature -&gt; ShowS)
-&gt; (XSignature -&gt; String)
-&gt; ([XSignature] -&gt; ShowS)
-&gt; Show XSignature
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [XSignature] -&gt; ShowS
$cshowList :: [XSignature] -&gt; ShowS
show :: XSignature -&gt; String
$cshow :: XSignature -&gt; String
showsPrec :: Int -&gt; XSignature -&gt; ShowS
$cshowsPrec :: Int -&gt; XSignature -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086712"><span id="local-6989586621679086714"><span class="annot"><span class="annottext">XSignature -&gt; XSignature -&gt; Bool
(XSignature -&gt; XSignature -&gt; Bool)
-&gt; (XSignature -&gt; XSignature -&gt; Bool) -&gt; Eq XSignature
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: XSignature -&gt; XSignature -&gt; Bool
$c/= :: XSignature -&gt; XSignature -&gt; Bool
== :: XSignature -&gt; XSignature -&gt; Bool
$c== :: XSignature -&gt; XSignature -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086697"><span id="local-6989586621679086699"><span id="local-6989586621679086701"><span id="local-6989586621679086703"><span id="local-6989586621679086705"><span id="local-6989586621679086707"><span id="local-6989586621679086709"><span class="annot"><span class="annottext">Eq XSignature
Eq XSignature
-&gt; (XSignature -&gt; XSignature -&gt; Ordering)
-&gt; (XSignature -&gt; XSignature -&gt; Bool)
-&gt; (XSignature -&gt; XSignature -&gt; Bool)
-&gt; (XSignature -&gt; XSignature -&gt; Bool)
-&gt; (XSignature -&gt; XSignature -&gt; Bool)
-&gt; (XSignature -&gt; XSignature -&gt; XSignature)
-&gt; (XSignature -&gt; XSignature -&gt; XSignature)
-&gt; Ord XSignature
XSignature -&gt; XSignature -&gt; Bool
XSignature -&gt; XSignature -&gt; Ordering
XSignature -&gt; XSignature -&gt; XSignature
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: XSignature -&gt; XSignature -&gt; XSignature
$cmin :: XSignature -&gt; XSignature -&gt; XSignature
max :: XSignature -&gt; XSignature -&gt; XSignature
$cmax :: XSignature -&gt; XSignature -&gt; XSignature
&gt;= :: XSignature -&gt; XSignature -&gt; Bool
$c&gt;= :: XSignature -&gt; XSignature -&gt; Bool
&gt; :: XSignature -&gt; XSignature -&gt; Bool
$c&gt; :: XSignature -&gt; XSignature -&gt; Bool
&lt;= :: XSignature -&gt; XSignature -&gt; Bool
$c&lt;= :: XSignature -&gt; XSignature -&gt; Bool
&lt; :: XSignature -&gt; XSignature -&gt; Bool
$c&lt; :: XSignature -&gt; XSignature -&gt; Bool
compare :: XSignature -&gt; XSignature -&gt; Ordering
$ccompare :: XSignature -&gt; XSignature -&gt; Ordering
$cp1Ord :: Eq XSignature
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086695"><span class="annot"><span class="annottext">XSignature -&gt; ()
(XSignature -&gt; ()) -&gt; NFData XSignature
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: XSignature -&gt; ()
$crnf :: XSignature -&gt; ()
</span><a href="#local-6989586621679086695"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086691"><span id="local-6989586621679086693"><span class="annot"><span class="annottext">Int -&gt; XSignature -&gt; Int
XSignature -&gt; Int
(Int -&gt; XSignature -&gt; Int)
-&gt; (XSignature -&gt; Int) -&gt; Hashable XSignature
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: XSignature -&gt; Int
$chash :: XSignature -&gt; Int
hashWithSalt :: Int -&gt; XSignature -&gt; Int
$chashWithSalt :: Int -&gt; XSignature -&gt; Int
</span><a href="#local-6989586621679086691"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086685"><span id="local-6989586621679086687"><span id="local-6989586621679086689"><span class="annot"><span class="annottext">XSignature -&gt; Int
XSignature -&gt; Ptr p -&gt; IO ()
XSignature -&gt; (Ptr p -&gt; IO a) -&gt; IO a
(XSignature -&gt; Int)
-&gt; (forall p a. XSignature -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. XSignature -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess XSignature
forall p. XSignature -&gt; Ptr p -&gt; IO ()
forall ba.
(ba -&gt; Int)
-&gt; (forall p a. ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. ba -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess ba
forall p a. XSignature -&gt; (Ptr p -&gt; IO a) -&gt; IO a
copyByteArrayToPtr :: XSignature -&gt; Ptr p -&gt; IO ()
$ccopyByteArrayToPtr :: forall p. XSignature -&gt; Ptr p -&gt; IO ()
withByteArray :: XSignature -&gt; (Ptr p -&gt; IO a) -&gt; IO a
$cwithByteArray :: forall p a. XSignature -&gt; (Ptr p -&gt; IO a) -&gt; IO a
length :: XSignature -&gt; Int
$clength :: XSignature -&gt; Int
</span><a href="#local-6989586621679086685"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ByteArrayAccess</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Generate a new XPrv</span><span>
</span><span id="line-92"></span><span class="hs-comment">--</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- The seed needs to be at least 32 bytes, otherwise an asynchronous error is thrown</span><span>
</span><span id="line-94"></span><span id="local-6989586621679086683"><span id="local-6989586621679086684"><span class="annot"><a href="Cardano.Crypto.Wallet.html#generate"><span class="hs-identifier hs-type">generate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679086684"><span class="hs-identifier hs-type">passPhrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679086683"><span class="hs-identifier hs-type">seed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679086683"><span class="hs-identifier hs-type">seed</span></a></span><span>
</span><span id="line-96"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679086684"><span class="hs-identifier hs-type">passPhrase</span></a></span><span>
</span><span id="line-97"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span></span></span><span>
</span><span id="line-98"></span><span id="generate"><span class="annot"><span class="annottext">generate :: seed -&gt; passPhrase -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#generate"><span class="hs-identifier hs-var hs-var">generate</span></a></span></span><span> </span><span id="local-6989586621679086682"><span class="annot"><span class="annottext">seed
</span><a href="#local-6989586621679086682"><span class="hs-identifier hs-var">seed</span></a></span></span><span> </span><span id="local-6989586621679086681"><span class="annot"><span class="annottext">passPhrase
</span><a href="#local-6989586621679086681"><span class="hs-identifier hs-var">passPhrase</span></a></span></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">seed -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">seed
</span><a href="#local-6989586621679086682"><span class="hs-identifier hs-var">seed</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; XPrv
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Wallet.generate: seed needs to be &gt;= 32 bytes, got : &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">seed -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">seed
</span><a href="#local-6989586621679086682"><span class="hs-identifier hs-var">seed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; XPrv
</span><a href="#local-6989586621679086677"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="#local-6989586621679086676"><span class="hs-identifier hs-type">phrase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679086676"><span class="annot"><span class="annottext">phrase :: Int -&gt; ByteString
</span><a href="#local-6989586621679086676"><span class="hs-identifier hs-var hs-var">phrase</span></a></span></span><span> </span><span id="local-6989586621679086675"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679086675"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Root Seed Chain &quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall bs. ByteArray bs =&gt; bs -&gt; bs -&gt; bs
</span><span class="hs-operator hs-var">`B.append`</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">BC.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679086675"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">-- repeatdly try to generate from a seed, if we reach 1000th iteration we just bail</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-comment">-- this should find a candidate after 2 tries on average</span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621679086677"><span class="annot"><span class="annottext">loop :: Int -&gt; XPrv
</span><a href="#local-6989586621679086677"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679086673"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679086673"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-108"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679086673"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; XPrv
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;internal error: Wallet.generate looping forever&quot;</span></span><span>
</span><span id="line-109"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-110"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; passPhrase -&gt; ChainCode -&gt; CryptoFailable EncryptedKey
forall passphrase secret cc.
(ByteArrayAccess passphrase, ByteArrayAccess secret,
 ByteArrayAccess cc) =&gt;
secret -&gt; passphrase -&gt; cc -&gt; CryptoFailable EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedCreate"><span class="hs-identifier hs-var">encryptedCreate</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086670"><span class="hs-identifier hs-var">iL</span></a></span><span> </span><span class="annot"><span class="annottext">passPhrase
</span><a href="#local-6989586621679086681"><span class="hs-identifier hs-var">passPhrase</span></a></span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679086669"><span class="hs-identifier hs-var">iR</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-111"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">CryptoPassed</span></span><span> </span><span id="local-6989586621679086667"><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679086667"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EncryptedKey -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679086667"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-112"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">CryptoFailed</span></span><span> </span><span id="local-6989586621679086665"><span class="annot"><span class="annottext">CryptoError
</span><a href="#local-6989586621679086665"><span class="hs-identifier hs-var">err</span></a></span></span><span>
</span><span id="line-113"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="#local-6989586621679086665"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError -&gt; CryptoError -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><span class="hs-identifier hs-var">CryptoError_SecretKeyStructureInvalid</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; XPrv
</span><a href="#local-6989586621679086677"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679086673"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; XPrv
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;internal error: Wallet.generate: got error from encryptedCreate&quot;</span></span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679086670"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086670"><span class="hs-identifier hs-var">iL</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086669"><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679086669"><span class="hs-identifier hs-var">iR</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context SHA512 -&gt; (ByteString, ChainCode)
</span><a href="Cardano.Crypto.Wallet.Pure.html#hFinalize"><span class="hs-identifier hs-var">hFinalize</span></a></span><span>
</span><span id="line-116"></span><span>                     </span><span class="annot"><span class="annottext">(Context SHA512 -&gt; (ByteString, ChainCode))
-&gt; Context SHA512 -&gt; (ByteString, ChainCode)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Context SHA512 -&gt; ByteString -&gt; Context SHA512)
-&gt; ByteString -&gt; Context SHA512 -&gt; Context SHA512
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Context SHA512 -&gt; ByteString -&gt; Context SHA512
forall message a.
(ByteArrayAccess message, HashAlgorithm a) =&gt;
Context a -&gt; message -&gt; Context a
</span><span class="hs-identifier hs-var">HMAC.update</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ByteString
</span><a href="#local-6989586621679086676"><span class="hs-identifier hs-var">phrase</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679086673"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>                     </span><span class="annot"><span class="annottext">(Context SHA512 -&gt; Context SHA512)
-&gt; Context SHA512 -&gt; Context SHA512
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">seed -&gt; Context SHA512
forall seed. ByteArrayAccess seed =&gt; seed -&gt; Context SHA512
</span><a href="Cardano.Crypto.Wallet.Pure.html#hInitSeed"><span class="hs-identifier hs-var">hInitSeed</span></a></span><span> </span><span class="annot"><span class="annottext">seed
</span><a href="#local-6989586621679086682"><span class="hs-identifier hs-var">seed</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Generate a new XPrv from an entropy seed</span><span>
</span><span id="line-120"></span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- The seed should be at least 16 bytes, although it is not enforced</span><span>
</span><span id="line-122"></span><span class="hs-comment">--</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- The passphrase encrypt the secret key in memory</span><span>
</span><span id="line-124"></span><span id="local-6989586621679086658"><span id="local-6989586621679086659"><span id="local-6989586621679086660"><span class="annot"><a href="Cardano.Crypto.Wallet.html#generateNew"><span class="hs-identifier hs-type">generateNew</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679086660"><span class="hs-identifier hs-type">keyPassPhrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679086659"><span class="hs-identifier hs-type">generationPassPhrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679086658"><span class="hs-identifier hs-type">seed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679086658"><span class="hs-identifier hs-type">seed</span></a></span><span>                 </span><span class="hs-comment">-- ^ Raw entropy used as source of randomness for this algorithm</span><span>
</span><span id="line-126"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679086659"><span class="hs-identifier hs-type">generationPassPhrase</span></a></span><span> </span><span class="hs-comment">-- ^ User chosen passphrase for the generation phase</span><span>
</span><span id="line-127"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679086660"><span class="hs-identifier hs-type">keyPassPhrase</span></a></span><span>        </span><span class="hs-comment">-- ^ Symmetric encryption key passphrase used for the in-memory security</span><span>
</span><span id="line-128"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span></span></span></span><span>
</span><span id="line-129"></span><span id="generateNew"><span class="annot"><span class="annottext">generateNew :: seed -&gt; generationPassPhrase -&gt; keyPassPhrase -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#generateNew"><span class="hs-identifier hs-var hs-var">generateNew</span></a></span></span><span> </span><span id="local-6989586621679086657"><span class="annot"><span class="annottext">seed
</span><a href="#local-6989586621679086657"><span class="hs-identifier hs-var">seed</span></a></span></span><span> </span><span id="local-6989586621679086656"><span class="annot"><span class="annottext">generationPassPhrase
</span><a href="#local-6989586621679086656"><span class="hs-identifier hs-var">genPassPhrase</span></a></span></span><span> </span><span id="local-6989586621679086655"><span class="annot"><span class="annottext">keyPassPhrase
</span><a href="#local-6989586621679086655"><span class="hs-identifier hs-var">memPassPhrase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="annottext">EncryptedKey -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span><span> </span><span class="annot"><span class="annottext">(EncryptedKey -&gt; XPrv) -&gt; EncryptedKey -&gt; XPrv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; keyPassPhrase -&gt; EncryptedKey
forall passphrase secret.
(ByteArrayAccess passphrase, ByteArrayAccess secret) =&gt;
secret -&gt; passphrase -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedCreateDirectWithTweak"><span class="hs-identifier hs-var">encryptedCreateDirectWithTweak</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086653"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">keyPassPhrase
</span><a href="#local-6989586621679086655"><span class="hs-identifier hs-var">memPassPhrase</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="#local-6989586621679086653"><span class="hs-identifier hs-type">out</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679086653"><span class="annot"><span class="annottext">out :: ByteString
</span><a href="#local-6989586621679086653"><span class="hs-identifier hs-var hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parameters -&gt; generationPassPhrase -&gt; seed -&gt; ByteString
forall password salt out.
(ByteArrayAccess password, ByteArrayAccess salt, ByteArray out) =&gt;
Parameters -&gt; password -&gt; salt -&gt; out
</span><span class="hs-identifier hs-var">fastPBKDF2_SHA512</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Parameters
</span><span class="hs-identifier hs-var">Parameters</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4096</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">96</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">generationPassPhrase
</span><a href="#local-6989586621679086656"><span class="hs-identifier hs-var">genPassPhrase</span></a></span><span> </span><span class="annot"><span class="annottext">seed
</span><a href="#local-6989586621679086657"><span class="hs-identifier hs-var">seed</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | Simple constructor</span><span>
</span><span id="line-136"></span><span id="local-6989586621679086651"><span class="annot"><a href="Cardano.Crypto.Wallet.html#xprv"><span class="hs-identifier hs-type">xprv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679086651"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679086651"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span></span><span>
</span><span id="line-137"></span><span id="xprv"><span class="annot"><span class="annottext">xprv :: bin -&gt; Either String XPrv
</span><a href="Cardano.Crypto.Wallet.html#xprv"><span class="hs-identifier hs-var hs-var">xprv</span></a></span></span><span> </span><span id="local-6989586621679086650"><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679086650"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><span class="annottext">Either String XPrv
-&gt; (EncryptedKey -&gt; Either String XPrv)
-&gt; Maybe EncryptedKey
-&gt; Either String XPrv
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Either String XPrv
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;error: xprv needs to be 128 bytes&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPrv -&gt; Either String XPrv
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(XPrv -&gt; Either String XPrv)
-&gt; (EncryptedKey -&gt; XPrv) -&gt; EncryptedKey -&gt; Either String XPrv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">EncryptedKey -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><span class="annottext">(Maybe EncryptedKey -&gt; Either String XPrv)
-&gt; Maybe EncryptedKey -&gt; Either String XPrv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedKey"><span class="hs-identifier hs-var">encryptedKey</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe EncryptedKey)
-&gt; ByteString -&gt; Maybe EncryptedKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">bin -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">convert</span></span><span> </span><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679086650"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#unXPrv"><span class="hs-identifier hs-type">unXPrv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-143"></span><span id="unXPrv"><span class="annot"><span class="annottext">unXPrv :: XPrv -&gt; ByteString
</span><a href="Cardano.Crypto.Wallet.html#unXPrv"><span class="hs-identifier hs-var hs-var">unXPrv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span id="local-6989586621679086646"><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679086646"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncryptedKey -&gt; ByteString
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#unEncryptedKey"><span class="hs-identifier hs-var">unEncryptedKey</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679086646"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xpub"><span class="hs-identifier hs-type">xpub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span>
</span><span id="line-146"></span><span id="xpub"><span class="annot"><span class="annottext">xpub :: ByteString -&gt; Either String XPub
</span><a href="Cardano.Crypto.Wallet.html#xpub"><span class="hs-identifier hs-var hs-var">xpub</span></a></span></span><span> </span><span id="local-6989586621679086644"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086644"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086644"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String XPub
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;error: xprv needs to be 64 bytes: got &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086644"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; bytes&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>         </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679086642"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086642"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086641"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086641"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
forall bs. ByteArray bs =&gt; Int -&gt; bs -&gt; (bs, bs)
</span><span class="hs-identifier hs-var">B.splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086644"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-150"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">XPub -&gt; Either String XPub
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; Either String XPub) -&gt; XPub -&gt; Either String XPub
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ChainCode -&gt; XPub
</span><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-var">XPub</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086642"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ChainCode
</span><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier hs-var">ChainCode</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ChainCode) -&gt; ByteString -&gt; ChainCode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">convert</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086641"><span class="hs-identifier hs-var">b2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#unXPub"><span class="hs-identifier hs-type">unXPub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-153"></span><span id="unXPub"><span class="annot"><span class="annottext">unXPub :: XPub -&gt; ByteString
</span><a href="Cardano.Crypto.Wallet.html#unXPub"><span class="hs-identifier hs-var hs-var">unXPub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span id="local-6989586621679086639"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086639"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span> </span><span id="local-6989586621679086638"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086638"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall bs. ByteArray bs =&gt; bs -&gt; bs -&gt; bs
</span><span class="hs-identifier hs-var">B.append</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086639"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086638"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xsignature"><span class="hs-identifier hs-type">xsignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-type">XSignature</span></a></span><span>
</span><span id="line-156"></span><span id="xsignature"><span class="annot"><span class="annottext">xsignature :: ByteString -&gt; Either String XSignature
</span><a href="Cardano.Crypto.Wallet.html#xsignature"><span class="hs-identifier hs-var hs-var">xsignature</span></a></span></span><span> </span><span id="local-6989586621679086637"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086637"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086637"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String XSignature
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;error: xsignature needs to be 64 bytes: got &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086637"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; bytes&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XSignature -&gt; Either String XSignature
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(XSignature -&gt; Either String XSignature)
-&gt; XSignature -&gt; Either String XSignature
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; XSignature
</span><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-var">XSignature</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086637"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | Generate extended public key from private key</span><span>
</span><span id="line-161"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#toXPub"><span class="hs-identifier hs-type">toXPub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span>
</span><span id="line-162"></span><span id="toXPub"><span class="annot"><span class="annottext">toXPub :: XPrv -&gt; XPub
</span><a href="Cardano.Crypto.Wallet.html#toXPub"><span class="hs-identifier hs-var hs-var">toXPub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span id="local-6989586621679086636"><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679086636"><span class="hs-identifier hs-var">ekey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ChainCode -&gt; XPub
</span><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-var">XPub</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086635"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ChainCode
</span><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier hs-var">ChainCode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086634"><span class="hs-identifier hs-var">cc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679086633"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086633"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
forall bs. ByteArray bs =&gt; Int -&gt; bs -&gt; (bs, bs)
</span><span class="hs-identifier hs-var">B.splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; (ByteString, ByteString))
-&gt; ByteString -&gt; (ByteString, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EncryptedKey -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">convert</span></span><span> </span><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679086636"><span class="hs-identifier hs-var">ekey</span></a></span><span>
</span><span id="line-164"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679086635"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086635"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086634"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086634"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
forall bs. ByteArray bs =&gt; Int -&gt; bs -&gt; (bs, bs)
</span><span class="hs-identifier hs-var">B.splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086633"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Return the Ed25519 public key associated with a XPub context</span><span>
</span><span id="line-167"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xPubGetPublicKey"><span class="hs-identifier hs-type">xPubGetPublicKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ed25519.PublicKey</span></span><span>
</span><span id="line-168"></span><span id="xPubGetPublicKey"><span class="annot"><span class="annottext">xPubGetPublicKey :: XPub -&gt; PublicKey
</span><a href="Cardano.Crypto.Wallet.html#xPubGetPublicKey"><span class="hs-identifier hs-var hs-var">xPubGetPublicKey</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span id="local-6989586621679086632"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086632"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="annottext">CryptoFailable PublicKey -&gt; PublicKey
forall a. CryptoFailable a -&gt; a
</span><span class="hs-identifier hs-var">throwCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable PublicKey -&gt; PublicKey)
-&gt; CryptoFailable PublicKey -&gt; PublicKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable PublicKey
forall ba. ByteArrayAccess ba =&gt; ba -&gt; CryptoFailable PublicKey
</span><span class="hs-identifier hs-var">Ed25519.publicKey</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086632"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span id="local-6989586621679086629"><span id="local-6989586621679086630"><span class="annot"><a href="Cardano.Crypto.Wallet.html#xPrvChangePass"><span class="hs-identifier hs-type">xPrvChangePass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679086630"><span class="hs-identifier hs-type">oldPassPhrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679086629"><span class="hs-identifier hs-type">newPassPhrase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679086630"><span class="hs-identifier hs-type">oldPassPhrase</span></a></span><span> </span><span class="hs-comment">-- ^ passphrase to decrypt the current encrypted key</span><span>
</span><span id="line-173"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679086629"><span class="hs-identifier hs-type">newPassPhrase</span></a></span><span> </span><span class="hs-comment">-- ^ new passphrase to use for the new encrypted key</span><span>
</span><span id="line-174"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span>
</span><span id="line-175"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span></span></span><span>
</span><span id="line-176"></span><span id="xPrvChangePass"><span class="annot"><span class="annottext">xPrvChangePass :: oldPassPhrase -&gt; newPassPhrase -&gt; XPrv -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#xPrvChangePass"><span class="hs-identifier hs-var hs-var">xPrvChangePass</span></a></span></span><span> </span><span id="local-6989586621679086628"><span class="annot"><span class="annottext">oldPassPhrase
</span><a href="#local-6989586621679086628"><span class="hs-identifier hs-var">oldPass</span></a></span></span><span> </span><span id="local-6989586621679086627"><span class="annot"><span class="annottext">newPassPhrase
</span><a href="#local-6989586621679086627"><span class="hs-identifier hs-var">newPass</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span id="local-6989586621679086626"><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679086626"><span class="hs-identifier hs-var">ekey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">EncryptedKey -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span><span> </span><span class="annot"><span class="annottext">(EncryptedKey -&gt; XPrv) -&gt; EncryptedKey -&gt; XPrv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">oldPassPhrase -&gt; newPassPhrase -&gt; EncryptedKey -&gt; EncryptedKey
forall oldPassPhrase newPassPhrase.
(ByteArrayAccess oldPassPhrase, ByteArrayAccess newPassPhrase) =&gt;
oldPassPhrase -&gt; newPassPhrase -&gt; EncryptedKey -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedChangePass"><span class="hs-identifier hs-var">encryptedChangePass</span></a></span><span> </span><span class="annot"><span class="annottext">oldPassPhrase
</span><a href="#local-6989586621679086628"><span class="hs-identifier hs-var">oldPass</span></a></span><span> </span><span class="annot"><span class="annottext">newPassPhrase
</span><a href="#local-6989586621679086627"><span class="hs-identifier hs-var">newPass</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679086626"><span class="hs-identifier hs-var">ekey</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Derive a child extended private key from an extended private key</span><span>
</span><span id="line-180"></span><span id="local-6989586621679086624"><span class="annot"><a href="Cardano.Crypto.Wallet.html#deriveXPrv"><span class="hs-identifier hs-type">deriveXPrv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679086624"><span class="hs-identifier hs-type">passPhrase</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationScheme"><span class="hs-identifier hs-type">DerivationScheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679086624"><span class="hs-identifier hs-type">passPhrase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span></span><span>
</span><span id="line-181"></span><span id="deriveXPrv"><span class="annot"><span class="annottext">deriveXPrv :: DerivationScheme -&gt; passPhrase -&gt; XPrv -&gt; Word32 -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#deriveXPrv"><span class="hs-identifier hs-var hs-var">deriveXPrv</span></a></span></span><span> </span><span id="local-6989586621679086623"><span class="annot"><span class="annottext">DerivationScheme
</span><a href="#local-6989586621679086623"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span id="local-6989586621679086622"><span class="annot"><span class="annottext">passPhrase
</span><a href="#local-6989586621679086622"><span class="hs-identifier hs-var">passPhrase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span id="local-6989586621679086621"><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679086621"><span class="hs-identifier hs-var">ekey</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679086620"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679086620"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">EncryptedKey -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DerivationScheme
-&gt; EncryptedKey -&gt; passPhrase -&gt; Word32 -&gt; EncryptedKey
forall passphrase.
ByteArrayAccess passphrase =&gt;
DerivationScheme
-&gt; EncryptedKey -&gt; passphrase -&gt; Word32 -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedDerivePrivate"><span class="hs-identifier hs-var">encryptedDerivePrivate</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="#local-6989586621679086623"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679086621"><span class="hs-identifier hs-var">ekey</span></a></span><span> </span><span class="annot"><span class="annottext">passPhrase
</span><a href="#local-6989586621679086622"><span class="hs-identifier hs-var">passPhrase</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679086620"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | Derive a child extended public key from an extended public key</span><span>
</span><span id="line-185"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#deriveXPub"><span class="hs-identifier hs-type">deriveXPub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationScheme"><span class="hs-identifier hs-type">DerivationScheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span>
</span><span id="line-186"></span><span id="deriveXPub"><span class="annot"><span class="annottext">deriveXPub :: DerivationScheme -&gt; XPub -&gt; Word32 -&gt; Maybe XPub
</span><a href="Cardano.Crypto.Wallet.html#deriveXPub"><span class="hs-identifier hs-var hs-var">deriveXPub</span></a></span></span><span> </span><span id="local-6989586621679086618"><span class="annot"><span class="annottext">DerivationScheme
</span><a href="#local-6989586621679086618"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span id="local-6989586621679086617"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086617"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span> </span><span id="local-6989586621679086616"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086616"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679086615"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679086615"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679086615"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0x80000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe XPub
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPub -&gt; Maybe XPub
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; Maybe XPub) -&gt; XPub -&gt; Maybe XPub
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ChainCode -&gt; XPub)
-&gt; (ByteString, ChainCode) -&gt; XPub
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ChainCode -&gt; XPub
</span><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-var">XPub</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString, ChainCode) -&gt; XPub)
-&gt; (ByteString, ChainCode) -&gt; XPub
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ChainCode)
-&gt; (ByteString, ByteString) -&gt; (ByteString, ChainCode)
forall (a :: Type -&gt; Type -&gt; Type) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ChainCode
</span><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier hs-var">ChainCode</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; (ByteString, ChainCode))
-&gt; (ByteString, ByteString) -&gt; (ByteString, ChainCode)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
-&gt; (ByteString, ByteString) -&gt; Word32 -&gt; (ByteString, ByteString)
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedDerivePublic"><span class="hs-identifier hs-var">encryptedDerivePublic</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="#local-6989586621679086618"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086617"><span class="hs-identifier hs-var">pub</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086616"><span class="hs-identifier hs-var">cc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679086615"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span id="local-6989586621679086611"><span id="local-6989586621679086612"><span class="annot"><a href="Cardano.Crypto.Wallet.html#sign"><span class="hs-identifier hs-type">sign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679086612"><span class="hs-identifier hs-type">passPhrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679086611"><span class="hs-identifier hs-type">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679086612"><span class="hs-identifier hs-type">passPhrase</span></a></span><span>
</span><span id="line-192"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span>
</span><span id="line-193"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679086611"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-194"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-type">XSignature</span></a></span></span></span><span>
</span><span id="line-195"></span><span id="sign"><span class="annot"><span class="annottext">sign :: passPhrase -&gt; XPrv -&gt; msg -&gt; XSignature
</span><a href="Cardano.Crypto.Wallet.html#sign"><span class="hs-identifier hs-var hs-var">sign</span></a></span></span><span> </span><span id="local-6989586621679086610"><span class="annot"><span class="annottext">passPhrase
</span><a href="#local-6989586621679086610"><span class="hs-identifier hs-var">passphrase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span id="local-6989586621679086609"><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679086609"><span class="hs-identifier hs-var">ekey</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679086608"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679086608"><span class="hs-identifier hs-var">ba</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; XSignature
</span><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-var">XSignature</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; XSignature) -&gt; ByteString -&gt; XSignature
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span id="local-6989586621679086606"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086606"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncryptedKey -&gt; passPhrase -&gt; msg -&gt; Signature
forall passphrase msg.
(ByteArrayAccess passphrase, ByteArrayAccess msg) =&gt;
EncryptedKey -&gt; passphrase -&gt; msg -&gt; Signature
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedSign"><span class="hs-identifier hs-var">encryptedSign</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679086609"><span class="hs-identifier hs-var">ekey</span></a></span><span> </span><span class="annot"><span class="annottext">passPhrase
</span><a href="#local-6989586621679086610"><span class="hs-identifier hs-var">passphrase</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679086608"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086606"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span id="local-6989586621679086604"><span class="annot"><a href="Cardano.Crypto.Wallet.html#verify"><span class="hs-identifier hs-type">verify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679086604"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679086604"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-type">XSignature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-199"></span><span id="verify"><span class="annot"><span class="annottext">verify :: XPub -&gt; msg -&gt; XSignature -&gt; Bool
</span><a href="Cardano.Crypto.Wallet.html#verify"><span class="hs-identifier hs-var hs-var">verify</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span id="local-6989586621679086603"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086603"><span class="hs-identifier hs-var">point</span></a></span></span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679086602"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679086602"><span class="hs-identifier hs-var">ba</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-type">XSignature</span></a></span><span> </span><span id="local-6989586621679086601"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086601"><span class="hs-keyword hs-var">signature</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679086600"><span class="annot"><span class="annottext">pub :: PublicKey
</span><a href="#local-6989586621679086600"><span class="hs-identifier hs-var hs-var">pub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoFailable PublicKey -&gt; PublicKey
forall a. CryptoFailable a -&gt; a
</span><span class="hs-identifier hs-var">throwCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable PublicKey -&gt; PublicKey)
-&gt; CryptoFailable PublicKey -&gt; PublicKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable PublicKey
forall ba. ByteArrayAccess ba =&gt; ba -&gt; CryptoFailable PublicKey
</span><span class="hs-identifier hs-var">Ed25519.publicKey</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086603"><span class="hs-identifier hs-var">point</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span id="local-6989586621679086599"><span class="annot"><span class="annottext">sig :: Signature
</span><a href="#local-6989586621679086599"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoFailable Signature -&gt; Signature
forall a. CryptoFailable a -&gt; a
</span><span class="hs-identifier hs-var">throwCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable Signature -&gt; Signature)
-&gt; CryptoFailable Signature -&gt; Signature
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable Signature
forall ba. ByteArrayAccess ba =&gt; ba -&gt; CryptoFailable Signature
</span><span class="hs-identifier hs-var">Ed25519.signature</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679086601"><span class="hs-keyword hs-var">signature</span></a></span><span>
</span><span id="line-202"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PublicKey -&gt; msg -&gt; Signature -&gt; Bool
forall ba.
ByteArrayAccess ba =&gt;
PublicKey -&gt; ba -&gt; Signature -&gt; Bool
</span><span class="hs-identifier hs-var">Ed25519.verify</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679086600"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679086602"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679086599"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-203"></span></pre></body></html>