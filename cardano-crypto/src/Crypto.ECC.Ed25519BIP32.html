<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables   #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds             #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures        #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators         #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies          #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications      #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances  #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts      #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds       #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes   #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds             #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE Rank2Types            #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns          #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE GADTs                 #-}</span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto.ECC.Ed25519BIP32</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Hash</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SHA512</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SHA256</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.MAC.HMAC</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html"><span class="hs-identifier">Crypto.Math.Edwards25519</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ED25519</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Type.Bool</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Type.Equality</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Unsafe.Coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafeCoerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Math.Bits.html"><span class="hs-identifier">Crypto.Math.Bits</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Math.Bytes.html"><span class="hs-identifier">Crypto.Math.Bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Bytes.html#Bytes"><span class="hs-identifier">Bytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Crypto.Math.Bytes.html"><span class="hs-identifier">Crypto.Math.Bytes</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bytes</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- | A Master secret is a 256 bits random quantity</span><span>
</span><span id="line-39"></span><span class="hs-keyword">type</span><span> </span><span id="MasterSecret"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MasterSecret"><span class="hs-identifier hs-var">MasterSecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Math.Bits.html#FBits"><span class="hs-identifier hs-type">FBits</span></a></span><span> </span><span class="annot"><span class="hs-number">256</span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | A child key is similar to the key in structure</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- except it has an additional annotation representing</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- the indexes for the hierarchy derivation indexes from</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- a base 'Key' (usually the root key)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">type</span><span> </span><span id="ChildKey"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChildKey"><span class="hs-identifier hs-var">ChildKey</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087078"><span class="annot"><a href="#local-6989586621679087078"><span class="hs-identifier hs-type">didxs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationHier"><span class="hs-identifier hs-type">DerivationHier</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- | A key is a 512 bit random value and a chaincode</span><span>
</span><span id="line-48"></span><span class="hs-comment">--</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- Left half need to have:</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- * Lowest 3 bits clear</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- * Highest bit clear</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- * Second highest bit set</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- * Third highest bit clear</span><span>
</span><span id="line-54"></span><span class="hs-comment">--</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- Right half doesn't have any particular structure.</span><span>
</span><span id="line-56"></span><span class="hs-keyword">type</span><span> </span><span id="Key"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Key"><span class="hs-identifier hs-var">Key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Bits.html#FBits"><span class="hs-identifier hs-type">FBits</span></a></span><span> </span><span class="annot"><span class="hs-number">256</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Bits.html#FBits"><span class="hs-identifier hs-type">FBits</span></a></span><span> </span><span class="annot"><span class="hs-number">256</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | A public part of a key</span><span>
</span><span id="line-59"></span><span class="hs-keyword">type</span><span> </span><span id="Public"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Public"><span class="hs-identifier hs-var">Public</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | A point is 1 bit of x sign and 255 bit of y coordinate (y's 256th bit is always 0)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">type</span><span> </span><span id="PointCompressed"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#PointCompressed"><span class="hs-identifier hs-var">PointCompressed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Math.Bits.html#FBits"><span class="hs-identifier hs-type">FBits</span></a></span><span> </span><span class="annot"><span class="hs-number">256</span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | A 256 bits chain code</span><span>
</span><span id="line-65"></span><span class="hs-keyword">newtype</span><span> </span><span id="ChainCode"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCode"><span class="hs-identifier hs-var">ChainCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ChainCode"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCode"><span class="hs-identifier hs-var">ChainCode</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unChainCode"><span class="annot"><span class="annottext">ChainCode -&gt; Bytes 32
</span><a href="Crypto.ECC.Ed25519BIP32.html#unChainCode"><span class="hs-identifier hs-var hs-var">unChainCode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Bytes.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087070"><span id="local-6989586621679087072"><span class="annot"><span class="annottext">ChainCode -&gt; ChainCode -&gt; Bool
(ChainCode -&gt; ChainCode -&gt; Bool)
-&gt; (ChainCode -&gt; ChainCode -&gt; Bool) -&gt; Eq ChainCode
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ChainCode -&gt; ChainCode -&gt; Bool
$c/= :: ChainCode -&gt; ChainCode -&gt; Bool
== :: ChainCode -&gt; ChainCode -&gt; Bool
$c== :: ChainCode -&gt; ChainCode -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | A n bits Digest</span><span>
</span><span id="line-69"></span><span class="hs-keyword">newtype</span><span> </span><span id="Hash"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Hash"><span class="hs-identifier hs-var">Hash</span></a></span></span><span> </span><span id="local-6989586621679087068"><span class="annot"><a href="#local-6989586621679087068"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Hash"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Hash"><span class="hs-identifier hs-var">Hash</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unHash"><span class="annot"><span class="annottext">Hash n -&gt; FBits n
</span><a href="Crypto.ECC.Ed25519BIP32.html#unHash"><span class="hs-identifier hs-var hs-var">unHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Bits.html#FBits"><span class="hs-identifier hs-type">FBits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087068"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087062"><span id="local-6989586621679087064"><span class="annot"><span class="annottext">Hash n -&gt; Hash n -&gt; Bool
(Hash n -&gt; Hash n -&gt; Bool)
-&gt; (Hash n -&gt; Hash n -&gt; Bool) -&gt; Eq (Hash n)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall (n :: Nat). Hash n -&gt; Hash n -&gt; Bool
/= :: Hash n -&gt; Hash n -&gt; Bool
$c/= :: forall (n :: Nat). Hash n -&gt; Hash n -&gt; Bool
== :: Hash n -&gt; Hash n -&gt; Bool
$c== :: forall (n :: Nat). Hash n -&gt; Hash n -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | A Serialized tag used during HMAC</span><span>
</span><span id="line-73"></span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Math.Bytes.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | Serialized Index</span><span>
</span><span id="line-76"></span><span class="hs-keyword">newtype</span><span> </span><span id="SerializedIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#SerializedIndex"><span class="hs-identifier hs-var">SerializedIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SerializedIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#SerializedIndex"><span class="hs-identifier hs-var">SerializedIndex</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Bytes.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087056"><span id="local-6989586621679087058"><span class="annot"><span class="annottext">SerializedIndex -&gt; SerializedIndex -&gt; Bool
(SerializedIndex -&gt; SerializedIndex -&gt; Bool)
-&gt; (SerializedIndex -&gt; SerializedIndex -&gt; Bool)
-&gt; Eq SerializedIndex
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SerializedIndex -&gt; SerializedIndex -&gt; Bool
$c/= :: SerializedIndex -&gt; SerializedIndex -&gt; Bool
== :: SerializedIndex -&gt; SerializedIndex -&gt; Bool
$c== :: SerializedIndex -&gt; SerializedIndex -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">type</span><span> </span><span id="HMAC_SHA512"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#HMAC_SHA512"><span class="hs-identifier hs-var">HMAC_SHA512</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Math.Bytes.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">data</span><span> </span><span id="DerivationType"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationType"><span class="hs-identifier hs-var">DerivationType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Hard"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Hard"><span class="hs-identifier hs-var">Hard</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Soft"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Soft"><span class="hs-identifier hs-var">Soft</span></a></span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">data</span><span> </span><span id="DerivationMaterial"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationMaterial"><span class="hs-identifier hs-var">DerivationMaterial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ChainCodeMaterial"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCodeMaterial"><span class="hs-identifier hs-var">ChainCodeMaterial</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="KeyMaterial"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#KeyMaterial"><span class="hs-identifier hs-var">KeyMaterial</span></a></span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">data</span><span> </span><span id="DerivationIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationIndex"><span class="hs-identifier hs-var">DerivationIndex</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087055"><span class="annot"><a href="#local-6989586621679087055"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationType"><span class="hs-identifier hs-type">DerivationType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087054"><span class="annot"><a href="#local-6989586621679087054"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DerivationIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationIndex"><span class="hs-identifier hs-var">DerivationIndex</span></a></span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">data</span><span> </span><span id="DerivationHier"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationHier"><span class="hs-identifier hs-var">DerivationHier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="%3A%3E"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#%3A%3E"><span class="hs-operator hs-var">(:&gt;)</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationHier"><span class="hs-identifier hs-type">DerivationHier</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="DerivationEnd"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationEnd"><span class="hs-identifier hs-var">DerivationEnd</span></a></span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">type</span><span> </span><span id="MaxHardIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MaxHardIndex"><span class="hs-identifier hs-var">MaxHardIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0xffffffff</span></span><span>
</span><span id="line-89"></span><span class="hs-keyword">type</span><span> </span><span id="MinHardIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MinHardIndex"><span class="hs-identifier hs-var">MinHardIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0x80000000</span></span><span>
</span><span id="line-90"></span><span class="hs-keyword">type</span><span> </span><span id="MaxSoftIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MaxSoftIndex"><span class="hs-identifier hs-var">MaxSoftIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MinHardIndex"><span class="hs-identifier hs-type">MinHardIndex</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">type</span><span> </span><span id="MinSoftIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MinSoftIndex"><span class="hs-identifier hs-var">MinSoftIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">data</span><span> </span><span id="ValidIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidIndex"><span class="hs-identifier hs-var">ValidIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679087190"><span id="IsValidIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#IsValidIndex"><span class="hs-identifier hs-var">IsValidIndex</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndex"><span class="hs-identifier hs-type">ValidDerivationIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087190"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:~:</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidIndex"><span class="hs-identifier hs-type">ValidIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087190"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-95"></span><span>    </span><span id="local-6989586621679087187"><span id="IsNotValidIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#IsNotValidIndex"><span class="hs-identifier hs-var">IsNotValidIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndex"><span class="hs-identifier hs-type">ValidDerivationIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087187"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:~:</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidIndex"><span class="hs-identifier hs-type">ValidIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087187"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">data</span><span> </span><span id="ValidHardIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidHardIndex"><span class="hs-identifier hs-var">ValidHardIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621679087180"><span id="IsValidHardIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#IsValidHardIndex"><span class="hs-identifier hs-var">IsValidHardIndex</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationHardIndex"><span class="hs-identifier hs-type">ValidDerivationHardIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087180"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:~:</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidHardIndex"><span class="hs-identifier hs-type">ValidHardIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087180"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621679087179"><span id="IsNotValidHardIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#IsNotValidHardIndex"><span class="hs-identifier hs-var">IsNotValidHardIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationHardIndex"><span class="hs-identifier hs-type">ValidDerivationHardIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087179"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:~:</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidHardIndex"><span class="hs-identifier hs-type">ValidHardIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087179"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-keyword">data</span><span> </span><span id="ValidSoftIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidSoftIndex"><span class="hs-identifier hs-var">ValidSoftIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679087172"><span id="IsValidSoftIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#IsValidSoftIndex"><span class="hs-identifier hs-var">IsValidSoftIndex</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationSoftIndex"><span class="hs-identifier hs-type">ValidDerivationSoftIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087172"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:~:</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidSoftIndex"><span class="hs-identifier hs-type">ValidSoftIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087172"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679087171"><span id="IsNotValidSoftIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#IsNotValidSoftIndex"><span class="hs-identifier hs-var">IsNotValidSoftIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationSoftIndex"><span class="hs-identifier hs-type">ValidDerivationSoftIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087171"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:~:</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidSoftIndex"><span class="hs-identifier hs-type">ValidSoftIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087171"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621679087044"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#getValidIndex"><span class="hs-identifier hs-type">getValidIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679087044"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679087044"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndex"><span class="hs-identifier hs-type">ValidDerivationIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087044"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:~:</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-106"></span><span id="getValidIndex"><span class="annot"><span class="annottext">getValidIndex :: Proxy n -&gt; Maybe (ValidDerivationIndex n :~: 'True)
</span><a href="Crypto.ECC.Ed25519BIP32.html#getValidIndex"><span class="hs-identifier hs-var hs-var">getValidIndex</span></a></span></span><span> </span><span id="local-6989586621679087042"><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087042"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; ValidIndex n
forall (n :: Nat). KnownNat n =&gt; Proxy n -&gt; ValidIndex n
</span><a href="Crypto.ECC.Ed25519BIP32.html#isValidIndex"><span class="hs-identifier hs-var">isValidIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087042"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-107"></span><span>                    </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#IsValidIndex"><span class="hs-identifier hs-type">IsValidIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ValidDerivationIndex n :~: 'True
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">('True :~: 'True) -&gt; Maybe ('True :~: 'True)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">'True :~: 'True
forall k (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span>
</span><span id="line-108"></span><span>                    </span><span class="annot"><span class="annottext">ValidIndex n
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ValidDerivationIndex n :~: 'True)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span id="local-6989586621679087202"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#isValidIndex"><span class="hs-identifier hs-type">isValidIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679087202"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679087202"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidIndex"><span class="hs-identifier hs-type">ValidIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087202"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-111"></span><span id="isValidIndex"><span class="annot"><span class="annottext">isValidIndex :: Proxy n -&gt; ValidIndex n
</span><a href="Crypto.ECC.Ed25519BIP32.html#isValidIndex"><span class="hs-identifier hs-var hs-var">isValidIndex</span></a></span></span><span> </span><span id="local-6989586621679087039"><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087039"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Proxy MinSoftIndex -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy MinSoftIndex
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MinSoftIndex"><span class="hs-identifier hs-type">MinSoftIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087039"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087039"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Proxy MaxHardIndex -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy MaxHardIndex
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MaxHardIndex"><span class="hs-identifier hs-type">MaxHardIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ValidDerivationIndex n :~: 'True) -&gt; ValidIndex n
forall (n :: Nat).
(ValidDerivationIndex n :~: 'True) -&gt; ValidIndex n
</span><a href="Crypto.ECC.Ed25519BIP32.html#IsValidIndex"><span class="hs-identifier hs-var">IsValidIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Any :~: Any) -&gt; (n &lt;=? MaxHardIndex) :~: 'True
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span> </span><span class="annot"><span class="annottext">Any :~: Any
forall k (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ValidDerivationIndex n :~: 'False) -&gt; ValidIndex n
forall (n :: Nat).
(ValidDerivationIndex n :~: 'False) -&gt; ValidIndex n
</span><a href="Crypto.ECC.Ed25519BIP32.html#IsNotValidIndex"><span class="hs-identifier hs-var">IsNotValidIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Any :~: Any) -&gt; (n &lt;=? MaxHardIndex) :~: 'False
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span> </span><span class="annot"><span class="annottext">Any :~: Any
forall k (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span id="local-6989586621679087034"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#getValidHardIndex"><span class="hs-identifier hs-type">getValidHardIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679087034"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679087034"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationHardIndex"><span class="hs-identifier hs-type">ValidDerivationHardIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087034"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:~:</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-117"></span><span id="getValidHardIndex"><span class="annot"><span class="annottext">getValidHardIndex :: Proxy n -&gt; Maybe (ValidDerivationHardIndex n :~: 'True)
</span><a href="Crypto.ECC.Ed25519BIP32.html#getValidHardIndex"><span class="hs-identifier hs-var hs-var">getValidHardIndex</span></a></span></span><span> </span><span id="local-6989586621679087032"><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087032"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; ValidHardIndex n
forall (n :: Nat). KnownNat n =&gt; Proxy n -&gt; ValidHardIndex n
</span><a href="Crypto.ECC.Ed25519BIP32.html#isValidHardIndex"><span class="hs-identifier hs-var">isValidHardIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087032"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-118"></span><span>                    </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#IsValidHardIndex"><span class="hs-identifier hs-type">IsValidHardIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ValidDerivationHardIndex n :~: 'True
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">('True :~: 'True) -&gt; Maybe ('True :~: 'True)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">'True :~: 'True
forall k (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span>
</span><span id="line-119"></span><span>                    </span><span class="annot"><span class="annottext">ValidHardIndex n
</span><span class="hs-identifier">_</span></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ValidDerivationHardIndex n :~: 'True)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span id="local-6989586621679087183"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#isValidHardIndex"><span class="hs-identifier hs-type">isValidHardIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679087183"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679087183"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidHardIndex"><span class="hs-identifier hs-type">ValidHardIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087183"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-122"></span><span id="isValidHardIndex"><span class="annot"><span class="annottext">isValidHardIndex :: Proxy n -&gt; ValidHardIndex n
</span><a href="Crypto.ECC.Ed25519BIP32.html#isValidHardIndex"><span class="hs-identifier hs-var hs-var">isValidHardIndex</span></a></span></span><span> </span><span id="local-6989586621679087030"><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087030"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Proxy MinHardIndex -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy MinHardIndex
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MinHardIndex"><span class="hs-identifier hs-type">MinHardIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087030"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087030"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Proxy MaxHardIndex -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy MaxHardIndex
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MaxHardIndex"><span class="hs-identifier hs-type">MaxHardIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ValidDerivationHardIndex n :~: 'True) -&gt; ValidHardIndex n
forall (n :: Nat).
(ValidDerivationHardIndex n :~: 'True) -&gt; ValidHardIndex n
</span><a href="Crypto.ECC.Ed25519BIP32.html#IsValidHardIndex"><span class="hs-identifier hs-var">IsValidHardIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Any :~: Any) -&gt; ValidDerivationHardIndex n :~: 'True
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span> </span><span class="annot"><span class="annottext">Any :~: Any
forall k (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ValidDerivationHardIndex n :~: 'False) -&gt; ValidHardIndex n
forall (n :: Nat).
(ValidDerivationHardIndex n :~: 'False) -&gt; ValidHardIndex n
</span><a href="Crypto.ECC.Ed25519BIP32.html#IsNotValidHardIndex"><span class="hs-identifier hs-var">IsNotValidHardIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Any :~: Any) -&gt; ValidDerivationHardIndex n :~: 'False
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span> </span><span class="annot"><span class="annottext">Any :~: Any
forall k (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span id="local-6989586621679087029"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#getValidSoftIndex"><span class="hs-identifier hs-type">getValidSoftIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679087029"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679087029"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationSoftIndex"><span class="hs-identifier hs-type">ValidDerivationSoftIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087029"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:~:</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-128"></span><span id="getValidSoftIndex"><span class="annot"><span class="annottext">getValidSoftIndex :: Proxy n -&gt; Maybe (ValidDerivationSoftIndex n :~: 'True)
</span><a href="Crypto.ECC.Ed25519BIP32.html#getValidSoftIndex"><span class="hs-identifier hs-var hs-var">getValidSoftIndex</span></a></span></span><span> </span><span id="local-6989586621679087027"><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087027"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; ValidSoftIndex n
forall (n :: Nat). KnownNat n =&gt; Proxy n -&gt; ValidSoftIndex n
</span><a href="Crypto.ECC.Ed25519BIP32.html#isValidSoftIndex"><span class="hs-identifier hs-var">isValidSoftIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087027"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-129"></span><span>                    </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#IsValidSoftIndex"><span class="hs-identifier hs-type">IsValidSoftIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ValidDerivationSoftIndex n :~: 'True
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">('True :~: 'True) -&gt; Maybe ('True :~: 'True)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">'True :~: 'True
forall k (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span>
</span><span id="line-130"></span><span>                    </span><span class="annot"><span class="annottext">ValidSoftIndex n
</span><span class="hs-identifier">_</span></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ValidDerivationSoftIndex n :~: 'True)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span id="local-6989586621679087175"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#isValidSoftIndex"><span class="hs-identifier hs-type">isValidSoftIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679087175"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679087175"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidSoftIndex"><span class="hs-identifier hs-type">ValidSoftIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087175"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-133"></span><span id="isValidSoftIndex"><span class="annot"><span class="annottext">isValidSoftIndex :: Proxy n -&gt; ValidSoftIndex n
</span><a href="Crypto.ECC.Ed25519BIP32.html#isValidSoftIndex"><span class="hs-identifier hs-var hs-var">isValidSoftIndex</span></a></span></span><span> </span><span id="local-6989586621679087025"><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087025"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Proxy MinSoftIndex -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy MinSoftIndex
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MinSoftIndex"><span class="hs-identifier hs-type">MinSoftIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087025"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="annot"><span class="annottext">Proxy n
</span><a href="#local-6989586621679087025"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Proxy 2147483647 -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy MaxSoftIndex
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MaxSoftIndex"><span class="hs-identifier hs-type">MaxSoftIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ValidDerivationSoftIndex n :~: 'True) -&gt; ValidSoftIndex n
forall (n :: Nat).
(ValidDerivationSoftIndex n :~: 'True) -&gt; ValidSoftIndex n
</span><a href="Crypto.ECC.Ed25519BIP32.html#IsValidSoftIndex"><span class="hs-identifier hs-var">IsValidSoftIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Any :~: Any) -&gt; (n &lt;=? 2147483647) :~: 'True
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span> </span><span class="annot"><span class="annottext">Any :~: Any
forall k (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ValidDerivationSoftIndex n :~: 'False) -&gt; ValidSoftIndex n
forall (n :: Nat).
(ValidDerivationSoftIndex n :~: 'False) -&gt; ValidSoftIndex n
</span><a href="Crypto.ECC.Ed25519BIP32.html#IsNotValidSoftIndex"><span class="hs-identifier hs-var">IsNotValidSoftIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Any :~: Any) -&gt; (n &lt;=? 2147483647) :~: 'False
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span> </span><span class="annot"><span class="annottext">Any :~: Any
forall k (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-keyword">type</span><span> </span><span id="ValidDerivationIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndex"><span class="hs-identifier hs-var">ValidDerivationIndex</span></a></span></span><span>     </span><span class="hs-special">(</span><span id="local-6989586621679087024"><span class="annot"><a href="#local-6989586621679087024"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MinSoftIndex"><span class="hs-identifier hs-type">MinSoftIndex</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=?</span></span><span> </span><span class="annot"><a href="#local-6989586621679087024"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679087024"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=?</span></span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MaxHardIndex"><span class="hs-identifier hs-type">MaxHardIndex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="hs-keyword">type</span><span> </span><span id="ValidDerivationHardIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationHardIndex"><span class="hs-identifier hs-var">ValidDerivationHardIndex</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087022"><span class="annot"><a href="#local-6989586621679087022"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MinHardIndex"><span class="hs-identifier hs-type">MinHardIndex</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=?</span></span><span> </span><span class="annot"><a href="#local-6989586621679087022"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679087022"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=?</span></span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MaxHardIndex"><span class="hs-identifier hs-type">MaxHardIndex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span class="hs-keyword">type</span><span> </span><span id="ValidDerivationSoftIndex"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationSoftIndex"><span class="hs-identifier hs-var">ValidDerivationSoftIndex</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087021"><span class="annot"><a href="#local-6989586621679087021"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MinSoftIndex"><span class="hs-identifier hs-type">MinSoftIndex</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=?</span></span><span> </span><span class="annot"><a href="#local-6989586621679087021"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679087021"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=?</span></span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#MaxSoftIndex"><span class="hs-identifier hs-type">MaxSoftIndex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="ValidDerivationIndexForType"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndexForType"><span class="hs-identifier hs-var">ValidDerivationIndexForType</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087020"><span class="annot"><a href="#local-6989586621679087020"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationType"><span class="hs-identifier hs-type">DerivationType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087019"><span class="annot"><a href="#local-6989586621679087019"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>    </span><span id="ValidDerivationIndexForType"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndexForType"><span class="hs-identifier hs-var">ValidDerivationIndexForType</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Hard"><span class="hs-identifier hs-type">Hard</span></a></span><span> </span><span id="local-6989586621679087018"><span class="annot"><a href="#local-6989586621679087018"><span class="hs-identifier hs-type hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationHardIndex"><span class="hs-identifier hs-type">ValidDerivationHardIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087018"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span id="ValidDerivationIndexForType"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndexForType"><span class="hs-identifier hs-var">ValidDerivationIndexForType</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Soft"><span class="hs-identifier hs-type">Soft</span></a></span><span> </span><span id="local-6989586621679087017"><span class="annot"><a href="#local-6989586621679087017"><span class="hs-identifier hs-type hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationSoftIndex"><span class="hs-identifier hs-type">ValidDerivationSoftIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087017"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="DerivationTag"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationTag"><span class="hs-identifier hs-var">DerivationTag</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087016"><span class="annot"><a href="#local-6989586621679087016"><span class="hs-identifier hs-type">ty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationType"><span class="hs-identifier hs-type">DerivationType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087015"><span class="annot"><a href="#local-6989586621679087015"><span class="hs-identifier hs-type">material</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationMaterial"><span class="hs-identifier hs-type">DerivationMaterial</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>    </span><span id="DerivationTag"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationTag"><span class="hs-identifier hs-var">DerivationTag</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Hard"><span class="hs-identifier hs-type">Hard</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#KeyMaterial"><span class="hs-identifier hs-type">KeyMaterial</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0x0</span></span><span>
</span><span id="line-148"></span><span>    </span><span id="DerivationTag"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationTag"><span class="hs-identifier hs-var">DerivationTag</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Hard"><span class="hs-identifier hs-type">Hard</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCodeMaterial"><span class="hs-identifier hs-type">ChainCodeMaterial</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0x1</span></span><span>
</span><span id="line-149"></span><span>    </span><span id="DerivationTag"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationTag"><span class="hs-identifier hs-var">DerivationTag</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Soft"><span class="hs-identifier hs-type">Soft</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#KeyMaterial"><span class="hs-identifier hs-type">KeyMaterial</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0x2</span></span><span>
</span><span id="line-150"></span><span>    </span><span id="DerivationTag"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationTag"><span class="hs-identifier hs-var">DerivationTag</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Soft"><span class="hs-identifier hs-type">Soft</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCodeMaterial"><span class="hs-identifier hs-type">ChainCodeMaterial</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0x3</span></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | Check if the left half is valid</span><span>
</span><span id="line-153"></span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#leftHalfValid"><span class="hs-identifier hs-type">leftHalfValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Bits.html#FBits"><span class="hs-identifier hs-type">FBits</span></a></span><span> </span><span class="annot"><span class="hs-number">256</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-154"></span><span id="leftHalfValid"><span class="annot"><span class="annottext">leftHalfValid :: FBits 256 -&gt; Bool
</span><a href="Crypto.ECC.Ed25519BIP32.html#leftHalfValid"><span class="hs-identifier hs-var hs-var">leftHalfValid</span></a></span></span><span> </span><span id="local-6989586621679087013"><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679087013"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: Type -&gt; Type). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FBits 256 -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679087013"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FBits 256 -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679087013"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FBits 256 -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679087013"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FBits 256 -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679087013"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">29</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FBits 256 -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679087013"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">28</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FBits 256 -&gt; Int -&gt; Bool
forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><span class="hs-identifier hs-var">testBit</span></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679087013"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">31</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-161"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#toPublic"><span class="hs-identifier hs-type">toPublic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Public"><span class="hs-identifier hs-type">Public</span></a></span><span>
</span><span id="line-164"></span><span id="toPublic"><span class="annot"><span class="annottext">toPublic :: Key -&gt; Public
</span><a href="Crypto.ECC.Ed25519BIP32.html#toPublic"><span class="hs-identifier hs-var hs-var">toPublic</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087009"><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679087009"><span class="hs-identifier hs-var">kl</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679087008"><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679087008"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FBits 256 -&gt; FBits 256
</span><a href="Crypto.ECC.Ed25519BIP32.html#kToPoint"><span class="hs-identifier hs-var">kToPoint</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679087009"><span class="hs-identifier hs-var">kl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679087008"><span class="hs-identifier hs-var">cc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#kToPoint"><span class="hs-identifier hs-type">kToPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Bits.html#FBits"><span class="hs-identifier hs-type">FBits</span></a></span><span> </span><span class="annot"><span class="hs-number">256</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span>
</span><span id="line-167"></span><span id="kToPoint"><span class="annot"><span class="annottext">kToPoint :: FBits 256 -&gt; FBits 256
</span><a href="Crypto.ECC.Ed25519BIP32.html#kToPoint"><span class="hs-identifier hs-var hs-var">kToPoint</span></a></span></span><span> </span><span id="local-6989586621679087006"><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679087006"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PointCompressed -&gt; FBits 256
</span><a href="Crypto.ECC.Ed25519BIP32.html#pointFromRepr"><span class="hs-identifier hs-var">pointFromRepr</span></a></span><span> </span><span class="annot"><span class="annottext">(PointCompressed -&gt; FBits 256) -&gt; PointCompressed -&gt; FBits 256
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Scalar -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#scalarToPoint"><span class="hs-identifier hs-var">ED25519.scalarToPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar
</span><a href="#local-6989586621679087003"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679087003"><span class="annot"><span class="annottext">r :: Scalar
</span><a href="#local-6989586621679087003"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bytes 32 -&gt; Scalar
</span><a href="Crypto.Math.Edwards25519.html#scalarP"><span class="hs-identifier hs-var">ED25519.scalarP</span></a></span><span> </span><span class="annot"><span class="annottext">(Bytes 32 -&gt; Scalar) -&gt; Bytes 32 -&gt; Scalar
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Endian -&gt; FBits 256 -&gt; Bytes (Div8 256)
forall (n :: Nat).
KnownNat n =&gt;
Endian -&gt; FBits n -&gt; Bytes (Div8 n)
</span><a href="Crypto.Math.Bytes.html#fromBits"><span class="hs-identifier hs-var">Bytes.fromBits</span></a></span><span> </span><span class="annot"><span class="annottext">Endian
</span><a href="Crypto.Math.Bytes.html#LittleEndian"><span class="hs-identifier hs-var">Bytes.LittleEndian</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679087006"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#pointAdd"><span class="hs-identifier hs-type">pointAdd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span>
</span><span id="line-171"></span><span id="pointAdd"><span class="annot"><span class="annottext">pointAdd :: FBits 256 -&gt; FBits 256 -&gt; FBits 256
</span><a href="Crypto.ECC.Ed25519BIP32.html#pointAdd"><span class="hs-identifier hs-var hs-var">pointAdd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PointCompressed -&gt; FBits 256
</span><a href="Crypto.ECC.Ed25519BIP32.html#pointFromRepr"><span class="hs-identifier hs-var">pointFromRepr</span></a></span><span> </span><span class="annot"><span class="annottext">(PointCompressed -&gt; FBits 256)
-&gt; (PointCompressed -&gt; PointCompressed)
-&gt; PointCompressed
-&gt; FBits 256
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((PointCompressed -&gt; PointCompressed)
 -&gt; PointCompressed -&gt; FBits 256)
-&gt; (PointCompressed -&gt; PointCompressed -&gt; PointCompressed)
-&gt; PointCompressed
-&gt; PointCompressed
-&gt; FBits 256
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>  </span><span class="annot"><span class="annottext">PointCompressed -&gt; PointCompressed -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#pointAdd"><span class="hs-identifier hs-var">ED25519.pointAdd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PointCompressed -&gt; PointCompressed -&gt; FBits 256)
-&gt; (FBits 256 -&gt; PointCompressed)
-&gt; FBits 256
-&gt; FBits 256
-&gt; FBits 256
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">FBits 256 -&gt; PointCompressed
</span><a href="Crypto.ECC.Ed25519BIP32.html#pointToRepr"><span class="hs-identifier hs-var">pointToRepr</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#pointToRepr"><span class="hs-identifier hs-type">pointToRepr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">ED25519.PointCompressed</span></a></span><span>
</span><span id="line-174"></span><span id="pointToRepr"><span class="annot"><span class="annottext">pointToRepr :: FBits 256 -&gt; PointCompressed
</span><a href="Crypto.ECC.Ed25519BIP32.html#pointToRepr"><span class="hs-identifier hs-var hs-var">pointToRepr</span></a></span></span><span> </span><span id="local-6989586621679086995"><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086995"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bytes 32 -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#pointCompressedP"><span class="hs-identifier hs-var">ED25519.pointCompressedP</span></a></span><span> </span><span class="annot"><span class="annottext">(Bytes 32 -&gt; PointCompressed) -&gt; Bytes 32 -&gt; PointCompressed
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Endian -&gt; FBits 256 -&gt; Bytes (Div8 256)
forall (n :: Nat).
KnownNat n =&gt;
Endian -&gt; FBits n -&gt; Bytes (Div8 n)
</span><a href="Crypto.Math.Bytes.html#fromBits"><span class="hs-identifier hs-var">Bytes.fromBits</span></a></span><span> </span><span class="annot"><span class="annottext">Endian
</span><a href="Crypto.Math.Bytes.html#LittleEndian"><span class="hs-identifier hs-var">Bytes.LittleEndian</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086995"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#pointFromRepr"><span class="hs-identifier hs-type">pointFromRepr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">ED25519.PointCompressed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span>
</span><span id="line-177"></span><span id="pointFromRepr"><span class="annot"><span class="annottext">pointFromRepr :: PointCompressed -&gt; FBits 256
</span><a href="Crypto.ECC.Ed25519BIP32.html#pointFromRepr"><span class="hs-identifier hs-var hs-var">pointFromRepr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-178"></span><span>      </span><span class="annot"><span class="annottext">Endian -&gt; Bytes 32 -&gt; FBits (32 * 8)
forall (n :: Nat). Endian -&gt; Bytes n -&gt; FBits (n * 8)
</span><a href="Crypto.Math.Bytes.html#toBits"><span class="hs-identifier hs-var">Bytes.toBits</span></a></span><span> </span><span class="annot"><span class="annottext">Endian
</span><a href="Crypto.Math.Bytes.html#LittleEndian"><span class="hs-identifier hs-var">Bytes.LittleEndian</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><span class="annottext">(Bytes 32 -&gt; FBits 256)
-&gt; (PointCompressed -&gt; Bytes 32) -&gt; PointCompressed -&gt; FBits 256
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PointCompressed -&gt; Bytes 32
</span><a href="Crypto.Math.Edwards25519.html#unPointCompressedP"><span class="hs-identifier hs-var">ED25519.unPointCompressedP</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="BitsToHashScheme"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#BitsToHashScheme"><span class="hs-identifier hs-var">BitsToHashScheme</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679086990"><span class="annot"><a href="#local-6989586621679086990"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>    </span><span id="BitsToHashScheme"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#BitsToHashScheme"><span class="hs-identifier hs-var">BitsToHashScheme</span></a></span></span><span> </span><span class="annot"><span class="hs-number">256</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.SHA256</span></span><span>
</span><span id="line-183"></span><span>    </span><span id="BitsToHashScheme"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#BitsToHashScheme"><span class="hs-identifier hs-var">BitsToHashScheme</span></a></span></span><span> </span><span class="annot"><span class="hs-number">512</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.SHA512</span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">type</span><span> </span><span id="ValidTag"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidTag"><span class="hs-identifier hs-var">ValidTag</span></a></span></span><span> </span><span id="local-6989586621679086988"><span class="annot"><a href="#local-6989586621679086988"><span class="hs-identifier hs-type">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679086988"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679086988"><span class="hs-identifier hs-type">tag</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | Compute the HMAC-SHA512 using the ChainCode as the key</span><span>
</span><span id="line-188"></span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#fcp"><span class="hs-identifier hs-type">fcp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679087100"><span class="annot"><a href="#local-6989586621679087100"><span class="hs-identifier hs-type">tag</span></a></span></span><span> </span><span id="local-6989586621679087101"><span class="annot"><a href="#local-6989586621679087101"><span class="hs-identifier hs-type">idx</span></a></span></span><span> </span><span id="local-6989586621679087104"><span class="annot"><a href="#local-6989586621679087104"><span class="hs-identifier hs-type">deriveType</span></a></span></span><span> </span><span id="local-6989586621679087103"><span class="annot"><a href="#local-6989586621679087103"><span class="hs-identifier hs-type">deriveMaterial</span></a></span></span><span>
</span><span id="line-189"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationTag"><span class="hs-identifier hs-type">DerivationTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087104"><span class="hs-identifier hs-type">deriveType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087103"><span class="hs-identifier hs-type">deriveMaterial</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679087101"><span class="hs-identifier hs-type">idx</span></a></span><span>
</span><span id="line-191"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationTag"><span class="hs-identifier hs-type">DerivationTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087104"><span class="hs-identifier hs-type">deriveType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087103"><span class="hs-identifier hs-type">deriveMaterial</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679087100"><span class="hs-identifier hs-type">tag</span></a></span><span>
</span><span id="line-192"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndex"><span class="hs-identifier hs-type">ValidDerivationIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087101"><span class="hs-identifier hs-type">idx</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-193"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndexForType"><span class="hs-identifier hs-type">ValidDerivationIndexForType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087104"><span class="hs-identifier hs-type">deriveType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087101"><span class="hs-identifier hs-type">idx</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-194"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679087103"><span class="hs-identifier hs-type">deriveMaterial</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679087104"><span class="hs-identifier hs-type">deriveType</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679087101"><span class="hs-identifier hs-type">idx</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationIndex"><span class="hs-identifier hs-type">DerivationIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087104"><span class="hs-identifier hs-type">deriveType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087101"><span class="hs-identifier hs-type">idx</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#HMAC_SHA512"><span class="hs-identifier hs-type">HMAC_SHA512</span></a></span><span>
</span><span id="line-202"></span><span id="fcp"><span class="annot"><span class="annottext">fcp :: Proxy deriveMaterial
-&gt; Proxy deriveType
-&gt; Proxy idx
-&gt; ChainCode
-&gt; DerivationIndex deriveType idx
-&gt; [Word8]
-&gt; HMAC_SHA512
</span><a href="Crypto.ECC.Ed25519BIP32.html#fcp"><span class="hs-identifier hs-var hs-var">fcp</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy deriveMaterial
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Proxy deriveType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679086986"><span class="annot"><span class="annottext">Proxy idx
</span><a href="#local-6989586621679086986"><span class="hs-identifier hs-var">pidx</span></a></span></span><span> </span><span id="local-6989586621679086985"><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679086985"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivationIndex deriveType idx
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679086984"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679086984"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">Bytes 32 -&gt; Bytes n -&gt; HMAC_SHA512
forall (keyLength :: Nat) (input :: Nat).
Bytes keyLength -&gt; Bytes input -&gt; HMAC_SHA512
</span><a href="Crypto.ECC.Ed25519BIP32.html#hmacSHA512"><span class="hs-identifier hs-var">hmacSHA512</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 32
</span><a href="#local-6989586621679086982"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">(forall (n :: Nat). KnownNat n =&gt; Bytes n -&gt; HMAC_SHA512)
-&gt; [Word8] -&gt; HMAC_SHA512
forall a.
(forall (n :: Nat). KnownNat n =&gt; Bytes n -&gt; a) -&gt; [Word8] -&gt; a
</span><a href="Crypto.Math.Bytes.html#packSome"><span class="hs-operator hs-var">`Bytes.packSome`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bytes 1 -&gt; [Word8]
forall (n :: Nat). Bytes n -&gt; [Word8]
</span><a href="Crypto.Math.Bytes.html#unpack"><span class="hs-identifier hs-var hs-var">Bytes.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 1
</span><a href="#local-6989586621679086979"><span class="hs-identifier hs-var">tagValue</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; [Word8] -&gt; [Word8]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679086984"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; [Word8] -&gt; [Word8]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Bytes 4 -&gt; [Word8]
forall (n :: Nat). Bytes n -&gt; [Word8]
</span><a href="Crypto.Math.Bytes.html#unpack"><span class="hs-identifier hs-var hs-var">Bytes.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 4
</span><a href="#local-6989586621679086978"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621679086982"><span class="annot"><span class="annottext">key :: Bytes 32
</span><a href="#local-6989586621679086982"><span class="hs-identifier hs-var hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainCode -&gt; Bytes 32
</span><a href="Crypto.ECC.Ed25519BIP32.html#unChainCode"><span class="hs-identifier hs-var hs-var">unChainCode</span></a></span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679086985"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#SerializedIndex"><span class="hs-identifier hs-type">SerializedIndex</span></a></span><span> </span><span id="local-6989586621679086978"><span class="annot"><span class="annottext">Bytes 4
</span><a href="#local-6989586621679086978"><span class="hs-identifier hs-var">idx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy idx -&gt; SerializedIndex
forall (idx :: Nat).
(KnownNat idx, ValidDerivationIndex idx ~ 'True) =&gt;
Proxy idx -&gt; SerializedIndex
</span><a href="Crypto.ECC.Ed25519BIP32.html#indexSerialized"><span class="hs-identifier hs-var">indexSerialized</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy idx
</span><a href="#local-6989586621679086986"><span class="hs-identifier hs-var">pidx</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><a href="#local-6989586621679086979"><span class="hs-identifier hs-type">tagValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span id="local-6989586621679086979"><span class="annot"><span class="annottext">tagValue :: Bytes 1
</span><a href="#local-6989586621679086979"><span class="hs-identifier hs-var hs-var">tagValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; Bytes 1
forall (n :: Nat). KnownNat n =&gt; [Word8] -&gt; Bytes n
</span><a href="Crypto.Math.Bytes.html#pack"><span class="hs-identifier hs-var">Bytes.pack</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Word8) -&gt; Integer -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy tag -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy tag
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679087100"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span id="local-6989586621679087141"><span id="local-6989586621679087142"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#hmacSHA512"><span class="hs-identifier hs-type">hmacSHA512</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Bytes.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087142"><span class="hs-identifier hs-type">keyLength</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Bytes.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087141"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#HMAC_SHA512"><span class="hs-identifier hs-type">HMAC_SHA512</span></a></span></span></span><span>
</span><span id="line-213"></span><span id="hmacSHA512"><span class="annot"><span class="annottext">hmacSHA512 :: Bytes keyLength -&gt; Bytes input -&gt; HMAC_SHA512
</span><a href="Crypto.ECC.Ed25519BIP32.html#hmacSHA512"><span class="hs-identifier hs-var hs-var">hmacSHA512</span></a></span></span><span> </span><span id="local-6989586621679086975"><span class="annot"><span class="annottext">Bytes keyLength
</span><a href="#local-6989586621679086975"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-comment">{-Bytes.trace &quot;hmac-input&quot; -&gt;-}</span><span> </span><span id="local-6989586621679086974"><span class="annot"><span class="annottext">Bytes input
</span><a href="#local-6989586621679086974"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">[Word8] -&gt; HMAC_SHA512
forall (n :: Nat). KnownNat n =&gt; [Word8] -&gt; Bytes n
</span><a href="Crypto.Math.Bytes.html#pack"><span class="hs-identifier hs-var">Bytes.pack</span></a></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; HMAC_SHA512) -&gt; [Word8] -&gt; HMAC_SHA512
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Digest SHA512 -&gt; [Word8]
forall a. ByteArrayAccess a =&gt; a -&gt; [Word8]
</span><span class="hs-identifier hs-var">B.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Digest SHA512 -&gt; [Word8]) -&gt; Digest SHA512 -&gt; [Word8]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HMAC SHA512 -&gt; Digest SHA512
forall a. HMAC a -&gt; Digest a
</span><span class="hs-identifier hs-var hs-var">C.hmacGetDigest</span></span><span> </span><span class="annot"><span class="annottext">HMAC SHA512
</span><a href="#local-6989586621679086971"><span class="hs-identifier hs-var">computed</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><a href="#local-6989586621679086971"><span class="hs-identifier hs-type">computed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.HMAC</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.SHA512</span></span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621679086971"><span class="annot"><span class="annottext">computed :: HMAC SHA512
</span><a href="#local-6989586621679086971"><span class="hs-identifier hs-var hs-var">computed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; HMAC SHA512
forall key message a.
(ByteArrayAccess key, ByteArrayAccess message, HashAlgorithm a) =&gt;
key -&gt; message -&gt; HMAC a
</span><span class="hs-identifier hs-var">C.hmac</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.pack</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; ByteString) -&gt; [Word8] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bytes keyLength -&gt; [Word8]
forall (n :: Nat). Bytes n -&gt; [Word8]
</span><a href="Crypto.Math.Bytes.html#unpack"><span class="hs-identifier hs-var hs-var">Bytes.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes keyLength
</span><a href="#local-6989586621679086975"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.pack</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; ByteString) -&gt; [Word8] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bytes input -&gt; [Word8]
forall (n :: Nat). Bytes n -&gt; [Word8]
</span><a href="Crypto.Math.Bytes.html#unpack"><span class="hs-identifier hs-var hs-var">Bytes.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes input
</span><a href="#local-6989586621679086974"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-keyword">class</span><span> </span><span id="GetDerivationMaterial"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#GetDerivationMaterial"><span class="hs-identifier hs-var">GetDerivationMaterial</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087116"><span class="annot"><a href="#local-6989586621679087116"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationType"><span class="hs-identifier hs-type">DerivationType</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679087115"><span class="annot"><a href="#local-6989586621679087115"><span class="hs-identifier hs-type">mat</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>    </span><span id="getDerivationMaterial"><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#getDerivationMaterial"><span class="hs-identifier hs-type">getDerivationMaterial</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679087116"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679087115"><span class="hs-identifier hs-type">mat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#GetDerivationMaterial"><span class="hs-identifier hs-type">GetDerivationMaterial</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Soft"><span class="hs-identifier hs-type">Soft</span></a></span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621679086965"><span class="annot"><span class="annottext">getDerivationMaterial :: Proxy 'Soft -&gt; Key -&gt; [Word8]
</span><a href="#local-6989586621679086965"><span class="hs-identifier hs-var hs-var hs-var hs-var">getDerivationMaterial</span></a></span></span><span> </span><span id="local-6989586621679086964"><span class="annot"><span class="annottext">Proxy 'Soft
</span><a href="#local-6989586621679086964"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679086963"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679086963"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy 'Soft -&gt; FBits 256 -&gt; [Word8]
forall (dtype :: DerivationType) mat.
GetDerivationMaterial dtype mat =&gt;
Proxy dtype -&gt; mat -&gt; [Word8]
</span><a href="Crypto.ECC.Ed25519BIP32.html#getDerivationMaterial"><span class="hs-identifier hs-var">getDerivationMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy 'Soft
</span><a href="#local-6989586621679086964"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Public -&gt; FBits 256
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Public -&gt; FBits 256) -&gt; Public -&gt; FBits 256
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Public
</span><a href="Crypto.ECC.Ed25519BIP32.html#toPublic"><span class="hs-identifier hs-var">toPublic</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679086963"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#GetDerivationMaterial"><span class="hs-identifier hs-type">GetDerivationMaterial</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Hard"><span class="hs-identifier hs-type">Hard</span></a></span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621679086961"><span class="annot"><span class="annottext">getDerivationMaterial :: Proxy 'Hard -&gt; Key -&gt; [Word8]
</span><a href="#local-6989586621679086961"><span class="hs-identifier hs-var hs-var hs-var hs-var">getDerivationMaterial</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy 'Hard
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679086960"><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086960"><span class="hs-identifier hs-var">kl</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679086959"><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086959"><span class="hs-identifier hs-var">kr</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ChainCode
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><span class="annottext">HMAC_SHA512 -&gt; [Word8]
forall (n :: Nat). Bytes n -&gt; [Word8]
</span><a href="Crypto.Math.Bytes.html#unpack"><span class="hs-identifier hs-var hs-var">Bytes.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(HMAC_SHA512 -&gt; [Word8]) -&gt; HMAC_SHA512 -&gt; [Word8]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bytes 32 -&gt; Bytes 32 -&gt; HMAC_SHA512
forall (m :: Nat) (n :: Nat) (r :: Nat).
((m + n) ~ r) =&gt;
Bytes n -&gt; Bytes m -&gt; Bytes r
</span><a href="Crypto.Math.Bytes.html#append"><span class="hs-identifier hs-var">Bytes.append</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endian -&gt; FBits 256 -&gt; Bytes (Div8 256)
forall (n :: Nat).
KnownNat n =&gt;
Endian -&gt; FBits n -&gt; Bytes (Div8 n)
</span><a href="Crypto.Math.Bytes.html#fromBits"><span class="hs-identifier hs-var">Bytes.fromBits</span></a></span><span> </span><span class="annot"><span class="annottext">Endian
</span><a href="Crypto.Math.Bytes.html#LittleEndian"><span class="hs-identifier hs-var">Bytes.LittleEndian</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086960"><span class="hs-identifier hs-var">kl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endian -&gt; FBits 256 -&gt; Bytes (Div8 256)
forall (n :: Nat).
KnownNat n =&gt;
Endian -&gt; FBits n -&gt; Bytes (Div8 n)
</span><a href="Crypto.Math.Bytes.html#fromBits"><span class="hs-identifier hs-var">Bytes.fromBits</span></a></span><span> </span><span class="annot"><span class="annottext">Endian
</span><a href="Crypto.Math.Bytes.html#LittleEndian"><span class="hs-identifier hs-var">Bytes.LittleEndian</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086959"><span class="hs-identifier hs-var">kr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#GetDerivationMaterial"><span class="hs-identifier hs-type">GetDerivationMaterial</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Soft"><span class="hs-identifier hs-type">Soft</span></a></span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679086956"><span class="annot"><span class="annottext">getDerivationMaterial :: Proxy 'Soft -&gt; FBits 256 -&gt; [Word8]
</span><a href="#local-6989586621679086956"><span class="hs-identifier hs-var hs-var hs-var hs-var">getDerivationMaterial</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy 'Soft
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679086955"><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086955"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bytes 32 -&gt; [Word8]
forall (n :: Nat). Bytes n -&gt; [Word8]
</span><a href="Crypto.Math.Bytes.html#unpack"><span class="hs-identifier hs-var hs-var">Bytes.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(Bytes 32 -&gt; [Word8]) -&gt; Bytes 32 -&gt; [Word8]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Endian -&gt; FBits 256 -&gt; Bytes (Div8 256)
forall (n :: Nat).
KnownNat n =&gt;
Endian -&gt; FBits n -&gt; Bytes (Div8 n)
</span><a href="Crypto.Math.Bytes.html#fromBits"><span class="hs-identifier hs-var">Bytes.fromBits</span></a></span><span> </span><span class="annot"><span class="annottext">Endian
</span><a href="Crypto.Math.Bytes.html#LittleEndian"><span class="hs-identifier hs-var">Bytes.LittleEndian</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086955"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#derive"><span class="hs-identifier hs-type">derive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679086953"><span class="annot"><a href="#local-6989586621679086953"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span id="local-6989586621679086952"><span class="annot"><a href="#local-6989586621679086952"><span class="hs-identifier hs-type">idx</span></a></span></span><span> </span><span class="hs-operator">.</span><span>
</span><span id="line-231"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationTag"><span class="hs-identifier hs-type">DerivationTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086953"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#KeyMaterial"><span class="hs-identifier hs-type">KeyMaterial</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationTag"><span class="hs-identifier hs-type">DerivationTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086953"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCodeMaterial"><span class="hs-identifier hs-type">ChainCodeMaterial</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679086952"><span class="hs-identifier hs-type">idx</span></a></span><span>
</span><span id="line-234"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndex"><span class="hs-identifier hs-type">ValidDerivationIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086952"><span class="hs-identifier hs-type">idx</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-235"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndexForType"><span class="hs-identifier hs-type">ValidDerivationIndexForType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086953"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086952"><span class="hs-identifier hs-type">idx</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-236"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#GetDerivationMaterial"><span class="hs-identifier hs-type">GetDerivationMaterial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086953"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationIndex"><span class="hs-identifier hs-type">DerivationIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086953"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086952"><span class="hs-identifier hs-type">idx</span></a></span><span>
</span><span id="line-238"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span>
</span><span id="line-239"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span>
</span><span id="line-240"></span><span id="derive"><span class="annot"><span class="annottext">derive :: DerivationIndex dtype idx -&gt; Key -&gt; Key
</span><a href="Crypto.ECC.Ed25519BIP32.html#derive"><span class="hs-identifier hs-var hs-var">derive</span></a></span></span><span> </span><span id="local-6989586621679086951"><span class="annot"><span class="annottext">DerivationIndex dtype idx
</span><a href="#local-6989586621679086951"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span id="local-6989586621679086950"><span class="annot"><span class="annottext">key :: Key
</span><a href="#local-6989586621679086950"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679086949"><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086949"><span class="hs-identifier hs-var">kl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086948"><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086948"><span class="hs-identifier hs-var">kr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086947"><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679086947"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086946"><span class="hs-identifier hs-var">kl'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086945"><span class="hs-identifier hs-var">kr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679086944"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621679086943"><span class="annot"><span class="annottext">dtype :: Proxy dtype
</span><a href="#local-6989586621679086943"><span class="hs-identifier hs-var hs-var">dtype</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy dtype
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679086953"><span class="hs-identifier hs-type">dtype</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621679086942"><span class="annot"><span class="annottext">matKeyProxy :: Proxy 'KeyMaterial
</span><a href="#local-6989586621679086942"><span class="hs-identifier hs-var hs-var">matKeyProxy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy 'KeyMaterial
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#KeyMaterial"><span class="hs-identifier hs-type">KeyMaterial</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621679086941"><span class="annot"><span class="annottext">matCCProxy :: Proxy 'ChainCodeMaterial
</span><a href="#local-6989586621679086941"><span class="hs-identifier hs-var hs-var">matCCProxy</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy 'ChainCodeMaterial
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCodeMaterial"><span class="hs-identifier hs-type">ChainCodeMaterial</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-comment">-- 1) Z</span><span>
</span><span id="line-246"></span><span>    </span><span id="local-6989586621679086940"><span class="annot"><span class="annottext">z :: HMAC_SHA512
</span><a href="#local-6989586621679086940"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy 'KeyMaterial
-&gt; Proxy dtype
-&gt; Proxy idx
-&gt; ChainCode
-&gt; DerivationIndex dtype idx
-&gt; [Word8]
-&gt; HMAC_SHA512
forall (tag :: Nat) (idx :: Nat) (deriveType :: DerivationType)
       (deriveMaterial :: DerivationMaterial).
(KnownNat (DerivationTag deriveType deriveMaterial), KnownNat idx,
 DerivationTag deriveType deriveMaterial ~ tag,
 ValidDerivationIndex idx ~ 'True,
 ValidDerivationIndexForType deriveType idx ~ 'True) =&gt;
Proxy deriveMaterial
-&gt; Proxy deriveType
-&gt; Proxy idx
-&gt; ChainCode
-&gt; DerivationIndex deriveType idx
-&gt; [Word8]
-&gt; HMAC_SHA512
</span><a href="Crypto.ECC.Ed25519BIP32.html#fcp"><span class="hs-identifier hs-var">fcp</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy 'KeyMaterial
</span><a href="#local-6989586621679086942"><span class="hs-identifier hs-var">matKeyProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy dtype
</span><a href="#local-6989586621679086943"><span class="hs-identifier hs-var">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy idx
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679086952"><span class="hs-identifier hs-type">idx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679086947"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationIndex dtype idx
</span><a href="#local-6989586621679086951"><span class="hs-identifier hs-var">idx</span></a></span><span>
</span><span id="line-247"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy dtype -&gt; Key -&gt; [Word8]
forall (dtype :: DerivationType) mat.
GetDerivationMaterial dtype mat =&gt;
Proxy dtype -&gt; mat -&gt; [Word8]
</span><a href="Crypto.ECC.Ed25519BIP32.html#getDerivationMaterial"><span class="hs-identifier hs-var">getDerivationMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy dtype
</span><a href="#local-6989586621679086943"><span class="hs-identifier hs-var">dtype</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679086950"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-comment">-- 2) produce kl' and kr'</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679086939"><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086939"><span class="hs-identifier hs-var">zl8</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086938"><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086938"><span class="hs-identifier hs-var">zr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HMAC_SHA512 -&gt; (FBits 256, FBits 256)
</span><a href="Crypto.ECC.Ed25519BIP32.html#step2"><span class="hs-identifier hs-var">step2</span></a></span><span> </span><span class="annot"><span class="annottext">HMAC_SHA512
</span><a href="#local-6989586621679086940"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621679086946"><span class="annot"><span class="annottext">kl' :: FBits 256
</span><a href="#local-6989586621679086946"><span class="hs-identifier hs-var hs-var">kl'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086939"><span class="hs-identifier hs-var">zl8</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 256 -&gt; FBits 256 -&gt; FBits 256
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086949"><span class="hs-identifier hs-var">kl</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span id="local-6989586621679086945"><span class="annot"><span class="annottext">kr' :: FBits 256
</span><a href="#local-6989586621679086945"><span class="hs-identifier hs-var hs-var">kr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086938"><span class="hs-identifier hs-var">zr</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 256 -&gt; FBits 256 -&gt; FBits 256
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086948"><span class="hs-identifier hs-var">kr</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-comment">-- 3) child chain code</span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621679086935"><span class="annot"><span class="annottext">untrimmedCC :: HMAC_SHA512
</span><a href="#local-6989586621679086935"><span class="hs-identifier hs-var hs-var">untrimmedCC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy 'ChainCodeMaterial
-&gt; Proxy dtype
-&gt; Proxy idx
-&gt; ChainCode
-&gt; DerivationIndex dtype idx
-&gt; [Word8]
-&gt; HMAC_SHA512
forall (tag :: Nat) (idx :: Nat) (deriveType :: DerivationType)
       (deriveMaterial :: DerivationMaterial).
(KnownNat (DerivationTag deriveType deriveMaterial), KnownNat idx,
 DerivationTag deriveType deriveMaterial ~ tag,
 ValidDerivationIndex idx ~ 'True,
 ValidDerivationIndexForType deriveType idx ~ 'True) =&gt;
Proxy deriveMaterial
-&gt; Proxy deriveType
-&gt; Proxy idx
-&gt; ChainCode
-&gt; DerivationIndex deriveType idx
-&gt; [Word8]
-&gt; HMAC_SHA512
</span><a href="Crypto.ECC.Ed25519BIP32.html#fcp"><span class="hs-identifier hs-var">fcp</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy 'ChainCodeMaterial
</span><a href="#local-6989586621679086941"><span class="hs-identifier hs-var">matCCProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy dtype
</span><a href="#local-6989586621679086943"><span class="hs-identifier hs-var">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy idx
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679086952"><span class="hs-identifier hs-type">idx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679086947"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationIndex dtype idx
</span><a href="#local-6989586621679086951"><span class="hs-identifier hs-var">idx</span></a></span><span>
</span><span id="line-257"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy dtype -&gt; Key -&gt; [Word8]
forall (dtype :: DerivationType) mat.
GetDerivationMaterial dtype mat =&gt;
Proxy dtype -&gt; mat -&gt; [Word8]
</span><a href="Crypto.ECC.Ed25519BIP32.html#getDerivationMaterial"><span class="hs-identifier hs-var">getDerivationMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy dtype
</span><a href="#local-6989586621679086943"><span class="hs-identifier hs-var">dtype</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679086950"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679086944"><span class="annot"><span class="annottext">c' :: ChainCode
</span><a href="#local-6989586621679086944"><span class="hs-identifier hs-var hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bytes 32 -&gt; ChainCode
</span><a href="Crypto.ECC.Ed25519BIP32.html#ChainCode"><span class="hs-identifier hs-var">ChainCode</span></a></span><span> </span><span class="annot"><span class="annottext">(Bytes 32 -&gt; ChainCode) -&gt; Bytes 32 -&gt; ChainCode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HMAC_SHA512 -&gt; Bytes 32
forall (n :: Nat) (m :: Nat).
(KnownNat m, KnownNat n, n &lt;= m) =&gt;
Bytes m -&gt; Bytes n
</span><a href="Crypto.Math.Bytes.html#drop"><span class="hs-identifier hs-var">Bytes.drop</span></a></span><span> </span><span class="annot"><span class="annottext">HMAC_SHA512
</span><a href="#local-6989586621679086935"><span class="hs-identifier hs-var">untrimmedCC</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#derivePublic"><span class="hs-identifier hs-type">derivePublic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679086932"><span class="annot"><a href="#local-6989586621679086932"><span class="hs-identifier hs-type">idx</span></a></span></span><span> </span><span id="local-6989586621679086931"><span class="annot"><a href="#local-6989586621679086931"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span class="hs-operator">.</span><span>
</span><span id="line-261"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679086931"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Soft"><span class="hs-identifier hs-type">Soft</span></a></span><span> </span><span class="hs-comment">-- can only derive public stuff with Soft Derivation</span><span>
</span><span id="line-262"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationTag"><span class="hs-identifier hs-type">DerivationTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086931"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#KeyMaterial"><span class="hs-identifier hs-type">KeyMaterial</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationTag"><span class="hs-identifier hs-type">DerivationTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086931"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCodeMaterial"><span class="hs-identifier hs-type">ChainCodeMaterial</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679086932"><span class="hs-identifier hs-type">idx</span></a></span><span>
</span><span id="line-265"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndex"><span class="hs-identifier hs-type">ValidDerivationIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086932"><span class="hs-identifier hs-type">idx</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-266"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndexForType"><span class="hs-identifier hs-type">ValidDerivationIndexForType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086931"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086932"><span class="hs-identifier hs-type">idx</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-267"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#GetDerivationMaterial"><span class="hs-identifier hs-type">GetDerivationMaterial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086931"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#DerivationIndex"><span class="hs-identifier hs-type">DerivationIndex</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#Soft"><span class="hs-identifier hs-type">Soft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679086932"><span class="hs-identifier hs-type">idx</span></a></span><span>
</span><span id="line-269"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span>
</span><span id="line-270"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span>
</span><span id="line-271"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span id="derivePublic"><span class="annot"><span class="annottext">derivePublic :: DerivationIndex 'Soft idx -&gt; FBits 256 -&gt; ChainCode -&gt; Public
</span><a href="Crypto.ECC.Ed25519BIP32.html#derivePublic"><span class="hs-identifier hs-var hs-var">derivePublic</span></a></span></span><span> </span><span id="local-6989586621679086930"><span class="annot"><span class="annottext">DerivationIndex 'Soft idx
</span><a href="#local-6989586621679086930"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span id="local-6989586621679086929"><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086929"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679086928"><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679086928"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086927"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679086926"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679086925"><span class="annot"><span class="annottext">dtype :: Proxy dtype
</span><a href="#local-6989586621679086925"><span class="hs-identifier hs-var hs-var">dtype</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy dtype
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679086931"><span class="hs-identifier hs-type">dtype</span></a></span><span>
</span><span id="line-275"></span><span>    </span><span id="local-6989586621679086924"><span class="annot"><span class="annottext">matKeyProxy :: Proxy 'KeyMaterial
</span><a href="#local-6989586621679086924"><span class="hs-identifier hs-var hs-var">matKeyProxy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy 'KeyMaterial
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#KeyMaterial"><span class="hs-identifier hs-type">KeyMaterial</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679086923"><span class="annot"><span class="annottext">matCCProxy :: Proxy 'ChainCodeMaterial
</span><a href="#local-6989586621679086923"><span class="hs-identifier hs-var hs-var">matCCProxy</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy 'ChainCodeMaterial
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ChainCodeMaterial"><span class="hs-identifier hs-type">ChainCodeMaterial</span></a></span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-comment">-- 1) Z</span><span>
</span><span id="line-278"></span><span>    </span><span id="local-6989586621679086922"><span class="annot"><span class="annottext">z :: HMAC_SHA512
</span><a href="#local-6989586621679086922"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy 'KeyMaterial
-&gt; Proxy dtype
-&gt; Proxy idx
-&gt; ChainCode
-&gt; DerivationIndex dtype idx
-&gt; [Word8]
-&gt; HMAC_SHA512
forall (tag :: Nat) (idx :: Nat) (deriveType :: DerivationType)
       (deriveMaterial :: DerivationMaterial).
(KnownNat (DerivationTag deriveType deriveMaterial), KnownNat idx,
 DerivationTag deriveType deriveMaterial ~ tag,
 ValidDerivationIndex idx ~ 'True,
 ValidDerivationIndexForType deriveType idx ~ 'True) =&gt;
Proxy deriveMaterial
-&gt; Proxy deriveType
-&gt; Proxy idx
-&gt; ChainCode
-&gt; DerivationIndex deriveType idx
-&gt; [Word8]
-&gt; HMAC_SHA512
</span><a href="Crypto.ECC.Ed25519BIP32.html#fcp"><span class="hs-identifier hs-var">fcp</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy 'KeyMaterial
</span><a href="#local-6989586621679086924"><span class="hs-identifier hs-var">matKeyProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy dtype
</span><a href="#local-6989586621679086925"><span class="hs-identifier hs-var">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy idx
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679086932"><span class="hs-identifier hs-type">idx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679086928"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationIndex dtype idx
DerivationIndex 'Soft idx
</span><a href="#local-6989586621679086930"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy dtype -&gt; FBits 256 -&gt; [Word8]
forall (dtype :: DerivationType) mat.
GetDerivationMaterial dtype mat =&gt;
Proxy dtype -&gt; mat -&gt; [Word8]
</span><a href="Crypto.ECC.Ed25519BIP32.html#getDerivationMaterial"><span class="hs-identifier hs-var">getDerivationMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy dtype
</span><a href="#local-6989586621679086925"><span class="hs-identifier hs-var">dtype</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086929"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-comment">-- 2) produce kl' and kr'</span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679086921"><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086921"><span class="hs-identifier hs-var">zl8</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HMAC_SHA512 -&gt; (FBits 256, FBits 256)
</span><a href="Crypto.ECC.Ed25519BIP32.html#step2"><span class="hs-identifier hs-var">step2</span></a></span><span> </span><span class="annot"><span class="annottext">HMAC_SHA512
</span><a href="#local-6989586621679086922"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621679086927"><span class="annot"><span class="annottext">p' :: FBits 256
</span><a href="#local-6989586621679086927"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FBits 256 -&gt; FBits 256
</span><a href="Crypto.ECC.Ed25519BIP32.html#kToPoint"><span class="hs-identifier hs-var">kToPoint</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086921"><span class="hs-identifier hs-var">zl8</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 256 -&gt; FBits 256 -&gt; FBits 256
</span><a href="Crypto.ECC.Ed25519BIP32.html#pointAdd"><span class="hs-operator hs-var">`pointAdd`</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086929"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-comment">-- 3) child chain code</span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621679086920"><span class="annot"><span class="annottext">untrimmedCC :: HMAC_SHA512
</span><a href="#local-6989586621679086920"><span class="hs-identifier hs-var hs-var">untrimmedCC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy 'ChainCodeMaterial
-&gt; Proxy dtype
-&gt; Proxy idx
-&gt; ChainCode
-&gt; DerivationIndex dtype idx
-&gt; [Word8]
-&gt; HMAC_SHA512
forall (tag :: Nat) (idx :: Nat) (deriveType :: DerivationType)
       (deriveMaterial :: DerivationMaterial).
(KnownNat (DerivationTag deriveType deriveMaterial), KnownNat idx,
 DerivationTag deriveType deriveMaterial ~ tag,
 ValidDerivationIndex idx ~ 'True,
 ValidDerivationIndexForType deriveType idx ~ 'True) =&gt;
Proxy deriveMaterial
-&gt; Proxy deriveType
-&gt; Proxy idx
-&gt; ChainCode
-&gt; DerivationIndex deriveType idx
-&gt; [Word8]
-&gt; HMAC_SHA512
</span><a href="Crypto.ECC.Ed25519BIP32.html#fcp"><span class="hs-identifier hs-var">fcp</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy 'ChainCodeMaterial
</span><a href="#local-6989586621679086923"><span class="hs-identifier hs-var">matCCProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy dtype
</span><a href="#local-6989586621679086925"><span class="hs-identifier hs-var">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy idx
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679086932"><span class="hs-identifier hs-type">idx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679086928"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationIndex dtype idx
DerivationIndex 'Soft idx
</span><a href="#local-6989586621679086930"><span class="hs-identifier hs-var">idx</span></a></span><span>
</span><span id="line-287"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy dtype -&gt; FBits 256 -&gt; [Word8]
forall (dtype :: DerivationType) mat.
GetDerivationMaterial dtype mat =&gt;
Proxy dtype -&gt; mat -&gt; [Word8]
</span><a href="Crypto.ECC.Ed25519BIP32.html#getDerivationMaterial"><span class="hs-identifier hs-var">getDerivationMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy dtype
</span><a href="#local-6989586621679086925"><span class="hs-identifier hs-var">dtype</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086929"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621679086926"><span class="annot"><span class="annottext">c' :: ChainCode
</span><a href="#local-6989586621679086926"><span class="hs-identifier hs-var hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bytes 32 -&gt; ChainCode
</span><a href="Crypto.ECC.Ed25519BIP32.html#ChainCode"><span class="hs-identifier hs-var">ChainCode</span></a></span><span> </span><span class="annot"><span class="annottext">(Bytes 32 -&gt; ChainCode) -&gt; Bytes 32 -&gt; ChainCode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HMAC_SHA512 -&gt; Bytes 32
forall (n :: Nat) (m :: Nat).
(KnownNat m, KnownNat n, n &lt;= m) =&gt;
Bytes m -&gt; Bytes n
</span><a href="Crypto.Math.Bytes.html#drop"><span class="hs-identifier hs-var">Bytes.drop</span></a></span><span> </span><span class="annot"><span class="annottext">HMAC_SHA512
</span><a href="#local-6989586621679086920"><span class="hs-identifier hs-var">untrimmedCC</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- | Given Z, return 8*ZL(28Bytes) and ZR</span><span>
</span><span id="line-291"></span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#step2"><span class="hs-identifier hs-type">step2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Bytes.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="annot"><span class="hs-number">64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Bits.html#FBits"><span class="hs-identifier hs-type">FBits</span></a></span><span> </span><span class="annot"><span class="hs-number">256</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Bits.html#FBits"><span class="hs-identifier hs-type">FBits</span></a></span><span> </span><span class="annot"><span class="hs-number">256</span></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span id="step2"><span class="annot"><span class="annottext">step2 :: HMAC_SHA512 -&gt; (FBits 256, FBits 256)
</span><a href="Crypto.ECC.Ed25519BIP32.html#step2"><span class="hs-identifier hs-var hs-var">step2</span></a></span></span><span> </span><span id="local-6989586621679086919"><span class="annot"><span class="annottext">HMAC_SHA512
</span><a href="#local-6989586621679086919"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FBits 256
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">FBits 256 -&gt; FBits 256 -&gt; FBits 256
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">FBits 256
</span><a href="#local-6989586621679086917"><span class="hs-identifier hs-var">zeroExtendedZl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Endian -&gt; Bytes 32 -&gt; FBits (32 * 8)
forall (n :: Nat). Endian -&gt; Bytes n -&gt; FBits (n * 8)
</span><a href="Crypto.Math.Bytes.html#toBits"><span class="hs-identifier hs-var">Bytes.toBits</span></a></span><span> </span><span class="annot"><span class="annottext">Endian
</span><a href="Crypto.Math.Bytes.html#LittleEndian"><span class="hs-identifier hs-var">Bytes.LittleEndian</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 32
</span><a href="#local-6989586621679086916"><span class="hs-identifier hs-var">zRight</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679086915"><span class="annot"><span class="annottext">Bytes 32
</span><a href="#local-6989586621679086915"><span class="hs-identifier hs-var">zLeft32</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679086916"><span class="annot"><span class="annottext">Bytes 32
</span><a href="#local-6989586621679086916"><span class="hs-identifier hs-var">zRight</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HMAC_SHA512 -&gt; (Bytes 32, Bytes 32)
forall (m :: Nat) (n :: Nat).
(KnownNat n, (n * 2) ~ m) =&gt;
Bytes m -&gt; (Bytes n, Bytes n)
</span><a href="Crypto.Math.Bytes.html#splitHalf"><span class="hs-identifier hs-var">Bytes.splitHalf</span></a></span><span> </span><span class="annot"><span class="annottext">HMAC_SHA512
</span><a href="#local-6989586621679086919"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-comment">-- step</span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-comment">-- * take 28 bytes of zLeft32 (zl)</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-comment">-- * extend back to 32 bytes</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-comment">-- * multiply this number by 8</span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621679086917"><span class="annot"><span class="annottext">zeroExtendedZl :: FBits 256
</span><a href="#local-6989586621679086917"><span class="hs-identifier hs-var hs-var">zeroExtendedZl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FBits 32
FBits (4 * 8)
</span><a href="#local-6989586621679086913"><span class="hs-identifier hs-var">zeroExtender</span></a></span><span> </span><span class="annot"><span class="annottext">FBits 32 -&gt; FBits 224 -&gt; FBits 256
forall (m :: Nat) (n :: Nat) (r :: Nat).
(SizeValid m, SizeValid n, SizeValid r, (m + n) ~ r) =&gt;
FBits n -&gt; FBits m -&gt; FBits r
</span><a href="Crypto.Math.Bits.html#append"><span class="hs-operator hs-var">`append`</span></a></span><span> </span><span class="annot"><span class="annottext">Endian -&gt; Bytes 28 -&gt; FBits (28 * 8)
forall (n :: Nat). Endian -&gt; Bytes n -&gt; FBits (n * 8)
</span><a href="Crypto.Math.Bytes.html#toBits"><span class="hs-identifier hs-var">Bytes.toBits</span></a></span><span> </span><span class="annot"><span class="annottext">Endian
</span><a href="Crypto.Math.Bytes.html#LittleEndian"><span class="hs-identifier hs-var">Bytes.LittleEndian</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 28
</span><a href="#local-6989586621679086911"><span class="hs-identifier hs-var">zl</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><a href="#local-6989586621679086911"><span class="hs-identifier hs-type">zl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Bytes.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="annot"><span class="hs-number">28</span></span><span> </span><span class="hs-comment">-- only take 28 bytes</span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621679086911"><span class="annot"><span class="annottext">zl :: Bytes 28
</span><a href="#local-6989586621679086911"><span class="hs-identifier hs-var hs-var">zl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bytes 32 -&gt; Bytes 28
forall (n :: Nat) (m :: Nat).
(KnownNat n, n &lt;= m) =&gt;
Bytes m -&gt; Bytes n
</span><a href="Crypto.Math.Bytes.html#take"><span class="hs-identifier hs-var">Bytes.take</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 32
</span><a href="#local-6989586621679086915"><span class="hs-identifier hs-var">zLeft32</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="#local-6989586621679086913"><span class="hs-identifier hs-type">zeroExtender</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Bits.html#FBits"><span class="hs-identifier hs-type">FBits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">4</span></span><span class="annot"><span class="hs-operator hs-type">*</span></span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- re-extend by 4 bytes</span><span>
</span><span id="line-306"></span><span>    </span><span id="local-6989586621679086913"><span class="annot"><span class="annottext">zeroExtender :: FBits (4 * 8)
</span><a href="#local-6989586621679086913"><span class="hs-identifier hs-var hs-var">zeroExtender</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FBits (4 * 8)
</span><span class="hs-number">0</span></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">-- | Serialized index</span><span>
</span><span id="line-309"></span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#indexSerialized"><span class="hs-identifier hs-type">indexSerialized</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679087136"><span class="annot"><a href="#local-6989586621679087136"><span class="hs-identifier hs-type">idx</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679087136"><span class="hs-identifier hs-type">idx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#ValidDerivationIndex"><span class="hs-identifier hs-type">ValidDerivationIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679087136"><span class="hs-identifier hs-type">idx</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679087136"><span class="hs-identifier hs-type">idx</span></a></span><span>
</span><span id="line-311"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.Ed25519BIP32.html#SerializedIndex"><span class="hs-identifier hs-type">SerializedIndex</span></a></span><span>
</span><span id="line-312"></span><span id="indexSerialized"><span class="annot"><span class="annottext">indexSerialized :: Proxy idx -&gt; SerializedIndex
</span><a href="Crypto.ECC.Ed25519BIP32.html#indexSerialized"><span class="hs-identifier hs-var hs-var">indexSerialized</span></a></span></span><span> </span><span id="local-6989586621679086909"><span class="annot"><span class="annottext">Proxy idx
</span><a href="#local-6989586621679086909"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bytes 4 -&gt; SerializedIndex
</span><a href="Crypto.ECC.Ed25519BIP32.html#SerializedIndex"><span class="hs-identifier hs-var">SerializedIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Bytes 4 -&gt; SerializedIndex) -&gt; Bytes 4 -&gt; SerializedIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Endian -&gt; FBits 32 -&gt; Bytes (Div8 32)
forall (n :: Nat).
KnownNat n =&gt;
Endian -&gt; FBits n -&gt; Bytes (Div8 n)
</span><a href="Crypto.Math.Bytes.html#fromBits"><span class="hs-identifier hs-var">Bytes.fromBits</span></a></span><span> </span><span class="annot"><span class="annottext">Endian
</span><a href="Crypto.Math.Bytes.html#LittleEndian"><span class="hs-identifier hs-var">Bytes.LittleEndian</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; FBits 32
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679086908"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Bits.html#FBits"><span class="hs-identifier hs-type">FBits</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679086908"><span class="annot"><span class="annottext">n :: Integer
</span><a href="#local-6989586621679086908"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy idx -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; Type).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="annot"><span class="annottext">Proxy idx
</span><a href="#local-6989586621679086909"><span class="hs-identifier hs-var">idx</span></a></span><span>
</span><span id="line-314"></span></pre></body></html>