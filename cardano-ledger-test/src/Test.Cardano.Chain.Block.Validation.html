<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts  #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase        #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell   #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TupleSections     #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Cardano.Chain.Block.Validation</span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Chain.Block.Validation.html#tests"><span class="hs-identifier">tests</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src"><span class="hs-identifier">Cardano.Prelude</span></a></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Resource</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ResIO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runResourceT</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Streaming</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Of</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Stream</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hoist</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Streaming.Prelude</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hedgehog</span></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Group</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">annotate</span></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">assert</span></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">discover</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">evalEither</span></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">property</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withTests</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lookupEnv</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">Cardano.Chain.Block</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">ABlockOrBoundary</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">BlockValidationMode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">BlockValidation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">ChainValidationError</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">ChainValidationState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">blockSlot</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">initialChainValidationState</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">updateBlock</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">updateChainBoundary</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">Cardano.Chain.Epoch.File</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">ParseError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">parseEpochFilesWithBoundary</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">Cardano.Chain.Genesis</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Genesis</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">Config</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">configEpochSlots</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">Cardano.Chain.Slotting</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">SlotNumber</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">Cardano.Chain.ValidationMode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier">fromBlockValidationMode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Chain.Config.html"><span class="hs-identifier">Test.Cardano.Chain.Config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Chain.Config.html#readMainetCfg"><span class="hs-identifier">readMainetCfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Mirror.html"><span class="hs-identifier">Test.Cardano.Mirror</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Mirror.html#mainnetEpochFiles"><span class="hs-identifier">mainnetEpochFiles</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Options.html"><span class="hs-identifier">Test.Options</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Options.html#ShouldAssertNF"><span class="hs-identifier">ShouldAssertNF</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Options.html#TestScenario"><span class="hs-identifier">TestScenario</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Options.html#TSGroup"><span class="hs-identifier">TSGroup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Options.html#TSProperty"><span class="hs-identifier">TSProperty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Options.html#concatTSGroups"><span class="hs-identifier">concatTSGroups</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | These tests perform chain validation over mainnet epoch files</span><span>
</span><span id="line-51"></span><span class="annot"><a href="Test.Cardano.Chain.Block.Validation.html#tests"><span class="hs-identifier hs-type">tests</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Options.html#ShouldAssertNF"><span class="hs-identifier hs-type">ShouldAssertNF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Options.html#TSGroup"><span class="hs-identifier hs-type">TSGroup</span></a></span><span>
</span><span id="line-52"></span><span id="tests"><span class="annot"><span class="annottext">tests :: ShouldAssertNF -&gt; TSGroup
</span><a href="Test.Cardano.Chain.Block.Validation.html#tests"><span class="hs-identifier hs-var hs-var">tests</span></a></span></span><span> </span><span id="local-6989586621679445294"><span class="annot"><span class="annottext">ShouldAssertNF
</span><a href="#local-6989586621679445294"><span class="hs-identifier hs-var">shouldAssertNF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TSGroup] -&gt; TSGroup
</span><a href="Test.Options.html#concatTSGroups"><span class="hs-identifier hs-var">concatTSGroups</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Group -&gt; TSGroup
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">String
[(PropertyName, Property)]
String -&gt; GroupName
GroupName -&gt; [(PropertyName, Property)] -&gt; Group
</span><span class="hs-var hs-var hs-var">$$discover</span></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679445290"><span class="annot"><span class="annottext">TestScenario
</span><a href="#local-6989586621679445290"><span class="hs-identifier hs-var">scenario</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GroupName -&gt; [(PropertyName, Property)] -&gt; Group
</span><span class="hs-identifier hs-var">Group</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="annottext">GroupName
</span><span class="hs-string">&quot;Test.Cardano.Chain.Block.Validation&quot;</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">PropertyName
</span><span class="hs-string">&quot;ts_prop_mainnetEpochsValid&quot;</span></span><span>
</span><span id="line-57"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShouldAssertNF -&gt; TSProperty
</span><a href="Test.Cardano.Chain.Block.Validation.html#ts_prop_mainnetEpochsValid"><span class="hs-identifier hs-var">ts_prop_mainnetEpochsValid</span></a></span><span> </span><span class="annot"><span class="annottext">ShouldAssertNF
</span><a href="#local-6989586621679445294"><span class="hs-identifier hs-var">shouldAssertNF</span></a></span><span> </span><span class="annot"><span class="annottext">TestScenario
</span><a href="#local-6989586621679445290"><span class="hs-identifier hs-var">scenario</span></a></span><span>
</span><span id="line-58"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="annot"><a href="Test.Cardano.Chain.Block.Validation.html#ts_prop_mainnetEpochsValid"><span class="hs-identifier hs-type">ts_prop_mainnetEpochsValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Options.html#ShouldAssertNF"><span class="hs-identifier hs-type">ShouldAssertNF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Options.html#TSProperty"><span class="hs-identifier hs-type">TSProperty</span></a></span><span>
</span><span id="line-63"></span><span id="ts_prop_mainnetEpochsValid"><span class="annot"><span class="annottext">ts_prop_mainnetEpochsValid :: ShouldAssertNF -&gt; TSProperty
</span><a href="Test.Cardano.Chain.Block.Validation.html#ts_prop_mainnetEpochsValid"><span class="hs-identifier hs-var hs-var">ts_prop_mainnetEpochsValid</span></a></span></span><span> </span><span id="local-6989586621679445288"><span class="annot"><span class="annottext">ShouldAssertNF
</span><a href="#local-6989586621679445288"><span class="hs-identifier hs-var">shouldAssertNF</span></a></span></span><span> </span><span id="local-6989586621679445287"><span class="annot"><span class="annottext">TestScenario
</span><a href="#local-6989586621679445287"><span class="hs-identifier hs-var">scenario</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestLimit -&gt; Property -&gt; Property
</span><span class="hs-identifier hs-var">withTests</span></span><span> </span><span class="annot"><span class="annottext">TestLimit
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property)
-&gt; (PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-64"></span><span>  </span><span id="local-6989586621679445285"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679445285"><span class="hs-identifier hs-var">menv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe String) -&gt; PropertyT IO (Maybe String)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe String) -&gt; PropertyT IO (Maybe String))
-&gt; IO (Maybe String) -&gt; PropertyT IO (Maybe String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Maybe String)
</span><span class="hs-identifier hs-var">lookupEnv</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CARDANO_MAINNET_MIRROR&quot;</span></span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; PropertyT IO ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; Bool -&gt; m ()
</span><span class="hs-identifier hs-var">assert</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; PropertyT IO ()) -&gt; Bool -&gt; PropertyT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679445285"><span class="hs-identifier hs-var">menv</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-comment">-- Get the 'Genesis.Config' from the mainnet genesis JSON</span><span>
</span><span id="line-68"></span><span>  </span><span id="local-6989586621679445282"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679445282"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PropertyT IO Config
forall (m :: * -&gt; *). MonadIO m =&gt; m Config
</span><a href="Test.Cardano.Chain.Config.html#readMainetCfg"><span class="hs-identifier hs-var">readMainetCfg</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-comment">-- Construct the initial 'ChainValidationState'</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679445281"><span class="annot"><span class="annottext">cvs :: ChainValidationState
</span><a href="#local-6989586621679445281"><span class="hs-identifier hs-var hs-var">cvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Error -&gt; ChainValidationState)
-&gt; (ChainValidationState -&gt; ChainValidationState)
-&gt; Either Error ChainValidationState
-&gt; ChainValidationState
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ChainValidationState
forall a. HasCallStack =&gt; Text -&gt; a
</span><span class="hs-identifier hs-var">panic</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ChainValidationState)
-&gt; (Error -&gt; Text) -&gt; Error -&gt; ChainValidationState
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Text
forall a b. (Show a, ConvertText String b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ChainValidationState -&gt; ChainValidationState
forall (cat :: * -&gt; * -&gt; *) a. Category cat =&gt; cat a a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Error ChainValidationState -&gt; ChainValidationState)
-&gt; Either Error ChainValidationState -&gt; ChainValidationState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Config -&gt; Either Error ChainValidationState
forall (m :: * -&gt; *).
MonadError Error m =&gt;
Config -&gt; m ChainValidationState
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-var">initialChainValidationState</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679445282"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href="#local-6989586621679445276"><span class="hs-identifier hs-type">takeFiles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621679445276"><span class="annot"><span class="annottext">takeFiles :: [String] -&gt; [String]
</span><a href="#local-6989586621679445276"><span class="hs-identifier hs-var hs-var">takeFiles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestScenario
</span><a href="#local-6989586621679445287"><span class="hs-identifier hs-var">scenario</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-76"></span><span>      </span><span class="annot"><span class="annottext">TestScenario
</span><a href="Test.Options.html#ContinuousIntegration"><span class="hs-identifier hs-var">ContinuousIntegration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String]
forall (cat :: * -&gt; * -&gt; *) a. Category cat =&gt; cat a a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src"><span class="hs-identifier hs-var">identity</span></a></span><span>
</span><span id="line-77"></span><span>      </span><span class="annot"><span class="annottext">TestScenario
</span><a href="Test.Options.html#Development"><span class="hs-identifier hs-var">Development</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">15</span></span><span>
</span><span id="line-78"></span><span>      </span><span class="annot"><span class="annottext">TestScenario
</span><a href="Test.Options.html#QualityAssurance"><span class="hs-identifier hs-var">QualityAssurance</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String]
forall (cat :: * -&gt; * -&gt; *) a. Category cat =&gt; cat a a
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src"><span class="hs-identifier hs-var">identity</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-comment">-- Get a list of epoch files to perform validation on</span><span>
</span><span id="line-81"></span><span>  </span><span id="local-6989586621679445270"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679445270"><span class="hs-identifier hs-var">files</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String]
</span><a href="#local-6989586621679445276"><span class="hs-identifier hs-var">takeFiles</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String])
-&gt; PropertyT IO [String] -&gt; PropertyT IO [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO [String] -&gt; PropertyT IO [String]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO [String]
</span><a href="Test.Cardano.Mirror.html#mainnetEpochFiles"><span class="hs-identifier hs-var">mainnetEpochFiles</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679445268"><span class="annot"><span class="annottext">stream :: Stream
  (Of (ABlockOrBoundary ByteString)) (ExceptT ParseError ResIO) ()
</span><a href="#local-6989586621679445268"><span class="hs-identifier hs-var hs-var">stream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochSlots
-&gt; [String]
-&gt; Stream
     (Of (ABlockOrBoundary ByteString)) (ExceptT ParseError ResIO) ()
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-var">parseEpochFilesWithBoundary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; EpochSlots
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-var">configEpochSlots</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679445282"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679445270"><span class="hs-identifier hs-var">files</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; PropertyT IO ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; String -&gt; m ()
</span><span class="hs-identifier hs-var">annotate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Did you build with `ghc -fhpc` or `stack --coverage`?\n&quot;</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;If so, please be aware that hpc will introduce thunks around &quot;</span></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expressions for its program coverage measurement purposes and &quot;</span></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;this assertion can fail as a result.\n&quot;</span></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Otherwise, for some reason, the `ChainValidationState` is not in &quot;</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;normal form.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679445267"><span class="annot"><span class="annottext">Either Error ChainValidationState
</span><a href="#local-6989586621679445267"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO (Either Error ChainValidationState)
-&gt; PropertyT IO (Either Error ChainValidationState)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either Error ChainValidationState)
 -&gt; PropertyT IO (Either Error ChainValidationState))
-&gt; (ExceptT Error ResIO ChainValidationState
    -&gt; IO (Either Error ChainValidationState))
-&gt; ExceptT Error ResIO ChainValidationState
-&gt; PropertyT IO (Either Error ChainValidationState)
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ResourceT IO (Either Error ChainValidationState)
-&gt; IO (Either Error ChainValidationState)
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><span class="hs-identifier hs-var">runResourceT</span></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO (Either Error ChainValidationState)
 -&gt; IO (Either Error ChainValidationState))
-&gt; (ExceptT Error ResIO ChainValidationState
    -&gt; ResourceT IO (Either Error ChainValidationState))
-&gt; ExceptT Error ResIO ChainValidationState
-&gt; IO (Either Error ChainValidationState)
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ExceptT Error ResIO ChainValidationState
-&gt; ResourceT IO (Either Error ChainValidationState)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShouldAssertNF
-&gt; Config
-&gt; ChainValidationState
-&gt; Stream
     (Of (ABlockOrBoundary ByteString)) (ExceptT ParseError ResIO) ()
-&gt; ExceptT Error ResIO ChainValidationState
</span><a href="Test.Cardano.Chain.Block.Validation.html#foldChainValidationState"><span class="hs-identifier hs-var">foldChainValidationState</span></a></span><span> </span><span class="annot"><span class="annottext">ShouldAssertNF
</span><a href="#local-6989586621679445288"><span class="hs-identifier hs-var">shouldAssertNF</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679445282"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ChainValidationState
</span><a href="#local-6989586621679445281"><span class="hs-identifier hs-var">cvs</span></a></span><span> </span><span class="annot"><span class="annottext">Stream
  (Of (ABlockOrBoundary ByteString)) (ExceptT ParseError ResIO) ()
</span><a href="#local-6989586621679445268"><span class="hs-identifier hs-var">stream</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><span class="annottext">PropertyT IO ChainValidationState -&gt; PropertyT IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO ChainValidationState -&gt; PropertyT IO ())
-&gt; PropertyT IO ChainValidationState -&gt; PropertyT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Either Error ChainValidationState
-&gt; PropertyT IO ChainValidationState
forall (m :: * -&gt; *) x a.
(MonadTest m, Show x, HasCallStack) =&gt;
Either x a -&gt; m a
</span><span class="hs-identifier hs-var">evalEither</span></span><span> </span><span class="annot"><span class="annottext">Either Error ChainValidationState
</span><a href="#local-6989586621679445267"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">data</span><span> </span><span id="Error"><span class="annot"><a href="Test.Cardano.Chain.Block.Validation.html#Error"><span class="hs-identifier hs-var">Error</span></a></span></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ErrorParseError"><span class="annot"><a href="Test.Cardano.Chain.Block.Validation.html#ErrorParseError"><span class="hs-identifier hs-var">ErrorParseError</span></a></span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ParseError</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ErrorChainValidationError"><span class="annot"><a href="Test.Cardano.Chain.Block.Validation.html#ErrorChainValidationError"><span class="hs-identifier hs-var">ErrorChainValidationError</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">SlotNumber</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ChainValidationError</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679445258"><span id="local-6989586621679445260"><span class="annot"><span class="annottext">Error -&gt; Error -&gt; Bool
(Error -&gt; Error -&gt; Bool) -&gt; (Error -&gt; Error -&gt; Bool) -&gt; Eq Error
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Error -&gt; Error -&gt; Bool
$c/= :: Error -&gt; Error -&gt; Bool
== :: Error -&gt; Error -&gt; Bool
$c== :: Error -&gt; Error -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445251"><span id="local-6989586621679445253"><span id="local-6989586621679445255"><span class="annot"><span class="annottext">Int -&gt; Error -&gt; String -&gt; String
[Error] -&gt; String -&gt; String
Error -&gt; String
(Int -&gt; Error -&gt; String -&gt; String)
-&gt; (Error -&gt; String) -&gt; ([Error] -&gt; String -&gt; String) -&gt; Show Error
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [Error] -&gt; String -&gt; String
$cshowList :: [Error] -&gt; String -&gt; String
show :: Error -&gt; String
$cshow :: Error -&gt; String
showsPrec :: Int -&gt; Error -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; Error -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Fold chain validation over a 'Stream' of 'Block's</span><span>
</span><span id="line-105"></span><span class="annot"><a href="Test.Cardano.Chain.Block.Validation.html#foldChainValidationState"><span class="hs-identifier hs-type">foldChainValidationState</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Options.html#ShouldAssertNF"><span class="hs-identifier hs-type">ShouldAssertNF</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">Genesis.Config</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ChainValidationState</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stream</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Of</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ABlockOrBoundary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ResIO</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Test.Cardano.Chain.Block.Validation.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ResIO</span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ChainValidationState</span></a></span><span>
</span><span id="line-111"></span><span id="foldChainValidationState"><span class="annot"><span class="annottext">foldChainValidationState :: ShouldAssertNF
-&gt; Config
-&gt; ChainValidationState
-&gt; Stream
     (Of (ABlockOrBoundary ByteString)) (ExceptT ParseError ResIO) ()
-&gt; ExceptT Error ResIO ChainValidationState
</span><a href="Test.Cardano.Chain.Block.Validation.html#foldChainValidationState"><span class="hs-identifier hs-var hs-var">foldChainValidationState</span></a></span></span><span> </span><span id="local-6989586621679445249"><span class="annot"><span class="annottext">ShouldAssertNF
</span><a href="#local-6989586621679445249"><span class="hs-identifier hs-var">shouldAssertNF</span></a></span></span><span> </span><span id="local-6989586621679445248"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679445248"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679445247"><span class="annot"><span class="annottext">ChainValidationState
</span><a href="#local-6989586621679445247"><span class="hs-identifier hs-var">cvs</span></a></span></span><span> </span><span id="local-6989586621679445246"><span class="annot"><span class="annottext">Stream
  (Of (ABlockOrBoundary ByteString)) (ExceptT ParseError ResIO) ()
</span><a href="#local-6989586621679445246"><span class="hs-identifier hs-var">blocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="annottext">(ChainValidationState
 -&gt; ABlockOrBoundary ByteString
 -&gt; ExceptT Error ResIO ChainValidationState)
-&gt; ExceptT Error ResIO ChainValidationState
-&gt; (ChainValidationState
    -&gt; ExceptT Error ResIO ChainValidationState)
-&gt; Stream
     (Of (ABlockOrBoundary ByteString)) (ExceptT Error ResIO) ()
-&gt; ExceptT Error ResIO ChainValidationState
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; m x) -&gt; m x -&gt; (x -&gt; m b) -&gt; Stream (Of a) m r -&gt; m b
</span><span class="hs-identifier hs-var">S.foldM_</span></span><span> </span><span class="annot"><span class="annottext">ChainValidationState
-&gt; ABlockOrBoundary ByteString
-&gt; ExceptT Error ResIO ChainValidationState
forall (m :: * -&gt; *).
MonadIO m =&gt;
ChainValidationState
-&gt; ABlockOrBoundary ByteString
-&gt; ExceptT Error m ChainValidationState
</span><a href="#local-6989586621679445244"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainValidationState -&gt; ExceptT Error ResIO ChainValidationState
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ChainValidationState
</span><a href="#local-6989586621679445247"><span class="hs-identifier hs-var">cvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ChainValidationState -&gt; ExceptT Error ResIO ChainValidationState
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall a. ExceptT ParseError ResIO a -&gt; ExceptT Error ResIO a)
-&gt; Stream
     (Of (ABlockOrBoundary ByteString)) (ExceptT ParseError ResIO) ()
-&gt; Stream
     (Of (ABlockOrBoundary ByteString)) (ExceptT Error ResIO) ()
forall k (t :: (* -&gt; *) -&gt; k -&gt; *) (m :: * -&gt; *) (n :: * -&gt; *)
       (b :: k).
(MFunctor t, Monad m) =&gt;
(forall a. m a -&gt; n a) -&gt; t m b -&gt; t n b
</span><span class="hs-identifier hs-var">hoist</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ParseError -&gt; Error)
-&gt; ExceptT ParseError ResIO a -&gt; ExceptT Error ResIO a
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><span class="hs-identifier hs-var">withExceptT</span></span><span> </span><span class="annot"><span class="annottext">ParseError -&gt; Error
</span><a href="Test.Cardano.Chain.Block.Validation.html#ErrorParseError"><span class="hs-identifier hs-var">ErrorParseError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream
  (Of (ABlockOrBoundary ByteString)) (ExceptT ParseError ResIO) ()
</span><a href="#local-6989586621679445246"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621679445352"><span class="annot"><a href="#local-6989586621679445244"><span class="hs-identifier hs-type">validate</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679445352"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ChainValidationState</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ABlockOrBoundary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Test.Cardano.Chain.Block.Validation.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445352"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ChainValidationState</span></a></span></span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621679445244"><span class="annot"><span class="annottext">validate :: ChainValidationState
-&gt; ABlockOrBoundary ByteString
-&gt; ExceptT Error m ChainValidationState
</span><a href="#local-6989586621679445244"><span class="hs-identifier hs-var hs-var">validate</span></a></span></span><span> </span><span id="local-6989586621679445242"><span class="annot"><span class="annottext">ChainValidationState
</span><a href="#local-6989586621679445242"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679445241"><span class="annot"><span class="annottext">ABlockOrBoundary ByteString
</span><a href="#local-6989586621679445241"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="annottext">(ChainValidationError -&gt; Error)
-&gt; ExceptT ChainValidationError m ChainValidationState
-&gt; ExceptT Error m ChainValidationState
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><span class="hs-identifier hs-var">withExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe SlotNumber -&gt; ChainValidationError -&gt; Error
</span><a href="Test.Cardano.Chain.Block.Validation.html#ErrorChainValidationError"><span class="hs-identifier hs-var">ErrorChainValidationError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ABlockOrBoundary ByteString -&gt; Maybe SlotNumber
forall a. ABlockOrBoundary a -&gt; Maybe SlotNumber
</span><a href="#local-6989586621679445240"><span class="hs-identifier hs-var">blockOrBoundarySlot</span></a></span><span> </span><span class="annot"><span class="annottext">ABlockOrBoundary ByteString
</span><a href="#local-6989586621679445241"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>      </span><span class="annot"><span class="annottext">(ExceptT ChainValidationError m ChainValidationState
 -&gt; ExceptT Error m ChainValidationState)
-&gt; (ReaderT
      ValidationMode
      (ExceptT ChainValidationError m)
      ChainValidationState
    -&gt; ExceptT ChainValidationError m ChainValidationState)
-&gt; ReaderT
     ValidationMode
     (ExceptT ChainValidationError m)
     ChainValidationState
-&gt; ExceptT Error m ChainValidationState
forall k (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT
  ValidationMode
  (ExceptT ChainValidationError m)
  ChainValidationState
-&gt; ValidationMode
-&gt; ExceptT ChainValidationError m ChainValidationState
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-operator hs-var hs-var">`runReaderT`</span></span><span> </span><span class="annot"><span class="annottext">BlockValidationMode -&gt; ValidationMode
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-var">fromBlockValidationMode</span></a></span><span> </span><span class="annot"><span class="annottext">BlockValidationMode
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-var">BlockValidation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>      </span><span class="annot"><span class="annottext">(ReaderT
   ValidationMode
   (ExceptT ChainValidationError m)
   ChainValidationState
 -&gt; ExceptT Error m ChainValidationState)
-&gt; ReaderT
     ValidationMode
     (ExceptT ChainValidationError m)
     ChainValidationState
-&gt; ExceptT Error m ChainValidationState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ABlockOrBoundary ByteString
</span><a href="#local-6989586621679445241"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-123"></span><span>          </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ABOBBoundary</span></a></span><span> </span><span id="local-6989586621679445237"><span class="annot"><span class="annottext">ABoundaryBlock ByteString
</span><a href="#local-6989586621679445237"><span class="hs-identifier hs-var">bvd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ShouldAssertNF
</span><a href="#local-6989586621679445249"><span class="hs-identifier hs-var">shouldAssertNF</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-125"></span><span>              </span><span class="annot"><span class="annottext">ShouldAssertNF
</span><a href="Test.Options.html#AssertNF"><span class="hs-identifier hs-var">AssertNF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>                </span><span id="local-6989586621679445235"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679445235"><span class="hs-identifier hs-var">isNF</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool
-&gt; ReaderT ValidationMode (ExceptT ChainValidationError m) Bool
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Bool
 -&gt; ReaderT ValidationMode (ExceptT ChainValidationError m) Bool)
-&gt; IO Bool
-&gt; ReaderT ValidationMode (ExceptT ChainValidationError m) Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChainValidationState -&gt; IO Bool
forall a. a -&gt; IO Bool
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-prelude-0.1.0.0/noopt/doc/html/cardano-prelude/src"><span class="hs-identifier hs-var">isNormalForm</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainValidationState -&gt; IO Bool)
-&gt; ChainValidationState -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">ChainValidationState
</span><a href="#local-6989586621679445242"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-127"></span><span>                </span><span class="annot"><span class="annottext">Bool
-&gt; ReaderT ValidationMode (ExceptT ChainValidationError m) ()
-&gt; ReaderT ValidationMode (ExceptT ChainValidationError m) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span>
</span><span id="line-128"></span><span>                  </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679445235"><span class="hs-identifier hs-var">isNF</span></a></span><span>
</span><span id="line-129"></span><span>                  </span><span class="hs-special">(</span><span>  </span><span class="annot"><span class="annottext">Text -&gt; ReaderT ValidationMode (ExceptT ChainValidationError m) ()
forall a. HasCallStack =&gt; Text -&gt; a
</span><span class="hs-identifier hs-var">panic</span></span><span>
</span><span id="line-130"></span><span>                  </span><span class="annot"><span class="annottext">(Text
 -&gt; ReaderT ValidationMode (ExceptT ChainValidationError m) ())
-&gt; Text
-&gt; ReaderT ValidationMode (ExceptT ChainValidationError m) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;ChainValidationState not in normal form at slot: &quot;</span></span><span>
</span><span id="line-131"></span><span>                  </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SlotNumber -&gt; Text
forall a b. (Show a, ConvertText String b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainValidationState -&gt; SlotNumber
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-var hs-var">cvsLastSlot</span></a></span><span> </span><span class="annot"><span class="annottext">ChainValidationState
</span><a href="#local-6989586621679445242"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>              </span><span class="annot"><span class="annottext">ShouldAssertNF
</span><a href="Test.Options.html#NoAssertNF"><span class="hs-identifier hs-var">NoAssertNF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ReaderT ValidationMode (ExceptT ChainValidationError m) ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>            </span><span class="annot"><span class="annottext">ChainValidationState
-&gt; ABoundaryBlock ByteString
-&gt; ReaderT
     ValidationMode
     (ExceptT ChainValidationError m)
     ChainValidationState
forall (m :: * -&gt; *).
MonadError ChainValidationError m =&gt;
ChainValidationState
-&gt; ABoundaryBlock ByteString -&gt; m ChainValidationState
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-var">updateChainBoundary</span></a></span><span> </span><span class="annot"><span class="annottext">ChainValidationState
</span><a href="#local-6989586621679445242"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ABoundaryBlock ByteString
</span><a href="#local-6989586621679445237"><span class="hs-identifier hs-var">bvd</span></a></span><span>
</span><span id="line-135"></span><span>          </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ABOBBlock</span></a></span><span> </span><span id="local-6989586621679445228"><span class="annot"><span class="annottext">ABlock ByteString
</span><a href="#local-6989586621679445228"><span class="hs-identifier hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Config
-&gt; ChainValidationState
-&gt; ABlock ByteString
-&gt; ReaderT
     ValidationMode
     (ExceptT ChainValidationError m)
     ChainValidationState
forall (m :: * -&gt; *).
(MonadError ChainValidationError m,
 MonadReader ValidationMode m) =&gt;
Config
-&gt; ChainValidationState
-&gt; ABlock ByteString
-&gt; m ChainValidationState
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-var">updateBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679445248"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ChainValidationState
</span><a href="#local-6989586621679445242"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ABlock ByteString
</span><a href="#local-6989586621679445228"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>  </span><span id="local-6989586621679445332"><span class="annot"><a href="#local-6989586621679445240"><span class="hs-identifier hs-type">blockOrBoundarySlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ABlockOrBoundary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445332"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">SlotNumber</span></a></span></span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621679445240"><span class="annot"><span class="annottext">blockOrBoundarySlot :: ABlockOrBoundary a -&gt; Maybe SlotNumber
</span><a href="#local-6989586621679445240"><span class="hs-identifier hs-var hs-var">blockOrBoundarySlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ABOBBoundary</span></a></span><span> </span><span class="annot"><span class="annottext">ABoundaryBlock a
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe SlotNumber
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-type">ABOBBlock</span></a></span><span>    </span><span id="local-6989586621679445227"><span class="annot"><span class="annottext">ABlock a
</span><a href="#local-6989586621679445227"><span class="hs-identifier hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SlotNumber -&gt; Maybe SlotNumber
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(SlotNumber -&gt; Maybe SlotNumber) -&gt; SlotNumber -&gt; Maybe SlotNumber
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ABlock a -&gt; SlotNumber
forall a. ABlock a -&gt; SlotNumber
</span><a href="../file:///__w/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.2/cardano-ledger-0.1.0.0/noopt/doc/html/cardano-ledger/src"><span class="hs-identifier hs-var">blockSlot</span></a></span><span> </span><span class="annot"><span class="annottext">ABlock a
</span><a href="#local-6989586621679445227"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-141"></span></pre></body></html>