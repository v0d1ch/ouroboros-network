<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_Fn2SeS69nNBEEX93ZtWn8j"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns               #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds                  #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass             #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric              #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies         #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification  #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts           #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances          #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures             #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards            #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables        #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving         #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications           #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies               #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances       #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE UndecidableSuperClasses    #-}</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">-- | Proof of concept implementation of Praos</span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ouroboros.Consensus.Mock.Protocol.Praos</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier">HotKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyEvolutionError"><span class="hs-identifier">HotKeyEvolutionError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier">Praos</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier">PraosChainDepState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosEvolvingStake"><span class="hs-identifier">PraosEvolvingStake</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier">PraosExtraFields</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier">PraosFields</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier">PraosParams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#emptyPraosEvolvingStake"><span class="hs-identifier">emptyPraosEvolvingStake</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#evolveKey"><span class="hs-identifier">evolveKey</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#forgePraosFields"><span class="hs-identifier">forgePraosFields</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Tags</span></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier">PraosCrypto</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosMockCrypto"><span class="hs-identifier">PraosMockCrypto</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosStandardCrypto"><span class="hs-identifier">PraosStandardCrypto</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier">PraosValidateView</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier">PraosValidationError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosValidateView"><span class="hs-identifier">praosValidateView</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Type instances</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier">BlockInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ticked</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Binary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromCBOR</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToCBOR</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">serializeEncoding'</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Decoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">decodeListLenOf</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.CBOR.Encoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encodeListLen</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.Serialise</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Serialise</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">unless</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">Control.Monad.Except</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">throwError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">Data.Typeable</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">GHC.Stack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">HasCallStack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">NoThunks.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">Numeric.Natural</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.DSIGN.Ed448</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ed448DSIGN</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.Hash.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HashAlgorithm</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hashToBytes</span></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>                     </span><span class="annot"><span class="hs-identifier">hashWithSerialiser</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sizeHash</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.Hash.SHA256</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SHA256</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.KES.Class</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.KES.Mock</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.KES.Simple</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.Util</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.VRF.Class</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.VRF.Mock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MockVRF</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.VRF.Simple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SimpleVRF</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Cardano.Slotting.EpochInfo</span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Block</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html"><span class="hs-identifier">Ouroboros.Consensus.Mock.Ledger.Stake</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.NodeId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">CoreNodeId</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Protocol.Abstract</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Protocol.Signed</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier">Ouroboros.Consensus.Util.Condense</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- The Praos paper can be located at https://ia.cr/2017/573</span><span>
</span><span id="line-83"></span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- A block as defined in Praos (section 3, definition 2, then extended in Fig 9)</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- consist of a tuple:</span><span>
</span><span id="line-86"></span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- &gt; B = (sl&#11388;, st, d, B_&#960;j, &#961;, &#963;&#11388;)</span><span>
</span><span id="line-88"></span><span class="hs-comment">--</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- where</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- - sl&#11388;: the slot at which the block was generated.</span><span>
</span><span id="line-91"></span><span class="hs-comment">--        Named 'simpleSlotNo' in the 'SimpleStdHeader' block header.</span><span>
</span><span id="line-92"></span><span class="hs-comment">--        As far as consensus is concerned this will be accessed through</span><span>
</span><span id="line-93"></span><span class="hs-comment">--        'biSlot' in each block in the 'ChainDepState'.</span><span>
</span><span id="line-94"></span><span class="hs-comment">--</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- - st: state, a string &#8712; {0,1}^&#955;, which holds the hash of the previous block.</span><span>
</span><span id="line-96"></span><span class="hs-comment">--       Named 'simplePrev' in the 'SimpleStdHeader' block header.</span><span>
</span><span id="line-97"></span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- - d: data (transaction data in most cases).</span><span>
</span><span id="line-99"></span><span class="hs-comment">--      Named 'simpleBody' inside 'SimpleBlock'.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- - B_&#960;j: block proof consisting of (U&#7522;, y, &#960;).</span><span>
</span><span id="line-102"></span><span class="hs-comment">--         Named 'praosY' inside 'PraosExtraFields'.</span><span>
</span><span id="line-103"></span><span class="hs-comment">--      - y: a VRF output used to confirm that U&#7522; was the slot leader.</span><span>
</span><span id="line-104"></span><span class="hs-comment">--      - &#960;: the VRF proof of the above value.</span><span>
</span><span id="line-105"></span><span class="hs-comment">--</span><span>
</span><span id="line-106"></span><span class="hs-comment">--      &gt; (y, &#960;) &#8796; VRF_evalProve(&#951;, sl&#11388;, TEST) see Fig 9</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- - &#961;: the block nonce consisting of (&#961;_y, &#961;_&#960;), to capture entropy from the</span><span>
</span><span id="line-109"></span><span class="hs-comment">--      block forging process.</span><span>
</span><span id="line-110"></span><span class="hs-comment">--      Named 'praosRho' inside 'PraosExtraFields'.</span><span>
</span><span id="line-111"></span><span class="hs-comment">--      - &#961;_y: a VRF output used to confirm this block captured all the previous</span><span>
</span><span id="line-112"></span><span class="hs-comment">--             entropy.</span><span>
</span><span id="line-113"></span><span class="hs-comment">--      - &#961;_&#960;: the VRF proof of the above value.</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">--      &gt; (&#961;_y, &#961;_&#960;) &#8796; VRF_evalProve(&#951;, sl&#11388;, NONCE) see Fig 9</span><span>
</span><span id="line-116"></span><span class="hs-comment">--</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- - &#963;&#11388;: a signature on (st, d, sl&#11388;, B_&#960;j, &#961;) with the signing key</span><span>
</span><span id="line-118"></span><span class="hs-comment">--       for the slot sl&#11388; for the stakeholder U&#7522;.</span><span>
</span><span id="line-119"></span><span class="hs-comment">--       Named 'praosSignature' in 'PraosFields'.</span><span>
</span><span id="line-120"></span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- Protocol parameters:</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- - k: maximum number of blocks we can rollback.</span><span>
</span><span id="line-123"></span><span class="hs-comment">--      Named 'praosSecurityParam' in 'PraosParams'.</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- - R: number of slots per epoch.</span><span>
</span><span id="line-125"></span><span class="hs-comment">--      Named 'praosSlotsPerEpoch' in 'PraosParams'.</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- - f: the active slots coefficient, specifies roughly the proportion of</span><span>
</span><span id="line-127"></span><span class="hs-comment">--      occupied slots per epoch.</span><span>
</span><span id="line-128"></span><span class="hs-comment">--      Named 'praosLeaderF' in 'PraosParams'.</span><span>
</span><span id="line-129"></span><span class="hs-comment">--</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- Some values you will encounter:</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- - &#951;: The epoch's nonce. Captures entropy from the block chain. See Fig 8 in</span><span>
</span><span id="line-132"></span><span class="hs-comment">--      praos paper for where it is used and Fig 10 for how it is defined.</span><span>
</span><span id="line-133"></span><span class="hs-comment">--      Defined as the hash of the &#951; from the previous epoch, this epoch number</span><span>
</span><span id="line-134"></span><span class="hs-comment">--      and the &#961; of the first 2/3 of the blocks in the previous epoch.</span><span>
</span><span id="line-135"></span><span class="hs-comment">--      Commonly named through the code as 'eta'.</span><span>
</span><span id="line-136"></span><span class="hs-comment">--</span><span>
</span><span id="line-137"></span><span class="hs-comment">--      &gt; &#951;_e &#8796; HASH(&#951;_{e-1} || e || &#961;_{e-1,0} ... &#961;_{e-1, 2R/3})</span><span>
</span><span id="line-138"></span><span class="hs-comment">--</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- - T&#7522;: the leader threshold for a specific stakeholder considering its</span><span>
</span><span id="line-140"></span><span class="hs-comment">--       relative stake (therefore depending on the slot). Defined in the Praos</span><span>
</span><span id="line-141"></span><span class="hs-comment">--       paper in Figure 4 using the definition for &#981;_f(&#945;&#7522;) from section 3.3.</span><span>
</span><span id="line-142"></span><span class="hs-comment">--       Named 't' in the code but essentially computed by 'leaderThreshold' in</span><span>
</span><span id="line-143"></span><span class="hs-comment">--       'rhoYT'.</span><span>
</span><span id="line-144"></span><span class="hs-comment">--</span><span>
</span><span id="line-145"></span><span class="hs-comment">--       &gt; T&#7522; &#8796; 2^(l_VRF) * p&#7522;</span><span>
</span><span id="line-146"></span><span class="hs-comment">--       &gt; p&#7522; = &#981;_f(&#945;&#7522;) &#8796; 1 - (1 - f)^(&#945;&#7522;)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Fields required by Praos in the header
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | The fields that Praos required in the header</span><span>
</span><span id="line-153"></span><span id="local-6989586621679171062"><span id="local-6989586621679171063"></span></span><span class="hs-keyword">data</span><span> </span><span id="PraosFields"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-var">PraosFields</span></a></span></span><span> </span><span id="local-6989586621679171275"><span class="annot"><a href="#local-6989586621679171275"><span class="hs-identifier hs-type">crypto</span></a></span></span><span> </span><span id="local-6989586621679171274"><span class="annot"><a href="#local-6989586621679171274"><span class="hs-identifier hs-type">typeBeingSigned</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PraosFields"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-var">PraosFields</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-154"></span><span>      </span><span id="praosSignature"><span class="annot"><span class="annottext">PraosFields crypto typeBeingSigned
-&gt; SignedKES (PraosKES crypto) typeBeingSigned
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosSignature"><span class="hs-identifier hs-var hs-var">praosSignature</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SignedKES</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171275"><span class="hs-identifier hs-type">crypto</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679171274"><span class="hs-identifier hs-type">typeBeingSigned</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosExtraFields"><span class="annot"><span class="annottext">PraosFields crypto typeBeingSigned -&gt; PraosExtraFields crypto
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosExtraFields"><span class="hs-identifier hs-var hs-var">praosExtraFields</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171275"><span class="hs-identifier hs-type">crypto</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x.
 PraosFields crypto typeBeingSigned
 -&gt; Rep (PraosFields crypto typeBeingSigned) x)
-&gt; (forall x.
    Rep (PraosFields crypto typeBeingSigned) x
    -&gt; PraosFields crypto typeBeingSigned)
-&gt; Generic (PraosFields crypto typeBeingSigned)
forall x.
Rep (PraosFields crypto typeBeingSigned) x
-&gt; PraosFields crypto typeBeingSigned
forall x.
PraosFields crypto typeBeingSigned
-&gt; Rep (PraosFields crypto typeBeingSigned) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall crypto typeBeingSigned x.
Rep (PraosFields crypto typeBeingSigned) x
-&gt; PraosFields crypto typeBeingSigned
forall crypto typeBeingSigned x.
PraosFields crypto typeBeingSigned
-&gt; Rep (PraosFields crypto typeBeingSigned) x
$cto :: forall crypto typeBeingSigned x.
Rep (PraosFields crypto typeBeingSigned) x
-&gt; PraosFields crypto typeBeingSigned
$cfrom :: forall crypto typeBeingSigned x.
PraosFields crypto typeBeingSigned
-&gt; Rep (PraosFields crypto typeBeingSigned) x
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span id="local-6989586621679171054"><span id="local-6989586621679171055"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679171048"><span id="local-6989586621679171050"><span id="local-6989586621679171052"><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171055"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171054"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171055"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171054"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span id="local-6989586621679171039"><span id="local-6989586621679171041"><span id="local-6989586621679171043"><span id="local-6989586621679171045"><span id="local-6989586621679171046"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171046"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171046"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171045"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-162"></span><span id="local-6989586621679171032"><span id="local-6989586621679171034"><span id="local-6989586621679171036"><span id="local-6989586621679171037"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171037"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171037"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171036"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Fields that should be included in the signature</span><span>
</span><span id="line-165"></span><span id="local-6989586621679171029"><span id="local-6989586621679171030"></span></span><span class="hs-keyword">data</span><span> </span><span id="PraosExtraFields"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-var">PraosExtraFields</span></a></span></span><span> </span><span id="local-6989586621679171269"><span class="annot"><a href="#local-6989586621679171269"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PraosExtraFields"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-var">PraosExtraFields</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-166"></span><span>      </span><span id="praosCreator"><span class="annot"><span class="annottext">PraosExtraFields c -&gt; CoreNodeId
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosCreator"><span class="hs-identifier hs-var hs-var">praosCreator</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosRho"><span class="annot"><span class="annottext">PraosExtraFields c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosRho"><span class="hs-identifier hs-var hs-var">praosRho</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CertifiedVRF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171269"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosY"><span class="annot"><span class="annottext">PraosExtraFields c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosY"><span class="hs-identifier hs-var hs-var">praosY</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CertifiedVRF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171269"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. PraosExtraFields c -&gt; Rep (PraosExtraFields c) x)
-&gt; (forall x. Rep (PraosExtraFields c) x -&gt; PraosExtraFields c)
-&gt; Generic (PraosExtraFields c)
forall x. Rep (PraosExtraFields c) x -&gt; PraosExtraFields c
forall x. PraosExtraFields c -&gt; Rep (PraosExtraFields c) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x. Rep (PraosExtraFields c) x -&gt; PraosExtraFields c
forall c x. PraosExtraFields c -&gt; Rep (PraosExtraFields c) x
$cto :: forall c x. Rep (PraosExtraFields c) x -&gt; PraosExtraFields c
$cfrom :: forall c x. PraosExtraFields c -&gt; Rep (PraosExtraFields c) x
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span id="local-6989586621679171022"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679171016"><span id="local-6989586621679171018"><span id="local-6989586621679171020"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171022"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171022"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span id="local-6989586621679171009"><span id="local-6989586621679171011"><span id="local-6989586621679171013"><span id="local-6989586621679171015"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171015"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171015"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-175"></span><span id="local-6989586621679171004"><span id="local-6989586621679171006"><span id="local-6989586621679171008"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171008"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171008"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | A validate view is an association from the (@signed@) value to the</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- @PraosFields@ that contains the signature that sign it.</span><span>
</span><span id="line-179"></span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- In this mock implementation, this could have been simplified to use</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- @SignedSimplePraos@ but from the consensus point of view, it is not relevant</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- which actual value is being signed, that's why we use the existential.</span><span>
</span><span id="line-183"></span><span class="hs-keyword">data</span><span> </span><span id="PraosValidateView"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-var">PraosValidateView</span></a></span></span><span> </span><span id="local-6989586621679171310"><span class="annot"><a href="#local-6989586621679171310"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679171309"><span class="annot"><a href="#local-6989586621679171309"><span class="hs-identifier hs-type">signed</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.Crypto.KES.Class.Signable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171310"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679171309"><span class="hs-identifier hs-type">signed</span></a></span><span>
</span><span id="line-185"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span id="PraosValidateView"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-var">PraosValidateView</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171310"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171309"><span class="hs-identifier hs-type">signed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679171309"><span class="hs-identifier hs-type">signed</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | Convenience constructor for 'PraosValidateView'</span><span>
</span><span id="line-188"></span><span id="local-6989586621679171001"><span id="local-6989586621679171002"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosValidateView"><span class="hs-identifier hs-type">praosValidateView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">SignedHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171002"><span class="hs-identifier hs-type">hdr</span></a></span><span>
</span><span id="line-189"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.Crypto.KES.Class.Signable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171001"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">Signed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171002"><span class="hs-identifier hs-type">hdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>                     </span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679171002"><span class="hs-identifier hs-type">hdr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171001"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">Signed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171002"><span class="hs-identifier hs-type">hdr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679171002"><span class="hs-identifier hs-type">hdr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-type">PraosValidateView</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171001"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-193"></span><span id="praosValidateView"><span class="annot"><span class="annottext">praosValidateView :: (hdr -&gt; PraosFields c (Signed hdr)) -&gt; hdr -&gt; PraosValidateView c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosValidateView"><span class="hs-identifier hs-var hs-var">praosValidateView</span></a></span></span><span> </span><span id="local-6989586621679171000"><span class="annot"><span class="annottext">hdr -&gt; PraosFields c (Signed hdr)
</span><a href="#local-6989586621679171000"><span class="hs-identifier hs-var">getFields</span></a></span></span><span> </span><span id="local-6989586621679170999"><span class="annot"><span class="annottext">hdr
</span><a href="#local-6989586621679170999"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">PraosFields c (Signed hdr) -&gt; Signed hdr -&gt; PraosValidateView c
forall c signed.
Signable (PraosKES c) signed =&gt;
PraosFields c signed -&gt; signed -&gt; PraosValidateView c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-var">PraosValidateView</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">hdr -&gt; PraosFields c (Signed hdr)
</span><a href="#local-6989586621679171000"><span class="hs-identifier hs-var">getFields</span></a></span><span> </span><span class="annot"><span class="annottext">hdr
</span><a href="#local-6989586621679170999"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">hdr -&gt; Signed hdr
forall hdr. SignedHeader hdr =&gt; hdr -&gt; Signed hdr
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">headerSigned</span></a></span><span> </span><span class="annot"><span class="annottext">hdr
</span><a href="#local-6989586621679170999"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Forging
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | The key used for the given period or a stub Poisoned value.</span><span>
</span><span id="line-201"></span><span class="hs-comment">--</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- A key will be poisoned if it failed to evolve by @updateKES@, and will remain</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- poisoned forever after that.</span><span>
</span><span id="line-204"></span><span id="local-6989586621679170996"><span id="local-6989586621679170997"></span></span><span class="hs-keyword">data</span><span> </span><span id="HotKey"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-var">HotKey</span></a></span></span><span> </span><span id="local-6989586621679171287"><span class="annot"><a href="#local-6989586621679171287"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>    </span><span id="HotKey"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-var">HotKey</span></a></span></span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Period</span></span><span>  </span><span class="hs-comment">-- ^ Absolute period of the KES key</span><span>
</span><span id="line-207"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SignKeyKES</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171287"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="HotKeyPoisoned"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyPoisoned"><span class="hs-identifier hs-var">HotKeyPoisoned</span></a></span></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. HotKey c -&gt; Rep (HotKey c) x)
-&gt; (forall x. Rep (HotKey c) x -&gt; HotKey c) -&gt; Generic (HotKey c)
forall x. Rep (HotKey c) x -&gt; HotKey c
forall x. HotKey c -&gt; Rep (HotKey c) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x. Rep (HotKey c) x -&gt; HotKey c
forall c x. HotKey c -&gt; Rep (HotKey c) x
$cto :: forall c x. Rep (HotKey c) x -&gt; HotKey c
$cfrom :: forall c x. HotKey c -&gt; Rep (HotKey c) x
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span id="local-6989586621679170991"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679170985"><span id="local-6989586621679170987"><span id="local-6989586621679170989"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170991"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170991"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-212"></span><span id="local-6989586621679170978"><span id="local-6989586621679170980"><span id="local-6989586621679170982"><span id="local-6989586621679170984"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170984"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170984"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | The 'HotKey' could not be evolved to the given 'Period'.</span><span>
</span><span id="line-215"></span><span class="hs-keyword">newtype</span><span> </span><span id="HotKeyEvolutionError"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyEvolutionError"><span class="hs-identifier hs-var">HotKeyEvolutionError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HotKeyEvolutionError"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyEvolutionError"><span class="hs-identifier hs-var">HotKeyEvolutionError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Period</span></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679170971"><span id="local-6989586621679170973"><span id="local-6989586621679170975"><span class="annot"><span class="annottext">Int -&gt; HotKeyEvolutionError -&gt; ShowS
[HotKeyEvolutionError] -&gt; ShowS
HotKeyEvolutionError -&gt; String
(Int -&gt; HotKeyEvolutionError -&gt; ShowS)
-&gt; (HotKeyEvolutionError -&gt; String)
-&gt; ([HotKeyEvolutionError] -&gt; ShowS)
-&gt; Show HotKeyEvolutionError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HotKeyEvolutionError] -&gt; ShowS
$cshowList :: [HotKeyEvolutionError] -&gt; ShowS
show :: HotKeyEvolutionError -&gt; String
$cshow :: HotKeyEvolutionError -&gt; String
showsPrec :: Int -&gt; HotKeyEvolutionError -&gt; ShowS
$cshowsPrec :: Int -&gt; HotKeyEvolutionError -&gt; ShowS
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">-- | To be used in conjunction with, e.g., 'updateMVar'.</span><span>
</span><span id="line-219"></span><span class="hs-comment">--</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- NOTE: when the key's period is after the target period, we shouldn't use</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- it, but we currently do. In real TPraos we check this in</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- 'tpraosCheckCanForge'.</span><span>
</span><span id="line-223"></span><span id="local-6989586621679171283"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#evolveKey"><span class="hs-identifier hs-type">evolveKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-224"></span><span>     </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171283"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171283"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171283"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">UpdateInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171283"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyEvolutionError"><span class="hs-identifier hs-type">HotKeyEvolutionError</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-228"></span><span id="evolveKey"><span class="annot"><span class="annottext">evolveKey :: SlotNo
-&gt; HotKey c
-&gt; (HotKey c, UpdateInfo (HotKey c) HotKeyEvolutionError)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#evolveKey"><span class="hs-identifier hs-var hs-var">evolveKey</span></a></span></span><span> </span><span id="local-6989586621679170970"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170970"><span class="hs-identifier hs-var">slotNo</span></a></span></span><span> </span><span id="local-6989586621679170969"><span class="annot"><span class="annottext">HotKey c
</span><a href="#local-6989586621679170969"><span class="hs-identifier hs-var">hotKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HotKey c
</span><a href="#local-6989586621679170969"><span class="hs-identifier hs-var">hotKey</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span id="local-6989586621679170968"><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679170968"><span class="hs-identifier hs-var">keyPeriod</span></a></span></span><span> </span><span id="local-6989586621679170967"><span class="annot"><span class="annottext">SignKeyKES (PraosKES c)
</span><a href="#local-6989586621679170967"><span class="hs-identifier hs-var">oldKey</span></a></span></span><span>
</span><span id="line-230"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679170968"><span class="hs-identifier hs-var">keyPeriod</span></a></span><span> </span><span class="annot"><span class="annottext">Period -&gt; Period -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679170966"><span class="hs-identifier hs-var">targetPeriod</span></a></span><span>
</span><span id="line-231"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HotKey c
</span><a href="#local-6989586621679170969"><span class="hs-identifier hs-var">hotKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HotKey c -&gt; UpdateInfo (HotKey c) HotKeyEvolutionError
forall updated failed. updated -&gt; UpdateInfo updated failed
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">Updated</span></a></span><span> </span><span class="annot"><span class="annottext">HotKey c
</span><a href="#local-6989586621679170969"><span class="hs-identifier hs-var">hotKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-233"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ContextKES (PraosKES c)
-&gt; SignKeyKES (PraosKES c)
-&gt; Period
-&gt; Maybe (SignKeyKES (PraosKES c))
forall v.
(KESAlgorithm v, HasCallStack) =&gt;
ContextKES v -&gt; SignKeyKES v -&gt; Period -&gt; Maybe (SignKeyKES v)
</span><span class="hs-identifier hs-var">updateKES</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SignKeyKES (PraosKES c)
</span><a href="#local-6989586621679170967"><span class="hs-identifier hs-var">oldKey</span></a></span><span> </span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679170968"><span class="hs-identifier hs-var">keyPeriod</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-234"></span><span>           </span><span class="annot"><span class="annottext">Maybe (SignKeyKES (PraosKES c))
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-235"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HotKey c
forall c. HotKey c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyPoisoned"><span class="hs-identifier hs-var">HotKeyPoisoned</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HotKeyEvolutionError -&gt; UpdateInfo (HotKey c) HotKeyEvolutionError
forall updated failed. failed -&gt; UpdateInfo updated failed
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">UpdateFailed</span></a></span><span> </span><span class="annot"><span class="annottext">(HotKeyEvolutionError
 -&gt; UpdateInfo (HotKey c) HotKeyEvolutionError)
-&gt; HotKeyEvolutionError
-&gt; UpdateInfo (HotKey c) HotKeyEvolutionError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Period -&gt; HotKeyEvolutionError
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyEvolutionError"><span class="hs-identifier hs-var">HotKeyEvolutionError</span></a></span><span> </span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679170966"><span class="hs-identifier hs-var">targetPeriod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>           </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679170962"><span class="annot"><span class="annottext">SignKeyKES (PraosKES c)
</span><a href="#local-6989586621679170962"><span class="hs-identifier hs-var">newKey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-237"></span><span>             </span><span class="annot"><span class="annottext">SlotNo
-&gt; HotKey c
-&gt; (HotKey c, UpdateInfo (HotKey c) HotKeyEvolutionError)
forall c.
PraosCrypto c =&gt;
SlotNo
-&gt; HotKey c
-&gt; (HotKey c, UpdateInfo (HotKey c) HotKeyEvolutionError)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#evolveKey"><span class="hs-identifier hs-var">evolveKey</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170970"><span class="hs-identifier hs-var">slotNo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Period -&gt; SignKeyKES (PraosKES c) -&gt; HotKey c
forall c. Period -&gt; SignKeyKES (PraosKES c) -&gt; HotKey c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-var">HotKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679170968"><span class="hs-identifier hs-var">keyPeriod</span></a></span><span> </span><span class="annot"><span class="annottext">Period -&gt; Period -&gt; Period
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Period
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SignKeyKES (PraosKES c)
</span><a href="#local-6989586621679170962"><span class="hs-identifier hs-var">newKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><span class="annottext">HotKey c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyPoisoned"><span class="hs-identifier hs-var">HotKeyPoisoned</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-239"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HotKey c
forall c. HotKey c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyPoisoned"><span class="hs-identifier hs-var">HotKeyPoisoned</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HotKeyEvolutionError -&gt; UpdateInfo (HotKey c) HotKeyEvolutionError
forall updated failed. failed -&gt; UpdateInfo updated failed
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">UpdateFailed</span></a></span><span> </span><span class="annot"><span class="annottext">(HotKeyEvolutionError
 -&gt; UpdateInfo (HotKey c) HotKeyEvolutionError)
-&gt; HotKeyEvolutionError
-&gt; UpdateInfo (HotKey c) HotKeyEvolutionError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Period -&gt; HotKeyEvolutionError
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyEvolutionError"><span class="hs-identifier hs-var">HotKeyEvolutionError</span></a></span><span> </span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679170966"><span class="hs-identifier hs-var">targetPeriod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>   </span><span class="annot"><a href="#local-6989586621679170966"><span class="hs-identifier hs-type">targetPeriod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Period</span></span><span>
</span><span id="line-242"></span><span>   </span><span id="local-6989586621679170966"><span class="annot"><span class="annottext">targetPeriod :: Period
</span><a href="#local-6989586621679170966"><span class="hs-identifier hs-var hs-var">targetPeriod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Period
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Period) -&gt; Word64 -&gt; Period
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Word64
</span><span class="hs-identifier hs-var hs-var">unSlotNo</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170970"><span class="hs-identifier hs-var">slotNo</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | Create a PraosFields using a proof, a key and the data to be signed.</span><span>
</span><span id="line-245"></span><span class="hs-comment">--</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- It is done by signing whatever is extracted from the extra fields by @mkToSign@</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- and storing the signature and the extra fields on a @PraosFields@.</span><span>
</span><span id="line-248"></span><span id="local-6989586621679170958"><span id="local-6989586621679170959"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#forgePraosFields"><span class="hs-identifier hs-type">forgePraosFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170959"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-249"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.Crypto.KES.Class.Signable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170959"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679170958"><span class="hs-identifier hs-type">toSign</span></a></span><span>
</span><span id="line-250"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span>
</span><span id="line-251"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosProof"><span class="hs-identifier hs-type">PraosProof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170959"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-253"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170959"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-254"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170959"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679170958"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170959"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170958"><span class="hs-identifier hs-type">toSign</span></a></span></span></span><span>
</span><span id="line-256"></span><span id="forgePraosFields"><span class="annot"><span class="annottext">forgePraosFields :: PraosProof c
-&gt; HotKey c
-&gt; (PraosExtraFields c -&gt; toSign)
-&gt; PraosFields c toSign
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#forgePraosFields"><span class="hs-identifier hs-var hs-var">forgePraosFields</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosProof"><span class="hs-identifier hs-type">PraosProof</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170954"><span id="local-6989586621679170955"><span id="local-6989586621679170956"><span class="annot"><span class="annottext">CoreNodeId
CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosLeader :: forall c. PraosProof c -&gt; CoreNodeId
praosProofY :: forall c.
PraosProof c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosProofRho :: forall c.
PraosProof c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosLeader :: CoreNodeId
praosProofY :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosProofRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosLeader"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679170950"><span class="annot"><span class="annottext">HotKey c
</span><a href="#local-6989586621679170950"><span class="hs-identifier hs-var">hotKey</span></a></span></span><span> </span><span id="local-6989586621679170949"><span class="annot"><span class="annottext">PraosExtraFields c -&gt; toSign
</span><a href="#local-6989586621679170949"><span class="hs-identifier hs-var">mkToSign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HotKey c
</span><a href="#local-6989586621679170950"><span class="hs-identifier hs-var">hotKey</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-258"></span><span>      </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKey"><span class="hs-identifier hs-type">HotKey</span></a></span><span> </span><span id="local-6989586621679170948"><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679170948"><span class="hs-identifier hs-var">kesPeriod</span></a></span></span><span> </span><span id="local-6989586621679170947"><span class="annot"><span class="annottext">SignKeyKES (PraosKES c)
</span><a href="#local-6989586621679170947"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PraosFields :: forall crypto typeBeingSigned.
SignedKES (PraosKES crypto) typeBeingSigned
-&gt; PraosExtraFields crypto -&gt; PraosFields crypto typeBeingSigned
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-259"></span><span>          </span><span class="annot"><span class="annottext">praosSignature :: SignedKES (PraosKES c) toSign
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosSignature"><span class="hs-identifier hs-var">praosSignature</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextKES (PraosKES c)
-&gt; Period
-&gt; toSign
-&gt; SignKeyKES (PraosKES c)
-&gt; SignedKES (PraosKES c) toSign
forall v a.
(KESAlgorithm v, Signable v a) =&gt;
ContextKES v -&gt; Period -&gt; a -&gt; SignKeyKES v -&gt; SignedKES v a
</span><span class="hs-identifier hs-var">signedKES</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Period
</span><a href="#local-6989586621679170948"><span class="hs-identifier hs-var">kesPeriod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PraosExtraFields c -&gt; toSign
</span><a href="#local-6989586621679170949"><span class="hs-identifier hs-var">mkToSign</span></a></span><span> </span><span class="annot"><span class="annottext">PraosExtraFields c
</span><a href="#local-6989586621679170945"><span class="hs-identifier hs-var">fieldsToSign</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SignKeyKES (PraosKES c)
</span><a href="#local-6989586621679170947"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-260"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">praosExtraFields :: PraosExtraFields c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosExtraFields"><span class="hs-identifier hs-var">praosExtraFields</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosExtraFields c
</span><a href="#local-6989586621679170945"><span class="hs-identifier hs-var">fieldsToSign</span></a></span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="annottext">HotKey c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#HotKeyPoisoned"><span class="hs-identifier hs-var">HotKeyPoisoned</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PraosFields c toSign
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;trying to sign with a poisoned key&quot;</span></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621679170945"><span class="annot"><span class="annottext">fieldsToSign :: PraosExtraFields c
</span><a href="#local-6989586621679170945"><span class="hs-identifier hs-var hs-var">fieldsToSign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosExtraFields :: forall c.
CoreNodeId
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; PraosExtraFields c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">praosCreator :: CoreNodeId
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosCreator"><span class="hs-identifier hs-var">praosCreator</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679170954"><span class="hs-identifier hs-var">praosLeader</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">praosRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosRho"><span class="hs-identifier hs-var">praosRho</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170956"><span class="hs-identifier hs-var">praosProofRho</span></a></span><span>
</span><span id="line-267"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">praosY :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosY"><span class="hs-identifier hs-var">praosY</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170955"><span class="hs-identifier hs-var">praosProofY</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Mock stake distribution
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">-- | An association from epoch to stake distributions.</span><span>
</span><span id="line-275"></span><span class="hs-comment">--</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- Should be used when checking if someone is the leader of a particular slot.</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- This is sufficiently good for a mock protocol as far as consensus is</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- concerned. It is not strictly necessary that the stake distribution is</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- computed from previous epochs, as we just need to consider that:</span><span>
</span><span id="line-280"></span><span class="hs-comment">--</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- 1) an attacker cannot influence it.</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- 2) all the nodes agree on the same value for each Slot.</span><span>
</span><span id="line-283"></span><span class="hs-comment">--</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- Each pair stores the stake distribution established by the end of the epoch</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- in the first item of the pair. See 'latestEvolvedStakeDistAsOfEpoch' for the</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- intended interface.</span><span>
</span><span id="line-287"></span><span class="hs-comment">--</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- If no value is returned, that means we are checking the stake before any</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- changes have happened so we should consult instead the 'praosInitialStake'.</span><span>
</span><span id="line-290"></span><span class="hs-keyword">newtype</span><span> </span><span id="PraosEvolvingStake"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosEvolvingStake"><span class="hs-identifier hs-var">PraosEvolvingStake</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PraosEvolvingStake"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosEvolvingStake"><span class="hs-identifier hs-var">PraosEvolvingStake</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EpochNo</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html#StakeDist"><span class="hs-identifier hs-type">StakeDist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span id="local-6989586621679170937"><span id="local-6989586621679170939"><span id="local-6989586621679170941"><span class="annot"><span class="annottext">Int -&gt; PraosEvolvingStake -&gt; ShowS
[PraosEvolvingStake] -&gt; ShowS
PraosEvolvingStake -&gt; String
(Int -&gt; PraosEvolvingStake -&gt; ShowS)
-&gt; (PraosEvolvingStake -&gt; String)
-&gt; ([PraosEvolvingStake] -&gt; ShowS)
-&gt; Show PraosEvolvingStake
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PraosEvolvingStake] -&gt; ShowS
$cshowList :: [PraosEvolvingStake] -&gt; ShowS
show :: PraosEvolvingStake -&gt; String
$cshow :: PraosEvolvingStake -&gt; String
showsPrec :: Int -&gt; PraosEvolvingStake -&gt; ShowS
$cshowsPrec :: Int -&gt; PraosEvolvingStake -&gt; ShowS
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span id="local-6989586621679170931"><span id="local-6989586621679170933"><span id="local-6989586621679170935"><span class="annot"><span class="annottext">Context -&gt; PraosEvolvingStake -&gt; IO (Maybe ThunkInfo)
Proxy PraosEvolvingStake -&gt; String
(Context -&gt; PraosEvolvingStake -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; PraosEvolvingStake -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy PraosEvolvingStake -&gt; String)
-&gt; NoThunks PraosEvolvingStake
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy PraosEvolvingStake -&gt; String
$cshowTypeOf :: Proxy PraosEvolvingStake -&gt; String
wNoThunks :: Context -&gt; PraosEvolvingStake -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; PraosEvolvingStake -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; PraosEvolvingStake -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: Context -&gt; PraosEvolvingStake -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621679170931"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#emptyPraosEvolvingStake"><span class="hs-identifier hs-type">emptyPraosEvolvingStake</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosEvolvingStake"><span class="hs-identifier hs-type">PraosEvolvingStake</span></a></span><span>
</span><span id="line-295"></span><span id="emptyPraosEvolvingStake"><span class="annot"><span class="annottext">emptyPraosEvolvingStake :: PraosEvolvingStake
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#emptyPraosEvolvingStake"><span class="hs-identifier hs-var hs-var">emptyPraosEvolvingStake</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map EpochNo StakeDist -&gt; PraosEvolvingStake
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosEvolvingStake"><span class="hs-identifier hs-var">PraosEvolvingStake</span></a></span><span> </span><span class="annot"><span class="annottext">Map EpochNo StakeDist
forall k a. Map k a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#latestEvolvedStakeDistAsOfEpoch"><span class="hs-identifier hs-type">latestEvolvedStakeDistAsOfEpoch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosEvolvingStake"><span class="hs-identifier hs-type">PraosEvolvingStake</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EpochNo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html#StakeDist"><span class="hs-identifier hs-type">StakeDist</span></a></span><span>
</span><span id="line-298"></span><span id="latestEvolvedStakeDistAsOfEpoch"><span class="annot"><span class="annottext">latestEvolvedStakeDistAsOfEpoch :: PraosEvolvingStake -&gt; EpochNo -&gt; Maybe StakeDist
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#latestEvolvedStakeDistAsOfEpoch"><span class="hs-identifier hs-var hs-var">latestEvolvedStakeDistAsOfEpoch</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosEvolvingStake"><span class="hs-identifier hs-type">PraosEvolvingStake</span></a></span><span> </span><span id="local-6989586621679170928"><span class="annot"><span class="annottext">Map EpochNo StakeDist
</span><a href="#local-6989586621679170928"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679170927"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679170927"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-299"></span><span>  </span><span class="annot"><span class="annottext">((EpochNo, StakeDist) -&gt; StakeDist)
-&gt; Maybe (EpochNo, StakeDist) -&gt; Maybe StakeDist
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochNo, StakeDist) -&gt; StakeDist
forall a b. (a, b) -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (EpochNo, StakeDist) -&gt; Maybe StakeDist)
-&gt; ((Map EpochNo StakeDist, Map EpochNo StakeDist)
    -&gt; Maybe (EpochNo, StakeDist))
-&gt; (Map EpochNo StakeDist, Map EpochNo StakeDist)
-&gt; Maybe StakeDist
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map EpochNo StakeDist -&gt; Maybe (EpochNo, StakeDist)
forall k a. Map k a -&gt; Maybe (k, a)
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-var">Map.lookupMax</span></a></span><span> </span><span class="annot"><span class="annottext">(Map EpochNo StakeDist -&gt; Maybe (EpochNo, StakeDist))
-&gt; ((Map EpochNo StakeDist, Map EpochNo StakeDist)
    -&gt; Map EpochNo StakeDist)
-&gt; (Map EpochNo StakeDist, Map EpochNo StakeDist)
-&gt; Maybe (EpochNo, StakeDist)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Map EpochNo StakeDist, Map EpochNo StakeDist)
-&gt; Map EpochNo StakeDist
forall a b. (a, b) -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((Map EpochNo StakeDist, Map EpochNo StakeDist) -&gt; Maybe StakeDist)
-&gt; (Map EpochNo StakeDist, Map EpochNo StakeDist)
-&gt; Maybe StakeDist
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
-&gt; Map EpochNo StakeDist
-&gt; (Map EpochNo StakeDist, Map EpochNo StakeDist)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Map k a)
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-var">Map.split</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679170927"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Map EpochNo StakeDist
</span><a href="#local-6989586621679170928"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Praos specific types
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- |The two VRF invocation modes, NONCE (rho) and TEST (y). See the comment at</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- the top of the module for an explanation of these.</span><span>
</span><span id="line-307"></span><span id="local-6989586621679170922"><span id="local-6989586621679170923"></span></span><span class="hs-keyword">data</span><span> </span><span id="VRFType"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-var">VRFType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NONCE"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#NONCE"><span class="hs-identifier hs-var">NONCE</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="TEST"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span></span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679170914"><span id="local-6989586621679170916"><span id="local-6989586621679170918"><span class="annot"><span class="annottext">Int -&gt; VRFType -&gt; ShowS
[VRFType] -&gt; ShowS
VRFType -&gt; String
(Int -&gt; VRFType -&gt; ShowS)
-&gt; (VRFType -&gt; String) -&gt; ([VRFType] -&gt; ShowS) -&gt; Show VRFType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [VRFType] -&gt; ShowS
$cshowList :: [VRFType] -&gt; ShowS
show :: VRFType -&gt; String
$cshow :: VRFType -&gt; String
showsPrec :: Int -&gt; VRFType -&gt; ShowS
$cshowsPrec :: Int -&gt; VRFType -&gt; ShowS
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679170910"><span id="local-6989586621679170912"><span class="annot"><span class="annottext">VRFType -&gt; VRFType -&gt; Bool
(VRFType -&gt; VRFType -&gt; Bool)
-&gt; (VRFType -&gt; VRFType -&gt; Bool) -&gt; Eq VRFType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: VRFType -&gt; VRFType -&gt; Bool
$c/= :: VRFType -&gt; VRFType -&gt; Bool
== :: VRFType -&gt; VRFType -&gt; Bool
$c== :: VRFType -&gt; VRFType -&gt; Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679170895"><span id="local-6989586621679170897"><span id="local-6989586621679170899"><span id="local-6989586621679170901"><span id="local-6989586621679170903"><span id="local-6989586621679170905"><span id="local-6989586621679170907"><span class="annot"><span class="annottext">Eq VRFType
Eq VRFType
-&gt; (VRFType -&gt; VRFType -&gt; Ordering)
-&gt; (VRFType -&gt; VRFType -&gt; Bool)
-&gt; (VRFType -&gt; VRFType -&gt; Bool)
-&gt; (VRFType -&gt; VRFType -&gt; Bool)
-&gt; (VRFType -&gt; VRFType -&gt; Bool)
-&gt; (VRFType -&gt; VRFType -&gt; VRFType)
-&gt; (VRFType -&gt; VRFType -&gt; VRFType)
-&gt; Ord VRFType
VRFType -&gt; VRFType -&gt; Bool
VRFType -&gt; VRFType -&gt; Ordering
VRFType -&gt; VRFType -&gt; VRFType
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: VRFType -&gt; VRFType -&gt; VRFType
$cmin :: VRFType -&gt; VRFType -&gt; VRFType
max :: VRFType -&gt; VRFType -&gt; VRFType
$cmax :: VRFType -&gt; VRFType -&gt; VRFType
&gt;= :: VRFType -&gt; VRFType -&gt; Bool
$c&gt;= :: VRFType -&gt; VRFType -&gt; Bool
&gt; :: VRFType -&gt; VRFType -&gt; Bool
$c&gt; :: VRFType -&gt; VRFType -&gt; Bool
&lt;= :: VRFType -&gt; VRFType -&gt; Bool
$c&lt;= :: VRFType -&gt; VRFType -&gt; Bool
&lt; :: VRFType -&gt; VRFType -&gt; Bool
$c&lt; :: VRFType -&gt; VRFType -&gt; Bool
compare :: VRFType -&gt; VRFType -&gt; Ordering
$ccompare :: VRFType -&gt; VRFType -&gt; Ordering
$cp1Ord :: Eq VRFType
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. VRFType -&gt; Rep VRFType x)
-&gt; (forall x. Rep VRFType x -&gt; VRFType) -&gt; Generic VRFType
forall x. Rep VRFType x -&gt; VRFType
forall x. VRFType -&gt; Rep VRFType x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep VRFType x -&gt; VRFType
$cfrom :: forall x. VRFType -&gt; Rep VRFType x
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679170886"><span id="local-6989586621679170888"><span id="local-6989586621679170890"><span class="annot"><span class="annottext">Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo)
Proxy VRFType -&gt; String
(Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy VRFType -&gt; String)
-&gt; NoThunks VRFType
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy VRFType -&gt; String
$cshowTypeOf :: Proxy VRFType -&gt; String
wNoThunks :: Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: Context -&gt; VRFType -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621679170886"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679170878"><span id="local-6989586621679170880"><span id="local-6989586621679170882"><span id="local-6989586621679170884"><span class="annot"><span class="hs-identifier hs-type">Serialise</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span></span></span></span></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679170871"><span id="local-6989586621679170873"><span class="annot"><span class="hs-identifier hs-type">ToCBOR</span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-comment">-- This is a cheat, and at some point we probably want to decide on Serialise/ToCBOR</span><span>
</span><span id="line-314"></span><span>  </span><span id="local-6989586621679170869"><span class="annot"><span class="annottext">toCBOR :: VRFType -&gt; Encoding
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toCBOR</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VRFType -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encode</span></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-comment">-- |Proofs certifying &#961; and y for a given slot and eta.</span><span>
</span><span id="line-317"></span><span class="hs-keyword">data</span><span> </span><span id="PraosProof"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosProof"><span class="hs-identifier hs-var">PraosProof</span></a></span></span><span> </span><span id="local-6989586621679171276"><span class="annot"><a href="#local-6989586621679171276"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PraosProof"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosProof"><span class="hs-identifier hs-var">PraosProof</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-318"></span><span>      </span><span id="praosProofRho"><span class="annot"><span class="annottext">PraosProof c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosProofRho"><span class="hs-identifier hs-var hs-var">praosProofRho</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CertifiedVRF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171276"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosProofY"><span class="annot"><span class="annottext">PraosProof c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosProofY"><span class="hs-identifier hs-var hs-var">praosProofY</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CertifiedVRF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171276"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosLeader"><span class="annot"><span class="annottext">PraosProof c -&gt; CoreNodeId
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosLeader"><span class="hs-identifier hs-var hs-var">praosLeader</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-comment">-- | An error that can arise during validation</span><span>
</span><span id="line-324"></span><span id="local-6989586621679170865"><span id="local-6989586621679170866"></span></span><span class="hs-keyword">data</span><span> </span><span id="PraosValidationError"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier hs-var">PraosValidationError</span></a></span></span><span> </span><span id="local-6989586621679171128"><span class="annot"><a href="#local-6989586621679171128"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-325"></span><span>      </span><span id="PraosInvalidSlot"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidSlot"><span class="hs-identifier hs-var">PraosInvalidSlot</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PraosUnknownCoreId"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosUnknownCoreId"><span class="hs-identifier hs-var">PraosUnknownCoreId</span></a></span></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PraosInvalidSig"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidSig"><span class="hs-identifier hs-var">PraosInvalidSig</span></a></span></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VerKeyKES</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigKES</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PraosInvalidCert"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidCert"><span class="hs-identifier hs-var">PraosInvalidCert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VerKeyVRF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CertVRF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171128"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PraosInsufficientStake"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInsufficientStake"><span class="hs-identifier hs-var">PraosInsufficientStake</span></a></span></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x.
 PraosValidationError c -&gt; Rep (PraosValidationError c) x)
-&gt; (forall x.
    Rep (PraosValidationError c) x -&gt; PraosValidationError c)
-&gt; Generic (PraosValidationError c)
forall x. Rep (PraosValidationError c) x -&gt; PraosValidationError c
forall x. PraosValidationError c -&gt; Rep (PraosValidationError c) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x.
Rep (PraosValidationError c) x -&gt; PraosValidationError c
forall c x.
PraosValidationError c -&gt; Rep (PraosValidationError c) x
$cto :: forall c x.
Rep (PraosValidationError c) x -&gt; PraosValidationError c
$cfrom :: forall c x.
PraosValidationError c -&gt; Rep (PraosValidationError c) x
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-comment">-- We override 'showTypeOf' to make sure to show @c@</span><span>
</span><span id="line-333"></span><span id="local-6989586621679170857"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679170853"><span id="local-6989586621679170855"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170857"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier hs-type">PraosValidationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170857"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-334"></span><span>  </span><span id="local-6989586621679170851"><span class="annot"><span class="annottext">showTypeOf :: Proxy (PraosValidationError c) -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showTypeOf</span></span></span><span> </span><span class="annot"><span class="annottext">Proxy (PraosValidationError c)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeRep -&gt; String) -&gt; TypeRep -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy (PraosValidationError c) -&gt; TypeRep
forall k (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; TypeRep
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">typeRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (PraosValidationError c)
forall k (t :: k). Proxy t
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier hs-type">PraosValidationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170857"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span id="local-6989586621679170840"><span id="local-6989586621679170842"><span id="local-6989586621679170844"><span id="local-6989586621679170846"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170846"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier hs-type">PraosValidationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170846"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-337"></span><span id="local-6989586621679170835"><span id="local-6989586621679170837"><span id="local-6989586621679170839"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170839"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier hs-type">PraosValidationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170839"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span id="local-6989586621679170833"><span id="local-6989586621679170834"></span></span><span class="hs-keyword">data</span><span> </span><span id="BlockInfo"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-var">BlockInfo</span></a></span></span><span> </span><span id="local-6989586621679171177"><span class="annot"><a href="#local-6989586621679171177"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BlockInfo"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-var">BlockInfo</span></a></span></span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="biSlot"><span class="annot"><span class="annottext">BlockInfo c -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var hs-var">biSlot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="biRho"><span class="annot"><span class="annottext">BlockInfo c -&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biRho"><span class="hs-identifier hs-var hs-var">biRho</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CertifiedVRF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171177"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. BlockInfo c -&gt; Rep (BlockInfo c) x)
-&gt; (forall x. Rep (BlockInfo c) x -&gt; BlockInfo c)
-&gt; Generic (BlockInfo c)
forall x. Rep (BlockInfo c) x -&gt; BlockInfo c
forall x. BlockInfo c -&gt; Rep (BlockInfo c) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x. Rep (BlockInfo c) x -&gt; BlockInfo c
forall c x. BlockInfo c -&gt; Rep (BlockInfo c) x
$cto :: forall c x. Rep (BlockInfo c) x -&gt; BlockInfo c
$cfrom :: forall c x. BlockInfo c -&gt; Rep (BlockInfo c) x
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span id="local-6989586621679170821"><span id="local-6989586621679170823"><span id="local-6989586621679170825"><span id="local-6989586621679170827"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170827"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170827"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-346"></span><span id="local-6989586621679170816"><span id="local-6989586621679170818"><span id="local-6989586621679170820"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170820"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170820"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-347"></span><span id="local-6989586621679170809"><span id="local-6989586621679170811"><span id="local-6989586621679170813"><span id="local-6989586621679170815"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170815"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170815"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Protocol proper
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-- | An uninhabited type representing the Praos protocol.</span><span>
</span><span id="line-354"></span><span class="hs-keyword">data</span><span> </span><span id="Praos"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-var">Praos</span></a></span></span><span> </span><span id="local-6989586621679170808"><span class="annot"><a href="#local-6989586621679170808"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | Praos parameters that are node independent</span><span>
</span><span id="line-357"></span><span id="local-6989586621679170806"><span id="local-6989586621679170807"></span></span><span class="hs-keyword">data</span><span> </span><span id="PraosParams"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-var">PraosParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PraosParams"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-var">PraosParams</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-358"></span><span>      </span><span id="praosLeaderF"><span class="annot"><span class="annottext">PraosParams -&gt; Double
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosLeaderF"><span class="hs-identifier hs-var hs-var">praosLeaderF</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-359"></span><span>      </span><span class="hs-comment">-- ^ f, the active slots coefficient, defined in 3.3 in the Praos paper.</span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosSecurityParam"><span class="annot"><span class="annottext">PraosParams -&gt; SecurityParam
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosSecurityParam"><span class="hs-identifier hs-var hs-var">praosSecurityParam</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">SecurityParam</span></a></span><span>
</span><span id="line-361"></span><span>      </span><span class="hs-comment">-- ^ k, maximum number of blocks we can rollback</span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="praosSlotsPerEpoch"><span class="annot"><span class="annottext">PraosParams -&gt; Word64
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosSlotsPerEpoch"><span class="hs-identifier hs-var hs-var">praosSlotsPerEpoch</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-363"></span><span>      </span><span class="hs-comment">-- ^ R, slots in each epoch, defined in section 3 in the Praos paper.</span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. PraosParams -&gt; Rep PraosParams x)
-&gt; (forall x. Rep PraosParams x -&gt; PraosParams)
-&gt; Generic PraosParams
forall x. Rep PraosParams x -&gt; PraosParams
forall x. PraosParams -&gt; Rep PraosParams x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep PraosParams x -&gt; PraosParams
$cfrom :: forall x. PraosParams -&gt; Rep PraosParams x
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679170794"><span id="local-6989586621679170796"><span id="local-6989586621679170798"><span class="annot"><span class="annottext">Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo)
Proxy PraosParams -&gt; String
(Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy PraosParams -&gt; String)
-&gt; NoThunks PraosParams
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy PraosParams -&gt; String
$cshowTypeOf :: Proxy PraosParams -&gt; String
wNoThunks :: Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: Context -&gt; PraosParams -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621679170794"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">-- | The configuration that will be provided to every node when running the</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- MockPraos protocol.</span><span>
</span><span id="line-369"></span><span class="hs-keyword">data</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="ConsensusConfig"><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">ConsensusConfig</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span id="local-6989586621679171175"><span class="annot"><a href="#local-6989586621679171175"><span class="hs-identifier hs-type hs-type">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PraosConfig"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-var">PraosConfig</span></a></span></span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="praosParams"><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; PraosParams
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosParams"><span class="hs-identifier hs-var hs-var">praosParams</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-type">PraosParams</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="praosInitialEta"><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; Natural
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosInitialEta"><span class="hs-identifier hs-var hs-var">praosInitialEta</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="praosInitialStake"><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; StakeDist
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosInitialStake"><span class="hs-identifier hs-var hs-var">praosInitialStake</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html#StakeDist"><span class="hs-identifier hs-type">StakeDist</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="praosEvolvingStake"><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; PraosEvolvingStake
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosEvolvingStake"><span class="hs-identifier hs-var hs-var">praosEvolvingStake</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosEvolvingStake"><span class="hs-identifier hs-type">PraosEvolvingStake</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="praosSignKeyVRF"><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; SignKeyVRF (PraosVRF c)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosSignKeyVRF"><span class="hs-identifier hs-var hs-var">praosSignKeyVRF</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SignKeyVRF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171175"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="praosVerKeys"><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
-&gt; Map CoreNodeId (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosVerKeys"><span class="hs-identifier hs-var hs-var">praosVerKeys</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VerKeyKES</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171175"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VerKeyVRF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171175"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x.
 ConsensusConfig (Praos c) -&gt; Rep (ConsensusConfig (Praos c)) x)
-&gt; (forall x.
    Rep (ConsensusConfig (Praos c)) x -&gt; ConsensusConfig (Praos c))
-&gt; Generic (ConsensusConfig (Praos c))
forall x.
Rep (ConsensusConfig (Praos c)) x -&gt; ConsensusConfig (Praos c)
forall x.
ConsensusConfig (Praos c) -&gt; Rep (ConsensusConfig (Praos c)) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall c x.
Rep (ConsensusConfig (Praos c)) x -&gt; ConsensusConfig (Praos c)
forall c x.
ConsensusConfig (Praos c) -&gt; Rep (ConsensusConfig (Praos c)) x
$cto :: forall c x.
Rep (ConsensusConfig (Praos c)) x -&gt; ConsensusConfig (Praos c)
$cfrom :: forall c x.
ConsensusConfig (Praos c) -&gt; Rep (ConsensusConfig (Praos c)) x
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span id="local-6989586621679170782"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679170776"><span id="local-6989586621679170778"><span id="local-6989586621679170780"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170782"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoThunks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170782"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span id="local-6989586621679171106"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#slotEpoch"><span class="hs-identifier hs-type">slotEpoch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171106"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EpochNo</span></span></span><span>
</span><span id="line-382"></span><span id="slotEpoch"><span class="annot"><span class="annottext">slotEpoch :: ConsensusConfig (Praos c) -&gt; SlotNo -&gt; EpochNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#slotEpoch"><span class="hs-identifier hs-var hs-var">slotEpoch</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-type">PraosConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170769"><span id="local-6989586621679170770"><span id="local-6989586621679170771"><span id="local-6989586621679170772"><span id="local-6989586621679170773"><span id="local-6989586621679170774"><span class="annot"><a href="#local-6989586621679170769"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679170768"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170768"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><span class="annottext">EpochSize -&gt; SlotNo -&gt; EpochNo
</span><span class="hs-identifier hs-var">fixedEpochInfoEpoch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; EpochSize
</span><span class="hs-identifier hs-var">EpochSize</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679170765"><span class="hs-identifier hs-var">praosSlotsPerEpoch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170768"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-type">PraosParams</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170763"><span id="local-6989586621679170764"><span id="local-6989586621679170765"><span class="annot"><span class="annottext">Double
Word64
SecurityParam
praosSecurityParam :: SecurityParam
praosLeaderF :: Double
praosSlotsPerEpoch :: Word64
praosSlotsPerEpoch :: PraosParams -&gt; Word64
praosSecurityParam :: PraosParams -&gt; SecurityParam
praosLeaderF :: PraosParams -&gt; Double
</span><a href="#local-6989586621679170763"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosParams
</span><a href="#local-6989586621679170774"><span class="hs-identifier hs-var">praosParams</span></a></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span id="local-6989586621679171173"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#epochFirst"><span class="hs-identifier hs-type">epochFirst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171173"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EpochNo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span></span><span>
</span><span id="line-388"></span><span id="epochFirst"><span class="annot"><span class="annottext">epochFirst :: ConsensusConfig (Praos c) -&gt; EpochNo -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#epochFirst"><span class="hs-identifier hs-var hs-var">epochFirst</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-type">PraosConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170756"><span id="local-6989586621679170757"><span id="local-6989586621679170758"><span id="local-6989586621679170759"><span id="local-6989586621679170760"><span id="local-6989586621679170761"><span class="annot"><a href="#local-6989586621679170756"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679170755"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679170755"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><span class="annottext">EpochSize -&gt; EpochNo -&gt; SlotNo
</span><span class="hs-identifier hs-var">fixedEpochInfoFirst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; EpochSize
</span><span class="hs-identifier hs-var">EpochSize</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679170753"><span class="hs-identifier hs-var">praosSlotsPerEpoch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679170755"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-type">PraosParams</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170751"><span id="local-6989586621679170752"><span id="local-6989586621679170753"><span class="annot"><span class="annottext">Double
Word64
SecurityParam
praosSecurityParam :: SecurityParam
praosLeaderF :: Double
praosSlotsPerEpoch :: Word64
praosSlotsPerEpoch :: PraosParams -&gt; Word64
praosSecurityParam :: PraosParams -&gt; SecurityParam
praosLeaderF :: PraosParams -&gt; Double
</span><a href="#local-6989586621679170751"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosParams
</span><a href="#local-6989586621679170761"><span class="hs-identifier hs-var">praosParams</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- |The chain dependent state, in this case as it is a mock, we just will store</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- a list of BlockInfos that allow us to look into the past.</span><span>
</span><span id="line-395"></span><span class="hs-keyword">newtype</span><span> </span><span id="PraosChainDepState"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-var">PraosChainDepState</span></a></span></span><span> </span><span id="local-6989586621679171141"><span class="annot"><a href="#local-6989586621679171141"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PraosChainDepState"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-var">PraosChainDepState</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-396"></span><span>      </span><span id="praosHistory"><span class="annot"><span class="annottext">PraosChainDepState c -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosHistory"><span class="hs-identifier hs-var hs-var">praosHistory</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171141"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-397"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621679170745"><span id="local-6989586621679170747"><span class="annot"><span class="annottext">PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool
(PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool)
-&gt; (PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool)
-&gt; Eq (PraosChainDepState c)
forall c.
PraosCrypto c =&gt;
PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool
$c/= :: forall c.
PraosCrypto c =&gt;
PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool
== :: PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool
$c== :: forall c.
PraosCrypto c =&gt;
PraosChainDepState c -&gt; PraosChainDepState c -&gt; Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679170739"><span id="local-6989586621679170741"><span id="local-6989586621679170743"><span class="annot"><span class="annottext">Int -&gt; PraosChainDepState c -&gt; ShowS
[PraosChainDepState c] -&gt; ShowS
PraosChainDepState c -&gt; String
(Int -&gt; PraosChainDepState c -&gt; ShowS)
-&gt; (PraosChainDepState c -&gt; String)
-&gt; ([PraosChainDepState c] -&gt; ShowS)
-&gt; Show (PraosChainDepState c)
forall c. PraosCrypto c =&gt; Int -&gt; PraosChainDepState c -&gt; ShowS
forall c. PraosCrypto c =&gt; [PraosChainDepState c] -&gt; ShowS
forall c. PraosCrypto c =&gt; PraosChainDepState c -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PraosChainDepState c] -&gt; ShowS
$cshowList :: forall c. PraosCrypto c =&gt; [PraosChainDepState c] -&gt; ShowS
show :: PraosChainDepState c -&gt; String
$cshow :: forall c. PraosCrypto c =&gt; PraosChainDepState c -&gt; String
showsPrec :: Int -&gt; PraosChainDepState c -&gt; ShowS
$cshowsPrec :: forall c. PraosCrypto c =&gt; Int -&gt; PraosChainDepState c -&gt; ShowS
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679170733"><span id="local-6989586621679170735"><span id="local-6989586621679170737"><span class="annot"><span class="annottext">Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo)
Proxy (PraosChainDepState c) -&gt; String
(Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy (PraosChainDepState c) -&gt; String)
-&gt; NoThunks (PraosChainDepState c)
forall c.
PraosCrypto c =&gt;
Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo)
forall c. PraosCrypto c =&gt; Proxy (PraosChainDepState c) -&gt; String
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy (PraosChainDepState c) -&gt; String
$cshowTypeOf :: forall c. PraosCrypto c =&gt; Proxy (PraosChainDepState c) -&gt; String
wNoThunks :: Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: forall c.
PraosCrypto c =&gt;
Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: forall c.
PraosCrypto c =&gt;
Context -&gt; PraosChainDepState c -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621679170733"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679170725"><span id="local-6989586621679170727"><span id="local-6989586621679170729"><span id="local-6989586621679170731"><span class="annot"><span class="annottext">Decoder s (PraosChainDepState c)
Decoder s [PraosChainDepState c]
[PraosChainDepState c] -&gt; Encoding
PraosChainDepState c -&gt; Encoding
(PraosChainDepState c -&gt; Encoding)
-&gt; (forall s. Decoder s (PraosChainDepState c))
-&gt; ([PraosChainDepState c] -&gt; Encoding)
-&gt; (forall s. Decoder s [PraosChainDepState c])
-&gt; Serialise (PraosChainDepState c)
forall s. Decoder s [PraosChainDepState c]
forall s. Decoder s (PraosChainDepState c)
forall c. PraosCrypto c =&gt; [PraosChainDepState c] -&gt; Encoding
forall c. PraosCrypto c =&gt; PraosChainDepState c -&gt; Encoding
forall c s. PraosCrypto c =&gt; Decoder s [PraosChainDepState c]
forall c s. PraosCrypto c =&gt; Decoder s (PraosChainDepState c)
forall a.
(a -&gt; Encoding)
-&gt; (forall s. Decoder s a)
-&gt; ([a] -&gt; Encoding)
-&gt; (forall s. Decoder s [a])
-&gt; Serialise a
decodeList :: Decoder s [PraosChainDepState c]
$cdecodeList :: forall c s. PraosCrypto c =&gt; Decoder s [PraosChainDepState c]
encodeList :: [PraosChainDepState c] -&gt; Encoding
$cencodeList :: forall c. PraosCrypto c =&gt; [PraosChainDepState c] -&gt; Encoding
decode :: Decoder s (PraosChainDepState c)
$cdecode :: forall c s. PraosCrypto c =&gt; Decoder s (PraosChainDepState c)
encode :: PraosChainDepState c -&gt; Encoding
$cencode :: forall c. PraosCrypto c =&gt; PraosChainDepState c -&gt; Encoding
</span><a href="#local-6989586621679170725"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Serialise</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span id="local-6989586621679171170"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosSlice"><span class="hs-identifier hs-type">infosSlice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171170"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171170"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-402"></span><span id="infosSlice"><span class="annot"><span class="annottext">infosSlice :: SlotNo -&gt; SlotNo -&gt; [BlockInfo c] -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosSlice"><span class="hs-identifier hs-var hs-var">infosSlice</span></a></span></span><span> </span><span id="local-6989586621679170723"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170723"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621679170722"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170722"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621679170721"><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679170721"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BlockInfo c -&gt; Bool) -&gt; [BlockInfo c] -&gt; [BlockInfo c]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">takeWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679170719"><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679170719"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BlockInfo c -&gt; SlotNo
forall c. BlockInfo c -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var hs-var">biSlot</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679170719"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170723"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>                      </span><span class="annot"><span class="annottext">([BlockInfo c] -&gt; [BlockInfo c]) -&gt; [BlockInfo c] -&gt; [BlockInfo c]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(BlockInfo c -&gt; Bool) -&gt; [BlockInfo c] -&gt; [BlockInfo c]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">dropWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679170717"><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679170717"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BlockInfo c -&gt; SlotNo
forall c. BlockInfo c -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var hs-var">biSlot</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679170717"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170722"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679170721"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosEta"><span class="hs-identifier hs-type">infosEta</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679171174"><span class="annot"><a href="#local-6989586621679171174"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171174"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171174"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171174"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-408"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EpochNo</span></span><span>
</span><span id="line-409"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-410"></span><span id="infosEta"><span class="annot"><span class="annottext">infosEta :: ConsensusConfig (Praos c) -&gt; [BlockInfo c] -&gt; EpochNo -&gt; Natural
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosEta"><span class="hs-identifier hs-var hs-var">infosEta</span></a></span></span><span> </span><span id="local-6989586621679170714"><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170714"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">EpochNo
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-411"></span><span>    </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; Natural
forall c. ConsensusConfig (Praos c) -&gt; Natural
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosInitialEta"><span class="hs-identifier hs-var hs-var">praosInitialEta</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170714"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-412"></span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosEta"><span class="hs-identifier hs-var">infosEta</span></a></span><span> </span><span id="local-6989586621679170713"><span class="annot"><span class="annottext">l :: ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170713"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-type">PraosConfig</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosParams"><span class="hs-identifier hs-var">praosParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-type">PraosParams</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170710"><span id="local-6989586621679170711"><span id="local-6989586621679170712"><span class="annot"><a href="#local-6989586621679170710"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span id="local-6989586621679170709"><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679170709"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679170708"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679170708"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-413"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679170707"><span class="annot"><span class="annottext">e' :: EpochNo
</span><a href="#local-6989586621679170707"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679170708"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; EpochNo -&gt; EpochNo
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><span class="hs-number">1</span></span><span>
</span><span id="line-414"></span><span>        </span><span class="hs-comment">-- the &#951; from the previous epoch</span><span>
</span><span id="line-415"></span><span>        </span><span id="local-6989586621679170706"><span class="annot"><span class="annottext">eta' :: Natural
</span><a href="#local-6989586621679170706"><span class="hs-identifier hs-var hs-var">eta'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; [BlockInfo c] -&gt; EpochNo -&gt; Natural
forall c.
PraosCrypto c =&gt;
ConsensusConfig (Praos c) -&gt; [BlockInfo c] -&gt; EpochNo -&gt; Natural
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosEta"><span class="hs-identifier hs-var">infosEta</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170713"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679170709"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679170707"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-416"></span><span>        </span><span class="hs-comment">-- the first slot in previous epoch</span><span>
</span><span id="line-417"></span><span>        </span><span id="local-6989586621679170705"><span class="annot"><span class="annottext">from :: SlotNo
</span><a href="#local-6989586621679170705"><span class="hs-identifier hs-var hs-var">from</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; EpochNo -&gt; SlotNo
forall c. ConsensusConfig (Praos c) -&gt; EpochNo -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#epochFirst"><span class="hs-identifier hs-var">epochFirst</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170713"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679170707"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-418"></span><span>        </span><span class="hs-comment">-- 2/3 of the slots per epoch</span><span>
</span><span id="line-419"></span><span>        </span><span id="local-6989586621679170704"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679170704"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">div</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679170710"><span class="hs-identifier hs-var">praosSlotsPerEpoch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">3</span></span><span>
</span><span id="line-420"></span><span>        </span><span class="hs-comment">-- the last of the 2/3 of slots in this epoch</span><span>
</span><span id="line-421"></span><span>        </span><span id="local-6989586621679170701"><span class="annot"><span class="annottext">to :: SlotNo
</span><a href="#local-6989586621679170701"><span class="hs-identifier hs-var hs-var">to</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><span class="hs-identifier hs-var">SlotNo</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; SlotNo) -&gt; Word64 -&gt; SlotNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Word64
</span><span class="hs-identifier hs-var hs-var">unSlotNo</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170705"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679170704"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-422"></span><span>        </span><span class="hs-comment">-- the list of rhos from the first block in this epoch until the one at</span><span>
</span><span id="line-423"></span><span>        </span><span class="hs-comment">-- 2/3 of the slots. Note it is reversed, i.e. start at the oldest.</span><span>
</span><span id="line-424"></span><span>        </span><span id="local-6989586621679170699"><span class="annot"><span class="annottext">rhos :: [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)]
</span><a href="#local-6989586621679170699"><span class="hs-identifier hs-var hs-var">rhos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)]
-&gt; [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)]
forall a. [a] -&gt; [a]
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BlockInfo c -&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
forall c.
BlockInfo c -&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biRho"><span class="hs-identifier hs-var hs-var">biRho</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679170697"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679170697"><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679170697"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; [BlockInfo c] -&gt; [BlockInfo c]
forall c. SlotNo -&gt; SlotNo -&gt; [BlockInfo c] -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosSlice"><span class="hs-identifier hs-var">infosSlice</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170705"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170701"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679170709"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; Natural
</span><span class="hs-identifier hs-var">bytesToNatural</span></span><span>
</span><span id="line-426"></span><span>          </span><span class="annot"><span class="annottext">(ByteString -&gt; Natural)
-&gt; (Hash
      (PraosHash c)
      (Natural, EpochNo,
       [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
    -&gt; ByteString)
-&gt; Hash
     (PraosHash c)
     (Natural, EpochNo,
      [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
-&gt; Natural
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
  (PraosHash c)
  (Natural, EpochNo,
   [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
-&gt; ByteString
forall h a. Hash h a -&gt; ByteString
</span><span class="hs-identifier hs-var">hashToBytes</span></span><span>
</span><span id="line-427"></span><span>          </span><span class="annot"><span class="annottext">(Hash
   (PraosHash c)
   (Natural, EpochNo,
    [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
 -&gt; Natural)
-&gt; Hash
     (PraosHash c)
     (Natural, EpochNo,
      [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
-&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Natural, EpochNo,
  [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
 -&gt; Encoding)
-&gt; (Natural, EpochNo,
    [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
-&gt; Hash
     (PraosHash c)
     (Natural, EpochNo,
      [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
forall h a. HashAlgorithm h =&gt; (a -&gt; Encoding) -&gt; a -&gt; Hash h a
</span><span class="hs-identifier hs-var">hashWithSerialiser</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosHash"><span class="hs-identifier hs-type">PraosHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171174"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Natural, EpochNo,
 [CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)])
-&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toCBOR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679170706"><span class="hs-identifier hs-var">eta'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679170708"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)]
</span><a href="#local-6989586621679170699"><span class="hs-identifier hs-var">rhos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-comment">-- | Ticking the Praos chain dep state has no effect</span><span>
</span><span id="line-430"></span><span class="hs-comment">--</span><span>
</span><span id="line-431"></span><span class="hs-comment">-- For the real Praos implementation, ticking is crucial, as it determines the</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- point where the &quot;nonce under construction&quot; is swapped out for the &quot;active&quot;</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- nonce. However, for the mock implementation, we keep the full history, and</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- choose the right nonce from that; this means that ticking has no effect.</span><span>
</span><span id="line-435"></span><span class="hs-comment">--</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- We do however need access to the ticked stake distribution.</span><span>
</span><span id="line-437"></span><span class="hs-keyword">data</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Ticked"><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">Ticked</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-type">PraosChainDepState</span></a></span><span> </span><span id="local-6989586621679171135"><span class="annot"><a href="#local-6989586621679171135"><span class="hs-identifier hs-type hs-type">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TickedPraosChainDepState"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TickedPraosChainDepState"><span class="hs-identifier hs-var">TickedPraosChainDepState</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-438"></span><span>      </span><span id="tickedPraosLedgerView"><span class="annot"><span class="annottext">Ticked (PraosChainDepState c) -&gt; Ticked (LedgerView (Praos c))
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#tickedPraosLedgerView"><span class="hs-identifier hs-var hs-var">tickedPraosLedgerView</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">Ticked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">LedgerView</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171135"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>      </span><span class="hs-comment">-- ^ The ticked ledger view.</span><span>
</span><span id="line-440"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="untickedPraosChainDepState"><span class="annot"><span class="annottext">Ticked (PraosChainDepState c) -&gt; PraosChainDepState c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#untickedPraosChainDepState"><span class="hs-identifier hs-var hs-var">untickedPraosChainDepState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-type">PraosChainDepState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171135"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-441"></span><span>      </span><span class="hs-comment">-- ^ The unticked chain dependent state, containing the full history.</span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span id="local-6989586621679170692"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170692"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusProtocol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170692"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span>  </span><span id="local-6989586621679170674"><span class="annot"><span class="annottext">protocolSecurityParam :: ConsensusConfig (Praos c) -&gt; SecurityParam
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">protocolSecurityParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosParams -&gt; SecurityParam
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosSecurityParam"><span class="hs-identifier hs-var hs-var">praosSecurityParam</span></a></span><span> </span><span class="annot"><span class="annottext">(PraosParams -&gt; SecurityParam)
-&gt; (ConsensusConfig (Praos c) -&gt; PraosParams)
-&gt; ConsensusConfig (Praos c)
-&gt; SecurityParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; PraosParams
forall c. ConsensusConfig (Praos c) -&gt; PraosParams
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosParams"><span class="hs-identifier hs-var hs-var">praosParams</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="LedgerView"><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">LedgerView</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170692"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="IsLeader"><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">IsLeader</span></a></span></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170692"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosProof"><span class="hs-identifier hs-type">PraosProof</span></a></span><span>           </span><span class="annot"><a href="#local-6989586621679170692"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ValidationErr"><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">ValidationErr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170692"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidationError"><span class="hs-identifier hs-type">PraosValidationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170692"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ValidateView"><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">ValidateView</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170692"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-type">PraosValidateView</span></a></span><span>    </span><span class="annot"><a href="#local-6989586621679170692"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ChainDepState"><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">ChainDepState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170692"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-type">PraosChainDepState</span></a></span><span>   </span><span class="annot"><a href="#local-6989586621679170692"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="CanBeLeader"><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">CanBeLeader</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170692"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span>  </span><span id="local-6989586621679170672"><span class="annot"><span class="annottext">checkIsLeader :: ConsensusConfig (Praos c)
-&gt; CanBeLeader (Praos c)
-&gt; SlotNo
-&gt; Ticked (ChainDepState (Praos c))
-&gt; Maybe (IsLeader (Praos c))
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">checkIsLeader</span></a></span></span><span> </span><span id="local-6989586621679170670"><span class="annot"><span class="annottext">cfg :: ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170670"><span class="hs-identifier hs-var">cfg</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-type">PraosConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170664"><span id="local-6989586621679170665"><span id="local-6989586621679170666"><span id="local-6989586621679170667"><span id="local-6989586621679170668"><span id="local-6989586621679170669"><span class="annot"><a href="#local-6989586621679170664"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679170663"><span class="annot"><span class="annottext">CanBeLeader (Praos c)
</span><a href="#local-6989586621679170663"><span class="hs-identifier hs-var">nid</span></a></span></span><span> </span><span id="local-6989586621679170662"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170662"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TickedPraosChainDepState"><span class="hs-identifier hs-type">TickedPraosChainDepState</span></a></span><span> </span><span id="local-6989586621679170661"><span class="annot"><a href="#local-6989586621679170661"><span class="hs-identifier hs-var">_u</span></a></span></span><span>  </span><span id="local-6989586621679170660"><span class="annot"><a href="#local-6989586621679170660"><span class="hs-identifier hs-var">cds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-456"></span><span>      </span><span class="hs-comment">-- See Figure 4 of the Praos paper.</span><span>
</span><span id="line-457"></span><span>      </span><span class="hs-comment">-- In order to be leader, y must be &lt; T&#7522;</span><span>
</span><span id="line-458"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OutputVRF (PraosVRF c) -&gt; Natural
forall v. OutputVRF v -&gt; Natural
</span><span class="hs-identifier hs-var">getOutputVRFNatural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; OutputVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; OutputVRF v
</span><span class="hs-identifier hs-var hs-var">certifiedOutput</span></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170657"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679170655"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-459"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PraosProof c -&gt; Maybe (PraosProof c)
forall a. a -&gt; Maybe a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">PraosProof :: forall c.
CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; CoreNodeId
-&gt; PraosProof c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosProof"><span class="hs-identifier hs-type">PraosProof</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-460"></span><span>               </span><span class="annot"><span class="annottext">praosProofRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosProofRho"><span class="hs-identifier hs-var">praosProofRho</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170654"><span class="hs-identifier hs-var">rho</span></a></span><span>
</span><span id="line-461"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">praosProofY :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosProofY"><span class="hs-identifier hs-var">praosProofY</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170657"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-462"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">praosLeader :: CoreNodeId
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosLeader"><span class="hs-identifier hs-var">praosLeader</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanBeLeader (Praos c)
CoreNodeId
</span><a href="#local-6989586621679170663"><span class="hs-identifier hs-var">nid</span></a></span><span>
</span><span id="line-463"></span><span>             </span><span class="hs-special">}</span><span>
</span><span id="line-464"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (IsLeader (Praos c))
forall a. Maybe a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-466"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679170653"><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170653"><span class="hs-identifier hs-var">rho'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679170652"><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170652"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679170655"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679170655"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
-&gt; [BlockInfo c]
-&gt; SlotNo
-&gt; CoreNodeId
-&gt; ((Natural, SlotNo, VRFType), (Natural, SlotNo, VRFType), Double)
forall c.
PraosCrypto c =&gt;
ConsensusConfig (Praos c)
-&gt; [BlockInfo c]
-&gt; SlotNo
-&gt; CoreNodeId
-&gt; ((Natural, SlotNo, VRFType), (Natural, SlotNo, VRFType), Double)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#rhoYT"><span class="hs-identifier hs-var">rhoYT</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170670"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PraosChainDepState c -&gt; [BlockInfo c]
forall c. PraosChainDepState c -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosHistory"><span class="hs-identifier hs-var hs-var">praosHistory</span></a></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c
</span><a href="#local-6989586621679170660"><span class="hs-identifier hs-var">cds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170662"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">CanBeLeader (Praos c)
CoreNodeId
</span><a href="#local-6989586621679170663"><span class="hs-identifier hs-var">nid</span></a></span><span>
</span><span id="line-467"></span><span>      </span><span id="local-6989586621679170654"><span class="annot"><span class="annottext">rho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170654"><span class="hs-identifier hs-var hs-var">rho</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; SignKeyVRF (PraosVRF c)
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
forall v a.
(VRFAlgorithm v, Signable v a) =&gt;
ContextVRF v -&gt; a -&gt; SignKeyVRF v -&gt; CertifiedVRF v a
</span><span class="hs-identifier hs-var">evalCertified</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170653"><span class="hs-identifier hs-var">rho'</span></a></span><span> </span><span class="annot"><span class="annottext">SignKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679170665"><span class="hs-identifier hs-var">praosSignKeyVRF</span></a></span><span>
</span><span id="line-468"></span><span>      </span><span id="local-6989586621679170657"><span class="annot"><span class="annottext">y :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170657"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; SignKeyVRF (PraosVRF c)
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
forall v a.
(VRFAlgorithm v, Signable v a) =&gt;
ContextVRF v -&gt; a -&gt; SignKeyVRF v -&gt; CertifiedVRF v a
</span><span class="hs-identifier hs-var">evalCertified</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170652"><span class="hs-identifier hs-var">y'</span></a></span><span>   </span><span class="annot"><span class="annottext">SignKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679170665"><span class="hs-identifier hs-var">praosSignKeyVRF</span></a></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span>  </span><span id="local-6989586621679170649"><span class="annot"><span class="annottext">tickChainDepState :: ConsensusConfig (Praos c)
-&gt; Ticked (LedgerView (Praos c))
-&gt; SlotNo
-&gt; ChainDepState (Praos c)
-&gt; Ticked (ChainDepState (Praos c))
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">tickChainDepState</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679170647"><span class="annot"><span class="annottext">Ticked (LedgerView (Praos c))
</span><a href="#local-6989586621679170647"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ticked (LedgerView (Praos c))
-&gt; PraosChainDepState c -&gt; Ticked (PraosChainDepState c)
forall c.
Ticked (LedgerView (Praos c))
-&gt; PraosChainDepState c -&gt; Ticked (PraosChainDepState c)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TickedPraosChainDepState"><span class="hs-identifier hs-var">TickedPraosChainDepState</span></a></span><span> </span><span class="annot"><span class="annottext">Ticked (LedgerView (Praos c))
</span><a href="#local-6989586621679170647"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span>  </span><span id="local-6989586621679170646"><span class="annot"><span class="annottext">updateChainDepState :: ConsensusConfig (Praos c)
-&gt; ValidateView (Praos c)
-&gt; SlotNo
-&gt; Ticked (ChainDepState (Praos c))
-&gt; Except (ValidationErr (Praos c)) (ChainDepState (Praos c))
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateChainDepState</span></a></span></span><span> </span><span id="local-6989586621679170644"><span class="annot"><span class="annottext">cfg :: ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170644"><span class="hs-identifier hs-var">cfg</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-type">PraosConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170638"><span id="local-6989586621679170639"><span id="local-6989586621679170640"><span id="local-6989586621679170641"><span id="local-6989586621679170642"><span id="local-6989586621679170643"><span class="annot"><a href="#local-6989586621679170638"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span>
</span><span id="line-473"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-type">PraosValidateView</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170636"><span id="local-6989586621679170637"><span class="annot"><a href="#local-6989586621679170636"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679170635"><span class="annot"><a href="#local-6989586621679170635"><span class="hs-identifier hs-var">toSign</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>                      </span><span id="local-6989586621679170634"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170634"><span class="hs-identifier hs-var">slot</span></a></span></span><span>
</span><span id="line-475"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TickedPraosChainDepState"><span class="hs-identifier hs-type">TickedPraosChainDepState</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">TickedTrivial</span></a></span><span> </span><span id="local-6989586621679170632"><span class="annot"><a href="#local-6989586621679170632"><span class="hs-identifier hs-var">cds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679170629"><span id="local-6989586621679170630"><span id="local-6989586621679170631"><span class="annot"><span class="annottext">CoreNodeId
CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosY :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosCreator :: CoreNodeId
praosY :: forall c.
PraosExtraFields c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosRho :: forall c.
PraosExtraFields c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosCreator :: forall c. PraosExtraFields c -&gt; CoreNodeId
</span><a href="#local-6989586621679170629"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosExtraFields c
</span><a href="#local-6989586621679170636"><span class="hs-identifier hs-var">praosExtraFields</span></a></span><span>
</span><span id="line-477"></span><span>        </span><span id="local-6989586621679170628"><span class="annot"><span class="annottext">nid :: CoreNodeId
</span><a href="#local-6989586621679170628"><span class="hs-identifier hs-var hs-var">nid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679170631"><span class="hs-identifier hs-var">praosCreator</span></a></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span>    </span><span class="hs-comment">-- check that the new block advances time</span><span>
</span><span id="line-480"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c -&gt; [BlockInfo c]
forall c. PraosChainDepState c -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosHistory"><span class="hs-identifier hs-var hs-var">praosHistory</span></a></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c
</span><a href="#local-6989586621679170632"><span class="hs-identifier hs-var">cds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-481"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679170627"><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679170627"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">BlockInfo c -&gt; SlotNo
forall c. BlockInfo c -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var hs-var">biSlot</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679170627"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170634"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(PraosValidationError c
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; PraosValidationError c
forall c. SlotNo -&gt; SlotNo -&gt; PraosValidationError c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidSlot"><span class="hs-identifier hs-var">PraosInvalidSlot</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170634"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockInfo c -&gt; SlotNo
forall c. BlockInfo c -&gt; SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var hs-var">biSlot</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679170627"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>        </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ExceptT (PraosValidationError c) Identity ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-comment">-- check that block creator is a known core node</span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679170626"><span class="annot"><span class="annottext">VerKeyKES (PraosKES c)
</span><a href="#local-6989586621679170626"><span class="hs-identifier hs-var">vkKES</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679170625"><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679170625"><span class="hs-identifier hs-var">vkVRF</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CoreNodeId
-&gt; Map CoreNodeId (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
-&gt; Maybe (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/containers-0.6.2.1/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679170628"><span class="hs-identifier hs-var">nid</span></a></span><span> </span><span class="annot"><span class="annottext">Map CoreNodeId (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
</span><a href="#local-6989586621679170638"><span class="hs-identifier hs-var">praosVerKeys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-487"></span><span>        </span><span class="annot"><span class="annottext">Maybe (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PraosValidationError c
-&gt; ExceptT
     (PraosValidationError c)
     Identity
     (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(PraosValidationError c
 -&gt; ExceptT
      (PraosValidationError c)
      Identity
      (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c)))
-&gt; PraosValidationError c
-&gt; ExceptT
     (PraosValidationError c)
     Identity
     (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CoreNodeId -&gt; PraosValidationError c
forall c. CoreNodeId -&gt; PraosValidationError c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosUnknownCoreId"><span class="hs-identifier hs-var">PraosUnknownCoreId</span></a></span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679170628"><span class="hs-identifier hs-var">nid</span></a></span><span>
</span><span id="line-488"></span><span>        </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679170623"><span class="annot"><span class="annottext">(VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
</span><a href="#local-6989586621679170623"><span class="hs-identifier hs-var">vks</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
-&gt; ExceptT
     (PraosValidationError c)
     Identity
     (VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(VerKeyKES (PraosKES c), VerKeyVRF (PraosVRF c))
</span><a href="#local-6989586621679170623"><span class="hs-identifier hs-var">vks</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span>    </span><span class="hs-comment">-- verify block signature</span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ContextKES (PraosKES c)
-&gt; VerKeyKES (PraosKES c)
-&gt; Period
-&gt; signed
-&gt; SignedKES (PraosKES c) signed
-&gt; Either String ()
forall v a.
(KESAlgorithm v, Signable v a) =&gt;
ContextKES v
-&gt; VerKeyKES v -&gt; Period -&gt; a -&gt; SignedKES v a -&gt; Either String ()
</span><span class="hs-identifier hs-var">verifySignedKES</span></span><span>
</span><span id="line-492"></span><span>           </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>           </span><span class="annot"><span class="annottext">VerKeyKES (PraosKES c)
</span><a href="#local-6989586621679170626"><span class="hs-identifier hs-var">vkKES</span></a></span><span>
</span><span id="line-494"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Period
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Period) -&gt; Word64 -&gt; Period
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Word64
</span><span class="hs-identifier hs-var hs-var">unSlotNo</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170634"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>           </span><span class="annot"><span class="annottext">signed
</span><a href="#local-6989586621679170635"><span class="hs-identifier hs-var">toSign</span></a></span><span>
</span><span id="line-496"></span><span>           </span><span class="annot"><span class="annottext">SignedKES (PraosKES c) signed
</span><a href="#local-6989586621679170637"><span class="hs-identifier hs-var">praosSignature</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-497"></span><span>       </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ExceptT (PraosValidationError c) Identity ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>       </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679170621"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679170621"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(PraosValidationError c
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
-&gt; VerKeyKES (PraosKES c)
-&gt; Natural
-&gt; SigKES (PraosKES c)
-&gt; PraosValidationError c
forall c.
String
-&gt; VerKeyKES (PraosKES c)
-&gt; Natural
-&gt; SigKES (PraosKES c)
-&gt; PraosValidationError c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidSig"><span class="hs-identifier hs-var">PraosInvalidSig</span></a></span><span>
</span><span id="line-499"></span><span>                                  </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679170621"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-500"></span><span>                                  </span><span class="annot"><span class="annottext">VerKeyKES (PraosKES c)
</span><a href="#local-6989586621679170626"><span class="hs-identifier hs-var">vkKES</span></a></span><span>
</span><span id="line-501"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Natural) -&gt; Word64 -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Word64
</span><span class="hs-identifier hs-var hs-var">unSlotNo</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170634"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignedKES (PraosKES c) signed -&gt; SigKES (PraosKES c)
forall v a. SignedKES v a -&gt; SigKES v
</span><span class="hs-identifier hs-var hs-var">getSig</span></span><span> </span><span class="annot"><span class="annottext">SignedKES (PraosKES c) signed
</span><a href="#local-6989586621679170637"><span class="hs-identifier hs-var">praosSignature</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679170619"><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170619"><span class="hs-identifier hs-var">rho'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679170618"><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170618"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679170617"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679170617"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
-&gt; [BlockInfo c]
-&gt; SlotNo
-&gt; CoreNodeId
-&gt; ((Natural, SlotNo, VRFType), (Natural, SlotNo, VRFType), Double)
forall c.
PraosCrypto c =&gt;
ConsensusConfig (Praos c)
-&gt; [BlockInfo c]
-&gt; SlotNo
-&gt; CoreNodeId
-&gt; ((Natural, SlotNo, VRFType), (Natural, SlotNo, VRFType), Double)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#rhoYT"><span class="hs-identifier hs-var">rhoYT</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170644"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PraosChainDepState c -&gt; [BlockInfo c]
forall c. PraosChainDepState c -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosHistory"><span class="hs-identifier hs-var hs-var">praosHistory</span></a></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c
</span><a href="#local-6989586621679170632"><span class="hs-identifier hs-var">cds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170634"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679170628"><span class="hs-identifier hs-var">nid</span></a></span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span>    </span><span class="hs-comment">-- verify rho proof</span><span>
</span><span id="line-507"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ExceptT (PraosValidationError c) Identity ()
-&gt; ExceptT (PraosValidationError c) Identity ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContextVRF (PraosVRF c)
-&gt; VerKeyVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; Bool
forall v a.
(VRFAlgorithm v, Signable v a) =&gt;
ContextVRF v -&gt; VerKeyVRF v -&gt; a -&gt; CertifiedVRF v a -&gt; Bool
</span><span class="hs-identifier hs-var">verifyCertified</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679170625"><span class="hs-identifier hs-var">vkVRF</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170619"><span class="hs-identifier hs-var">rho'</span></a></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170630"><span class="hs-identifier hs-var">praosRho</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExceptT (PraosValidationError c) Identity ()
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; ExceptT (PraosValidationError c) Identity ()
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-508"></span><span>        </span><span class="annot"><span class="annottext">PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(PraosValidationError c
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; Natural
-&gt; CertVRF (PraosVRF c)
-&gt; PraosValidationError c
forall c.
VerKeyVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; Natural
-&gt; CertVRF (PraosVRF c)
-&gt; PraosValidationError c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidCert"><span class="hs-identifier hs-var">PraosInvalidCert</span></a></span><span>
</span><span id="line-509"></span><span>            </span><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679170625"><span class="hs-identifier hs-var">vkVRF</span></a></span><span>
</span><span id="line-510"></span><span>            </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170619"><span class="hs-identifier hs-var">rho'</span></a></span><span>
</span><span id="line-511"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OutputVRF (PraosVRF c) -&gt; Natural
forall v. OutputVRF v -&gt; Natural
</span><span class="hs-identifier hs-var">getOutputVRFNatural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; OutputVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; OutputVRF v
</span><span class="hs-identifier hs-var hs-var">certifiedOutput</span></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170630"><span class="hs-identifier hs-var">praosRho</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; CertVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; CertVRF v
</span><span class="hs-identifier hs-var hs-var">certifiedProof</span></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170630"><span class="hs-identifier hs-var">praosRho</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-comment">-- verify y proof</span><span>
</span><span id="line-515"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ExceptT (PraosValidationError c) Identity ()
-&gt; ExceptT (PraosValidationError c) Identity ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContextVRF (PraosVRF c)
-&gt; VerKeyVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; Bool
forall v a.
(VRFAlgorithm v, Signable v a) =&gt;
ContextVRF v -&gt; VerKeyVRF v -&gt; a -&gt; CertifiedVRF v a -&gt; Bool
</span><span class="hs-identifier hs-var">verifyCertified</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679170625"><span class="hs-identifier hs-var">vkVRF</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170618"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170629"><span class="hs-identifier hs-var">praosY</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExceptT (PraosValidationError c) Identity ()
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; ExceptT (PraosValidationError c) Identity ()
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-516"></span><span>        </span><span class="annot"><span class="annottext">PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(PraosValidationError c
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; Natural
-&gt; CertVRF (PraosVRF c)
-&gt; PraosValidationError c
forall c.
VerKeyVRF (PraosVRF c)
-&gt; (Natural, SlotNo, VRFType)
-&gt; Natural
-&gt; CertVRF (PraosVRF c)
-&gt; PraosValidationError c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInvalidCert"><span class="hs-identifier hs-var">PraosInvalidCert</span></a></span><span>
</span><span id="line-517"></span><span>            </span><span class="annot"><span class="annottext">VerKeyVRF (PraosVRF c)
</span><a href="#local-6989586621679170625"><span class="hs-identifier hs-var">vkVRF</span></a></span><span>
</span><span id="line-518"></span><span>            </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170618"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-519"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OutputVRF (PraosVRF c) -&gt; Natural
forall v. OutputVRF v -&gt; Natural
</span><span class="hs-identifier hs-var">getOutputVRFNatural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; OutputVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; OutputVRF v
</span><span class="hs-identifier hs-var hs-var">certifiedOutput</span></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170629"><span class="hs-identifier hs-var">praosY</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; CertVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; CertVRF v
</span><span class="hs-identifier hs-var hs-var">certifiedProof</span></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170629"><span class="hs-identifier hs-var">praosY</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span>    </span><span class="hs-comment">-- verify stake</span><span>
</span><span id="line-523"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ExceptT (PraosValidationError c) Identity ()
-&gt; ExceptT (PraosValidationError c) Identity ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OutputVRF (PraosVRF c) -&gt; Natural
forall v. OutputVRF v -&gt; Natural
</span><span class="hs-identifier hs-var">getOutputVRFNatural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; OutputVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; OutputVRF v
</span><span class="hs-identifier hs-var hs-var">certifiedOutput</span></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170629"><span class="hs-identifier hs-var">praosY</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679170617"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExceptT (PraosValidationError c) Identity ()
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; ExceptT (PraosValidationError c) Identity ()
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-524"></span><span>        </span><span class="annot"><span class="annottext">PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(PraosValidationError c
 -&gt; ExceptT (PraosValidationError c) Identity ())
-&gt; PraosValidationError c
-&gt; ExceptT (PraosValidationError c) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Natural -&gt; PraosValidationError c
forall c. Double -&gt; Natural -&gt; PraosValidationError c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosInsufficientStake"><span class="hs-identifier hs-var">PraosInsufficientStake</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679170617"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; PraosValidationError c)
-&gt; Natural -&gt; PraosValidationError c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-525"></span><span>                       </span><span class="annot"><span class="annottext">OutputVRF (PraosVRF c) -&gt; Natural
forall v. OutputVRF v -&gt; Natural
</span><span class="hs-identifier hs-var">getOutputVRFNatural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; OutputVRF (PraosVRF c)
forall v a. CertifiedVRF v a -&gt; OutputVRF v
</span><span class="hs-identifier hs-var hs-var">certifiedOutput</span></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170629"><span class="hs-identifier hs-var">praosY</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span>    </span><span class="hs-comment">-- &quot;store&quot; a block by adding it to the chain dependent state</span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679170614"><span class="annot"><span class="annottext">bi :: BlockInfo c
</span><a href="#local-6989586621679170614"><span class="hs-identifier hs-var hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockInfo :: forall c.
SlotNo
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; BlockInfo c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span>
</span><span id="line-529"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">biSlot :: SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var">biSlot</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170634"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-530"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">biRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biRho"><span class="hs-identifier hs-var">biRho</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170630"><span class="hs-identifier hs-var">praosRho</span></a></span><span>
</span><span id="line-531"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span>    </span><span class="annot"><span class="annottext">PraosChainDepState c
-&gt; ExceptT (PraosValidationError c) Identity (PraosChainDepState c)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(PraosChainDepState c
 -&gt; ExceptT
      (PraosValidationError c) Identity (PraosChainDepState c))
-&gt; PraosChainDepState c
-&gt; ExceptT (PraosValidationError c) Identity (PraosChainDepState c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c] -&gt; PraosChainDepState c
forall c. [BlockInfo c] -&gt; PraosChainDepState c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-var">PraosChainDepState</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockInfo c] -&gt; PraosChainDepState c)
-&gt; [BlockInfo c] -&gt; PraosChainDepState c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679170614"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c -&gt; [BlockInfo c] -&gt; [BlockInfo c]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c -&gt; [BlockInfo c]
forall c. PraosChainDepState c -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosHistory"><span class="hs-identifier hs-var hs-var">praosHistory</span></a></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c
</span><a href="#local-6989586621679170632"><span class="hs-identifier hs-var">cds</span></a></span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span>  </span><span id="local-6989586621679170613"><span class="annot"><span class="annottext">reupdateChainDepState :: ConsensusConfig (Praos c)
-&gt; ValidateView (Praos c)
-&gt; SlotNo
-&gt; Ticked (ChainDepState (Praos c))
-&gt; ChainDepState (Praos c)
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">reupdateChainDepState</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-536"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosValidateView"><span class="hs-identifier hs-type">PraosValidateView</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170610"><span id="local-6989586621679170611"><span class="annot"><a href="#local-6989586621679170610"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>                        </span><span id="local-6989586621679170609"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170609"><span class="hs-identifier hs-var">slot</span></a></span></span><span>
</span><span id="line-538"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TickedPraosChainDepState"><span class="hs-identifier hs-type">TickedPraosChainDepState</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">TickedTrivial</span></a></span><span> </span><span id="local-6989586621679170608"><span class="annot"><a href="#local-6989586621679170608"><span class="hs-identifier hs-var">cds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosExtraFields"><span class="hs-identifier hs-type">PraosExtraFields</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170605"><span id="local-6989586621679170606"><span id="local-6989586621679170607"><span class="annot"><span class="annottext">CoreNodeId
CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosY :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosCreator :: CoreNodeId
praosY :: forall c.
PraosExtraFields c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosRho :: forall c.
PraosExtraFields c
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
praosCreator :: forall c. PraosExtraFields c -&gt; CoreNodeId
</span><a href="#local-6989586621679170605"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosExtraFields c
</span><a href="#local-6989586621679170610"><span class="hs-identifier hs-var">praosExtraFields</span></a></span><span>
</span><span id="line-540"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679170604"><span class="annot"><span class="annottext">bi :: BlockInfo c
</span><a href="#local-6989586621679170604"><span class="hs-identifier hs-var hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockInfo :: forall c.
SlotNo
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; BlockInfo c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span>
</span><span id="line-541"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">biSlot :: SlotNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biSlot"><span class="hs-identifier hs-var">biSlot</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170609"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-542"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">biRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#biRho"><span class="hs-identifier hs-var">biRho</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170606"><span class="hs-identifier hs-var">praosRho</span></a></span><span>
</span><span id="line-543"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockInfo c] -&gt; PraosChainDepState c
forall c. [BlockInfo c] -&gt; PraosChainDepState c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosChainDepState"><span class="hs-identifier hs-var">PraosChainDepState</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockInfo c] -&gt; PraosChainDepState c)
-&gt; [BlockInfo c] -&gt; PraosChainDepState c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c
</span><a href="#local-6989586621679170604"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo c -&gt; [BlockInfo c] -&gt; [BlockInfo c]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c -&gt; [BlockInfo c]
forall c. PraosChainDepState c -&gt; [BlockInfo c]
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosHistory"><span class="hs-identifier hs-var hs-var">praosHistory</span></a></span><span> </span><span class="annot"><span class="annottext">PraosChainDepState c
</span><a href="#local-6989586621679170608"><span class="hs-identifier hs-var">cds</span></a></span></span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-comment">-- (Standard) Praos uses the standard chain selection rule, so no need to</span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-comment">-- override (though see note regarding clock skew).</span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span class="hs-comment">-- | Probability for stakeholder U&#7522; to be elected in slot</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- sl&#11388; considering its relative stake &#945;&#7522;.</span><span>
</span><span id="line-551"></span><span id="local-6989586621679171101"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#phi"><span class="hs-identifier hs-type">phi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171101"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Rational</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span></span><span>
</span><span id="line-552"></span><span id="phi"><span class="annot"><span class="annottext">phi :: ConsensusConfig (Praos c) -&gt; Rational -&gt; Double
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#phi"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosConfig"><span class="hs-identifier hs-type">PraosConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170597"><span id="local-6989586621679170598"><span id="local-6989586621679170599"><span id="local-6989586621679170600"><span id="local-6989586621679170601"><span id="local-6989586621679170602"><span class="annot"><a href="#local-6989586621679170597"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679170596"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679170596"><span class="hs-identifier hs-var">alpha</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679170595"><span class="hs-identifier hs-var">praosLeaderF</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">**</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">fromRational</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679170596"><span class="hs-identifier hs-var">alpha</span></a></span><span>
</span><span id="line-553"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosParams"><span class="hs-identifier hs-type">PraosParams</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170592"><span id="local-6989586621679170593"><span id="local-6989586621679170595"><span class="annot"><span class="annottext">Double
Word64
SecurityParam
praosSlotsPerEpoch :: Word64
praosSecurityParam :: SecurityParam
praosLeaderF :: Double
praosSlotsPerEpoch :: PraosParams -&gt; Word64
praosSecurityParam :: PraosParams -&gt; SecurityParam
praosLeaderF :: PraosParams -&gt; Double
</span><a href="#local-6989586621679170592"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PraosParams
</span><a href="#local-6989586621679170602"><span class="hs-identifier hs-var">praosParams</span></a></span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span class="hs-comment">-- | Compute T&#7522; for a given stakeholder @n@ at a @SlotNo@. Will be computed from</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- 'praosEvolvingStake' (or taken from 'praosInitialStake' if checking epoch 0).</span><span>
</span><span id="line-558"></span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#leaderThreshold"><span class="hs-identifier hs-type">leaderThreshold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679171099"><span class="annot"><a href="#local-6989586621679171099"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171099"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-559"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171099"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171099"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-561"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span>
</span><span id="line-562"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span>
</span><span id="line-563"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-564"></span><span id="leaderThreshold"><span class="annot"><span class="annottext">leaderThreshold :: ConsensusConfig (Praos c)
-&gt; [BlockInfo c] -&gt; SlotNo -&gt; CoreNodeId -&gt; Double
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#leaderThreshold"><span class="hs-identifier hs-var hs-var">leaderThreshold</span></a></span></span><span> </span><span id="local-6989586621679170590"><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170590"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679170589"><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679170589"><span class="hs-identifier hs-var">_blockInfos</span></a></span></span><span> </span><span id="local-6989586621679170588"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170588"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679170587"><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679170587"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-565"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-566"></span><span>      </span><span id="local-6989586621679170586"><span class="annot"><span class="annottext">alpha :: Rational
</span><a href="#local-6989586621679170586"><span class="hs-identifier hs-var hs-var">alpha</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; CoreNodeId -&gt; StakeDist -&gt; Rational
</span><a href="Ouroboros.Consensus.Mock.Ledger.Stake.html#stakeWithDefault"><span class="hs-identifier hs-var">stakeWithDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679170587"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-567"></span><span>        </span><span class="annot"><span class="annottext">(StakeDist -&gt; Rational) -&gt; StakeDist -&gt; Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StakeDist -&gt; Maybe StakeDist -&gt; StakeDist
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; StakeDist
forall c. ConsensusConfig (Praos c) -&gt; StakeDist
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosInitialStake"><span class="hs-identifier hs-var hs-var">praosInitialStake</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170590"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>        </span><span class="annot"><span class="annottext">(Maybe StakeDist -&gt; StakeDist) -&gt; Maybe StakeDist -&gt; StakeDist
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PraosEvolvingStake -&gt; EpochNo -&gt; Maybe StakeDist
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#latestEvolvedStakeDistAsOfEpoch"><span class="hs-identifier hs-var">latestEvolvedStakeDistAsOfEpoch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; PraosEvolvingStake
forall c. ConsensusConfig (Praos c) -&gt; PraosEvolvingStake
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#praosEvolvingStake"><span class="hs-identifier hs-var hs-var">praosEvolvingStake</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170590"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; SlotNo -&gt; EpochNo
forall c. ConsensusConfig (Praos c) -&gt; SlotNo -&gt; EpochNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#slotEpoch"><span class="hs-identifier hs-var">slotEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170590"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170588"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-570"></span><span>      </span><span class="hs-comment">-- 2^(l_VRF * 8) * &#981;_f(&#945;&#7522;)</span><span>
</span><span id="line-571"></span><span>      </span><span class="hs-comment">-- the 8 factor converts from bytes to bits.</span><span>
</span><span id="line-572"></span><span>      </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Period -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">^</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (PraosHash c) -&gt; Period
forall h (proxy :: * -&gt; *). HashAlgorithm h =&gt; proxy h -&gt; Period
</span><span class="hs-identifier hs-var">sizeHash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (PraosHash c)
forall k (t :: k). Proxy t
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosHash"><span class="hs-identifier hs-type">PraosHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171099"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Period -&gt; Period -&gt; Period
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Period
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; Rational -&gt; Double
forall c. ConsensusConfig (Praos c) -&gt; Rational -&gt; Double
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#phi"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170590"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679170586"><span class="hs-identifier hs-var">alpha</span></a></span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span class="hs-comment">-- |Compute the rho, y and T&#7522; parameters for a given slot.</span><span>
</span><span id="line-575"></span><span id="local-6989586621679171142"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#rhoYT"><span class="hs-identifier hs-type">rhoYT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171142"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-576"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">ConsensusConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#Praos"><span class="hs-identifier hs-type">Praos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171142"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171142"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-578"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span>
</span><span id="line-579"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">CoreNodeId</span></a></span><span>
</span><span id="line-580"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-583"></span><span>         </span><span class="hs-special">)</span></span><span>
</span><span id="line-584"></span><span id="rhoYT"><span class="annot"><span class="annottext">rhoYT :: ConsensusConfig (Praos c)
-&gt; [BlockInfo c]
-&gt; SlotNo
-&gt; CoreNodeId
-&gt; ((Natural, SlotNo, VRFType), (Natural, SlotNo, VRFType), Double)
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#rhoYT"><span class="hs-identifier hs-var hs-var">rhoYT</span></a></span></span><span> </span><span id="local-6989586621679170583"><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170583"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679170582"><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679170582"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679170581"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170581"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679170580"><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679170580"><span class="hs-identifier hs-var">nid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-585"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679170579"><span class="annot"><span class="annottext">e :: EpochNo
</span><a href="#local-6989586621679170579"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; SlotNo -&gt; EpochNo
forall c. ConsensusConfig (Praos c) -&gt; SlotNo -&gt; EpochNo
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#slotEpoch"><span class="hs-identifier hs-var">slotEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170583"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170581"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-586"></span><span>        </span><span id="local-6989586621679170578"><span class="annot"><span class="annottext">eta :: Natural
</span><a href="#local-6989586621679170578"><span class="hs-identifier hs-var hs-var">eta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c) -&gt; [BlockInfo c] -&gt; EpochNo -&gt; Natural
forall c.
PraosCrypto c =&gt;
ConsensusConfig (Praos c) -&gt; [BlockInfo c] -&gt; EpochNo -&gt; Natural
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#infosEta"><span class="hs-identifier hs-var">infosEta</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170583"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679170582"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679170579"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-587"></span><span>        </span><span id="local-6989586621679170577"><span class="annot"><span class="annottext">rho :: (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170577"><span class="hs-identifier hs-var hs-var">rho</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679170578"><span class="hs-identifier hs-var">eta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170581"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VRFType
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#NONCE"><span class="hs-identifier hs-var">NONCE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>        </span><span id="local-6989586621679170576"><span class="annot"><span class="annottext">y :: (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170576"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679170578"><span class="hs-identifier hs-var">eta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170581"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VRFType
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#TEST"><span class="hs-identifier hs-var">TEST</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>        </span><span id="local-6989586621679170575"><span class="annot"><span class="annottext">t :: Double
</span><a href="#local-6989586621679170575"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
-&gt; [BlockInfo c] -&gt; SlotNo -&gt; CoreNodeId -&gt; Double
forall c.
PraosCrypto c =&gt;
ConsensusConfig (Praos c)
-&gt; [BlockInfo c] -&gt; SlotNo -&gt; CoreNodeId -&gt; Double
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#leaderThreshold"><span class="hs-identifier hs-var">leaderThreshold</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusConfig (Praos c)
</span><a href="#local-6989586621679170583"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockInfo c]
</span><a href="#local-6989586621679170582"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170581"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CoreNodeId
</span><a href="#local-6989586621679170580"><span class="hs-identifier hs-var">nid</span></a></span><span>
</span><span id="line-590"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170577"><span class="hs-identifier hs-var">rho</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170576"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679170575"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Crypto models
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KESAlgorithm</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679171096"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VRFAlgorithm</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679171096"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HashAlgorithm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosHash"><span class="hs-identifier hs-type">PraosHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171096"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171096"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-600"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171096"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">Condense</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigKES</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171096"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.Crypto.VRF.Class.Signable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171096"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContextKES</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-type">PraosKES</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171096"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContextVRF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-type">PraosVRF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679171096"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="PraosCrypto"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-var">PraosCrypto</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679171096"><span class="annot"><a href="#local-6989586621679171096"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="PraosKES"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-var">PraosKES</span></a></span></span><span>  </span><span id="local-6989586621679171096"><span class="annot"><a href="#local-6989586621679171096"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="PraosVRF"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-var">PraosVRF</span></a></span></span><span>  </span><span id="local-6989586621679171096"><span class="annot"><a href="#local-6989586621679171096"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="PraosHash"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosHash"><span class="hs-identifier hs-var">PraosHash</span></a></span></span><span> </span><span id="local-6989586621679171096"><span class="annot"><a href="#local-6989586621679171096"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span class="hs-keyword">data</span><span> </span><span id="PraosStandardCrypto"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosStandardCrypto"><span class="hs-identifier hs-var">PraosStandardCrypto</span></a></span></span><span>
</span><span id="line-611"></span><span class="hs-keyword">data</span><span> </span><span id="PraosMockCrypto"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosMockCrypto"><span class="hs-identifier hs-var">PraosMockCrypto</span></a></span></span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosStandardCrypto"><span class="hs-identifier hs-type">PraosStandardCrypto</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PraosKES"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-var">PraosKES</span></a></span></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosStandardCrypto"><span class="hs-identifier hs-type">PraosStandardCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SimpleKES</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ed448DSIGN</span></span><span> </span><span class="annot"><span class="hs-number">1000</span></span><span>
</span><span id="line-615"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PraosVRF"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-var">PraosVRF</span></a></span></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosStandardCrypto"><span class="hs-identifier hs-type">PraosStandardCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SimpleVRF</span></span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PraosHash"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosHash"><span class="hs-identifier hs-var">PraosHash</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosStandardCrypto"><span class="hs-identifier hs-type">PraosStandardCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SHA256</span></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosMockCrypto"><span class="hs-identifier hs-type">PraosMockCrypto</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-619"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PraosKES"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosKES"><span class="hs-identifier hs-var">PraosKES</span></a></span></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosMockCrypto"><span class="hs-identifier hs-type">PraosMockCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MockKES</span></span><span> </span><span class="annot"><span class="hs-number">10000</span></span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PraosVRF"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosVRF"><span class="hs-identifier hs-var">PraosVRF</span></a></span></span><span>  </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosMockCrypto"><span class="hs-identifier hs-type">PraosMockCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MockVRF</span></span><span>
</span><span id="line-621"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PraosHash"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosHash"><span class="hs-identifier hs-var">PraosHash</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosMockCrypto"><span class="hs-identifier hs-type">PraosMockCrypto</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SHA256</span></span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Condense
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span id="local-6989586621679170552"><span id="local-6989586621679170553"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170553"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-type">Condense</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170553"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170552"><span class="hs-identifier hs-type">toSign</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-628"></span><span>   </span><span id="local-6989586621679170549"><span class="annot"><span class="annottext">condense :: PraosFields c toSign -&gt; String
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">condense</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosFields"><span class="hs-identifier hs-type">PraosFields</span></a></span><span class="hs-special">{</span><span id="local-6989586621679170546"><span id="local-6989586621679170547"><span class="annot"><span class="annottext">SignedKES (PraosKES c) toSign
PraosExtraFields c
praosExtraFields :: PraosExtraFields c
praosSignature :: SignedKES (PraosKES c) toSign
praosExtraFields :: forall crypto typeBeingSigned.
PraosFields crypto typeBeingSigned -&gt; PraosExtraFields crypto
praosSignature :: forall crypto typeBeingSigned.
PraosFields crypto typeBeingSigned
-&gt; SignedKES (PraosKES crypto) typeBeingSigned
</span><a href="#local-6989586621679170546"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignedKES (PraosKES c) toSign -&gt; String
forall a. Condense a =&gt; a -&gt; String
</span><a href="../file:///home/runner/work/ouroboros-network/ouroboros-network/dist-newstyle/build/x86_64-linux/ghc-8.10.4/ouroboros-consensus-0.1.0.0/noopt/doc/html/ouroboros-consensus/src"><span class="hs-identifier hs-var">condense</span></a></span><span> </span><span class="annot"><span class="annottext">SignedKES (PraosKES c) toSign
</span><a href="#local-6989586621679170547"><span class="hs-identifier hs-var">praosSignature</span></a></span></span></span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span class="hs-comment">{-------------------------------------------------------------------------------
  Serialisation
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span id="local-6989586621679170545"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679170539"><span id="local-6989586621679170541"><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#PraosCrypto"><span class="hs-identifier hs-type">PraosCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170545"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Serialise</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679170545"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-635"></span><span>  </span><span id="local-6989586621679170538"><span class="annot"><span class="annottext">encode :: BlockInfo c -&gt; Encoding
</span><a href="#local-6989586621679170538"><span class="hs-identifier hs-var hs-var hs-var hs-var">encode</span></a></span></span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679170536"><span id="local-6989586621679170537"><span class="annot"><span class="annottext">SlotNo
CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
biRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
biSlot :: SlotNo
biRho :: forall c.
BlockInfo c -&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
biSlot :: forall c. BlockInfo c -&gt; SlotNo
</span><a href="#local-6989586621679170536"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Encoding] -&gt; Encoding
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Period -&gt; Encoding
</span><span class="hs-identifier hs-var">encodeListLen</span></span><span> </span><span class="annot"><span class="annottext">Period
</span><span class="hs-number">2</span></span><span>
</span><span id="line-637"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Encoding
forall a. Serialise a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170537"><span class="hs-identifier hs-var">biSlot</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType) -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toCBOR</span></span><span> </span><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170536"><span class="hs-identifier hs-var">biRho</span></a></span><span>
</span><span id="line-639"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-640"></span><span>  </span><span id="local-6989586621679170535"><span class="annot"><span class="annottext">decode :: Decoder s (BlockInfo c)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">decode</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-641"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Decoder s ()
forall s. Int -&gt; Decoder s ()
</span><span class="hs-identifier hs-var">decodeListLenOf</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-642"></span><span>    </span><span id="local-6989586621679170533"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679170533"><span class="hs-identifier hs-var">biSlot</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s SlotNo
forall a s. Serialise a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">decode</span></span><span>
</span><span id="line-643"></span><span>    </span><span id="local-6989586621679170532"><span class="annot"><span class="annottext">CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
</span><a href="#local-6989586621679170532"><span class="hs-identifier hs-var">biRho</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType))
forall a s. FromCBOR a =&gt; Decoder s a
</span><span class="hs-identifier hs-var">fromCBOR</span></span><span>
</span><span id="line-644"></span><span>    </span><span class="annot"><span class="annottext">BlockInfo c -&gt; Decoder s (BlockInfo c)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">BlockInfo :: forall c.
SlotNo
-&gt; CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
-&gt; BlockInfo c
</span><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#BlockInfo"><span class="hs-identifier hs-type">BlockInfo</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">SlotNo
CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
biRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
biSlot :: SlotNo
biRho :: CertifiedVRF (PraosVRF c) (Natural, SlotNo, VRFType)
biSlot :: SlotNo
</span><a href="#local-6989586621679170532"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span></span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SignableRepresentation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ouroboros.Consensus.Mock.Protocol.Praos.html#VRFType"><span class="hs-identifier hs-type">VRFType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-647"></span><span>  </span><span id="local-6989586621679170528"><span class="annot"><span class="annottext">getSignableRepresentation :: (Natural, SlotNo, VRFType) -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">getSignableRepresentation</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; ByteString
</span><span class="hs-identifier hs-var">serializeEncoding'</span></span><span> </span><span class="annot"><span class="annottext">(Encoding -&gt; ByteString)
-&gt; ((Natural, SlotNo, VRFType) -&gt; Encoding)
-&gt; (Natural, SlotNo, VRFType)
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/runner/.ghcup/ghc/8.10.4/share/doc/ghc-8.10.4/html/libraries/base-4.14.1.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural, SlotNo, VRFType) -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toCBOR</span></span><span>
</span><span id="line-648"></span></pre></body></html>